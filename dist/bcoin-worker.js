/*! For license information please see bcoin-worker.js.LICENSE.txt */
module.exports=(()=>{"use strict";var t={1332:(t,e,r)=>{const i=r(1676),s=r(7766),{inspectSymbol:n}=r(5666);class o{constructor(t,e){this.value=0,null!=t&&this.fromOptions(t,e)}fromOptions(t,e){return"string"==typeof e?this.from(e,t):"number"==typeof t?this.fromValue(t):this.fromBTC(t)}toValue(){return this.value}toSatoshis(t){return t?this.value:this.value.toString(10)}toBits(t){return o.encode(this.value,2,t)}toMBTC(t){return o.encode(this.value,5,t)}toBTC(t){return o.encode(this.value,8,t)}to(t,e){switch(t){case"sat":return this.toSatoshis(e);case"ubtc":case"bits":return this.toBits(e);case"mbtc":return this.toMBTC(e);case"btc":return this.toBTC(e)}throw new Error(`Unknown unit "${t}".`)}toString(){return this.toBTC()}fromValue(t){return i(Number.isSafeInteger(t)&&t>=0,"Value must be an int64."),this.value=t,this}fromSatoshis(t){return this.value=o.decode(t,0),this}fromBits(t){return this.value=o.decode(t,2),this}fromMBTC(t){return this.value=o.decode(t,5),this}fromBTC(t){return this.value=o.decode(t,8),this}from(t,e){switch(t){case"sat":return this.fromSatoshis(e);case"ubtc":case"bits":return this.fromBits(e);case"mbtc":return this.fromMBTC(e);case"btc":return this.fromBTC(e)}throw new Error(`Unknown unit "${t}".`)}static fromOptions(t,e){return(new this).fromOptions(t,e)}static fromValue(t){return(new this).fromValue(t)}static fromSatoshis(t){return(new this).fromSatoshis(t)}static fromBits(t){return(new this).fromBits(t)}static fromMBTC(t){return(new this).fromMBTC(t)}static fromBTC(t){return(new this).fromBTC(t)}static from(t,e){return(new this).from(t,e)}[n](){return`<Amount: ${this.toString()}>`}static btc(t,e){return"string"==typeof t?t:o.encode(t,8,e)}static value(t){return"number"==typeof t?t:o.decode(t,8)}static encode(t,e,r){return r?s.toFloat(t,e):s.encode(t,e)}static decode(t,e){return"number"==typeof t?s.fromFloat(t,e):s.decode(t,e)}}t.exports=o},3940:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(6586),o=r(6521),h=r(4875),{encoding:f}=s,u=2147483647;t.exports=class{constructor(){this.version=1,this.height=-1,this.coinbase=!1,this.output=new o,this.spent=!1,this.raw=null}toOutput(){return this.output}toCoin(t){const e=new n;return e.version=this.version,e.height=this.height,e.coinbase=this.coinbase,e.script=this.output.script,e.value=this.output.value,e.hash=t.hash,e.index=t.index,e}fromOutput(t){return this.output=t,this}static fromOutput(t){return(new this).fromOutput(t)}fromCoin(t){return this.version=t.version,this.height=t.height,this.coinbase=t.coinbase,this.output.script=t.script,this.output.value=t.value,this}static fromCoin(t){return(new this).fromCoin(t)}fromTX(t,e,r){return i("number"==typeof e),i("number"==typeof r),i(e>=0&&e<t.outputs.length),this.version=t.version,this.height=r,this.coinbase=t.isCoinbase(),this.output=t.outputs[e],this}static fromTX(t,e,r){return(new this).fromTX(t,e,r)}getSize(){if(this.raw)return this.raw.length;let t=0;return t+=f.sizeVarint(this.version),t+=4,t+=h.size(this.output),t}toWriter(t){if(this.raw)return t.writeBytes(this.raw),t;let e=this.height,r=0;return this.coinbase&&(r|=1),-1===e&&(e=u),r|=e<<1,t.writeVarint(this.version),t.writeU32(r),h.pack(this.output,t),t}toRaw(){if(this.raw)return this.raw;const t=this.getSize(),e=s.write(t);return this.toWriter(e),this.raw=e.render(),this.raw}fromReader(t){const e=t.readVarint(),r=t.readU32();let i=r>>>1;return i===u&&(i=-1),this.version=e,this.coinbase=0!=(1&r),this.height=i,h.unpack(this.output,t),this}static fromReader(t){return(new this).fromReader(t)}fromRaw(t){return this.fromReader(s.read(t)),this.raw=t,this}static fromRaw(t){return(new this).fromRaw(t)}}},4722:(t,e,r)=>{const i=r(1676),s=r(3940);t.exports=class{constructor(){this.outputs=new Map}add(t,e){return i(t>>>0===t),i(e),this.outputs.set(t,e),e}addOutput(t,e){return this.add(t,s.fromOutput(e))}addIndex(t,e,r){return this.add(e,s.fromTX(t,e,r))}addCoin(t){return this.add(t.index,s.fromCoin(t))}has(t){return this.outputs.has(t)}isUnspent(t){const e=this.outputs.get(t);return!(!e||e.spent)}get(t){return this.outputs.get(t)||null}getOutput(t){const e=this.outputs.get(t);return e?e.output:null}getCoin(t){const e=this.outputs.get(t.index);return e?e.toCoin(t):null}spend(t){const e=this.get(t);return!e||e.spent?null:(e.spent=!0,e)}remove(t){const e=this.get(t);return e?(this.outputs.delete(t),e):null}isEmpty(){return 0===this.outputs.size}fromTX(t,e){i("number"==typeof e);for(let r=0;r<t.outputs.length;r++){if(t.outputs[r].script.isUnspendable())continue;const i=s.fromTX(t,r,e);this.outputs.set(r,i)}return this}static fromTX(t,e){return(new this).fromTX(t,e)}}},4377:(t,e,r)=>{const{BufferMap:i}=r(1013),s=r(4722),n=r(1083),o=r(3940);t.exports=class{constructor(){this.map=new i,this.undo=new n}get(t){return this.map.get(t)}has(t){return this.map.has(t)}add(t,e){return this.map.set(t,e),e}ensure(t){return this.map.get(t)||this.add(t,new s)}remove(t){const e=this.map.get(t);return e?(this.map.delete(t),e):null}addTX(t,e){const r=t.hash(),i=s.fromTX(t,e);return this.add(r,i)}removeTX(t,e){const r=t.hash(),i=s.fromTX(t,e);for(const t of i.outputs.values())t.spent=!0;return this.add(r,i)}addEntry(t,e){const{hash:r,index:i}=t;return this.ensure(r).add(i,e)}addCoin(t){return this.ensure(t.hash).addCoin(t)}addOutput(t,e){const{hash:r,index:i}=t;return this.ensure(r).addOutput(i,e)}addIndex(t,e,r){const i=t.hash();return this.ensure(i).addIndex(t,e,r)}spendEntry(t){const{hash:e,index:r}=t,i=this.get(e);if(!i)return null;const s=i.spend(r);return s?(this.undo.push(s),s):null}removeEntry(t){const{hash:e,index:r}=t,i=this.get(e);return i?i.remove(r):null}hasEntry(t){const{hash:e,index:r}=t,i=this.get(e);return!!i&&i.has(r)}getEntry(t){const{hash:e,index:r}=t,i=this.get(e);return i?i.get(r):null}isUnspent(t){const{hash:e,index:r}=t,i=this.get(e);return!!i&&i.isUnspent(r)}getCoin(t){const e=this.get(t.hash);return e?e.getCoin(t):null}getOutput(t){const{hash:e,index:r}=t,i=this.get(e);return i?i.getOutput(r):null}getHeight(t){const e=this.getEntry(t);return e?e.height:-1}isCoinbase(t){const e=this.getEntry(t);return!!e&&e.coinbase}hasEntryFor(t){return this.hasEntry(t.prevout)}getEntryFor(t){return this.getEntry(t.prevout)}isUnspentFor(t){return this.isUnspent(t.prevout)}getCoinFor(t){return this.getCoin(t.prevout)}getOutputFor(t){return this.getOutput(t.prevout)}getHeightFor(t){return this.getHeight(t.prevout)}isCoinbaseFor(t){return this.isCoinbase(t.prevout)}async readCoin(t,e){const r=this.getEntry(e);if(r)return r;const i=await t.readCoin(e);return i?this.addEntry(e,i):null}async readInputs(t,e){let r=!0;for(const{prevout:i}of e.inputs)await this.readCoin(t,i)||(r=!1);return r}async spendInputs(t,e){let r=0;for(;r<e.inputs.length;){const i=Math.min(r+4,e.inputs.length),s=[];for(;r<i;r++){const{prevout:i}=e.inputs[r];s.push(this.readCoin(t,i))}const n=await Promise.all(s);for(const t of n){if(!t||t.spent)return!1;t.spent=!0,this.undo.push(t)}}return!0}getSize(t){let e=0;e+=t.inputs.length;for(const{prevout:r}of t.inputs){const t=this.getEntry(r);t&&(e+=t.getSize())}return e}toWriter(t,e){for(const{prevout:r}of e.inputs){const e=this.getEntry(r);e?(t.writeU8(1),e.toWriter(t)):t.writeU8(0)}return t}fromReader(t,e){for(const{prevout:r}of e.inputs){if(0===t.readU8())continue;const e=o.fromReader(t);this.addEntry(r,e)}return this}static fromReader(t,e){return(new this).fromReader(t,e)}}},4875:(t,e,r)=>{const i=r(1676),{encoding:s}=r(8889),n=r(2581),o=r(6762),h=Buffer.alloc(0);function f(t){if(0===t.length)return!1;switch(t[0]){case 2:case 3:return 33===t.length;case 4:return 65===t.length&&n.publicKeyVerify(t);default:return!1}}e.pack=function(t,e){return e.writeVarint(t.value),function(t,e){const r=t.getPubkeyhash(!0);if(r)return e.writeU8(0),e.writeBytes(r),e;const s=t.getScripthash();if(s)return e.writeU8(1),e.writeBytes(s),e;const o=t.getPubkey(!0);if(o&&f(o)){const t=function(t){let e;switch(t[0]){case 2:case 3:e=t;break;case 4:e=n.publicKeyConvert(t,!0),e[0]=4|1&t[64];break;default:throw new Error("Bad point format.")}return i(33===e.length),e}(o);return e.writeBytes(t),e}e.writeVarint(t.raw.length+6),e.writeBytes(t.raw)}(t.script,e),e},e.unpack=function(t,e){return t.value=e.readVarint(),function(t,e){switch(e.readU8()){case 0:{const r=e.readBytes(20,!0);t.fromPubkeyhash(r);break}case 1:{const r=e.readBytes(20,!0);t.fromScripthash(r);break}case 2:case 3:case 4:case 5:{e.offset-=1;const r=function(t){const e=t[0];switch(i(33===t.length),e){case 2:case 3:return t;case 4:t[0]=2;break;case 5:t[0]=3;break;default:throw new Error("Bad point format.")}const r=n.publicKeyConvert(t,!1);return t[0]=e,r}(e.readBytes(33,!0));t.fromPubkey(r);break}default:{e.offset-=1;const r=e.readVarint()-6;if(r>o.MAX_SCRIPT_SIZE)t.fromNulldata(h),e.seek(r);else{const i=e.readBytes(r);t.fromRaw(i)}break}}}(t.script,e),t},e.size=function(t){let e=0;return e+=s.sizeVarint(t.value),e+=function(t){if(t.isPubkeyhash(!0))return 21;if(t.isScripthash())return 21;const e=t.getPubkey(!0);if(e&&f(e))return 33;let r=0;return r+=s.sizeVarint(t.raw.length+6),r+=t.raw.length,r}(t.script),e}},1083:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(3940);t.exports=class{constructor(){this.items=[]}push(t){return this.items.push(t)}getSize(){let t=0;t+=4;for(const e of this.items)t+=e.getSize();return t}toRaw(){const t=this.getSize(),e=s.write(t);e.writeU32(this.items.length);for(const t of this.items)t.toWriter(e);return e.render()}fromRaw(t){const e=s.read(t),r=e.readU32();for(let t=0;t<r;t++)this.items.push(n.fromReader(e));return this}static fromRaw(t){return(new this).fromRaw(t)}isEmpty(){return 0===this.items.length}commit(){const t=this.toRaw();return this.items.length=0,t}apply(t,e){const r=this.items.pop();i(r),t.addEntry(e,r)}}},4951:(t,e,r)=>{const i=r(1676),s=r(2355);function n(t,e){i(t.length===e.length);for(let r=t.length-1;r>=0;r--){if(t[r]<e[r])return-1;if(t[r]>e[r])return 1}return 0}t.exports=function(t,e,r,i){let o=r;for(t.writeUInt32LE(o,76,!0);o<=i;){if(n(s.digest(t),e)<=0)return o;o+=1,t.writeUInt32LE(o,76,!0)}return-1}},7911:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(4450),o=r(8401),h=r(2372),f=r(1808),u=r(2355),a=r(6853),c=r(6762),{inspectSymbol:d}=r(5666),l=Buffer.alloc(20,0);class m{constructor(t,e){this.type=m.types.PUBKEYHASH,this.version=-1,this.hash=l,t&&this.fromOptions(t,e)}fromOptions(t,e){if("string"==typeof t)return this.fromString(t,e);i(t);const{hash:r,type:s,version:n}=t;return this.fromHash(r,s,n)}static fromOptions(t,e){return(new this).fromOptions(t,e)}getHash(t){return"hex"===t?this.hash.toString("hex"):this.hash}isNull(){if(20===this.hash.length)return this.hash.equals(l);if(32===this.hash.length)return this.hash.equals(c.ZERO_HASH);for(let t=0;t<this.hash.length;t++)if(0!==this.hash[t])return!1;return!0}equals(t){return i(t instanceof m),this.type===t.type&&this.version===t.version&&this.hash.equals(t.hash)}getType(){return m.typesByVal[this.type].toLowerCase()}getPrefix(t){const e=(t=a.get(t)).addressPrefix;switch(this.type){case m.types.PUBKEYHASH:return e.pubkeyhash;case m.types.SCRIPTHASH:return e.scripthash;case m.types.WITNESS:if(20===this.hash.length)return e.witnesspubkeyhash;if(32===this.hash.length)return e.witnessscripthash}return-1}getSize(){let t=5+this.hash.length;return-1!==this.version&&(t+=2),t}toRaw(t){const e=this.getSize(),r=s.write(e),n=this.getPrefix(t);return i(-1!==n,"Not a valid address prefix."),r.writeU8(n),-1!==this.version&&(r.writeU8(this.version),r.writeU8(0)),r.writeBytes(this.hash),r.writeChecksum(u.digest),r.render()}toBase58(t){return n.encode(this.toRaw(t))}toBech32(t){const e=this.version,r=this.hash;i(-1!==e,"Cannot convert non-program address to bech32.");const s=(t=a.get(t)).addressPrefix.bech32;return o.encode(s,e,r)}fromString(t,e){if(i("string"==typeof t),i(t.length>0),i(t.length<=100),function(t){let e=!1,r=!1;for(let s=0;s<t.length;s++){const n=t.charCodeAt(s);if(!(n>=48&&n<=57)&&(32&n?(i(n>=97&&n<=122),e=!0):(i(n>=65&&n<=90),r=!0),e&&r))return!0}return!1}(t))return this.fromBase58(t,e);try{return this.fromBech32(t,e)}catch(r){return this.fromBase58(t,e)}}static fromString(t,e){return(new this).fromString(t,e)}toString(t){return-1!==this.version?this.toBech32(t):this.toBase58(t)}[d](){return`<Address: type=${this.getType()} version=${this.version} str=${this.toString()}>`}fromRaw(t,e){const r=s.read(t,!0),i=r.readU8();e=a.fromAddress(i,e);const n=m.getType(i,e);let o=-1;if(n===m.types.WITNESS){if(t.length>38)throw new Error("Address is too long.");if(o=r.readU8(),0!==r.readU8())throw new Error("Address version padding is non-zero.")}else if(25!==t.length)throw new Error("Address is too long.");const h=r.readBytes(r.left()-4);return r.verifyChecksum(u.digest),this.fromHash(h,n,o)}static fromRaw(t,e){return(new this).fromRaw(t,e)}fromBase58(t,e){if(i("string"==typeof t),t.length>55)throw new Error("Address is too long.");return this.fromRaw(n.decode(t),e)}static fromBase58(t,e){return(new this).fromBase58(t,e)}fromBech32(t,e){const r=m.types.WITNESS;i("string"==typeof t);const[s,n,h]=o.decode(t);return a.fromBech32(s,e),this.fromHash(h,r,n)}static fromBech32(t,e){return(new this).fromBech32(t,e)}fromScript(t){const e=t.getPubkey();if(e)return this.hash=f.digest(e),this.type=m.types.PUBKEYHASH,this.version=-1,this;const r=t.getPubkeyhash();if(r)return this.hash=r,this.type=m.types.PUBKEYHASH,this.version=-1,this;const i=t.getScripthash();if(i)return this.hash=i,this.type=m.types.SCRIPTHASH,this.version=-1,this;const s=t.getProgram();return s&&!s.isMalformed()?(this.hash=s.data,this.type=m.types.WITNESS,this.version=s.version,this):t.isMultisig()?(this.hash=t.hash160(),this.type=m.types.SCRIPTHASH,this.version=-1,this):null}fromWitness(t){const[,e]=t.getPubkeyhashInput();if(e)return this.hash=f.digest(e),this.type=m.types.WITNESS,this.version=0,this;const r=t.getScripthashInput();return r?(this.hash=h.digest(r),this.type=m.types.WITNESS,this.version=0,this):null}fromInputScript(t){const[,e]=t.getPubkeyhashInput();if(e)return this.hash=f.digest(e),this.type=m.types.PUBKEYHASH,this.version=-1,this;const r=t.getScripthashInput();return r?(this.hash=f.digest(r),this.type=m.types.SCRIPTHASH,this.version=-1,this):null}static fromWitness(t){return(new this).fromWitness(t)}static fromInputScript(t){return(new this).fromInputScript(t)}static fromScript(t){return(new this).fromScript(t)}fromHash(t,e,r){return"string"==typeof e&&(e=m.types[e.toUpperCase()],i(null!=e,"Not a valid address type.")),null==e&&(e=m.types.PUBKEYHASH),null==r&&(r=-1),i(Buffer.isBuffer(t)),i(e>>>0===e),i((0|r)===r),i(e>=m.types.PUBKEYHASH&&e<=m.types.WITNESS,"Not a valid address type."),-1===r?(i(e!==m.types.WITNESS,"Wrong version (witness)"),i(20===t.length,"Hash is the wrong size.")):(i(e===m.types.WITNESS,"Wrong version (non-witness)."),i(r>=0&&r<=16,"Bad program version."),0===r&&e===m.types.WITNESS&&i(20===t.length||32===t.length,"Witness program hash is the wrong size."),i(t.length>=2&&t.length<=40,"Hash is the wrong size.")),this.hash=t,this.type=e,this.version=r,this}static fromHash(t,e,r){return(new this).fromHash(t,e,r)}fromPubkeyhash(t){const e=m.types.PUBKEYHASH;return i(20===t.length,"P2PKH must be 20 bytes."),this.fromHash(t,e,-1)}static fromPubkeyhash(t){return(new this).fromPubkeyhash(t)}fromScripthash(t){const e=m.types.SCRIPTHASH;return i(t&&20===t.length,"P2SH must be 20 bytes."),this.fromHash(t,e,-1)}static fromScripthash(t){return(new this).fromScripthash(t)}fromWitnessPubkeyhash(t){const e=m.types.WITNESS;return i(t&&20===t.length,"P2WPKH must be 20 bytes."),this.fromHash(t,e,0)}static fromWitnessPubkeyhash(t){return(new this).fromWitnessPubkeyhash(t)}fromWitnessScripthash(t){const e=m.types.WITNESS;return i(t&&32===t.length,"P2WPKH must be 32 bytes."),this.fromHash(t,e,0)}static fromWitnessScripthash(t){return(new this).fromWitnessScripthash(t)}fromProgram(t,e){const r=m.types.WITNESS;return i(t>=0,"Bad version for witness program."),this.fromHash(e,r,t)}static fromProgram(t,e){return(new this).fromProgram(t,e)}isPubkeyhash(){return this.type===m.types.PUBKEYHASH}isScripthash(){return this.type===m.types.SCRIPTHASH}isWitnessPubkeyhash(){return 0===this.version&&20===this.hash.length}isWitnessScripthash(){return 0===this.version&&32===this.hash.length}isProgram(){return-1!==this.version}isUnknown(){return-1!==this.version&&(this.version>0||20!==this.hash.length&&32!==this.hash.length)}static getHash(t,e){if(!t)throw new Error("Object is not an address.");let r;if(Buffer.isBuffer(t)){if(20!==t.length&&32!==t.length)throw new Error("Object is not an address.");r=t}else{if(!(t instanceof m))throw new Error("Object is not an address.");r=t.hash}return"hex"===e?r.toString("hex"):r}static getType(t,e){const r=e.addressPrefix;switch(t){case r.pubkeyhash:return m.types.PUBKEYHASH;case r.scripthash:return m.types.SCRIPTHASH;case r.witnesspubkeyhash:case r.witnessscripthash:return m.types.WITNESS;default:throw new Error("Unknown address prefix.")}}}m.types={PUBKEYHASH:0,SCRIPTHASH:1,WITNESS:2},m.typesByVal=["PUBKEYHASH","SCRIPTHASH","WITNESS"],t.exports=m},6586:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(1972),o=r(1332),h=r(6521),f=r(6853),u=r(6762),a=r(8638),{inspectSymbol:c}=r(5666);class d extends h{constructor(t){super(),this.version=1,this.height=-1,this.coinbase=!1,this.hash=u.ZERO_HASH,this.index=0,t&&this.fromOptions(t)}fromOptions(t){return i(t,"Coin data is required."),null!=t.version&&(i(t.version>>>0===t.version,"Version must be a uint32."),this.version=t.version),null!=t.height&&(-1!==t.height?(i(t.height>>>0===t.height,"Height must be a uint32."),this.height=t.height):this.height=-1),null!=t.value&&(i(Number.isSafeInteger(t.value)&&t.value>=0,"Value must be a uint64."),this.value=t.value),t.script&&this.script.fromOptions(t.script),null!=t.coinbase&&(i("boolean"==typeof t.coinbase,"Coinbase must be a boolean."),this.coinbase=t.coinbase),null!=t.hash&&(i(Buffer.isBuffer(t.hash)),this.hash=t.hash),null!=t.index&&(i(t.index>>>0===t.index,"Index must be a uint32."),this.index=t.index),this}static fromOptions(t){return(new this).fromOptions(t)}clone(){i(!1,"Coins are not cloneable.")}getDepth(t){return i("number"==typeof t,"Must pass a height."),-1===this.height||-1===t||t<this.height?0:t-this.height+1}toKey(){return a.toKey(this.hash,this.index)}fromKey(t){const{hash:e,index:r}=a.fromKey(t);return this.hash=e,this.index=r,this}static fromKey(t){return(new this).fromKey(t)}rhash(){return n.revHex(this.hash)}txid(){return this.rhash()}[c](){return{type:this.getType(),version:this.version,height:this.height,value:o.btc(this.value),script:this.script,coinbase:this.coinbase,hash:this.hash?n.revHex(this.hash):null,index:this.index,address:this.getAddress()}}toJSON(){return this.getJSON()}getJSON(t,e){let r=this.getAddress();return t=f.get(t),r&&(r=r.toString(t)),{version:this.version,height:this.height,value:this.value,script:this.script.toJSON(),address:r,coinbase:this.coinbase,hash:e?void 0:this.rhash(),index:e?void 0:this.index}}fromJSON(t){return i(t,"Coin data required."),i(t.version>>>0===t.version,"Version must be a uint32."),i(-1===t.height||t.height>>>0===t.height,"Height must be a uint32."),i(Number.isSafeInteger(t.value)&&t.value>=0,"Value must be a uint64."),i("boolean"==typeof t.coinbase,"Coinbase must be a boolean."),this.version=t.version,this.height=t.height,this.value=t.value,this.script.fromJSON(t.script),this.coinbase=t.coinbase,null!=t.hash&&(i("string"==typeof t.hash,"Hash must be a string."),i(64===t.hash.length,"Hash must be a string."),i(t.index>>>0===t.index,"Index must be a uint32."),this.hash=n.fromRev(t.hash),this.index=t.index),this}static fromJSON(t){return(new this).fromJSON(t)}getSize(){return 17+this.script.getVarSize()}toWriter(t){let e=this.height;return-1===e&&(e=2147483647),t.writeU32(this.version),t.writeU32(e),t.writeI64(this.value),t.writeVarBytes(this.script.toRaw()),t.writeU8(this.coinbase?1:0),t}toRaw(){const t=this.getSize();return this.toWriter(s.write(t)).render()}fromReader(t){return this.version=t.readU32(),this.height=t.readU32(),this.value=t.readI64(),this.script.fromRaw(t.readVarBytes()),this.coinbase=1===t.readU8(),2147483647===this.height&&(this.height=-1),this}fromRaw(t){return this.fromReader(s.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}fromTX(t,e,r){return i("number"==typeof e),i("number"==typeof r),i(e>=0&&e<t.outputs.length),this.version=t.version,this.height=r,this.value=t.outputs[e].value,this.script=t.outputs[e].script,this.coinbase=t.isCoinbase(),this.hash=t.hash(),this.index=e,this}static fromTX(t,e,r){return(new this).fromTX(t,e,r)}static isCoin(t){return t instanceof d}}t.exports=d},5780:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(6853),o=r(4240),h=r(8628),f=r(8638),{inspectSymbol:u}=r(5666);class a{constructor(t){this.prevout=new f,this.script=new o,this.sequence=4294967295,this.witness=new h,t&&this.fromOptions(t)}fromOptions(t){return i(t,"Input data is required."),this.prevout.fromOptions(t.prevout),t.script&&this.script.fromOptions(t.script),null!=t.sequence&&(i(t.sequence>>>0===t.sequence,"Sequence must be a uint32."),this.sequence=t.sequence),t.witness&&this.witness.fromOptions(t.witness),this}static fromOptions(t){return(new this).fromOptions(t)}clone(){const t=new this.constructor;return t.prevout=this.prevout,t.script.inject(this.script),t.sequence=this.sequence,t.witness.inject(this.witness),t}equals(t){return i(a.isInput(t)),this.prevout.equals(t.prevout)}compare(t){return i(a.isInput(t)),this.prevout.compare(t.prevout)}getType(t){if(this.isCoinbase())return"coinbase";if(t)return t.getType();let e;return e=this.witness.items.length>0?this.witness.getInputType():this.script.getInputType(),o.typesByVal[e].toLowerCase()}getRedeem(t){if(this.isCoinbase())return null;if(!t)return this.witness.isScripthashInput()?this.witness.getRedeem():this.script.isScripthashInput()?this.script.getRedeem():null;let e=t.script,r=null;return e.isScripthash()&&(e=this.script.getRedeem(),r=e),e&&e.isWitnessScripthash()&&(e=this.witness.getRedeem(),r=e),r}getSubtype(t){if(this.isCoinbase())return null;const e=this.getRedeem(t);if(!e)return null;const r=e.getType();return o.typesByVal[r].toLowerCase()}getAddress(t){return this.isCoinbase()?null:t?t.getAddress():this.script.code.length>0?this.script.getInputAddress():this.witness.items.length>0?this.witness.getInputAddress():null}getHash(t,e){const r=this.getAddress(t);return r?r.getHash(e):null}isFinal(){return 4294967295===this.sequence}isRBF(){return this.sequence<4294967294}isCoinbase(){return this.prevout.isNull()}[u](){return this.format()}format(t){return{type:this.getType(t),subtype:this.getSubtype(t),address:this.getAddress(t),script:this.script,witness:this.witness,redeem:this.getRedeem(t),sequence:this.sequence,prevout:this.prevout,coin:t||null}}toJSON(t,e){return this.getJSON()}getJSON(t,e){let r;return t=n.get(t),e||(r=this.getAddress(),r&&(r=r.toString(t))),{prevout:this.prevout.toJSON(),script:this.script.toJSON(),witness:this.witness.toJSON(),sequence:this.sequence,address:r,coin:e?e.getJSON(t,!0):void 0}}fromJSON(t){return i(t,"Input data is required."),i(t.sequence>>>0===t.sequence,"Sequence must be a uint32."),this.prevout.fromJSON(t.prevout),this.script.fromJSON(t.script),this.witness.fromJSON(t.witness),this.sequence=t.sequence,this}static fromJSON(t){return(new this).fromJSON(t)}getSize(){return 40+this.script.getVarSize()}toRaw(){const t=this.getSize();return this.toWriter(s.write(t)).render()}toWriter(t){return this.prevout.toWriter(t),t.writeVarBytes(this.script.toRaw()),t.writeU32(this.sequence),t}fromReader(t){return this.prevout.fromReader(t),this.script.fromRaw(t.readVarBytes()),this.sequence=t.readU32(),this}fromRaw(t){return this.fromReader(s.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}fromOutpoint(t){return i(Buffer.isBuffer(t.hash)),i("number"==typeof t.index),this.prevout.hash=t.hash,this.prevout.index=t.index,this}static fromOutpoint(t){return(new this).fromOutpoint(t)}fromCoin(t){return i(Buffer.isBuffer(t.hash)),i("number"==typeof t.index),this.prevout.hash=t.hash,this.prevout.index=t.index,this}static fromCoin(t){return(new this).fromCoin(t)}fromTX(t,e){return i(t),i("number"==typeof e),i(e>=0&&e<t.outputs.length),this.prevout.hash=t.hash(),this.prevout.index=e,this}static fromTX(t,e){return(new this).fromTX(t,e)}static isInput(t){return t instanceof a}}t.exports=a},2359:(t,e,r)=>{const i=r(8889),s=r(1972);class n{constructor(t,e){this.type=t,this.hash=e}getSize(){return 36}toWriter(t){return t.writeU32(this.type),t.writeHash(this.hash),t}toRaw(){return this.toWriter(i.write(36)).render()}fromReader(t){return this.type=t.readU32(),this.hash=t.readHash(),this}fromRaw(t){return this.fromReader(i.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}isBlock(){switch(this.type){case n.types.BLOCK:case n.types.WITNESS_BLOCK:case n.types.FILTERED_BLOCK:case n.types.WITNESS_FILTERED_BLOCK:case n.types.CMPCT_BLOCK:return!0;default:return!1}}isTX(){switch(this.type){case n.types.TX:case n.types.WITNESS_TX:return!0;default:return!1}}hasWitness(){return 0!=(this.type&n.WITNESS_FLAG)}rhash(){return s.revHex(this.hash)}}n.types={TX:1,BLOCK:2,FILTERED_BLOCK:3,CMPCT_BLOCK:4,WITNESS_TX:1|1<<30,WITNESS_BLOCK:2|1<<30,WITNESS_FILTERED_BLOCK:3|1<<30},n.typesByVal={1:"TX",2:"BLOCK",3:"FILTERED_BLOCK",4:"CMPCT_BLOCK",[1|1<<30]:"WITNESS_TX",[2|1<<30]:"WITNESS_BLOCK",[3|1<<30]:"WITNESS_FILTERED_BLOCK"},n.WITNESS_FLAG=1<<30,t.exports=n},1101:(t,e,r)=>{const i=r(1676),s=r(4450),n=r(8889),o=r(1808),h=r(2355),f=r(6853),u=r(4240),a=r(7911),c=r(6521),d=r(2581),{encoding:l}=n,{inspectSymbol:m}=r(5666),p=Buffer.alloc(33,0);class b{constructor(t){this.witness=!1,this.nested=!1,this.publicKey=p,this.privateKey=null,this.script=null,this._keyHash=null,this._keyAddress=null,this._program=null,this._nestedHash=null,this._nestedAddress=null,this._scriptHash160=null,this._scriptHash256=null,this._scriptAddress=null,t&&this.fromOptions(t)}fromOptions(t){let e=g(t);if(null!=t.witness&&(i("boolean"==typeof t.witness),this.witness=t.witness),null!=t.nested&&(i("boolean"==typeof t.nested),this.nested=t.nested),Buffer.isBuffer(e))return this.fromKey(e);e=g(t.key),t.publicKey&&(e=g(t.publicKey)),t.privateKey&&(e=g(t.privateKey));const r=t.script,s=t.compressed;return r?this.fromScript(e,r,s):this.fromKey(e,s)}static fromOptions(t){return(new this).fromOptions(t)}refresh(){this._keyHash=null,this._keyAddress=null,this._program=null,this._nestedHash=null,this._nestedAddress=null,this._scriptHash160=null,this._scriptHash256=null,this._scriptAddress=null}fromPrivate(t,e){return i(Buffer.isBuffer(t),"Private key must be a buffer."),i(d.privateKeyVerify(t),"Not a valid private key."),this.privateKey=t,this.publicKey=d.publicKeyCreate(t,!1!==e),this}static fromPrivate(t,e){return(new this).fromPrivate(t,e)}fromPublic(t){return i(Buffer.isBuffer(t),"Public key must be a buffer."),i(d.publicKeyVerify(t),"Not a valid public key."),this.publicKey=t,this}generate(t){const e=d.privateKeyGenerate();return this.fromKey(e,t)}static generate(t){return(new this).generate(t)}static fromPublic(t){return(new this).fromPublic(t)}fromKey(t,e){return i(Buffer.isBuffer(t),"Key must be a buffer."),32===t.length?this.fromPrivate(t,!1!==e):this.fromPublic(t)}static fromKey(t,e){return(new this).fromKey(t,e)}fromScript(t,e,r){return i(e instanceof u,"Non-script passed into KeyRing."),this.fromKey(t,r),this.script=e,this}static fromScript(t,e,r){return(new this).fromScript(t,e,r)}fromMultisigScript(t,e){i(t instanceof u,"Non-script passed."),i(t.isMultisig(),"Script must be multisig");const r=t.getSmall(-2);return i(e>=1&&e<=r,"Requested `i`th key, `n` available"),this.fromKey(t.code[e].toData()),this}static fromMultisigScript(t,e){return(new this).fromMultisigScript(t,e)}getSecretSize(){let t=0;return t+=1,t+=this.privateKey.length,33===this.publicKey.length&&(t+=1),t+=4,t}toSecret(t){const e=this.getSecretSize(),r=n.write(e);return i(this.privateKey,"Cannot serialize without private key."),t=f.get(t),r.writeU8(t.keyPrefix.privkey),r.writeBytes(this.privateKey),33===this.publicKey.length&&r.writeU8(1),r.writeChecksum(h.digest),s.encode(r.render())}fromSecret(t,e){const r=n.read(s.decode(t),!0),o=r.readU8();f.fromWIF(o,e);const u=r.readBytes(32);let a=!1;return r.left()>4&&(i(1===r.readU8(),"Bad compression flag."),a=!0),r.verifyChecksum(h.digest),this.fromPrivate(u,a)}static fromSecret(t,e){return(new this).fromSecret(t,e)}getPrivateKey(t,e){return this.privateKey?"base58"===t?this.toSecret(e):"hex"===t?this.privateKey.toString("hex"):this.privateKey:null}getPublicKey(t){return"base58"===t?s.encode(this.publicKey):"hex"===t?this.publicKey.toString("hex"):this.publicKey}getScript(){return this.script}getProgram(){if(!this.witness)return null;if(!this._program){let t;if(this.script){const e=this.script.sha256();t=u.fromProgram(0,e)}else{const e=o.digest(this.publicKey);t=u.fromProgram(0,e)}this._program=t}return this._program}getNestedHash(t){return this.witness?(this._nestedHash||(this._nestedHash=this.getProgram().hash160()),"hex"===t?this._nestedHash.toString("hex"):this._nestedHash):null}getNestedAddress(t,e){if(!this.witness)return null;if(!this._nestedAddress){const t=this.getNestedHash(),e=a.fromScripthash(t);this._nestedAddress=e}return"base58"===t?this._nestedAddress.toBase58(e):"string"===t?this._nestedAddress.toString(e):this._nestedAddress}getScriptHash(t){return this.witness?this.getScriptHash256(t):this.getScriptHash160(t)}getScriptHash160(t){return this.script?(this._scriptHash160||(this._scriptHash160=this.script.hash160()),"hex"===t?this._scriptHash160.toString("hex"):this._scriptHash160):null}getScriptHash256(t){return this.script?(this._scriptHash256||(this._scriptHash256=this.script.sha256()),"hex"===t?this._scriptHash256.toString("hex"):this._scriptHash256):null}getScriptAddress(t,e){if(!this.script)return null;if(!this._scriptAddress){let t;if(this.witness){const e=this.getScriptHash256();t=a.fromWitnessScripthash(e)}else{const e=this.getScriptHash160();t=a.fromScripthash(e)}this._scriptAddress=t}return"base58"===t?this._scriptAddress.toBase58(e):"string"===t?this._scriptAddress.toString(e):this._scriptAddress}getKeyHash(t){return this._keyHash||(this._keyHash=o.digest(this.publicKey)),"hex"===t?this._keyHash.toString("hex"):this._keyHash}getKeyAddress(t,e){if(!this._keyAddress){const t=this.getKeyHash();let e;e=this.witness?a.fromWitnessPubkeyhash(t):a.fromPubkeyhash(t),this._keyAddress=e}return"base58"===t?this._keyAddress.toBase58(e):"string"===t?this._keyAddress.toString(e):this._keyAddress}getHash(t){return this.nested?this.getNestedHash(t):this.script?this.getScriptHash(t):this.getKeyHash(t)}getAddress(t,e){return this.nested?this.getNestedAddress(t,e):this.script?this.getScriptAddress(t,e):this.getKeyAddress(t,e)}ownHash(t){return!!(t&&(t.equals(this.getKeyHash())||this.script&&t.equals(this.getScriptHash())||this.witness&&t.equals(this.getNestedHash())))}ownOutput(t,e){let r;return t instanceof c?r=t:(r=t.outputs[e],i(r,"Output does not exist.")),this.ownHash(r.getHash())}getRedeem(t){if(this.witness&&t.equals(this.getNestedHash()))return this.getProgram();if(this.script){if(t.equals(this.getScriptHash160()))return this.script;if(t.equals(this.getScriptHash256()))return this.script}return null}sign(t){return i(this.privateKey,"Cannot sign without private key."),d.signDER(t,this.privateKey)}verify(t,e){return d.verifyDER(t,e,this.publicKey)}getVersion(){return this.witness?this.nested?-1:0:-1}getType(){return this.nested?a.types.SCRIPTHASH:this.witness?a.types.WITNESS:this.script?a.types.SCRIPTHASH:a.types.PUBKEYHASH}[m](){return this.toJSON()}toJSON(t){return{witness:this.witness,nested:this.nested,publicKey:this.publicKey.toString("hex"),script:this.script?this.script.toRaw().toString("hex"):null,program:this.witness?this.getProgram().toRaw().toString("hex"):null,type:a.typesByVal[this.getType()].toLowerCase(),address:this.getAddress("string",t)}}fromJSON(t){return i(t),i("boolean"==typeof t.witness),i("boolean"==typeof t.nested),i("string"==typeof t.publicKey),i(!t.script||"string"==typeof t.script),this.witness=t.witness,this.nested=t.nested,this.publicKey=Buffer.from(t.publicKey,"hex"),t.script&&(this.script=Buffer.from(t.script,"hex")),this}static fromJSON(t){return(new this).fromJSON(t)}getSize(){let t=0;return t+=1,this.privateKey?(t+=l.sizeVarBytes(this.privateKey),t+=1):t+=l.sizeVarBytes(this.publicKey),t+=this.script?this.script.getVarSize():1,t}toWriter(t){let e=0;return this.witness&&(e|=1),this.nested&&(e|=2),t.writeU8(e),this.privateKey?(t.writeVarBytes(this.privateKey),t.writeU8(33===this.publicKey.length?1:0)):t.writeVarBytes(this.publicKey),this.script?t.writeVarBytes(this.script.toRaw()):t.writeVarint(0),t}toRaw(){const t=this.getSize();return this.toWriter(n.write(t)).render()}fromReader(t){const e=t.readU8();this.witness=0!=(1&e),this.nested=0!=(2&e);const r=t.readVarBytes();if(32===r.length){const e=1===t.readU8();this.privateKey=r,this.publicKey=d.publicKeyCreate(r,e)}else this.publicKey=r,i(d.publicKeyVerify(r),"Invalid public key.");const s=t.readVarBytes();return s.length>0&&(this.script=u.fromRaw(s)),this}fromRaw(t){return this.fromReader(n.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t){return(new this).fromRaw(t)}static isKeyRing(t){return t instanceof b}}function g(t){return t?t.privateKey?t.privateKey:t.publicKey?t.publicKey:t:t}t.exports=b},6377:(t,e,r)=>{const i=r(1676),{encoding:s}=r(8889),{BufferMap:n}=r(1013),o=r(4240),h=r(101),f=r(5780),u=r(6521),a=r(6586),c=r(8638),d=r(4377),l=r(7911),m=r(6762),p=r(1377),b=r(1332),g=r(9840),w=r(1972),{inspectSymbol:S}=r(5666);class y extends h{constructor(t){super(),this.mutable=!0,this.changeIndex=-1,this.view=new d,t&&this.fromOptions(t)}fromOptions(t){if(null!=t.version&&(i(t.version>>>0===t.version,"Version must a be uint32."),this.version=t.version),t.inputs){i(Array.isArray(t.inputs),"Inputs must be an array.");for(const e of t.inputs)this.addInput(e)}if(t.outputs){i(Array.isArray(t.outputs),"Outputs must be an array.");for(const e of t.outputs)this.addOutput(e)}return null!=t.locktime&&(i(t.locktime>>>0===t.locktime,"Locktime must be a uint32."),this.locktime=t.locktime),null!=t.changeIndex&&(-1!==t.changeIndex?(i(t.changeIndex>>>0===t.changeIndex,"Change index must be a uint32."),this.changeIndex=t.changeIndex):this.changeIndex=-1),this}static fromOptions(t){return(new this).fromOptions(t)}clone(){const t=new this.constructor;return t.inject(this),t.changeIndex=this.changeIndex,t}addInput(t){const e=f.fromOptions(t);return this.inputs.push(e),e}addOutpoint(t){const e=c.fromOptions(t),r=f.fromOutpoint(e);return this.inputs.push(r),r}addCoin(t){i(t instanceof a,"Cannot add non-coin.");const e=f.fromCoin(t);return this.inputs.push(e),this.view.addCoin(t),e}addTX(t,e,r){i(t instanceof h,"Cannot add non-transaction."),null==r&&(r=-1);const s=f.fromTX(t,e);return this.inputs.push(s),this.view.addIndex(t,e,r),s}addOutput(t,e){let r;return r=null!=e?u.fromScript(t,e):u.fromOptions(t),this.outputs.push(r),r}check(t){return super.check(this.view,t)}checkAsync(t,e){return super.checkAsync(this.view,t,e)}verify(t){try{this.check(t)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}async verifyAsync(t,e){try{await this.checkAsync(t,e)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}getFee(){return super.getFee(this.view)}getInputValue(){return super.getInputValue(this.view)}getInputAddresses(){return super.getInputAddresses(this.view)}getAddresses(){return super.getAddresses(this.view)}getInputHashes(t){return super.getInputHashes(this.view,t)}getHashes(t){return super.getHashes(this.view,t)}hasCoins(){return super.hasCoins(this.view)}getSigops(t){return super.getSigops(this.view,t)}getSigopsCost(t){return super.getSigopsCost(this.view,t)}getSigopsSize(){return super.getSigopsSize(this.getSigopsCost())}verifyInputs(t){const[e]=this.checkInputs(t);return-1!==e}checkInputs(t){return super.checkInputs(this.view,t)}scriptInput(t,e,r){const s=this.inputs[t];if(i(s,"Input does not exist."),i(e,"No coin passed."),0!==s.script.raw.length||0!==s.witness.items.length)return!0;const n=e.script,h=n.getScripthash();if(h){const t=r.getRedeem(h);if(!t)return!1;if(t.isProgram()){const e=t.getWitnessScripthash();if(e){const i=r.getRedeem(e);if(!i)return!1;const n=this.scriptVector(i,r);return!!n&&(n.push(i.toRaw()),s.witness.fromStack(n),s.script.fromItems([t.toRaw()]),!0)}const i=t.getWitnessPubkeyhash();if(i){const e=o.fromPubkeyhash(i),n=this.scriptVector(e,r);return!!n&&(s.witness.fromStack(n),s.script.fromItems([t.toRaw()]),!0)}return!1}const e=this.scriptVector(t,r);return!!e&&(e.push(t.toRaw()),s.script.fromStack(e),!0)}if(n.isProgram()){const t=n.getWitnessScripthash();if(t){const e=r.getRedeem(t);if(!e)return!1;const i=this.scriptVector(e,r);return!!i&&(i.push(e.toRaw()),s.witness.fromStack(i),!0)}const e=n.getWitnessPubkeyhash();if(e){const t=o.fromPubkeyhash(e),i=this.scriptVector(t,r);return!!i&&(s.witness.fromStack(i),!0)}return!1}const f=this.scriptVector(n,r);return!!f&&(s.script.fromStack(f),!0)}scriptVector(t,e){const r=t.getPubkey();if(r){if(!r.equals(e.publicKey))return null;const t=new g;return t.pushInt(0),t}const i=t.getPubkeyhash();if(i){if(!i.equals(e.getKeyHash()))return null;const t=new g;return t.pushInt(0),t.pushData(e.publicKey),t}const[,s]=t.getMultisig();if(-1!==s){if(-1===t.indexOf(e.publicKey))return null;const r=new g;r.pushInt(0);for(let t=0;t<s;t++)r.pushInt(0);return r}return null}async signInputAsync(t,e,r,i,s){return s?await s.signInput(this,t,e,r,i,s):this.signInput(t,e,r,i)}signInput(t,e,r,s){const n=this.inputs[t],h=r.privateKey;i(n,"Input does not exist."),i(e,"No coin passed.");const f=e.value;let u=e.script,a=n.script,c=0,d=!1;if(u.isScripthash()){if(u=n.script.getRedeem(),!u)throw new Error("Input has not been templated.");d=!0}if(u.isWitnessScripthash()){if(u=n.witness.getRedeem(),!u)throw new Error("Input has not been templated.");a=n.witness,d=!0,c=1}else{const t=u.getWitnessPubkeyhash();t&&(u=o.fromPubkeyhash(t),a=n.witness,d=!1,c=1)}const l=this.signature(t,u,f,h,s,c);if(d){const t=a.toStack(),e=t.pop(),i=this.signVector(u,t,l,r);return!!i&&(i.push(e),a.fromStack(i),!0)}const m=a.toStack(),p=this.signVector(u,m,l,r);return!!p&&(a.fromStack(p),!0)}signVector(t,e,r,s){const n=t.getPubkey();if(n){if(!s.publicKey.equals(n))return null;if(0===e.length)throw new Error("Input has not been templated.");return e.get(0).length>0||e.set(0,r),e}const o=t.getPubkeyhash();if(o){if(!s.getKeyHash().equals(o))return null;if(2!==e.length)throw new Error("Input has not been templated.");if(0===e.get(1).length)throw new Error("Input has not been templated.");return e.get(0).length>0||e.set(0,r),e}const[h,f]=t.getMultisig();if(-1!==h){if(e.length<2)throw new Error("Input has not been templated.");if(0!==e.get(0).length)throw new Error("Input has not been templated.");if(e.length-1>f)throw new Error("Input has not been templated.");let n=0;for(let t=1;t<e.length;t++)e.get(t).length>0&&(n+=1);if(n===h&&e.length-1===h)return e;for(;e.length-1<f;)e.pushInt(0);const o=[];for(const e of t.code)e.data&&o.push(e.data);let u=-1;for(let t=0;t<o.length;t++)if(o[t].equals(s.publicKey)){u=t;break}if(-1===u)return null;if(u+=1,u<e.length&&n<h&&0===e.get(u).length&&(e.set(u,r),n+=1),n>=h){for(let t=e.length-1;t>=1;t--)0===e.get(t).length&&e.remove(t);for(;n>h;)e.pop(),n-=1;i(n===h),i(e.length-1===h)}return e}return null}isSigned(){for(let t=0;t<this.inputs.length;t++){const{prevout:e}=this.inputs[t],r=this.view.getOutput(e);if(!r)return!1;if(!this.isInputSigned(t,r))return!1}return!0}isInputSigned(t,e){const r=this.inputs[t];i(r,"Input does not exist."),i(e,"No coin passed.");let s=e.script,n=r.script,h=!1;if(s.isScripthash()){if(s=r.script.getRedeem(),!s)return!1;h=!0}if(s.isWitnessScripthash()){if(s=r.witness.getRedeem(),!s)return!1;n=r.witness,h=!0}else{const t=s.getWitnessPubkeyhash();t&&(s=o.fromPubkeyhash(t),n=r.witness,h=!1)}const f=n.toStack();return h&&f.pop(),this.isVectorSigned(s,f)}isVectorSigned(t,e){if(t.isPubkey())return 1===e.length&&0!==e.get(0).length;if(t.isPubkeyhash())return 2===e.length&&0!==e.get(0).length&&0!==e.get(1).length;const[r]=t.getMultisig();if(-1!==r){if(e.length-1!==r)return!1;for(let t=1;t<e.length;t++)if(0===e.get(t).length)return!1;return!0}return!1}template(t){if(Array.isArray(t)){let e=0;for(const r of t)e+=this.template(r);return e}let e=0;for(let r=0;r<this.inputs.length;r++){const{prevout:i}=this.inputs[r],s=this.view.getOutput(i);s&&t.ownOutput(s)&&this.scriptInput(r,s,t)&&(e+=1)}return e}sign(t,e){if(Array.isArray(t)){let r=0;for(const i of t)r+=this.sign(i,e);return r}i(t.privateKey,"No private key available.");let r=0;for(let i=0;i<this.inputs.length;i++){const{prevout:s}=this.inputs[i],n=this.view.getOutput(s);n&&t.ownOutput(n)&&this.scriptInput(i,n,t)&&this.signInput(i,n,t,e)&&(r+=1)}return r}async signAsync(t,e,r){return r?await r.sign(this,t,e):this.sign(t,e)}async estimateSize(t){const e=m.WITNESS_SCALE_FACTOR;let r=0;r+=4,r+=s.sizeVarint(this.inputs.length),r+=40*this.inputs.length,r+=s.sizeVarint(this.outputs.length);for(const t of this.outputs)r+=t.getSize();r+=4;for(const{prevout:i}of this.inputs){const n=this.view.getOutput(i);if(!n){r+=110;continue}const o=n.script;if(o.isPubkey()){r+=1,r+=74;continue}if(o.isPubkeyhash()){r+=1,r+=74,r+=34;continue}const[h]=o.getMultisig();if(-1===h)if(o.isWitnessPubkeyhash()){let t=0;t+=1,t+=74,t+=34,t=(t+e-1)/e|0,r+=t}else{if(t){const e=await t(o);if(-1!==e){r+=e;continue}}if(o.isScripthash())r+=1,r+=149;else if(o.isWitnessScripthash()){let t=0;t+=1,t+=149,t=(t+e-1)/e|0,r+=t}else r+=110}else{let t=0;t+=1,t+=74*h,t+=s.sizeVarint(t),r+=t}}return r}selectCoins(t,e){return new I(this,e).select(t)}subtractIndex(t,e){i("number"==typeof t),i("number"==typeof e);const r=this.outputs[t];if(!r)throw new Error("Subtraction index does not exist.");if(r.value<e+r.getDustThreshold())throw new Error("Could not subtract fee.");r.value-=e}subtractFee(t){i("number"==typeof t);let e=0;for(const t of this.outputs)t.script.isUnspendable()||(e+=1);if(0===e)throw new Error("Could not subtract fee.");const r=t%e,s=(t-r)/e;for(const t of this.outputs)if(!t.script.isUnspendable()){if(t.value<s+t.getDustThreshold())throw new Error("Could not subtract fee.");t.value-=s}for(const t of this.outputs)if(!t.script.isUnspendable()&&t.value>=r+t.getDustThreshold())return void(t.value-=r);throw new Error("Could not subtract fee.")}async fund(t,e){i(e,"Options are required."),i(e.changeAddress,"Change address is required."),i(0===this.inputs.length,"TX is already funded.");const r=await this.selectCoins(t,e);for(const t of r.chosen)this.addCoin(t);if(r.subtractFee){const t=r.subtractIndex;-1!==t?this.subtractIndex(t,r.fee):this.subtractFee(r.fee)}const s=new u;return s.value=r.change,s.script.fromAddress(r.changeAddress),s.isDust(p.MIN_RELAY)?(this.changeIndex=-1,i.strictEqual(this.getFee(),r.fee+r.change)):(this.outputs.push(s),this.changeIndex=this.outputs.length-1,i.strictEqual(this.getFee(),r.fee)),r}sortMembers(){let t=null;-1!==this.changeIndex&&(t=this.outputs[this.changeIndex],i(t)),this.inputs.sort(N),this.outputs.sort(B),-1!==this.changeIndex&&(this.changeIndex=this.outputs.indexOf(t),i(-1!==this.changeIndex))}avoidFeeSniping(t){i("number"==typeof t,"Must pass in height."),0==(10*Math.random()|0)&&(t-=100*Math.random()|0)<0&&(t=0),this.setLocktime(t)}setLocktime(t){i(t>>>0===t,"Locktime must be a uint32."),i(this.inputs.length>0,"Cannot set sequence with no inputs.");for(const t of this.inputs)4294967295===t.sequence&&(t.sequence=4294967294);this.locktime=t}setSequence(t,e,r){const s=this.inputs[t];i(s,"Input does not exist."),i(e>>>0===e,"Locktime must be a uint32."),this.version=2,r?(e>>>=m.SEQUENCE_GRANULARITY,e&=m.SEQUENCE_MASK,e|=m.SEQUENCE_TYPE_FLAG):e&=m.SEQUENCE_MASK,s.sequence=e}[S](){return this.format()}format(){return super.format(this.view)}toJSON(){return super.toJSON(null,this.view)}getJSON(t){return super.getJSON(t,this.view)}fromJSON(t){super.fromJSON(t);for(let e=0;e<t.inputs.length;e++){const r=t.inputs[e],{prevout:i}=r;if(!r.coin)continue;const s=a.fromJSON(r.coin);s.hash=w.fromRev(i.hash),s.index=i.index,this.view.addCoin(s)}return this}static fromJSON(t){return(new this).fromJSON(t)}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}toTX(){return(new h).inject(this)}commit(){return[this.toTX(),this.view]}static fromTX(t){return(new this).inject(t)}static isMTX(t){return t instanceof y}}class I{constructor(t,e){this.tx=t.clone(),this.coins=[],this.outputValue=0,this.index=0,this.chosen=[],this.change=0,this.fee=I.MIN_FEE,this.selection="value",this.subtractFee=!1,this.subtractIndex=-1,this.height=-1,this.depth=-1,this.hardFee=-1,this.rate=I.FEE_RATE,this.maxFee=-1,this.round=!1,this.changeAddress=null,this.inputs=new n,this.estimate=null,this.injectInputs(),e&&this.fromOptions(e)}fromOptions(t){if(t.selection&&(i("string"==typeof t.selection),this.selection=t.selection),null!=t.subtractFee&&("number"==typeof t.subtractFee?(i(Number.isSafeInteger(t.subtractFee)),i(t.subtractFee>=-1),this.subtractIndex=t.subtractFee,this.subtractFee=-1!==this.subtractIndex):(i("boolean"==typeof t.subtractFee),this.subtractFee=t.subtractFee)),null!=t.subtractIndex&&(i(Number.isSafeInteger(t.subtractIndex)),i(t.subtractIndex>=-1),this.subtractIndex=t.subtractIndex,this.subtractFee=-1!==this.subtractIndex),null!=t.height&&(i(Number.isSafeInteger(t.height)),i(t.height>=-1),this.height=t.height),null!=t.confirmations&&(i(Number.isSafeInteger(t.confirmations)),i(t.confirmations>=-1),this.depth=t.confirmations),null!=t.depth&&(i(Number.isSafeInteger(t.depth)),i(t.depth>=-1),this.depth=t.depth),null!=t.hardFee&&(i(Number.isSafeInteger(t.hardFee)),i(t.hardFee>=-1),this.hardFee=t.hardFee),null!=t.rate&&(i(Number.isSafeInteger(t.rate)),i(t.rate>=0),this.rate=t.rate),null!=t.maxFee&&(i(Number.isSafeInteger(t.maxFee)),i(t.maxFee>=-1),this.maxFee=t.maxFee),null!=t.round&&(i("boolean"==typeof t.round),this.round=t.round),t.changeAddress){const e=t.changeAddress;"string"==typeof e?this.changeAddress=l.fromString(e):(i(e instanceof l),this.changeAddress=e)}if(t.estimate&&(i("function"==typeof t.estimate),this.estimate=t.estimate),t.inputs){i(Array.isArray(t.inputs));for(let e=0;e<t.inputs.length;e++){const r=t.inputs[e];i(r&&"object"==typeof r);const{hash:s,index:n}=r;i(Buffer.isBuffer(s)),i("number"==typeof n),this.inputs.set(c.toKey(s,n),e)}}return this}injectInputs(){if(this.tx.inputs.length>0)for(let t=0;t<this.tx.inputs.length;t++){const{prevout:e}=this.tx.inputs[t];this.inputs.set(e.toKey(),t)}}init(t){switch(this.coins=t.slice(),this.outputValue=this.tx.getOutputValue(),this.index=0,this.chosen=[],this.change=0,this.fee=I.MIN_FEE,this.tx.inputs.length=0,this.selection){case"all":case"random":this.coins.sort(_);break;case"age":this.coins.sort(E);break;case"value":this.coins.sort(O);break;default:throw new v(`Bad selection type: ${this.selection}.`)}}total(){return this.subtractFee?this.outputValue:this.outputValue+this.fee}isFull(){return this.tx.getInputValue()>=this.total()}isSpendable(t){return!this.tx.view.hasEntry(t)&&(-1===this.height||(t.coinbase?-1!==t.height&&!(this.height+1<t.height+m.COINBASE_MATURITY):-1===this.depth||!(t.getDepth(this.height)<this.depth)))}getFee(t){if(this.round){const e=p.getRoundFee(t,this.rate);return Math.min(e,I.MAX_FEE)}const e=p.getMinFee(t,this.rate);return Math.min(e,I.MAX_FEE)}fund(){if(this.inputs.size>0){const t=[];for(let e=0;e<this.inputs.size;e++)t.push(null);for(const e of this.coins){const{hash:r,index:i}=e,s=c.toKey(r,i),n=this.inputs.get(s);null!=n&&(t[n]=e,this.inputs.delete(s))}if(this.inputs.size>0)throw new Error("Could not resolve preferred inputs.");for(const e of t)this.tx.addCoin(e),this.chosen.push(e)}for(;this.index<this.coins.length;){const t=this.coins[this.index++];if(this.isSpendable(t)&&(this.tx.addCoin(t),this.chosen.push(t),"all"!==this.selection&&this.isFull()))break}}async select(t){if(this.init(t),-1!==this.hardFee?this.selectHard():await this.selectEstimate(),!this.isFull())throw new v("Not enough funds.",this.tx.getInputValue(),this.total());return this.change=this.tx.getInputValue()-this.total(),this}async selectEstimate(){this.fee=I.MIN_FEE,this.fund();const t=new u;this.changeAddress?t.script.fromAddress(this.changeAddress):t.script.fromPubkeyhash(Buffer.allocUnsafe(20)),this.tx.outputs.push(t);do{const t=await this.tx.estimateSize(this.estimate);if(this.fee=this.getFee(t),this.maxFee>0&&this.fee>this.maxFee)throw new v("Fee is too high.");this.isFull()||this.fund()}while(!this.isFull()&&this.index<this.coins.length)}selectHard(){this.fee=Math.min(this.hardFee,I.MAX_FEE),this.fund()}}I.FEE_RATE=1e4,I.MIN_FEE=1e4,I.MAX_FEE=m.COIN/10;class v extends Error{constructor(t,e,r){super(),this.type="FundingError",this.message=t,this.availableFunds=-1,this.requiredFunds=-1,null!=e&&(this.message+=` (available=${b.btc(e)},`,this.message+=` required=${b.btc(r)})`,this.availableFunds=e,this.requiredFunds=r),Error.captureStackTrace&&Error.captureStackTrace(this,v)}}function E(t,e){return(t=-1===t.height?2147483647:t.height)-(-1===e.height?2147483647:e.height)}function _(t,e){return Math.random()>.5?1:-1}function O(t,e){return-1===t.height&&-1!==e.height?1:-1!==t.height&&-1===e.height?-1:e.value-t.value}function N(t,e){return t.compare(e)}function B(t,e){return t.compare(e)}(e=y).MTX=y,e.Selector=I,e.FundingError=v,t.exports=e},8638:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(1972),o=r(6762),{inspectSymbol:h}=r(5666);class f{constructor(t,e){this.hash=o.ZERO_HASH,this.index=4294967295,null!=t&&(i(Buffer.isBuffer(t)),i(e>>>0===e,"Index must be a uint32."),this.hash=t,this.index=e)}fromOptions(t){return i(t,"Outpoint data is required."),i(Buffer.isBuffer(t.hash)),i(t.index>>>0===t.index,"Index must be a uint32."),this.hash=t.hash,this.index=t.index,this}static fromOptions(t){return(new this).fromOptions(t)}clone(){const t=new this.constructor;return t.hash=this.hash,t.index=this.index,t}equals(t){return i(f.isOutpoint(t)),this.hash.equals(t.hash)&&this.index===t.index}compare(t){i(f.isOutpoint(t));const e=function(t,e){const r=Math.min(t.length,e.length);for(let i=0;i<r;i++){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1}return t.length<e.length?-1:t.length>e.length?1:0}(this.txid(),t.txid());return 0!==e?e:this.index-t.index}isNull(){return 4294967295===this.index&&this.hash.equals(o.ZERO_HASH)}rhash(){return n.revHex(this.hash)}txid(){return this.rhash()}toKey(){return this.toRaw()}fromKey(t){return this.hash=t.slice(0,32),this.index=s.readU32(t,32),this}static fromKey(t){return(new this).fromKey(t)}toWriter(t){return t.writeHash(this.hash),t.writeU32(this.index),t}getSize(){return 36}toRaw(){return this.toWriter(s.write(36)).render()}fromReader(t){return this.hash=t.readHash(),this.index=t.readU32(),this}fromRaw(t){return this.fromReader(s.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t){return(new this).fromRaw(t)}fromJSON(t){return i(t,"Outpoint data is required."),i("string"==typeof t.hash,"Hash must be a string."),i(t.index>>>0===t.index,"Index must be a uint32."),this.hash=n.fromRev(t.hash),this.index=t.index,this}toJSON(){return{hash:n.revHex(this.hash),index:this.index}}static fromJSON(t){return(new this).fromJSON(t)}fromTX(t,e){return i(t),i("number"==typeof e),i(e>=0),this.hash=t.hash(),this.index=e,this}static fromTX(t,e){return(new this).fromTX(t,e)}static toKey(t,e){return new f(t,e).toKey()}[h](){return`<Outpoint: ${this.rhash()}/${this.index}>`}static isOutpoint(t){return t instanceof f}}t.exports=f},6521:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(1332),o=r(6853),h=r(7911),f=r(4240),u=r(6762),a=r(1377),{inspectSymbol:c}=r(5666);class d{constructor(t){this.value=0,this.script=new f,t&&this.fromOptions(t)}fromOptions(t){return i(t,"Output data is required."),t.value&&(i(Number.isSafeInteger(t.value)&&t.value>=0,"Value must be a uint64."),this.value=t.value),t.script&&this.script.fromOptions(t.script),t.address&&this.script.fromAddress(t.address),this}static fromOptions(t){return(new this).fromOptions(t)}fromScript(t,e){return"string"==typeof t&&(t=h.fromString(t)),t instanceof h&&(t=f.fromAddress(t)),i(t instanceof f,"Script must be a Script."),i(Number.isSafeInteger(e)&&e>=0,"Value must be a uint64."),this.script=t,this.value=e,this}static fromScript(t,e){return(new this).fromScript(t,e)}clone(){const t=new this.constructor;return t.value=this.value,t.script.inject(this.script),t}equals(t){return i(d.isOutput(t)),this.value===t.value&&this.script.equals(t.script)}compare(t){i(d.isOutput(t));const e=this.value-t.value;return 0!==e?e:this.script.compare(t.script)}getType(){return f.typesByVal[this.script.getType()].toLowerCase()}getAddress(){return this.script.getAddress()}getHash(t){const e=this.getAddress();return e?e.getHash(t):null}[c](){return{type:this.getType(),value:n.btc(this.value),script:this.script,address:this.getAddress()}}toJSON(){return this.getJSON()}getJSON(t){let e=this.getAddress();return t=o.get(t),e&&(e=e.toString(t)),{value:this.value,script:this.script.toJSON(),address:e}}getDustThreshold(t){const e=u.WITNESS_SCALE_FACTOR;if(this.script.isUnspendable())return 0;let r=this.getSize();return this.script.isProgram()?r+=37+(107/e|0)+4:r+=148,3*a.getMinFee(r,t)}getSize(){return 8+this.script.getVarSize()}isDust(t){return this.value<this.getDustThreshold(t)}fromJSON(t){return i(t,"Output data is required."),i(Number.isSafeInteger(t.value)&&t.value>=0,"Value must be a uint64."),this.value=t.value,this.script.fromJSON(t.script),this}static fromJSON(t){return(new this).fromJSON(t)}toWriter(t){return t.writeI64(this.value),t.writeVarBytes(this.script.toRaw()),t}toRaw(){const t=this.getSize();return this.toWriter(s.write(t)).render()}fromReader(t){return this.value=t.readI64(),this.script.fromRaw(t.readVarBytes()),this}fromRaw(t){return this.fromReader(s.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}static isOutput(t){return t instanceof d}}t.exports=d},101:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(2355),o=r(2581),{BufferSet:h}=r(1013),f=r(1972),u=r(1332),a=r(6853),c=r(4240),d=r(5780),l=r(6521),m=r(8638),p=r(2359),b=r(6762),g=r(1377),w=r(8521),{encoding:S}=s,{hashType:y}=c,{inspectSymbol:I}=r(5666);class v{constructor(t){this.version=1,this.inputs=[],this.outputs=[],this.locktime=0,this.mutable=!1,this._hash=null,this._hhash=null,this._whash=null,this._raw=null,this._offset=-1,this._block=!1,this._size=-1,this._witness=-1,this._sigops=-1,this._hashPrevouts=null,this._hashSequence=null,this._hashOutputs=null,t&&this.fromOptions(t)}fromOptions(t){if(i(t,"TX data is required."),null!=t.version&&(i(t.version>>>0===t.version,"Version must be a uint32."),this.version=t.version),t.inputs){i(Array.isArray(t.inputs),"Inputs must be an array.");for(const e of t.inputs)this.inputs.push(new d(e))}if(t.outputs){i(Array.isArray(t.outputs),"Outputs must be an array.");for(const e of t.outputs)this.outputs.push(new l(e))}return null!=t.locktime&&(i(t.locktime>>>0===t.locktime,"Locktime must be a uint32."),this.locktime=t.locktime),this}static fromOptions(t){return(new this).fromOptions(t)}clone(){return(new this.constructor).inject(this)}inject(t){this.version=t.version;for(const e of t.inputs)this.inputs.push(e.clone());for(const e of t.outputs)this.outputs.push(e.clone());return this.locktime=t.locktime,this}refresh(){this._hash=null,this._hhash=null,this._whash=null,this._raw=null,this._size=-1,this._offset=-1,this._block=!1,this._witness=-1,this._sigops=-1,this._hashPrevouts=null,this._hashSequence=null,this._hashOutputs=null}hash(t){let e=this._hash;if(e||(e=n.digest(this.toNormal()),this.mutable||(this._hash=e)),"hex"===t){let t=this._hhash;t||(t=e.toString("hex"),this.mutable||(this._hhash=t)),e=t}return e}witnessHash(t){if(!this.hasWitness())return this.hash(t);let e=this._whash;return e||(e=n.digest(this.toRaw()),this.mutable||(this._whash=e)),"hex"===t?e.toString("hex"):e}toRaw(){return this.frame().data}toNormal(){return this.hasWitness()?this.frameNormal().data:this.toRaw()}toWriter(t,e){return this.mutable?this.hasWitness()?this.writeWitness(t):this.writeNormal(t):(e&&(this._offset=t.offset,this._block=!0),t.writeBytes(this.toRaw()),t)}toNormalWriter(t){return this.hasWitness()?(this.writeNormal(t),t):this.toWriter(t)}frame(){if(this.mutable)return i(!this._raw),this.hasWitness()?this.frameWitness():this.frameNormal();if(this._raw){i(this._size>=0),i(this._witness>=0);const t=new E(this._size,this._witness);return t.data=this._raw,t}let t;return t=this.hasWitness()?this.frameWitness():this.frameNormal(),this._raw=t.data,this._size=t.size,this._witness=t.witness,t}getPosition(){return i(this._block&&this._offset>80,"Position not available."),{offset:this._offset,size:this._size}}getSizes(){return this.mutable?this.hasWitness()?this.getWitnessSizes():this.getNormalSizes():this.frame()}getVirtualSize(){const t=b.WITNESS_SCALE_FACTOR;return(this.getWeight()+t-1)/t|0}getSigopsSize(t){const e=b.WITNESS_SCALE_FACTOR,r=g.BYTES_PER_SIGOP;return(Math.max(this.getWeight(),t*r)+e-1)/e|0}getWeight(){const t=this.getSizes();return(t.size-t.witness)*(b.WITNESS_SCALE_FACTOR-1)+t.size}getSize(){return this.getSizes().size}getBaseSize(){const t=this.getSizes();return t.size-t.witness}hasWitness(){if(-1!==this._witness)return 0!==this._witness;for(const t of this.inputs)if(t.witness.items.length>0)return!0;return!1}signatureHash(t,e,r,s,n){if(i(t>=0&&t<this.inputs.length),i(e instanceof c),i("number"==typeof r),i("number"==typeof s),0===n)return this.signatureHashV0(t,e,s);if(1===n)return this.signatureHashV1(t,e,r,s);throw new Error("Unknown sighash version.")}signatureHashV0(t,e,r){if((31&r)===y.SINGLE&&t>=this.outputs.length){const t=Buffer.alloc(32,0);return t[0]=1,t}e=e.removeSeparators();const i=this.hashSize(t,e,r),o=s.pool(i);if(o.writeU32(this.version),r&y.ANYONECANPAY){const r=this.inputs[t];o.writeVarint(1),r.prevout.toWriter(o),o.writeVarBytes(e.toRaw()),o.writeU32(r.sequence)}else{o.writeVarint(this.inputs.length);for(let i=0;i<this.inputs.length;i++){const s=this.inputs[i];if(s.prevout.toWriter(o),i!==t)switch(o.writeVarint(0),31&r){case y.NONE:case y.SINGLE:o.writeU32(0);break;default:o.writeU32(s.sequence)}else o.writeVarBytes(e.toRaw()),o.writeU32(s.sequence)}}switch(31&r){case y.NONE:o.writeVarint(0);break;case y.SINGLE:{const e=this.outputs[t];o.writeVarint(t+1);for(let e=0;e<t;e++)o.writeI64(-1),o.writeVarint(0);e.toWriter(o);break}default:o.writeVarint(this.outputs.length);for(const t of this.outputs)t.toWriter(o)}return o.writeU32(this.locktime),o.writeU32(r),n.digest(o.render())}hashSize(t,e,r){let i=0;switch(i+=4,r&y.ANYONECANPAY?(i+=1,i+=36,i+=e.getVarSize(),i+=4):(i+=S.sizeVarint(this.inputs.length),i+=41*(this.inputs.length-1),i+=36,i+=e.getVarSize(),i+=4),31&r){case y.NONE:i+=1;break;case y.SINGLE:i+=S.sizeVarint(t+1),i+=9*t,i+=this.outputs[t].getSize();break;default:i+=S.sizeVarint(this.outputs.length);for(const t of this.outputs)i+=t.getSize()}return i+=8,i}signatureHashV1(t,e,r,i){const o=this.inputs[t];let h=b.ZERO_HASH,f=b.ZERO_HASH,u=b.ZERO_HASH;if(!(i&y.ANYONECANPAY))if(this._hashPrevouts)h=this._hashPrevouts;else{const t=s.pool(36*this.inputs.length);for(const e of this.inputs)e.prevout.toWriter(t);h=n.digest(t.render()),this.mutable||(this._hashPrevouts=h)}if(!(i&y.ANYONECANPAY)&&(31&i)!==y.SINGLE&&(31&i)!==y.NONE)if(this._hashSequence)f=this._hashSequence;else{const t=s.pool(4*this.inputs.length);for(const e of this.inputs)t.writeU32(e.sequence);f=n.digest(t.render()),this.mutable||(this._hashSequence=f)}if((31&i)!==y.SINGLE&&(31&i)!==y.NONE)if(this._hashOutputs)u=this._hashOutputs;else{let t=0;for(const e of this.outputs)t+=e.getSize();const e=s.pool(t);for(const t of this.outputs)t.toWriter(e);u=n.digest(e.render()),this.mutable||(this._hashOutputs=u)}else if((31&i)===y.SINGLE&&t<this.outputs.length){const e=this.outputs[t];u=n.digest(e.toRaw())}const a=156+e.getVarSize(),c=s.pool(a);return c.writeU32(this.version),c.writeBytes(h),c.writeBytes(f),c.writeHash(o.prevout.hash),c.writeU32(o.prevout.index),c.writeVarBytes(e.toRaw()),c.writeI64(r),c.writeU32(o.sequence),c.writeBytes(u),c.writeU32(this.locktime),c.writeU32(i),n.digest(c.render())}checksig(t,e,r,i,s,n){if(0===i.length)return!1;const h=i[i.length-1],f=this.signatureHash(t,e,r,h,n);return o.verifyDER(f,i.slice(0,-1),s)}signature(t,e,r,i,n,h){null==n&&(n=y.ALL),null==h&&(h=0);const f=this.signatureHash(t,e,r,n,h),u=o.signDER(f,i),a=s.write(u.length+1);return a.writeBytes(u),a.writeU8(n),a.render()}check(t,e){if(0===this.inputs.length)throw new w("UNKNOWN_ERROR","No inputs.");if(!this.isCoinbase())for(let r=0;r<this.inputs.length;r++){const{prevout:i}=this.inputs[r],s=t.getOutput(i);if(!s)throw new w("UNKNOWN_ERROR","No coin available.");this.checkInput(r,s,e)}}checkInput(t,e,r){const s=this.inputs[t];i(s,"Input does not exist."),i(e,"No coin passed."),c.verify(s.script,s.witness,e.script,this,t,e.value,r)}async checkAsync(t,e,r){if(0===this.inputs.length)throw new w("UNKNOWN_ERROR","No inputs.");this.isCoinbase()||(r?await r.check(this,t,e):this.check(t,e))}async checkInputAsync(t,e,r,s){const n=this.inputs[t];i(n,"Input does not exist."),i(e,"No coin passed."),s?await s.checkInput(this,t,e,r):this.checkInput(t,e,r)}verify(t,e){try{this.check(t,e)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}verifyInput(t,e,r){try{this.checkInput(t,e,r)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}async verifyAsync(t,e,r){try{await this.checkAsync(t,e,r)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}async verifyInputAsync(t,e,r,i){try{await this.checkInput(t,e,r,i)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0}isCoinbase(){return 1===this.inputs.length&&this.inputs[0].prevout.isNull()}isRBF(){if(2===this.version)return!1;for(const t of this.inputs)if(t.isRBF())return!0;return!1}getFee(t){return this.hasCoins(t)?this.getInputValue(t)-this.getOutputValue():0}getInputValue(t){let e=0;for(const{prevout:r}of this.inputs){const i=t.getOutput(r);if(!i)return 0;e+=i.value}return e}getOutputValue(){let t=0;for(const e of this.outputs)t+=e.value;return t}_getInputAddresses(t){const e=new h,r=[];if(this.isCoinbase())return[r,e];for(const i of this.inputs){const s=t?t.getOutputFor(i):null,n=i.getAddress(s);if(!n)continue;const o=n.getHash();e.has(o)||(e.add(o),r.push(n))}return[r,e]}_getOutputAddresses(){const t=new h,e=[];for(const r of this.outputs){const i=r.getAddress();if(!i)continue;const s=i.getHash();t.has(s)||(t.add(s),e.push(i))}return[e,t]}_getAddresses(t){const[e,r]=this._getInputAddresses(t),i=this.getOutputAddresses();for(const t of i){const i=t.getHash();r.has(i)||(r.add(i),e.push(t))}return[e,r]}getInputAddresses(t){const[e]=this._getInputAddresses(t);return e}getOutputAddresses(){const[t]=this._getOutputAddresses();return t}getAddresses(t){const[e]=this._getAddresses(t);return e}getInputHashes(t,e){const[,r]=this._getInputAddresses(t);return"hex"!==e?r.toArray():r.toArray().map((t=>t.toString("hex")))}getOutputHashes(t){const[,e]=this._getOutputAddresses();return"hex"!==t?e.toArray():e.toArray().map((t=>t.toString("hex")))}getHashes(t,e){const[,r]=this._getAddresses(t);return"hex"!==e?r.toArray():r.toArray().map((t=>t.toString("hex")))}hasCoins(t){if(0===this.inputs.length)return!1;for(const{prevout:e}of this.inputs)if(!t.hasEntry(e))return!1;return!0}isFinal(t,e){const r=b.LOCKTIME_THRESHOLD;if(0===this.locktime)return!0;if(this.locktime<(this.locktime<r?t:e))return!0;for(const t of this.inputs)if(4294967295!==t.sequence)return!1;return!0}verifyLocktime(t,e){const r=b.LOCKTIME_THRESHOLD,s=this.inputs[t];return i(s,"Input does not exist."),i(e>=0,"Locktime must be non-negative."),this.locktime<r==e<r&&!(e>this.locktime)&&4294967295!==s.sequence}verifySequence(t,e){const r=b.SEQUENCE_DISABLE_FLAG,s=b.SEQUENCE_TYPE_FLAG,n=b.SEQUENCE_MASK,o=this.inputs[t];return i(o,"Input does not exist."),i(e>=0,"Locktime must be non-negative."),!(!(e&r)&&(this.version<2||o.sequence&r||(o.sequence&s)!=(e&s)||(e&n)>(o.sequence&n)))}getLegacySigops(){if(-1!==this._sigops)return this._sigops;let t=0;for(const e of this.inputs)t+=e.script.getSigops(!1);for(const e of this.outputs)t+=e.script.getSigops(!1);return this.mutable||(this._sigops=t),t}getScripthashSigops(t){if(this.isCoinbase())return 0;let e=0;for(const r of this.inputs){const i=t.getOutputFor(r);i&&i.script.isScripthash()&&(e+=i.script.getScripthashSigops(r.script))}return e}getWitnessSigops(t){if(this.isCoinbase())return 0;let e=0;for(const r of this.inputs){const i=t.getOutputFor(r);i&&(e+=i.script.getWitnessSigops(r.script,r.witness))}return e}getSigopsCost(t,e){null==e&&(e=c.flags.STANDARD_VERIFY_FLAGS);const r=b.WITNESS_SCALE_FACTOR;let i=this.getLegacySigops()*r;return e&c.flags.VERIFY_P2SH&&(i+=this.getScripthashSigops(t)*r),e&c.flags.VERIFY_WITNESS&&(i+=this.getWitnessSigops(t)),i}getSigops(t,e){const r=b.WITNESS_SCALE_FACTOR;return(this.getSigopsCost(t,e)+r-1)/r|0}isSane(){const[t]=this.checkSanity();return t}checkSanity(){if(0===this.inputs.length)return[!1,"bad-txns-vin-empty",100];if(0===this.outputs.length)return[!1,"bad-txns-vout-empty",100];if(this.getBaseSize()>b.MAX_BLOCK_SIZE)return[!1,"bad-txns-oversize",100];let t=0;for(const e of this.outputs){if(e.value<0)return[!1,"bad-txns-vout-negative",100];if(e.value>b.MAX_MONEY)return[!1,"bad-txns-vout-toolarge",100];if(t+=e.value,t<0||t>b.MAX_MONEY)return[!1,"bad-txns-txouttotal-toolarge",100]}const e=new h;for(const t of this.inputs){const r=t.prevout.toKey();if(e.has(r))return[!1,"bad-txns-inputs-duplicate",100];e.add(r)}if(this.isCoinbase()){const t=this.inputs[0].script.getSize();if(t<2||t>100)return[!1,"bad-cb-length",100]}else for(const t of this.inputs)if(t.prevout.isNull())return[!1,"bad-txns-prevout-null",10];return[!0,"valid",0]}isStandard(){const[t]=this.checkStandard();return t}checkStandard(){if(this.version<1||this.version>g.MAX_TX_VERSION)return[!1,"version",0];if(this.getWeight()>=g.MAX_TX_WEIGHT)return[!1,"tx-size",0];for(const t of this.inputs){if(t.script.getSize()>1650)return[!1,"scriptsig-size",0];if(!t.script.isPushOnly())return[!1,"scriptsig-not-pushonly",0]}let t=0;for(const e of this.outputs){if(!e.script.isStandard())return[!1,"scriptpubkey",0];if(e.script.isNulldata())t++;else{if(e.script.isMultisig()&&!g.BARE_MULTISIG)return[!1,"bare-multisig",0];if(e.isDust(g.MIN_RELAY))return[!1,"dust",0]}}return t>1?[!1,"multi-op-return",0]:[!0,"valid",0]}hasStandardInputs(t){if(this.isCoinbase())return!0;for(const e of this.inputs){const r=t.getOutputFor(e);if(!r)return!1;if(!r.script.isPubkeyhash())if(r.script.isScripthash()){const t=e.script.getRedeem();if(!t)return!1;if(t.getSigops(!0)>g.MAX_P2SH_SIGOPS)return!1}else if(r.script.isUnknown())return!1}return!0}hasStandardWitness(t){if(this.isCoinbase())return!0;for(const e of this.inputs){const r=e.witness,i=t.getOutputFor(e);if(!i)continue;if(0===r.items.length)continue;let s=i.script;if(s.isScripthash()&&(s=e.script.getRedeem(),!s))return!1;if(!s.isProgram())return!1;if(s.isWitnessPubkeyhash()){if(2!==r.items.length)return!1;if(r.items[0].length>73)return!1;if(r.items[1].length>65)return!1}else if(s.isWitnessScripthash()){if(r.items.length-1>g.MAX_P2WSH_STACK)return!1;for(let t=0;t<r.items.length-1;t++)if(r.items[t].length>g.MAX_P2WSH_PUSH)return!1;const t=r.items[r.items.length-1];if(t.length>g.MAX_P2WSH_SIZE)return!1;const i=c.fromRaw(t);if(i.isPubkey()){if(r.items.length-1!=1)return!1;if(r.items[0].length>73)return!1;continue}if(i.isPubkeyhash()){if(e.witness.items.length-1!=2)return!1;if(r.items[0].length>73)return!1;if(r.items[1].length>65)return!1;continue}const[s]=i.getMultisig();if(-1!==s){if(r.items.length-1!==s+1)return!1;if(0!==r.items[0].length)return!1;for(let t=1;t<r.items.length-1;t++)if(r.items[t].length>73)return!1}}else{if(r.items.length>g.MAX_P2WSH_STACK)return!1;for(const t of r.items)if(t.length>g.MAX_P2WSH_PUSH)return!1}}return!0}verifyInputs(t,e){const[r]=this.checkInputs(t,e);return-1!==r}checkInputs(t,e){i("number"==typeof e);let r=0;for(const{prevout:s}of this.inputs){const n=t.getEntry(s);if(!n)return[-1,"bad-txns-inputs-missingorspent",0];if(n.coinbase&&e-n.height<b.COINBASE_MATURITY)return[-1,"bad-txns-premature-spend-of-coinbase",0];const o=t.getOutput(s);if(i(o),o.value<0||o.value>b.MAX_MONEY)return[-1,"bad-txns-inputvalues-outofrange",100];if(r+=o.value,r<0||r>b.MAX_MONEY)return[-1,"bad-txns-inputvalues-outofrange",100]}const s=this.getOutputValue();if(r<s)return[-1,"bad-txns-in-belowout",100];const n=r-s;return n<0?[-1,"bad-txns-fee-negative",100]:n>b.MAX_MONEY?[-1,"bad-txns-fee-outofrange",100]:[n,"valid",0]}getModifiedSize(t){null==t&&(t=this.getVirtualSize());for(const e of this.inputs){const r=41+Math.min(110,e.script.getSize());t>r&&(t-=r)}return t}getPriority(t,e,r){if(i("number"==typeof e,"Must pass in height."),this.isCoinbase())return 0;null==r&&(r=this.getVirtualSize());let s=0;for(const{prevout:r}of this.inputs){const i=t.getOutput(r);if(!i)continue;const n=t.getHeight(r);if(-1!==n&&n<=e){const t=e-n;s+=i.value*t}}return Math.floor(s/r)}getChainValue(t){if(this.isCoinbase())return 0;let e=0;for(const{prevout:r}of this.inputs){const i=t.getOutput(r);i&&(-1!==t.getHeight(r)&&(e+=i.value))}return e}isFree(t,e,r){return this.getPriority(t,e,r)>g.FREE_THRESHOLD}getMinFee(t,e){return null==t&&(t=this.getVirtualSize()),g.getMinFee(t,e)}getRoundFee(t,e){return null==t&&(t=this.getVirtualSize()),g.getRoundFee(t,e)}getRate(t,e){const r=this.getFee(t);return r<0?0:(null==e&&(e=this.getVirtualSize()),g.getRate(e,r))}getPrevout(){if(this.isCoinbase())return[];const t=new h;for(const e of this.inputs)t.add(e.prevout.hash);return t.toArray()}isWatched(t){let e=!1;t.test(this.hash())&&(e=!0);for(let r=0;r<this.outputs.length;r++){const i=this.outputs[r];if(i.script.test(t)){if(1===t.update){const e=m.fromTX(this,r);t.add(e.toRaw())}else if(2===t.update&&(i.script.isPubkey()||i.script.isMultisig())){const e=m.fromTX(this,r);t.add(e.toRaw())}e=!0}}if(e)return e;for(const e of this.inputs){const r=e.prevout;if(t.test(r.toRaw()))return!0;if(e.script.test(t))return!0}return!1}rhash(){return f.revHex(this.hash())}rwhash(){return f.revHex(this.witnessHash())}txid(){return this.rhash()}wtxid(){return this.rwhash()}toInv(){return new p(p.types.TX,this.hash())}[I](){return this.format()}format(t,e,r){let i=0,s=0,n=-1,o=null,h=0,a=null;return t&&(s=this.getFee(t),i=this.getRate(t),Number.isSafeInteger(i)||(i=0)),e&&(n=e.height,o=f.revHex(e.hash),h=e.time,a=f.date(h)),null==r&&(r=-1),{hash:this.txid(),witnessHash:this.wtxid(),size:this.getSize(),virtualSize:this.getVirtualSize(),value:u.btc(this.getOutputValue()),fee:u.btc(s),rate:u.btc(i),minFee:u.btc(this.getMinFee()),height:n,block:o,time:h,date:a,index:r,version:this.version,inputs:this.inputs.map((e=>{const r=t?t.getOutputFor(e):null;return e.format(r)})),outputs:this.outputs,locktime:this.locktime}}toJSON(){return this.getJSON()}getJSON(t,e,r,i){let s,n,o,h,u,c;return e&&(n=this.getFee(e),s=this.getRate(e),Number.isSafeInteger(s)||(s=0)),r&&(o=r.height,h=f.revHex(r.hash),u=r.time,c=f.date(u)),t=a.get(t),{hash:this.txid(),witnessHash:this.wtxid(),fee:n,rate:s,mtime:f.now(),height:o,block:h,time:u,date:c,index:i,version:this.version,inputs:this.inputs.map((r=>{const i=e?e.getCoinFor(r):null;return r.getJSON(t,i)})),outputs:this.outputs.map((e=>e.getJSON(t))),locktime:this.locktime,hex:this.toRaw().toString("hex")}}fromJSON(t){i(t,"TX data is required."),i(t.version>>>0===t.version,"Version must be a uint32."),i(Array.isArray(t.inputs),"Inputs must be an array."),i(Array.isArray(t.outputs),"Outputs must be an array."),i(t.locktime>>>0===t.locktime,"Locktime must be a uint32."),this.version=t.version;for(const e of t.inputs)this.inputs.push(d.fromJSON(e));for(const e of t.outputs)this.outputs.push(l.fromJSON(e));return this.locktime=t.locktime,this}static fromJSON(t){return(new this).fromJSON(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}static fromReader(t,e){return(new this).fromReader(t,e)}fromRaw(t){return this.fromReader(s.read(t))}fromReader(t,e){if(function(t){return!(t.left()<6)&&0===t.data[t.offset+4]&&0!==t.data[t.offset+5]}(t))return this.fromWitnessReader(t,e);const r=t.start();this.version=t.readU32();const i=t.readVarint();for(let e=0;e<i;e++)this.inputs.push(d.fromReader(t));const s=t.readVarint();for(let e=0;e<s;e++)this.outputs.push(l.fromReader(t));return this.locktime=t.readU32(),e&&(this._offset=r,this._block=!0),this.mutable?t.end():(this._raw=t.endData(),this._size=this._raw.length,this._witness=0),this}fromWitnessReader(t,e){const r=t.start();this.version=t.readU32(),i(0===t.readU8(),"Non-zero marker.");let s=t.readU8();i(0!==s,"Flags byte is zero.");const n=t.readVarint();for(let e=0;e<n;e++)this.inputs.push(d.fromReader(t));const o=t.readVarint();for(let e=0;e<o;e++)this.outputs.push(l.fromReader(t));let h=0,f=!1;if(1&s){s^=1,h=t.offset;for(const e of this.inputs)e.witness.fromReader(t),e.witness.items.length>0&&(f=!0);h=t.offset-h+2}if(0!==s)throw new Error("Unknown witness flag.");if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Zero input witness tx.");return this.locktime=t.readU32(),e&&(this._offset=r,this._block=!0),!this.mutable&&f?(this._raw=t.endData(),this._size=this._raw.length,this._witness=h):t.end(),this}frameNormal(){const t=this.getNormalSizes(),e=s.write(t.size);return this.writeNormal(e),t.data=e.render(),t}frameWitness(){const t=this.getWitnessSizes(),e=s.write(t.size);return this.writeWitness(e),t.data=e.render(),t}writeNormal(t){if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Cannot serialize zero-input tx.");t.writeU32(this.version),t.writeVarint(this.inputs.length);for(const e of this.inputs)e.toWriter(t);t.writeVarint(this.outputs.length);for(const e of this.outputs)e.toWriter(t);return t.writeU32(this.locktime),t}writeWitness(t){if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Cannot serialize zero-input tx.");t.writeU32(this.version),t.writeU8(0),t.writeU8(1),t.writeVarint(this.inputs.length);for(const e of this.inputs)e.toWriter(t);t.writeVarint(this.outputs.length);for(const e of this.outputs)e.toWriter(t);const e=t.offset;for(const e of this.inputs)e.witness.toWriter(t);const r=t.offset-e;if(t.writeU32(this.locktime),r===this.inputs.length)throw new Error("Cannot serialize empty-witness tx.");return t}getNormalSizes(){let t=0;t+=4,t+=S.sizeVarint(this.inputs.length);for(const e of this.inputs)t+=e.getSize();t+=S.sizeVarint(this.outputs.length);for(const e of this.outputs)t+=e.getSize();return t+=4,new E(t,0)}getWitnessSizes(){let t=0,e=0;t+=4,e+=2,t+=S.sizeVarint(this.inputs.length);for(const r of this.inputs)t+=r.getSize(),e+=r.witness.getVarSize();t+=S.sizeVarint(this.outputs.length);for(const e of this.outputs)t+=e.getSize();return t+=4,new E(t+e,e)}static isTX(t){return t instanceof v}}class E{constructor(t,e){this.data=null,this.size=t,this.witness=e}}t.exports=v},6762:(t,e,r)=>{const i=r(1676),s=r(6401);e.COIN=1e8,e.MAX_MONEY=21e6*e.COIN,e.BASE_REWARD=50*e.COIN,e.HALF_REWARD=Math.floor(e.BASE_REWARD/2),e.MAX_BLOCK_SIZE=1e6,e.MAX_RAW_BLOCK_SIZE=4e6,e.MAX_BLOCK_WEIGHT=4e6,e.MAX_BLOCK_SIGOPS=2e4,e.MAX_BLOCK_SIGOPS_COST=8e4,e.MEDIAN_TIMESPAN=11,e.VERSION_TOP_BITS=536870912,e.VERSION_TOP_MASK=3758096384,e.COINBASE_MATURITY=100,e.WITNESS_SCALE_FACTOR=4,e.LOCKTIME_THRESHOLD=5e8,e.SEQUENCE_DISABLE_FLAG=1<<31>>>0,e.SEQUENCE_TYPE_FLAG=1<<22,e.SEQUENCE_GRANULARITY=9,e.SEQUENCE_MASK=65535,e.MAX_SCRIPT_SIZE=1e4,e.MAX_SCRIPT_STACK=1e3,e.MAX_SCRIPT_PUSH=520,e.MAX_SCRIPT_OPS=201,e.MAX_MULTISIG_PUBKEYS=20,e.BIP16_TIME=1333238400,e.ZERO_HASH=Buffer.alloc(32,0),e.fromCompact=function(t){if(0===t)return new s(0);const e=t>>>24,r=t>>>23&1;let i,n=8388607&t;return e<=3?(n>>>=8*(3-e),i=new s(n)):(i=new s(n),i.iushln(8*(e-3))),r&&i.ineg(),i},e.toCompact=function(t){if(t.isZero())return 0;let e,r=t.byteLength();r<=3?(e=t.toNumber(),e<<=8*(3-r)):e=t.ushrn(8*(r-3)).toNumber(),8388608&e&&(e>>=8,r++);let i=r<<24|e;return t.isNeg()&&(i|=8388608),i>>>=0,i},e.verifyPOW=function(t,r){const i=e.fromCompact(r);return!i.isNeg()&&!i.isZero()&&(!(i.bitLength()>256)&&!new s(t,"le").gt(i))},e.getReward=function(t,r){i(t>=0,"Bad height for reward.");const s=Math.floor(t/r);return s>=33?0:0===s?e.BASE_REWARD:e.HALF_REWARD>>>s-1},e.hasBit=function(t,r){return(t&e.VERSION_TOP_MASK)>>>0===e.VERSION_TOP_BITS&&0!=(t&1<<r)}},6853:(t,e,r)=>{const i=r(1676),s=r(1456),n=r(3157),o=r(6762),h=r(6039),{inspectSymbol:f}=r(5666);class u{constructor(t){i(!u[t.type],"Cannot create two networks."),this.type=t.type,this.seeds=t.seeds,this.magic=t.magic,this.port=t.port,this.checkpointMap=t.checkpointMap,this.lastCheckpoint=t.lastCheckpoint,this.checkpoints=[],this.halvingInterval=t.halvingInterval,this.genesis=t.genesis,this.genesisBlock=t.genesisBlock,this.pow=t.pow,this.block=t.block,this.bip30=t.bip30,this.activationThreshold=t.activationThreshold,this.minerWindow=t.minerWindow,this.deployments=t.deployments,this.deploys=t.deploys,this.unknownBits=~o.VERSION_TOP_MASK,this.keyPrefix=t.keyPrefix,this.addressPrefix=t.addressPrefix,this.requireStandard=t.requireStandard,this.rpcPort=t.rpcPort,this.walletPort=t.walletPort,this.minRelay=t.minRelay,this.feeRate=t.feeRate,this.maxFeeRate=t.maxFeeRate,this.selfConnect=t.selfConnect,this.requestMempool=t.requestMempool,this.time=new h,this.init()}init(){let t=0;for(const e of this.deploys)t|=1<<e.bit;t|=o.VERSION_TOP_MASK,this.unknownBits=~t>>>0;for(const t of Object.keys(this.checkpointMap)){const e=this.checkpointMap[t],r=Number(t);this.checkpoints.push({hash:e,height:r})}this.checkpoints.sort(c)}byBit(t){const e=s.search(this.deploys,t,a);return-1===e?null:this.deploys[e]}now(){return this.time.now()}ms(){return this.time.ms()}static create(t){if("string"==typeof t&&(t=n[t]),i(t,"Unknown network."),u[t.type])return u[t.type];const e=new u(t);return u[e.type]=e,u.primary||(u.primary=e),e}static set(t){return i("string"==typeof t,"Bad network."),u.primary=u.get(t),u.type=t,u.primary}static get(t){if(!t)return i(u.primary,"No default network."),u.primary;if(t instanceof u)return t;if("string"==typeof t)return u.create(t);throw new Error("Unknown network.")}static ensure(t){return t?t instanceof u?t:"string"==typeof t&&n[t]?u.create(t):(i(u.primary,"No default network."),u.primary):(i(u.primary,"No default network."),u.primary)}static by(t,e,r,i){if(r){if(e(r=u.get(r),t))return r;throw new Error(`Network mismatch for ${i}.`)}for(const i of n.types)if(e(r=n[i],t))return u.get(i);throw new Error(`Network not found for ${i}.`)}static fromMagic(t,e){return u.by(t,d,e,"magic number")}static fromWIF(t,e){return u.by(t,l,e,"WIF")}static fromPublic(t,e){return u.by(t,m,e,"xpubkey")}static fromPrivate(t,e){return u.by(t,p,e,"xprivkey")}static fromPublic58(t,e){return u.by(t,b,e,"xpubkey")}static fromPrivate58(t,e){return u.by(t,g,e,"xprivkey")}static fromAddress(t,e){return u.by(t,w,e,"base58 address")}static fromBech32(t,e){return u.by(t,S,e,"bech32 address")}toString(){return this.type}[f](){return`<Network: ${this.type}>`}static isNetwork(t){return t instanceof u}}function a(t,e){return t.bit-e}function c(t,e){return t.height-e.height}function d(t,e){return t.magic===e}function l(t,e){return t.keyPrefix.privkey===e}function m(t,e){return t.keyPrefix.xpubkey===e}function p(t,e){return t.keyPrefix.xprivkey===e}function b(t,e){return t.keyPrefix.xpubkey58===e}function g(t,e){return t.keyPrefix.xprivkey58===e}function w(t,e){const r=t.addressPrefix;switch(e){case r.pubkeyhash:case r.scripthash:case r.witnesspubkeyhash:case r.witnessscripthash:return!0}return!1}function S(t,e){return t.addressPrefix.bech32===e}u.primary=null,u.type=null,u.main=null,u.testnet=null,u.regtest=null,u.simnet=null,u.set("main"),t.exports=u},3157:(t,e,r)=>{const i=r(6401),s=e;function n(t){return Buffer.from(t,"hex")}s.types=["main","testnet","regtest","simnet"];const o={type:"main",seeds:["seed.bitcoin.sipa.be","dnsseed.bluematt.me","dnsseed.bitcoin.dashjr.org","seed.bitcoinstats.com","seed.bitcoin.jonasschnelli.ch","seed.btc.petertodd.org","seed.bitcoin.sprovoost.nl","dnsseed.emzy.de"],magic:3652501241,port:8333};o.checkpointMap={11111:n("1d7c6eb2fd42f55925e92efad68b61edd22fba29fde8783df744e26900000000"),33333:n("a6d0b5df7d0df069ceb1e736a216ad187a50b07aaa4e78748a58d52d00000000"),74e3:n("201a66b853f9e7814a820e2af5f5dc79c07144e31ce4c9a39339570000000000"),105e3:n("97dc6b1d15fbeef373a744fee0b254b0d2c820a3ae7f0228ce91020000000000"),134444:n("feb0d2420d4a18914c81ac30f494a5d4ff34cd15d34cfd2fb105000000000000"),168e3:n("63b703835cb735cb9a89d733cbe66f212f63795e0172ea619e09000000000000"),193e3:n("17138bca83bdc3e6f60f01177c3877a98266de40735f2a459f05000000000000"),21e4:n("2e3471a19b8e22b7f939c63663076603cf692f19837e34958b04000000000000"),216116:n("4edf231bf170234e6a811460f95c94af9464e41ee833b4f4b401000000000000"),225430:n("32595730b165f097e7b806a679cf7f3e439040f750433808c101000000000000"),25e4:n("14d2f24d29bed75354f3f88a5fb50022fc064b02291fdf873800000000000000"),279e3:n("407ebde958e44190fa9e810ea1fc3a7ef601c3b0a0728cae0100000000000000"),295e3:n("83a93246c67003105af33ae0b29dd66f689d0f0ff54e9b4d0000000000000000"),300255:n("b2f3a0f0de4120c1089d5f5280a263059f9b6e7c520428160000000000000000"),319400:n("3bf115fd057391587ca39a531c5d4989e1adec9b2e05c6210000000000000000"),343185:n("548536d48e7678fcfa034202dd45d4a76b1ad061f38b2b070000000000000000"),352940:n("ffc9520143e41c94b6e03c2fa3e62bb76b55ba2df45d75100000000000000000"),382320:n("b28afdde92b0899715e40362f56afdb20e3d135bedc68d0a0000000000000000"),401465:n("eed16cb3e893ed9366f27c39a9ecd95465d02e3ef40e45010000000000000000"),42e4:n("a1ff746b2d42b834cb7d6b8981b09c265c2cabc016e8cc020000000000000000"),44e4:n("9bf296b8de5f834f7635d5e258a434ad51b4dbbcf7c08c030000000000000000"),45e4:n("0ba2070c62cd9da1f8cef88a0648c661a411d33e728340010000000000000000"),46e4:n("8c25fc7e414d3e868d6ce0ec473c30ad44e7e8bc1b75ef000000000000000000"),47e4:n("89756d1ed75901437300af10d5ab69070a282e729c536c000000000000000000"),48e4:n("b1a896fd31e639e0c74d1abeb1dbc93f176b767a5d4c02010000000000000000"),49e4:n("90dec4d0153f20fbdcb245b1d5fb3d5a8d7bb1379106de000000000000000000"),5e5:n("045d94a1c33354c3759cc0512dcc49fd81bf4c3637fb24000000000000000000"),51e4:n("297301b8ca28584cb0c31c7e3fed51696bc33ef8782615000000000000000000"),525e3:n("1dde8e3fb49bbd5ab66a1b847544d67fff10b108a1fa2f000000000000000000")},o.lastCheckpoint=525e3,o.halvingInterval=21e4,o.genesis={version:1,hash:n("6fe28c0ab6f1b372c1a6a246ae63f74f931e8365e15a089c68d6190000000000"),prevBlock:n("0000000000000000000000000000000000000000000000000000000000000000"),merkleRoot:n("3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a"),time:1231006505,bits:486604799,nonce:2083236893,height:0},o.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a29ab5f49ffff001d1dac2b7c0101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",o.pow={limit:new i("00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),bits:486604799,chainwork:new i("00000000000000000000000000000000000000000259c9b7d8c7779d29a1188f","hex"),targetTimespan:1209600,targetSpacing:600,retargetInterval:2016,targetReset:!1,noRetargeting:!1},o.block={bip34height:227931,bip34hash:n("b808089c756add1591b1d17bab44bba3fed9e02f942ab4894b02000000000000"),bip65height:388381,bip65hash:n("f035476cfaeb9f677c2cdad00fd908c556775ded24b6c2040000000000000000"),bip66height:363725,bip66hash:n("3109b588941188a9f1c2576aae462d729b8cce9da1ea79030000000000000000"),pruneAfterHeight:1e3,keepBlocks:288,maxTipAge:86400,slowHeight:325e3},o.bip30={91842:n("eccae000e3c8e4e093936360431f3b7603c563c1ff6181390a4d0a0000000000"),91880:n("21d77ccb4c08386a04ac0196ae10f6a1d2c2a377558ca190f143070000000000")},o.activationThreshold=1916,o.minerWindow=2016,o.deployments={csv:{name:"csv",bit:0,startTime:1462060800,timeout:1493596800,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:1479168e3,timeout:1510704e3,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:1496275200,timeout:1510704e3,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},o.deploys=[o.deployments.csv,o.deployments.segwit,o.deployments.segsignal,o.deployments.testdummy],o.keyPrefix={privkey:128,xpubkey:76067358,xprivkey:76066276,xpubkey58:"xpub",xprivkey58:"xprv",coinType:0},o.addressPrefix={pubkeyhash:0,scripthash:5,witnesspubkeyhash:6,witnessscripthash:10,bech32:"bc"},o.requireStandard=!0,o.rpcPort=8332,o.walletPort=8334,o.minRelay=1e3,o.feeRate=1e5,o.maxFeeRate=4e5,o.selfConnect=!1,o.requestMempool=!1;const h={type:"testnet",seeds:["testnet-seed.bitcoin.jonasschnelli.ch","seed.tbtc.petertodd.org","testnet-seed.bluematt.me","testnet-seed.bitcoin.schildbach.de","seed.testnet.bitcoin.sprovoost.nl"],magic:118034699,port:18333};h.checkpointMap={546:n("70cb6af7ebbcb1315d3414029c556c55f3e2fc353c4c9063a76c932a00000000"),1e4:n("02a1b43f52591e53b660069173ac83b675798e12599dbb0442b7580000000000"),5e4:n("0c6ceabe803cec55ba2831e445956d0a43ba9521743a802cddac7e0700000000"),9e4:n("cafc21e17faf90461a5905aa03302c394912651ed9475ae711723e0d00000000"),1e5:n("1e0a16bbadccde1d80c66597b1939e45f91b570d29f95fc158299e0000000000"),14e4:n("92c0877b54c556889b72175ccbe0c91a1208f6ef7efb2c006101062300000000"),17e4:n("508125560d202b89757889bb0e49c712477be20440058f05db4f0e0000000000"),21e4:n("32365454b5f29a826bff8ad9b0448cad0072fc73d50e482d91a3dece00000000"),23e4:n("b11a447e62643e0b27406eb0fc270cb8126d7b5b70822fb642d9513400000000"),27e4:n("1c42b811cf9c163932f6e95ec55bf9b5e2cb5324e7e93001572e000000000000"),3e5:n("a141bf3972424853f04367b47995e220e0b5a2706e5618766f22000000000000"),34e4:n("67edd4d92e405608109164b15f92b193377d49325b0ed036739c010000000000"),35e4:n("592b44bc0f7a4286cf07ead8497114c6952c1c7dea7305193deacf8e00000000"),39e4:n("f217e183484fb6d695609cc71fa2ae24c3020943407e0150b298030000000000"),42e4:n("de9e73a3b91fbb014e036e8583a17d6b638a699aeb2de8573d12580800000000"),46e4:n("2e8baaffc107f15c87aebe01664b63d07476afa53bcbada1281a030000000000"),5e5:n("06f60922a2aab2757317820fc6ffaf6a470e2cbb0f63a2aac0a7010000000000"),54e4:n("8dd0bebfbc4878f5af09d3e848dcc57827d2c1cebea8ec5d8cbe420500000000"),57e4:n("87acbd4cd3c40ec9bd648f8698ed226b31187274c06cc7a9af79030000000000"),6e5:n("169a05b3bb04b7d13ad628915630900a5ed2e89f3a9dc6064f62000000000000"),63e4:n("bbbe117035432a6a4effcb297207a02b031735b43e0d19a9217c000000000000"),67e4:n("080bfe75caed8624fcfdfbc65973c8f962d7bdc495a891f5d16b7d0000000000"),7e5:n("c14d3f6a1e7c7d66fd940951e44f3c3be1273bea4d2ab1786140000000000000"),74e4:n("b3b423f0462fd78a01e4f1a59a2737a0525b5dbb9bba0b4634f9000000000000"),78e4:n("0381582e34c3755964dc2813e2b33e521e5596367144e1670851050000000000"),8e5:n("03b5f8ab257e02903f509f5ff2935220eec2e77b1819651d099b200000000000"),84e4:n("dac1648107bd4394e57e4083c86d42b548b1cfb119665f179ea80a0000000000"),88e4:n("ff90b4bb07eded8e96715bf595c09c7d21dd8c61b8306ff48705d60000000000"),9e5:n("9bd8ac418beeb1a2cf5d68c8b5c6ebaa947a5b766e5524898d6f350000000000"),94e4:n("c98f1651a475b00d12f8c25eb166ee843affaa90610e36a19d68030000000000"),98e4:n("cc8e9774542d044a9698ca2336ae02d5987157e676f1c76aa3877c0000000000"),101e4:n("9d9fb11abc2712d80368229e97b8d827b2a07d27eb5335e5c924000000000000"),105e4:n("d8190cf0af7f08e179cab51d67db0b44b87951a78f7fdc31b4a01a0000000000")},h.lastCheckpoint=105e4,h.halvingInterval=21e4,h.genesis={version:1,hash:n("43497fd7f826957108f4a30fd9cec3aeba79972084e90ead01ea330900000000"),prevBlock:n("0000000000000000000000000000000000000000000000000000000000000000"),merkleRoot:n("3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a"),time:1296688602,bits:486604799,nonce:414098458,height:0},h.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4adae5494dffff001d1aa4ae180101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",h.pow={limit:new i("00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),bits:486604799,chainwork:new i("000000000000000000000000000000000000000000000062b7123cfd7d09f7b6","hex"),targetTimespan:1209600,targetSpacing:600,retargetInterval:2016,targetReset:!0,noRetargeting:!1},h.block={bip34height:21111,bip34hash:n("f88ecd9912d00d3f5c2a8e0f50417d3e415c75b3abe584346da9b32300000000"),bip65height:581885,bip65hash:n("b61e864fbec41dfaf09da05d1d76dc068b0dd82ee7982ff255667f0000000000"),bip66height:330776,bip66hash:n("82a14b9e5ea81d4832b8e2cd3c2a6092b5a3853285a8995ec4c8042100000000"),pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:86400,slowHeight:95e4},h.bip30={},h.activationThreshold=1512,h.minerWindow=2016,h.deployments={csv:{name:"csv",bit:0,startTime:1456790400,timeout:1493596800,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:1462060800,timeout:1493596800,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:4294967295,timeout:4294967295,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},h.deploys=[h.deployments.csv,h.deployments.segwit,h.deployments.segsignal,h.deployments.testdummy],h.keyPrefix={privkey:239,xpubkey:70617039,xprivkey:70615956,xpubkey58:"tpub",xprivkey58:"tprv",coinType:1},h.addressPrefix={pubkeyhash:111,scripthash:196,witnesspubkeyhash:3,witnessscripthash:40,bech32:"tb"},h.requireStandard=!1,h.rpcPort=18332,h.walletPort=18334,h.minRelay=1e3,h.feeRate=2e4,h.maxFeeRate=6e4,h.selfConnect=!1,h.requestMempool=!1;const f={type:"regtest",seeds:[],magic:3669344250,port:48444,checkpointMap:{},lastCheckpoint:0,halvingInterval:150};f.genesis={version:1,hash:n("06226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f"),prevBlock:n("0000000000000000000000000000000000000000000000000000000000000000"),merkleRoot:n("3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a"),time:1296688602,bits:545259519,nonce:2,height:0},f.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4adae5494dffff7f20020000000101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",f.pow={limit:new i("7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),bits:545259519,chainwork:new i("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:1209600,targetSpacing:600,retargetInterval:2016,targetReset:!0,noRetargeting:!0},f.block={bip34height:1e8,bip34hash:null,bip65height:1351,bip65hash:null,bip66height:1251,bip66hash:null,pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:4294967295,slowHeight:0},f.bip30={},f.activationThreshold=108,f.minerWindow=144,f.deployments={csv:{name:"csv",bit:0,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:-1,timeout:4294967295,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:4294967295,timeout:4294967295,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0}},f.deploys=[f.deployments.csv,f.deployments.segwit,f.deployments.segsignal,f.deployments.testdummy],f.keyPrefix={privkey:239,xpubkey:70617039,xprivkey:70615956,xpubkey58:"tpub",xprivkey58:"tprv",coinType:1},f.addressPrefix={pubkeyhash:111,scripthash:196,witnesspubkeyhash:3,witnessscripthash:40,bech32:"bcrt"},f.requireStandard=!1,f.rpcPort=48332,f.walletPort=48334,f.minRelay=1e3,f.feeRate=2e4,f.maxFeeRate=6e4,f.selfConnect=!0,f.requestMempool=!0;const u={type:"simnet",seeds:["127.0.0.1"],magic:303307798,port:18555,checkpointMap:{},lastCheckpoint:0,halvingInterval:21e4};u.genesis={version:1,hash:n("f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68"),prevBlock:n("0000000000000000000000000000000000000000000000000000000000000000"),merkleRoot:n("3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a"),time:1401292357,bits:545259519,nonce:2,height:0},u.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a45068653ffff7f20020000000101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",u.pow={limit:new i("7fffff0000000000000000000000000000000000000000000000000000000000","hex"),bits:545259519,chainwork:new i("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:1209600,targetSpacing:600,retargetInterval:2016,targetReset:!0,noRetargeting:!1},u.block={bip34height:0,bip34hash:n("f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68"),bip65height:0,bip65hash:n("f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68"),bip66height:0,bip66hash:n("f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68"),pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:4294967295,slowHeight:0},u.bip30={},u.activationThreshold=75,u.minerWindow=100,u.deployments={csv:{name:"csv",bit:0,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:4294967295,timeout:4294967295,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},u.deploys=[u.deployments.csv,u.deployments.segwit,u.deployments.segsignal,u.deployments.testdummy],u.keyPrefix={privkey:100,xpubkey:69254458,xprivkey:69253376,xpubkey58:"spub",xprivkey58:"sprv",coinType:115},u.addressPrefix={pubkeyhash:63,scripthash:123,witnesspubkeyhash:25,witnessscripthash:40,bech32:"sb"},u.requireStandard=!1,u.rpcPort=18556,u.walletPort=18558,u.minRelay=1e3,u.feeRate=2e4,u.maxFeeRate=6e4,u.selfConnect=!1,u.requestMempool=!1,s.main=o,s.testnet=h,s.regtest=f,s.simnet=u},1377:(t,e,r)=>{const i=r(1676),s=r(6762);e.MAX_TX_VERSION=2,e.MAX_TX_SIZE=s.MAX_BLOCK_SIZE/10,e.MAX_TX_WEIGHT=s.MAX_BLOCK_WEIGHT/10,e.MAX_TX_SIGOPS=s.MAX_BLOCK_SIGOPS/5,e.MAX_TX_SIGOPS_COST=s.MAX_BLOCK_SIGOPS_COST/5,e.BYTES_PER_SIGOP=20,e.MIN_RELAY=1e3,e.BARE_MULTISIG=!0,e.FREE_THRESHOLD=144*s.COIN/250,e.MAX_P2SH_SIGOPS=15,e.MAX_OP_RETURN_BYTES=83,e.MAX_OP_RETURN=80,e.MAX_P2WSH_STACK=100,e.MAX_P2WSH_PUSH=80,e.MAX_P2WSH_SIZE=3600,e.MEMPOOL_MAX_ANCESTORS=25,e.MEMPOOL_MAX_SIZE=1e8,e.MEMPOOL_EXPIRY_TIME=259200,e.MEMPOOL_MAX_ORPHANS=100,e.MIN_BLOCK_WEIGHT=0,e.MAX_BLOCK_WEIGHT=1e6*s.WITNESS_SCALE_FACTOR,e.BLOCK_PRIORITY_WEIGHT=0,e.BLOCK_PRIORITY_THRESHOLD=e.FREE_THRESHOLD,e.getMinFee=function(t,r){if(null==r&&(r=e.MIN_RELAY),i(t>=0),i(r>=0),0===t)return 0;let s=Math.floor(r*t/1e3);return 0===s&&r>0&&(s=r),s},e.getRoundFee=function(t,r){if(null==r&&(r=e.MIN_RELAY),i(t>=0),i(r>=0),0===t)return 0;let s=r*Math.ceil(t/1e3);return 0===s&&r>0&&(s=r),s},e.getRate=function(t,e){return i(t>=0),i(e>=0),0===t?0:Math.floor(1e3*e/t)}},6039:(t,e,r)=>{const i=r(8614),s=r(1972),n=r(1456);function o(t,e){return t-e}t.exports=class extends i{constructor(t){super(),null==t&&(t=200),this.samples=[],this.known=new Map,this.limit=t,this.offset=0,this.checked=!1}add(t,e){if(this.samples.length>=this.limit)return;if(this.known.has(t))return;const r=e-s.now();if(this.known.set(t,r),n.insert(this.samples,r,o),this.emit("sample",r,this.samples.length),this.samples.length>=5&&this.samples.length%2==1){let t=this.samples[this.samples.length>>>1];if(Math.abs(t)>=4200){if(!this.checked){let t=!1;for(const e of this.samples)if(0!==e&&Math.abs(e)<300){t=!0;break}t||(this.checked=!0,this.emit("mismatch"))}t=0}this.offset=t,this.emit("offset",this.offset)}}now(){return s.now()+this.offset}adjust(t){return t+this.offset}local(t){return t-this.offset}ms(){return Date.now()+1e3*this.offset}}},3029:(t,e,r)=>{const i=r(1676),s=r(2581),n=r(4429);e.opcodes={OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_CHECKLOCKTIMEVERIFY:177,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_INVALIDOPCODE:255},e.opcodesByVal={0:"OP_0",76:"OP_PUSHDATA1",77:"OP_PUSHDATA2",78:"OP_PUSHDATA4",79:"OP_1NEGATE",80:"OP_RESERVED",81:"OP_1",82:"OP_2",83:"OP_3",84:"OP_4",85:"OP_5",86:"OP_6",87:"OP_7",88:"OP_8",89:"OP_9",90:"OP_10",91:"OP_11",92:"OP_12",93:"OP_13",94:"OP_14",95:"OP_15",96:"OP_16",97:"OP_NOP",98:"OP_VER",99:"OP_IF",100:"OP_NOTIF",101:"OP_VERIF",102:"OP_VERNOTIF",103:"OP_ELSE",104:"OP_ENDIF",105:"OP_VERIFY",106:"OP_RETURN",107:"OP_TOALTSTACK",108:"OP_FROMALTSTACK",109:"OP_2DROP",110:"OP_2DUP",111:"OP_3DUP",112:"OP_2OVER",113:"OP_2ROT",114:"OP_2SWAP",115:"OP_IFDUP",116:"OP_DEPTH",117:"OP_DROP",118:"OP_DUP",119:"OP_NIP",120:"OP_OVER",121:"OP_PICK",122:"OP_ROLL",123:"OP_ROT",124:"OP_SWAP",125:"OP_TUCK",126:"OP_CAT",127:"OP_SUBSTR",128:"OP_LEFT",129:"OP_RIGHT",130:"OP_SIZE",131:"OP_INVERT",132:"OP_AND",133:"OP_OR",134:"OP_XOR",135:"OP_EQUAL",136:"OP_EQUALVERIFY",137:"OP_RESERVED1",138:"OP_RESERVED2",139:"OP_1ADD",140:"OP_1SUB",141:"OP_2MUL",142:"OP_2DIV",143:"OP_NEGATE",144:"OP_ABS",145:"OP_NOT",146:"OP_0NOTEQUAL",147:"OP_ADD",148:"OP_SUB",149:"OP_MUL",150:"OP_DIV",151:"OP_MOD",152:"OP_LSHIFT",153:"OP_RSHIFT",154:"OP_BOOLAND",155:"OP_BOOLOR",156:"OP_NUMEQUAL",157:"OP_NUMEQUALVERIFY",158:"OP_NUMNOTEQUAL",159:"OP_LESSTHAN",160:"OP_GREATERTHAN",161:"OP_LESSTHANOREQUAL",162:"OP_GREATERTHANOREQUAL",163:"OP_MIN",164:"OP_MAX",165:"OP_WITHIN",166:"OP_RIPEMD160",167:"OP_SHA1",168:"OP_SHA256",169:"OP_HASH160",170:"OP_HASH256",171:"OP_CODESEPARATOR",172:"OP_CHECKSIG",173:"OP_CHECKSIGVERIFY",174:"OP_CHECKMULTISIG",175:"OP_CHECKMULTISIGVERIFY",176:"OP_NOP1",177:"OP_CHECKLOCKTIMEVERIFY",178:"OP_CHECKSEQUENCEVERIFY",179:"OP_NOP4",180:"OP_NOP5",181:"OP_NOP6",182:"OP_NOP7",183:"OP_NOP8",184:"OP_NOP9",185:"OP_NOP10",255:"OP_INVALIDOPCODE"},e.small=[Buffer.from([129]),Buffer.from([]),Buffer.from([1]),Buffer.from([2]),Buffer.from([3]),Buffer.from([4]),Buffer.from([5]),Buffer.from([6]),Buffer.from([7]),Buffer.from([8]),Buffer.from([9]),Buffer.from([10]),Buffer.from([11]),Buffer.from([12]),Buffer.from([13]),Buffer.from([14]),Buffer.from([15]),Buffer.from([16])],e.flags={VERIFY_NONE:0,VERIFY_P2SH:1,VERIFY_STRICTENC:2,VERIFY_DERSIG:4,VERIFY_LOW_S:8,VERIFY_NULLDUMMY:16,VERIFY_SIGPUSHONLY:32,VERIFY_MINIMALDATA:64,VERIFY_DISCOURAGE_UPGRADABLE_NOPS:128,VERIFY_CLEANSTACK:256,VERIFY_CHECKLOCKTIMEVERIFY:512,VERIFY_CHECKSEQUENCEVERIFY:1024,VERIFY_WITNESS:2048,VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM:4096,VERIFY_MINIMALIF:8192,VERIFY_NULLFAIL:16384,VERIFY_WITNESS_PUBKEYTYPE:32768,VERIFY_CONST_SCRIPTCODE:65536},e.flags.MANDATORY_VERIFY_FLAGS=e.flags.VERIFY_P2SH,e.flags.STANDARD_VERIFY_FLAGS=0|e.flags.MANDATORY_VERIFY_FLAGS|e.flags.VERIFY_DERSIG|e.flags.VERIFY_STRICTENC|e.flags.VERIFY_MINIMALDATA|e.flags.VERIFY_NULLDUMMY|e.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS|e.flags.VERIFY_CLEANSTACK|e.flags.VERIFY_MINIMALIF|e.flags.VERIFY_NULLFAIL|e.flags.VERIFY_CHECKLOCKTIMEVERIFY|e.flags.VERIFY_CHECKSEQUENCEVERIFY|e.flags.VERIFY_LOW_S|e.flags.VERIFY_WITNESS|e.flags.VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM|e.flags.VERIFY_WITNESS_PUBKEYTYPE|e.flags.VERIFY_CONST_SCRIPTCODE,e.flags.ONLY_STANDARD_VERIFY_FLAGS=e.flags.STANDARD_VERIFY_FLAGS&~e.flags.MANDATORY_VERIFY_FLAGS,e.hashType={ALL:1,NONE:2,SINGLE:3,ANYONECANPAY:128},e.hashTypeByVal={1:"ALL",2:"NONE",3:"SINGLE",128:"ANYONECANPAY"},e.types={NONSTANDARD:0,PUBKEY:1,PUBKEYHASH:2,SCRIPTHASH:3,MULTISIG:4,NULLDATA:5,WITNESSMALFORMED:128,WITNESSSCRIPTHASH:129,WITNESSPUBKEYHASH:130},e.typesByVal={0:"NONSTANDARD",1:"PUBKEY",2:"PUBKEYHASH",3:"SCRIPTHASH",4:"MULTISIG",5:"NULLDATA",128:"WITNESSMALFORMED",129:"WITNESSSCRIPTHASH",130:"WITNESSPUBKEYHASH"},e.isHashType=function(t){if(i(Buffer.isBuffer(t)),0===t.length)return!1;const r=t[t.length-1]&~e.hashType.ANYONECANPAY;return!(r<e.hashType.ALL||r>e.hashType.SINGLE)},e.isLowDER=function(t){return!!e.isSignatureEncoding(t)&&s.isLowDER(t.slice(0,-1))},e.isKeyEncoding=function(t){if(i(Buffer.isBuffer(t)),t.length<33)return!1;if(4===t[0]){if(65!==t.length)return!1}else{if(2!==t[0]&&3!==t[0])return!1;if(33!==t.length)return!1}return!0},e.isCompressedEncoding=function(t){return i(Buffer.isBuffer(t)),33===t.length&&(2===t[0]||3===t[0])},e.isSignatureEncoding=function(t){if(i(Buffer.isBuffer(t)),t.length<9)return!1;if(t.length>73)return!1;if(48!==t[0])return!1;if(t[1]!==t.length-3)return!1;const e=t[3];if(5+e>=t.length)return!1;const r=t[5+e];return!(e+r+7!==t.length||2!==t[2]||0===e||128&t[4]||e>1&&0===t[4]&&!(128&t[5])||2!==t[e+4]||0===r||128&t[e+6]||r>1&&0===t[e+6]&&!(128&t[e+7]))},e.toASM=function(t,r){if(t.length<=4)return n.decode(t).toString(10);if(r&&e.isSignatureEncoding(t)){const r=t[t.length-1];let i=e.hashTypeByVal[31&r]||"";return i&&(r&e.hashType.ANYONECANPAY&&(i+="|ANYONECANPAY"),i=`[${i}]`),t.slice(0,-1).toString("hex")+i}return t.toString("hex")}},5784:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(4429),o=r(3029),h=o.opcodes,f=[];let u=null;class a{constructor(t,e){this.value=t||0,this.data=e||null}isMinimal(){if(!this.data)return!0;if(1===this.data.length){if(129===this.data[0])return!1;if(this.data[0]>=1&&this.data[0]<=16)return!1}return this.data.length<=75?this.value===this.data.length:this.data.length<=255?this.value===h.OP_PUSHDATA1:this.data.length<=65535?this.value===h.OP_PUSHDATA2:(i(this.value===h.OP_PUSHDATA4),!0)}isDisabled(){switch(this.value){case h.OP_CAT:case h.OP_SUBSTR:case h.OP_LEFT:case h.OP_RIGHT:case h.OP_INVERT:case h.OP_AND:case h.OP_OR:case h.OP_XOR:case h.OP_2MUL:case h.OP_2DIV:case h.OP_MUL:case h.OP_DIV:case h.OP_MOD:case h.OP_LSHIFT:case h.OP_RSHIFT:return!0}return!1}isBranch(){return this.value>=h.OP_IF&&this.value<=h.OP_ENDIF}equals(t){return i(a.isOpcode(t)),this.value===t.value&&(this.data?(i(t.data),this.data.equals(t.data)):(i(!t.data),!0))}toOp(){return this.value}toData(){return this.data}toLength(){return this.data?this.data.length:-1}toPush(){return this.value===h.OP_0?o.small[1]:this.value===h.OP_1NEGATE?o.small[0]:this.value>=h.OP_1&&this.value<=h.OP_16?o.small[this.value-80+1]:this.toData()}toString(t){const e=this.toPush();return e?e.toString(t||"utf8"):null}toSmall(){return this.value===h.OP_0?0:this.value>=h.OP_1&&this.value<=h.OP_16?this.value-80:-1}toNum(t,e){return this.value===h.OP_0?n.fromInt(0):this.value===h.OP_1NEGATE?n.fromInt(-1):this.value>=h.OP_1&&this.value<=h.OP_16?n.fromInt(this.value-80):this.data?n.decode(this.data,t,e):null}toInt(t,e){const r=this.toNum(t,e);return r?r.getInt():-1}toBool(){const t=this.toSmall();return-1!==t&&1===t}toSymbol(){if(-1===this.value)return"OP_INVALIDOPCODE";return o.opcodesByVal[this.value]||`0x${c(this.value)}`}getSize(){if(!this.data)return 1;switch(this.value){case h.OP_PUSHDATA1:return 2+this.data.length;case h.OP_PUSHDATA2:return 3+this.data.length;case h.OP_PUSHDATA4:return 5+this.data.length;default:return 1+this.data.length}}toWriter(t){if(-1===this.value)throw new Error("Cannot reserialize a parse error.");if(!this.data)return t.writeU8(this.value),t;switch(this.value){case h.OP_PUSHDATA1:t.writeU8(this.value),t.writeU8(this.data.length),t.writeBytes(this.data);break;case h.OP_PUSHDATA2:t.writeU8(this.value),t.writeU16(this.data.length),t.writeBytes(this.data);break;case h.OP_PUSHDATA4:t.writeU8(this.value),t.writeU32(this.data.length),t.writeBytes(this.data);break;default:i(this.value===this.data.length),t.writeU8(this.value),t.writeBytes(this.data)}return t}toRaw(){const t=this.getSize();return this.toWriter(s.write(t)).render()}toFormat(){if(-1===this.value)return"0x01";if(this.data){if(this.data.length<=4){const t=this.toNum();if(this.equals(a.fromNum(t)))return t.toString(10)}const t=o.opcodesByVal[this.value],e=this.data.toString("hex");if(!t)return`0x${c(this.value)} 0x${e}`;let r=this.data.length.toString(16);for(;r.length%2!=0;)r="0"+r;return`${t} 0x${r} 0x${e}`}const t=o.opcodesByVal[this.value];return t||`0x${c(this.value)}`}toASM(t){return-1===this.value?"[error]":this.data?o.toASM(this.data,t):o.opcodesByVal[this.value]||"OP_UNKNOWN"}static fromOp(t){i("number"==typeof t);const e=f[t];return i(e,"Bad opcode."),e}static fromData(t){if(i(Buffer.isBuffer(t)),1===t.length){if(129===t[0])return this.fromOp(h.OP_1NEGATE);if(t[0]>=1&&t[0]<=16)return this.fromOp(t[0]+80)}return this.fromPush(t)}static fromPush(t){if(i(Buffer.isBuffer(t)),0===t.length)return this.fromOp(h.OP_0);if(t.length<=75)return new this(t.length,t);if(t.length<=255)return new this(h.OP_PUSHDATA1,t);if(t.length<=65535)return new this(h.OP_PUSHDATA2,t);if(t.length<=4294967295)return new this(h.OP_PUSHDATA4,t);throw new Error("Pushdata size too large.")}static fromString(t,e){i("string"==typeof t);const r=Buffer.from(t,e||"utf8");return this.fromData(r)}static fromSmall(t){return i((255&t)===t&&t>=0&&t<=16),this.fromOp(0===t?0:t+80)}static fromNum(t){return i(n.isScriptNum(t)),this.fromData(t.encode())}static fromInt(t){return i(Number.isSafeInteger(t)),0===t?this.fromOp(h.OP_0):-1===t?this.fromOp(h.OP_1NEGATE):t>=1&&t<=16?this.fromOp(t+80):this.fromNum(n.fromNumber(t))}static fromBool(t){return i("boolean"==typeof t),this.fromSmall(t?1:0)}static fromSymbol(t){i("string"==typeof t),i(t.length>0),32&t.charCodeAt(0)&&(t=t.toUpperCase()),/^OP_/.test(t)||(t=`OP_${t}`);const e=o.opcodes[t];if(null!=e)return this.fromOp(e);i(/^OP_0X/.test(t),"Unknown opcode."),i(7===t.length,"Unknown opcode.");const r=parseInt(t.substring(5),16);return i((255&r)===r,"Unknown opcode."),this.fromOp(r)}static fromReader(t){const e=t.readU8(),r=f[e];if(r)return r;switch(e){case h.OP_PUSHDATA1:{if(t.left()<1)return u;const r=t.readU8();return t.left()<r?(t.seek(t.left()),u):new this(e,t.readBytes(r))}case h.OP_PUSHDATA2:{if(t.left()<2)return t.seek(t.left()),u;const r=t.readU16();return t.left()<r?(t.seek(t.left()),u):new this(e,t.readBytes(r))}case h.OP_PUSHDATA4:{if(t.left()<4)return t.seek(t.left()),u;const r=t.readU32();return t.left()<r?(t.seek(t.left()),u):new this(e,t.readBytes(r))}default:return t.left()<e?(t.seek(t.left()),u):new this(e,t.readBytes(e))}}static fromRaw(t){return this.fromReader(s.read(t))}static isOpcode(t){return t instanceof a}}function c(t){return t<=15?"0"+t.toString(16):t.toString(16)}u=Object.freeze(new a(-1));for(let t=0;t<=255;t++){if(t>=1&&t<=78){f.push(null);continue}const e=new a(t);f.push(Object.freeze(e))}t.exports=a},6578:(t,e,r)=>{const i=r(1676),s=r(3029),n=s.types,{inspectSymbol:o}=r(5666);t.exports=class{constructor(t,e){i((255&t)===t),i(t>=0&&t<=16),i(Buffer.isBuffer(e)),i(e.length>=2&&e.length<=40),this.version=t,this.data=e}getType(){return 0===this.version?20===this.data.length?n.WITNESSPUBKEYHASH:32===this.data.length?n.WITNESSSCRIPTHASH:n.WITNESSMALFORMED:n.NONSTANDARD}isUnknown(){const t=this.getType();return t===n.WITNESSMALFORMED||t===n.NONSTANDARD}isMalformed(){return this.getType()===n.WITNESSMALFORMED}[o](){const t=this.data.toString("hex"),e=s.typesByVal[this.getType()].toLowerCase();return`<Program: version=${this.version} data=${t} type=${e}>`}}},4240:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(100),o=r(8122),h=r(2372),f=r(1808),u=r(2355),a=r(2581),c=r(6762),d=r(1377),l=r(6578),m=r(5784),p=r(9840),b=r(8521),g=r(4429),w=r(3029),S=r(7911),y=w.opcodes,I=w.types,{encoding:v}=s,{inspectSymbol:E}=r(5666),_=Buffer.alloc(0);class O{constructor(t){this.raw=_,this.code=[],t&&this.fromOptions(t)}get length(){return this.code.length}set length(t){this.code.length=t}fromOptions(t){if(i(t,"Script data is required."),Buffer.isBuffer(t))return this.fromRaw(t);if(Array.isArray(t))return this.fromArray(t);if(t.raw){if(!t.code)return this.fromRaw(t.raw);i(Buffer.isBuffer(t.raw),"Raw must be a Buffer."),this.raw=t.raw}if(t.code){if(!t.raw)return this.fromArray(t.code);i(Array.isArray(t.code),"Code must be an array."),this.code=t.code}return this}static fromOptions(t){return(new this).fromOptions(t)}values(){return this.code.values()}entries(){return this.code.entries()}[Symbol.iterator](){return this.code[Symbol.iterator]()}toArray(){return this.code.slice()}fromArray(t){i(Array.isArray(t)),this.clear();for(const e of t)this.push(e);return this.compile()}static fromArray(t){return(new this).fromArray(t)}toItems(){const t=[];for(const e of this.code){const r=e.toPush();if(!r)throw new Error("Non-push opcode in script.");t.push(r)}return t}fromItems(t){i(Array.isArray(t)),this.clear();for(const e of t)this.pushData(e);return this.compile()}static fromItems(t){return(new this).fromItems(t)}toStack(){return new p(this.toItems())}fromStack(t){return this.fromItems(t.items)}static fromStack(t){return(new this).fromStack(t)}clone(){return(new this.constructor).inject(this)}inject(t){return this.raw=t.raw,this.code=t.code.slice(),this}equals(t){return i(O.isScript(t)),this.raw.equals(t.raw)}compare(t){return i(O.isScript(t)),this.raw.compare(t.raw)}clear(){return this.raw=_,this.code.length=0,this}[E](){return`<Script: ${this.toString()}>`}toString(){const t=[];for(const e of this.code)t.push(e.toFormat());return t.join(" ")}toASM(t){this.isNulldata()&&(t=!1);const e=[];for(const r of this.code)e.push(r.toASM(t));return e.join(" ")}compile(){if(0===this.code.length)return this.clear();let t=0;for(const e of this.code)t+=e.getSize();const e=s.write(t);for(const t of this.code)t.toWriter(e);return this.raw=e.render(),this}toWriter(t){return t.writeVarBytes(this.raw),t}toRaw(){return this.raw}toJSON(){return this.toRaw().toString("hex")}fromJSON(t){return i("string"==typeof t,"Code must be a string."),this.fromRaw(Buffer.from(t,"hex"))}static fromJSON(t){return(new this).fromJSON(t)}getSubscript(t){if(0===t)return this.clone();const e=new O;for(let r=t;r<this.code.length;r++){const t=this.code[r];if(-1===t.value)break;e.code.push(t)}return e.compile()}removeSeparators(){let t=!1;for(const e of this.code){if(-1===e.value)break;if(e.value===y.OP_CODESEPARATOR){t=!0;break}}if(!t)return this;const e=new O;for(const t of this.code){if(-1===t.value)break;t.value!==y.OP_CODESEPARATOR&&e.code.push(t)}return e.compile()}execute(t,e,r,s,a,d){if(null==e&&(e=O.flags.STANDARD_VERIFY_FLAGS),null==d&&(d=0),this.raw.length>c.MAX_SCRIPT_SIZE)throw new b("SCRIPT_SIZE");const l=[],m=[];let p=0,w=0,S=0,I=!1;e&O.flags.VERIFY_MINIMALDATA&&(I=!0);for(let v=0;v<this.code.length;v++){const E=this.code[v];if(-1===E.value)throw new b("BAD_OPCODE",E,v);if(E.data&&E.data.length>c.MAX_SCRIPT_PUSH)throw new b("PUSH_SIZE",E,v);if(E.value>y.OP_16&&++w>c.MAX_SCRIPT_OPS)throw new b("OP_COUNT",E,v);if(E.isDisabled())throw new b("DISABLED_OPCODE",E,v);if(E.value===y.OP_CODESEPARATOR&&0===d&&e&O.flags.VERIFY_CONST_SCRIPTCODE)throw new b("OP_CODESEPARATOR",E,v);if(!S||E.isBranch())if(E.data){if(I&&!E.isMinimal())throw new b("MINIMALDATA",E,v);if(t.push(E.data),t.length+m.length>c.MAX_SCRIPT_STACK)throw new b("STACK_SIZE",E,v)}else{switch(E.value){case y.OP_0:t.pushInt(0);break;case y.OP_1NEGATE:t.pushInt(-1);break;case y.OP_1:case y.OP_2:case y.OP_3:case y.OP_4:case y.OP_5:case y.OP_6:case y.OP_7:case y.OP_8:case y.OP_9:case y.OP_10:case y.OP_11:case y.OP_12:case y.OP_13:case y.OP_14:case y.OP_15:case y.OP_16:t.pushInt(E.value-80);break;case y.OP_NOP:break;case y.OP_CHECKLOCKTIMEVERIFY:{if(!(e&O.flags.VERIFY_CHECKLOCKTIMEVERIFY))break;if(!r)throw new b("UNKNOWN_ERROR","No TX passed in.");if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);const i=t.getNum(-1,I,5);if(i.isNeg())throw new b("NEGATIVE_LOCKTIME",E,v);const n=i.toDouble();if(!r.verifyLocktime(s,n))throw new b("UNSATISFIED_LOCKTIME",E,v);break}case y.OP_CHECKSEQUENCEVERIFY:{if(!(e&O.flags.VERIFY_CHECKSEQUENCEVERIFY))break;if(!r)throw new b("UNKNOWN_ERROR","No TX passed in.");if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);const i=t.getNum(-1,I,5);if(i.isNeg())throw new b("NEGATIVE_LOCKTIME",E,v);const n=i.toDouble();if(!r.verifySequence(s,n))throw new b("UNSATISFIED_LOCKTIME",E,v);break}case y.OP_NOP1:case y.OP_NOP4:case y.OP_NOP5:case y.OP_NOP6:case y.OP_NOP7:case y.OP_NOP8:case y.OP_NOP9:case y.OP_NOP10:if(e&O.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new b("DISCOURAGE_UPGRADABLE_NOPS",E,v);break;case y.OP_IF:case y.OP_NOTIF:{let r=!1;if(!S){if(t.length<1)throw new b("UNBALANCED_CONDITIONAL",E,v);if(1===d&&e&O.flags.VERIFY_MINIMALIF){const e=t.get(-1);if(e.length>1)throw new b("MINIMALIF");if(1===e.length&&1!==e[0])throw new b("MINIMALIF")}r=t.getBool(-1),E.value===y.OP_NOTIF&&(r=!r),t.pop()}l.push(r),r||(S+=1);break}case y.OP_ELSE:if(0===l.length)throw new b("UNBALANCED_CONDITIONAL",E,v);l[l.length-1]=!l[l.length-1],l[l.length-1]?S-=1:S+=1;break;case y.OP_ENDIF:if(0===l.length)throw new b("UNBALANCED_CONDITIONAL",E,v);l.pop()||(S-=1);break;case y.OP_VERIFY:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);if(!t.getBool(-1))throw new b("VERIFY",E,v);t.pop();break;case y.OP_RETURN:throw new b("OP_RETURN",E,v);case y.OP_TOALTSTACK:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);m.push(t.pop());break;case y.OP_FROMALTSTACK:if(0===m.length)throw new b("INVALID_ALTSTACK_OPERATION",E,v);t.push(m.pop());break;case y.OP_2DROP:if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);t.pop(),t.pop();break;case y.OP_2DUP:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.get(-2),r=t.get(-1);t.push(e),t.push(r);break}case y.OP_3DUP:{if(t.length<3)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.get(-3),r=t.get(-2),i=t.get(-1);t.push(e),t.push(r),t.push(i);break}case y.OP_2OVER:{if(t.length<4)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.get(-4),r=t.get(-3);t.push(e),t.push(r);break}case y.OP_2ROT:{if(t.length<6)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.get(-6),r=t.get(-5);t.erase(-6,-4),t.push(e),t.push(r);break}case y.OP_2SWAP:if(t.length<4)throw new b("INVALID_STACK_OPERATION",E,v);t.swap(-4,-2),t.swap(-3,-1);break;case y.OP_IFDUP:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);if(t.getBool(-1)){const e=t.get(-1);t.push(e)}break;case y.OP_DEPTH:t.pushInt(t.length);break;case y.OP_DROP:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.pop();break;case y.OP_DUP:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.push(t.get(-1));break;case y.OP_NIP:if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);t.remove(-2);break;case y.OP_OVER:if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);t.push(t.get(-2));break;case y.OP_PICK:case y.OP_ROLL:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.getInt(-1,I,4);if(t.pop(),e<0||e>=t.length)throw new b("INVALID_STACK_OPERATION",E,v);const r=t.get(-e-1);E.value===y.OP_ROLL&&t.remove(-e-1),t.push(r);break}case y.OP_ROT:if(t.length<3)throw new b("INVALID_STACK_OPERATION",E,v);t.swap(-3,-2),t.swap(-2,-1);break;case y.OP_SWAP:if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);t.swap(-2,-1);break;case y.OP_TUCK:if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);t.insert(-2,t.get(-1));break;case y.OP_SIZE:if(t.length<1)throw new b("INVALID_STACK_OPERATION",E,v);t.pushInt(t.get(-1).length);break;case y.OP_EQUAL:case y.OP_EQUALVERIFY:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.get(-2),r=t.get(-1),i=e.equals(r);if(t.pop(),t.pop(),t.pushBool(i),E.value===y.OP_EQUALVERIFY){if(!i)throw new b("EQUALVERIFY",E,v);t.pop()}break}case y.OP_1ADD:case y.OP_1SUB:case y.OP_NEGATE:case y.OP_ABS:case y.OP_NOT:case y.OP_0NOTEQUAL:{if(t.length<1)throw new b("INVALID_STACK_OPERATION",E,v);let e,r=t.getNum(-1,I,4);switch(E.value){case y.OP_1ADD:r.iaddn(1);break;case y.OP_1SUB:r.isubn(1);break;case y.OP_NEGATE:r.ineg();break;case y.OP_ABS:r.iabs();break;case y.OP_NOT:e=r.isZero(),r=g.fromBool(e);break;case y.OP_0NOTEQUAL:e=!r.isZero(),r=g.fromBool(e);break;default:i(!1,"Fatal script error.")}t.pop(),t.pushNum(r);break}case y.OP_ADD:case y.OP_SUB:case y.OP_BOOLAND:case y.OP_BOOLOR:case y.OP_NUMEQUAL:case y.OP_NUMEQUALVERIFY:case y.OP_NUMNOTEQUAL:case y.OP_LESSTHAN:case y.OP_GREATERTHAN:case y.OP_LESSTHANOREQUAL:case y.OP_GREATERTHANOREQUAL:case y.OP_MIN:case y.OP_MAX:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.getNum(-2,I,4),r=t.getNum(-1,I,4);let s,n;switch(E.value){case y.OP_ADD:s=e.iadd(r);break;case y.OP_SUB:s=e.isub(r);break;case y.OP_BOOLAND:n=e.toBool()&&r.toBool(),s=g.fromBool(n);break;case y.OP_BOOLOR:n=e.toBool()||r.toBool(),s=g.fromBool(n);break;case y.OP_NUMEQUAL:case y.OP_NUMEQUALVERIFY:n=e.eq(r),s=g.fromBool(n);break;case y.OP_NUMNOTEQUAL:n=!e.eq(r),s=g.fromBool(n);break;case y.OP_LESSTHAN:n=e.lt(r),s=g.fromBool(n);break;case y.OP_GREATERTHAN:n=e.gt(r),s=g.fromBool(n);break;case y.OP_LESSTHANOREQUAL:n=e.lte(r),s=g.fromBool(n);break;case y.OP_GREATERTHANOREQUAL:n=e.gte(r),s=g.fromBool(n);break;case y.OP_MIN:s=g.min(e,r);break;case y.OP_MAX:s=g.max(e,r);break;default:i(!1,"Fatal script error.")}if(t.pop(),t.pop(),t.pushNum(s),E.value===y.OP_NUMEQUALVERIFY){if(!t.getBool(-1))throw new b("NUMEQUALVERIFY",E,v);t.pop()}break}case y.OP_WITHIN:{if(t.length<3)throw new b("INVALID_STACK_OPERATION",E,v);const e=t.getNum(-3,I,4),r=t.getNum(-2,I,4),i=t.getNum(-1,I,4),s=r.lte(e)&&e.lt(i);t.pop(),t.pop(),t.pop(),t.pushBool(s);break}case y.OP_RIPEMD160:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.push(n.digest(t.pop()));break;case y.OP_SHA1:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.push(o.digest(t.pop()));break;case y.OP_SHA256:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.push(h.digest(t.pop()));break;case y.OP_HASH160:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.push(f.digest(t.pop()));break;case y.OP_HASH256:if(0===t.length)throw new b("INVALID_STACK_OPERATION",E,v);t.push(u.digest(t.pop()));break;case y.OP_CODESEPARATOR:p=v+1;break;case y.OP_CHECKSIG:case y.OP_CHECKSIGVERIFY:{if(!r)throw new b("UNKNOWN_ERROR","No TX passed in.");if(t.length<2)throw new b("INVALID_STACK_OPERATION",E,v);const i=t.get(-2),n=t.get(-1),o=this.getSubscript(p);if(0===d&&o.findAndDelete(i)>0&&e&O.flags.VERIFY_CONST_SCRIPTCODE)throw new b("SIG_FINDANDDELETE",E,v);B(i,e),N(n,e,d);let h=!1;if(i.length>0){const t=i[i.length-1];h=A(r.signatureHash(s,o,a,t,d),i,n)}if(!h&&e&O.flags.VERIFY_NULLFAIL&&0!==i.length)throw new b("NULLFAIL",E,v);if(t.pop(),t.pop(),t.pushBool(h),E.value===y.OP_CHECKSIGVERIFY){if(!h)throw new b("CHECKSIGVERIFY",E,v);t.pop()}break}case y.OP_CHECKMULTISIG:case y.OP_CHECKMULTISIGVERIFY:{if(!r)throw new b("UNKNOWN_ERROR","No TX passed in.");let i=1;if(t.length<i)throw new b("INVALID_STACK_OPERATION",E,v);let n,o,h=t.getInt(-i,I,4),f=h+2;if(h<0||h>c.MAX_MULTISIG_PUBKEYS)throw new b("PUBKEY_COUNT",E,v);if(w+=h,w>c.MAX_SCRIPT_OPS)throw new b("OP_COUNT",E,v);if(i+=1,n=i,i+=h,t.length<i)throw new b("INVALID_STACK_OPERATION",E,v);let u=t.getInt(-i,I,4);if(u<0||u>h)throw new b("SIG_COUNT",E,v);if(i+=1,o=i,i+=u,t.length<i)throw new b("INVALID_STACK_OPERATION",E,v);const l=this.getSubscript(p);for(let r=0;r<u;r++){const i=t.get(-o-r);if(0===d&&l.findAndDelete(i)>0&&e&O.flags.VERIFY_CONST_SCRIPTCODE)throw new b("SIG_FINDANDDELETE",E,v)}let m=!0;for(;m&&u>0;){const i=t.get(-o),f=t.get(-n);if(B(i,e),N(f,e,d),i.length>0){const t=i[i.length-1];A(r.signatureHash(s,l,a,t,d),i,f)&&(o+=1,u-=1)}n+=1,h-=1,u>h&&(m=!1)}for(;i>1;){if(!m&&e&O.flags.VERIFY_NULLFAIL&&0===f&&0!==t.get(-1).length)throw new b("NULLFAIL",E,v);f>0&&(f-=1),t.pop(),i-=1}if(t.length<1)throw new b("INVALID_STACK_OPERATION",E,v);if(e&O.flags.VERIFY_NULLDUMMY&&0!==t.get(-1).length)throw new b("SIG_NULLDUMMY",E,v);if(t.pop(),t.pushBool(m),E.value===y.OP_CHECKMULTISIGVERIFY){if(!m)throw new b("CHECKMULTISIGVERIFY",E,v);t.pop()}break}default:throw new b("BAD_OPCODE",E,v)}if(t.length+m.length>c.MAX_SCRIPT_STACK)throw new b("STACK_SIZE",E,v)}else if(t.length+m.length>c.MAX_SCRIPT_STACK)throw new b("STACK_SIZE",E,v)}if(0!==l.length)throw new b("UNBALANCED_CONDITIONAL")}findAndDelete(t){const e=m.fromPush(t);if(this.raw.length<e.getSize())return 0;let r=!1;for(const t of this.code){if(-1===t.value)break;if(t.equals(e)){r=!0;break}}if(!r)return 0;const i=[];let s=0;for(const t of this.code){if(-1===t.value)break;t.equals(e)?s+=1:i.push(t)}return this.code=i,this.compile(),s}indexOf(t){for(let e=0;e<this.code.length;e++){const r=this.code[e];if(-1===r.value)break;if(r.data&&r.data.equals(t))return e}return-1}isCode(){for(const t of this.code){if(-1===t.value)return!1;if(t.isDisabled())return!1;switch(t.value){case y.OP_RESERVED:case y.OP_NOP:case y.OP_VER:case y.OP_VERIF:case y.OP_VERNOTIF:case y.OP_RESERVED1:case y.OP_RESERVED2:case y.OP_NOP1:return!1}if(t.value>y.OP_CHECKSEQUENCEVERIFY)return!1}return!0}fromPubkey(t){return i(Buffer.isBuffer(t)&&(33===t.length||65===t.length)),this.raw=Buffer.allocUnsafe(1+t.length+1),this.raw[0]=t.length,t.copy(this.raw,1),this.raw[1+t.length]=y.OP_CHECKSIG,t=this.raw.slice(1,1+t.length),this.code.length=0,this.code.push(m.fromPush(t)),this.code.push(m.fromOp(y.OP_CHECKSIG)),this}static fromPubkey(t){return(new this).fromPubkey(t)}fromPubkeyhash(t){return i(Buffer.isBuffer(t)&&20===t.length),this.raw=Buffer.allocUnsafe(25),this.raw[0]=y.OP_DUP,this.raw[1]=y.OP_HASH160,this.raw[2]=20,t.copy(this.raw,3),this.raw[23]=y.OP_EQUALVERIFY,this.raw[24]=y.OP_CHECKSIG,t=this.raw.slice(3,23),this.code.length=0,this.code.push(m.fromOp(y.OP_DUP)),this.code.push(m.fromOp(y.OP_HASH160)),this.code.push(m.fromPush(t)),this.code.push(m.fromOp(y.OP_EQUALVERIFY)),this.code.push(m.fromOp(y.OP_CHECKSIG)),this}static fromPubkeyhash(t){return(new this).fromPubkeyhash(t)}fromMultisig(t,e,r){i((255&t)===t&&(255&e)===e),i(Array.isArray(r)),i(r.length===e,"`n` keys are required for multisig."),i(t>=1&&t<=e),i(e>=1&&e<=15),this.clear(),this.pushSmall(t);for(const t of function(t){return t.slice().sort(((t,e)=>t.compare(e)))}(r))this.pushData(t);return this.pushSmall(e),this.pushOp(y.OP_CHECKMULTISIG),this.compile()}static fromMultisig(t,e,r){return(new this).fromMultisig(t,e,r)}fromScripthash(t){return i(Buffer.isBuffer(t)&&20===t.length),this.raw=Buffer.allocUnsafe(23),this.raw[0]=y.OP_HASH160,this.raw[1]=20,t.copy(this.raw,2),this.raw[22]=y.OP_EQUAL,t=this.raw.slice(2,22),this.code.length=0,this.code.push(m.fromOp(y.OP_HASH160)),this.code.push(m.fromPush(t)),this.code.push(m.fromOp(y.OP_EQUAL)),this}static fromScripthash(t){return(new this).fromScripthash(t)}fromNulldata(t){return i(Buffer.isBuffer(t)),i(t.length<=d.MAX_OP_RETURN,"Nulldata too large."),this.clear(),this.pushOp(y.OP_RETURN),this.pushData(t),this.compile()}static fromNulldata(t){return(new this).fromNulldata(t)}fromProgram(t,e){return i((255&t)===t&&t>=0&&t<=16),i(Buffer.isBuffer(e)&&e.length>=2&&e.length<=40),this.raw=Buffer.allocUnsafe(2+e.length),this.raw[0]=0===t?0:t+80,this.raw[1]=e.length,e.copy(this.raw,2),e=this.raw.slice(2,2+e.length),this.code.length=0,this.code.push(m.fromSmall(t)),this.code.push(m.fromPush(e)),this}static fromProgram(t,e){return(new this).fromProgram(t,e)}fromAddress(t){if("string"==typeof t&&(t=S.fromString(t)),i(t instanceof S,"Not an address."),t.isPubkeyhash())return this.fromPubkeyhash(t.hash);if(t.isScripthash())return this.fromScripthash(t.hash);if(t.isProgram())return this.fromProgram(t.version,t.hash);throw new Error("Unknown address type.")}static fromAddress(t){return(new this).fromAddress(t)}fromCommitment(t,e){const r=s.write(36);return r.writeU32BE(2854332909),r.writeHash(t),this.clear(),this.pushOp(y.OP_RETURN),this.pushData(r.render()),e&&this.pushData(e),this.compile()}static fromCommitment(t,e){return(new this).fromCommitment(t,e)}getRedeem(){let t=null;for(const e of this.code){if(-1===e.value)return null;if(e.value>y.OP_16)return null;t=e.data}return t?O.fromRaw(t):null}getType(){return this.isPubkey()?I.PUBKEY:this.isPubkeyhash()?I.PUBKEYHASH:this.isScripthash()?I.SCRIPTHASH:this.isWitnessPubkeyhash()?I.WITNESSPUBKEYHASH:this.isWitnessScripthash()?I.WITNESSSCRIPTHASH:this.isMultisig()?I.MULTISIG:this.isNulldata()?I.NULLDATA:I.NONSTANDARD}isUnknown(){return this.getType()===I.NONSTANDARD}isStandard(){const[t,e]=this.getMultisig();return-1!==t?!(e<1||e>3||t<1||t>e):this.isNulldata()?this.raw.length<=d.MAX_OP_RETURN_BYTES:this.getType()!==I.NONSTANDARD}getSize(){return this.raw.length}getVarSize(){return v.sizeVarBytes(this.raw)}getInputAddress(){return S.fromInputScript(this)}getAddress(){return S.fromScript(this)}hash160(t){let e=f.digest(this.toRaw());return"hex"===t&&(e=e.toString("hex")),e}sha256(t){let e=h.digest(this.toRaw());return"hex"===t&&(e=e.toString("hex")),e}isPubkey(t){if(t)return this.raw.length>=35&&(33===this.raw[0]||65===this.raw[0])&&this.raw[0]+2===this.raw.length&&this.raw[this.raw.length-1]===y.OP_CHECKSIG;if(2!==this.code.length)return!1;const e=this.getLength(0);return(33===e||65===e)&&this.getOp(1)===y.OP_CHECKSIG}getPubkey(t){return this.isPubkey(t)?t?this.raw.slice(1,1+this.raw[0]):this.getData(0):null}isPubkeyhash(t){return t||25===this.raw.length?25===this.raw.length&&this.raw[0]===y.OP_DUP&&this.raw[1]===y.OP_HASH160&&20===this.raw[2]&&this.raw[23]===y.OP_EQUALVERIFY&&this.raw[24]===y.OP_CHECKSIG:5===this.code.length&&this.getOp(0)===y.OP_DUP&&this.getOp(1)===y.OP_HASH160&&20===this.getLength(2)&&this.getOp(3)===y.OP_EQUALVERIFY&&this.getOp(4)===y.OP_CHECKSIG}getPubkeyhash(t){return this.isPubkeyhash(t)?t?this.raw.slice(3,23):this.getData(2):null}isMultisig(t){if(this.code.length<4||this.code.length>19)return!1;if(this.getOp(-1)!==y.OP_CHECKMULTISIG)return!1;const e=this.getSmall(0);if(e<1)return!1;const r=this.getSmall(-2);if(r<1||e>r)return!1;if(this.code.length!==r+3)return!1;for(let e=1;e<r+1;e++){const r=this.code[e],i=r.toLength();if(33!==i&&65!==i)return!1;if(t&&!r.isMinimal())return!1}return!0}getMultisig(t){return this.isMultisig(t)?[this.getSmall(0),this.getSmall(-2)]:[-1,-1]}isScripthash(){return 23===this.raw.length&&this.raw[0]===y.OP_HASH160&&20===this.raw[1]&&this.raw[22]===y.OP_EQUAL}getScripthash(){return this.isScripthash()?this.getData(1):null}isNulldata(t){if(0===this.code.length)return!1;if(this.getOp(0)!==y.OP_RETURN)return!1;if(1===this.code.length)return!0;if(t&&this.raw.length>d.MAX_OP_RETURN_BYTES)return!1;for(let e=1;e<this.code.length;e++){const r=this.code[e];if(-1===r.value)return!1;if(r.value>y.OP_16)return!1;if(t&&!r.isMinimal())return!1}return!0}getNulldata(t){if(!this.isNulldata(t))return null;for(let t=1;t<this.code.length;t++){const e=this.code[t].toPush();if(e)return e}return _}isCommitment(){return this.raw.length>=38&&this.raw[0]===y.OP_RETURN&&36===this.raw[1]&&2854332909===this.raw.readUInt32BE(2,!0)}getCommitment(){return this.isCommitment()?this.raw.slice(6,38):null}isProgram(){return!(this.raw.length<4||this.raw.length>42||this.raw[0]!==y.OP_0&&(this.raw[0]<y.OP_1||this.raw[0]>y.OP_16)||this.raw[1]+2!==this.raw.length)}getProgram(){if(!this.isProgram())return null;const t=this.getSmall(0),e=this.getData(1);return new l(t,e)}forWitness(){if(this.isProgram())return this.clone();const t=this.getPubkey();if(t){const e=f.digest(t);return O.fromProgram(0,e)}const e=this.getPubkeyhash();return e?O.fromProgram(0,e):O.fromProgram(0,this.sha256())}isWitnessPubkeyhash(){return 22===this.raw.length&&this.raw[0]===y.OP_0&&20===this.raw[1]}getWitnessPubkeyhash(){return this.isWitnessPubkeyhash()?this.getData(1):null}isWitnessScripthash(){return 34===this.raw.length&&this.raw[0]===y.OP_0&&32===this.raw[1]}getWitnessScripthash(){return this.isWitnessScripthash()?this.getData(1):null}isUnspendable(){return this.raw.length>c.MAX_SCRIPT_SIZE||this.raw.length>0&&this.raw[0]===y.OP_RETURN}getInputType(){return this.isPubkeyInput()?I.PUBKEY:this.isPubkeyhashInput()?I.PUBKEYHASH:this.isScripthashInput()?I.SCRIPTHASH:this.isMultisigInput()?I.MULTISIG:I.NONSTANDARD}isUnknownInput(){return this.getInputType()===I.NONSTANDARD}isPubkeyInput(){if(1!==this.code.length)return!1;const t=this.getLength(0);return t>=9&&t<=73}getPubkeyInput(){return this.isPubkeyInput()?this.getData(0):null}isPubkeyhashInput(){if(2!==this.code.length)return!1;const t=this.getLength(0),e=this.getLength(1);return t>=9&&t<=73&&(33===e||65===e)}getPubkeyhashInput(){return this.isPubkeyhashInput()?[this.getData(0),this.getData(1)]:[null,null]}isMultisigInput(){if(this.code.length<2)return!1;if(this.getOp(0)!==y.OP_0)return!1;if(this.getOp(1)>y.OP_PUSHDATA4)return!1;if(this.isScripthashInput())return!1;for(let t=1;t<this.code.length;t++){const e=this.getLength(t);if(e<9||e>73)return!1}return!0}getMultisigInput(){if(!this.isMultisigInput())return null;const t=[];for(let e=1;e<this.code.length;e++)t.push(this.getData(e));return t}isScripthashInput(){if(this.code.length<1)return!1;const t=this.getData(-1);if(!t)return!1;if(0===t.length)return!1;if(w.isSignatureEncoding(t))return!1;if(w.isKeyEncoding(t))return!1;const e=O.fromRaw(t);return!!e.isCode()&&!e.isUnspendable()&&!!this.isPushOnly()}getScripthashInput(){return this.isScripthashInput()?this.getData(-1):null}getCoinbaseHeight(){return O.getCoinbaseHeight(this.raw)}static getCoinbaseHeight(t){if(0===t.length)return-1;if(t[0]>=y.OP_1&&t[0]<=y.OP_16)return t[0]-80;if(t[0]>6)return-1;const e=m.fromRaw(t),r=e.toNum();return r?r.isNeg()?-1:e.equals(m.fromNum(r))?r.toDouble():-1:1}test(t){for(const e of this.code){if(-1===e.value)break;if(e.data&&0!==e.data.length&&t.test(e.data))return!0}return!1}isPushOnly(){for(const t of this.code){if(-1===t.value)return!1;if(t.value>y.OP_16)return!1}return!0}getSigops(t){let e=0,r=-1;for(const i of this.code){if(-1===i.value)break;switch(i.value){case y.OP_CHECKSIG:case y.OP_CHECKSIGVERIFY:e+=1;break;case y.OP_CHECKMULTISIG:case y.OP_CHECKMULTISIGVERIFY:t&&r>=y.OP_1&&r<=y.OP_16?e+=r-80:e+=c.MAX_MULTISIG_PUBKEYS}r=i.value}return e}getScripthashSigops(t){if(!this.isScripthash())return this.getSigops(!0);const e=t.getRedeem();return e?e.getSigops(!0):0}getWitnessSigops(t,e){let r=this.getProgram();if(!r&&this.isScripthash()){const e=t.getRedeem();e&&(r=e.getProgram())}if(!r)return 0;if(0===r.version){if(20===r.data.length)return 1;if(32===r.data.length&&e.items.length>0)return e.getRedeem().getSigops(!0)}return 0}get(t){return t<0&&(t+=this.code.length),t<0||t>=this.code.length?null:this.code[t]}pop(){return this.code.pop()||null}shift(){return this.code.shift()||null}remove(t){if(t<0&&(t+=this.code.length),t<0||t>=this.code.length)return null;const e=this.code.splice(t,1);return 0===e.length?null:e[0]}set(t,e){return t<0&&(t+=this.code.length),i(m.isOpcode(e)),i(t>=0&&t<=this.code.length),this.code[t]=e,this}push(t){return i(m.isOpcode(t)),this.code.push(t),this}unshift(t){return i(m.isOpcode(t)),this.code.unshift(t),this}insert(t,e){return t<0&&(t+=this.code.length),i(m.isOpcode(e)),i(t>=0&&t<=this.code.length),this.code.splice(t,0,e),this}getOp(t){const e=this.get(t);return e?e.value:-1}popOp(){const t=this.pop();return t?t.value:-1}shiftOp(){const t=this.shift();return t?t.value:-1}removeOp(t){const e=this.remove(t);return e?e.value:-1}setOp(t,e){return this.set(t,m.fromOp(e))}pushOp(t){return this.push(m.fromOp(t))}unshiftOp(t){return this.unshift(m.fromOp(t))}insertOp(t,e){return this.insert(t,m.fromOp(e))}getData(t){const e=this.get(t);return e?e.data:null}popData(){const t=this.pop();return t?t.data:null}shiftData(){const t=this.shift();return t?t.data:null}removeData(t){const e=this.remove(t);return e?e.data:null}setData(t,e){return this.set(t,m.fromData(e))}pushData(t){return this.push(m.fromData(t))}unshiftData(t){return this.unshift(m.fromData(t))}insertData(t,e){return this.insert(t,m.fromData(e))}getLength(t){const e=this.get(t);return e?e.toLength():-1}getPush(t){const e=this.get(t);return e?e.toPush():null}popPush(){const t=this.pop();return t?t.toPush():null}shiftPush(){const t=this.shift();return t?t.toPush():null}removePush(t){const e=this.remove(t);return e?e.toPush():null}setPush(t,e){return this.set(t,m.fromPush(e))}pushPush(t){return this.push(m.fromPush(t))}unshiftPush(t){return this.unshift(m.fromPush(t))}insertPush(t,e){return this.insert(t,m.fromPush(e))}getString(t,e){const r=this.get(t);return r?r.toString(e):null}popString(t){const e=this.pop();return e?e.toString(t):null}shiftString(t){const e=this.shift();return e?e.toString(t):null}removeString(t,e){const r=this.remove(t);return r?r.toString(e):null}setString(t,e,r){return this.set(t,m.fromString(e,r))}pushString(t,e){return this.push(m.fromString(t,e))}unshiftString(t,e){return this.unshift(m.fromString(t,e))}insertString(t,e,r){return this.insert(t,m.fromString(e,r))}getSmall(t){const e=this.get(t);return e?e.toSmall():-1}popSmall(){const t=this.pop();return t?t.toSmall():-1}shiftSmall(){const t=this.shift();return t?t.toSmall():-1}removeSmall(t){const e=this.remove(t);return e?e.toSmall():-1}setSmall(t,e){return this.set(t,m.fromSmall(e))}pushSmall(t){return this.push(m.fromSmall(t))}unshiftSmall(t){return this.unshift(m.fromSmall(t))}insertSmall(t,e){return this.insert(t,m.fromSmall(e))}getNum(t,e,r){const i=this.get(t);return i?i.toNum(e,r):null}popNum(t,e){const r=this.pop();return r?r.toNum(t,e):null}shiftNum(t,e){const r=this.shift();return r?r.toNum(t,e):null}removeNum(t,e,r){const i=this.remove(t);return i?i.toNum(e,r):null}setNum(t,e){return this.set(t,m.fromNum(e))}pushNum(t){return this.push(m.fromNum(t))}unshiftNum(t){return this.unshift(m.fromNum(t))}insertNum(t,e){return this.insert(t,m.fromNum(e))}getInt(t,e,r){const i=this.get(t);return i?i.toInt(e,r):-1}popInt(t,e){const r=this.pop();return r?r.toInt(t,e):-1}shiftInt(t,e){const r=this.shift();return r?r.toInt(t,e):-1}removeInt(t,e,r){const i=this.remove(t);return i?i.toInt(e,r):-1}setInt(t,e){return this.set(t,m.fromInt(e))}pushInt(t){return this.push(m.fromInt(t))}unshiftInt(t){return this.unshift(m.fromInt(t))}insertInt(t,e){return this.insert(t,m.fromInt(e))}getBool(t){const e=this.get(t);return!!e&&e.toBool()}popBool(){const t=this.pop();return!!t&&t.toBool()}shiftBool(){const t=this.shift();return!!t&&t.toBool()}removeBool(t){const e=this.remove(t);return!!e&&e.toBool()}setBool(t,e){return this.set(t,m.fromBool(e))}pushBool(t){return this.push(m.fromBool(t))}unshiftBool(t){return this.unshift(m.fromBool(t))}insertBool(t,e){return this.insert(t,m.fromBool(e))}getSym(t){const e=this.get(t);return e?e.toSymbol():null}popSym(){const t=this.pop();return t?t.toSymbol():null}shiftSym(){const t=this.shift();return t?t.toSymbol():null}removeSym(t){const e=this.remove(t);return e?e.toSymbol():null}setSym(t,e){return this.set(t,m.fromSymbol(e))}pushSym(t){return this.push(m.fromSymbol(t))}unshiftSym(t){return this.unshift(m.fromSymbol(t))}insertSym(t,e){return this.insert(t,m.fromSymbol(e))}fromString(t){if(i("string"==typeof t),0===(t=t.trim()).length)return this;const e=t.split(/\s+/),r=s.write();for(const t of e){let e=t;32&e.charCodeAt(0)&&(e=e.toUpperCase()),/^OP_/.test(e)||(e=`OP_${e}`);const s=y[e];if(null!=s)r.writeU8(s);else{if("'"===t[0]){i("'"===t[t.length-1],"Invalid string.");const e=t.slice(1,-1),s=m.fromString(e);r.writeBytes(s.toRaw());continue}if(/^-?\d+$/.test(t)){const e=g.fromString(t,10),i=m.fromNum(e);r.writeBytes(i.toRaw());continue}i(0===t.indexOf("0x"),"Unknown opcode.");const e=t.substring(2),s=Buffer.from(e,"hex");i(s.length===e.length/2,"Invalid hex string."),r.writeBytes(s)}}return this.fromRaw(r.render())}static fromString(t){return(new this).fromString(t)}static verify(t,e,r,s,n,o,h){if(null==h&&(h=O.flags.STANDARD_VERIFY_FLAGS),h&O.flags.VERIFY_SIGPUSHONLY&&!t.isPushOnly())throw new b("SIG_PUSHONLY");let f,u=new p;if(t.execute(u,h,s,n,o,0),h&O.flags.VERIFY_P2SH&&(f=u.clone()),r.execute(u,h,s,n,o,0),0===u.length||!u.getBool(-1))throw new b("EVAL_FALSE");let a=!1;if(h&O.flags.VERIFY_WITNESS&&r.isProgram()){if(a=!0,0!==t.raw.length)throw new b("WITNESS_MALLEATED");O.verifyProgram(e,r,h,s,n,o),u.length=1}if(h&O.flags.VERIFY_P2SH&&r.isScripthash()){if(!t.isPushOnly())throw new b("SIG_PUSHONLY");if(u=f,0===u.length)throw new b("EVAL_FALSE");const r=u.pop(),i=O.fromRaw(r);if(i.execute(u,h,s,n,o,0),0===u.length||!u.getBool(-1))throw new b("EVAL_FALSE");if(h&O.flags.VERIFY_WITNESS&&i.isProgram()){if(a=!0,!t.raw.equals(m.fromPush(r).toRaw()))throw new b("WITNESS_MALLEATED_P2SH");O.verifyProgram(e,i,h,s,n,o),u.length=1}}if(h&O.flags.VERIFY_CLEANSTACK&&(i(0!=(h&O.flags.VERIFY_P2SH)),1!==u.length))throw new b("CLEANSTACK");if(h&O.flags.VERIFY_WITNESS&&(i(0!=(h&O.flags.VERIFY_P2SH)),!a&&e.items.length>0))throw new b("WITNESS_UNEXPECTED")}static verifyProgram(t,e,r,s,n,o){const f=e.getProgram();i(f,"verifyProgram called on non-witness-program."),i(0!=(r&O.flags.VERIFY_WITNESS));const u=t.toStack();let a;if(0===f.version){if(32===f.data.length){if(0===u.length)throw new b("WITNESS_PROGRAM_WITNESS_EMPTY");const t=u.pop();if(!h.digest(t).equals(f.data))throw new b("WITNESS_PROGRAM_MISMATCH");a=O.fromRaw(t)}else{if(20!==f.data.length)throw new b("WITNESS_PROGRAM_WRONG_LENGTH");if(2!==u.length)throw new b("WITNESS_PROGRAM_MISMATCH");a=O.fromPubkeyhash(f.data)}for(let t=0;t<u.length;t++)if(u.get(t).length>c.MAX_SCRIPT_PUSH)throw new b("PUSH_SIZE");if(a.execute(u,r,s,n,o,1),1!==u.length)throw new b("CLEANSTACK");if(!u.getBool(-1))throw new b("EVAL_FALSE")}else if(r&O.flags.VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM)throw new b("DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM")}fromReader(t){return this.fromRaw(t.readVarBytes())}fromRaw(t){const e=s.read(t);for(this.raw=t;e.left();)this.code.push(m.fromReader(e));return this}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}static isScript(t){return t instanceof O}}function N(t,e,r){if(i(Buffer.isBuffer(t)),i("number"==typeof e),i("number"==typeof r),e&O.flags.VERIFY_STRICTENC&&!w.isKeyEncoding(t))throw new b("PUBKEYTYPE");if(1===r&&e&O.flags.VERIFY_WITNESS_PUBKEYTYPE&&!w.isCompressedEncoding(t))throw new b("WITNESS_PUBKEYTYPE");return!0}function B(t,e){if(i(Buffer.isBuffer(t)),i("number"==typeof e),0===t.length)return!0;if((e&O.flags.VERIFY_DERSIG||e&O.flags.VERIFY_LOW_S||e&O.flags.VERIFY_STRICTENC)&&!w.isSignatureEncoding(t))throw new b("SIG_DER");if(e&O.flags.VERIFY_LOW_S&&!w.isLowDER(t))throw new b("SIG_HIGH_S");if(e&O.flags.VERIFY_STRICTENC&&!w.isHashType(t))throw new b("SIG_HASHTYPE");return!0}function A(t,e,r){return a.verifyDER(t,e.slice(0,-1),r)}O.opcodes=w.opcodes,O.opcodesByVal=w.opcodesByVal,O.flags=w.flags,O.hashType=w.hashType,O.hashTypeByVal=w.hashTypeByVal,O.types=w.types,O.typesByVal=w.typesByVal,t.exports=O},8521:t=>{class e extends Error{constructor(t,r,i){super(),this.type="ScriptError",this.code=t,this.message=t,this.op=-1,this.ip=-1,"string"==typeof r?this.message=r:r&&(this.message=`${t} (op=${r.toSymbol()}, ip=${i})`,this.op=r.value,this.ip=i),Error.captureStackTrace&&Error.captureStackTrace(this,e)}}t.exports=e},4429:(t,e,r)=>{const i=r(1676),{I64:s}=r(865),n=r(8521),{inspectSymbol:o}=r(5666),h=Buffer.alloc(0);class f extends s{constructor(t,e){super(t,e)}getInt(){return this.lt(s.INT32_MIN)?s.LONG_MIN:this.gt(s.INT32_MAX)?s.LONG_MAX:this.toInt()}toRaw(){let t=this;if(t.isZero())return h;let e=!1;t.isNeg()&&(t=t.neg(),e=!0);const r=t.byteLength();let s=0;t.testn(8*r-1)&&(s=1);const n=Buffer.allocUnsafe(r+s);switch(r){case 8:n[7]=t.hi>>>24&255;case 7:n[6]=t.hi>>16&255;case 6:n[5]=t.hi>>8&255;case 5:n[4]=255&t.hi;case 4:n[3]=t.lo>>>24&255;case 3:n[2]=t.lo>>16&255;case 2:n[1]=t.lo>>8&255;case 1:n[0]=255&t.lo}return 128&n[r-1]?(i(1===s),i(n.length===r+s),n[r]=e?128:0):e?(i(0===s),i(n.length===r),n[r-1]|=128):(i(0===s),i(n.length===r)),n}fromRaw(t){if(i(Buffer.isBuffer(t)),0===t.length)return this;switch(t.length){case 8:this.hi|=t[7]<<24;case 7:this.hi|=t[6]<<16;case 6:this.hi|=t[5]<<8;case 5:this.hi|=t[4];case 4:this.lo|=t[3]<<24;case 3:this.lo|=t[2]<<16;case 2:this.lo|=t[1]<<8;case 1:this.lo|=t[0];break;default:for(let e=0;e<t.length;e++)this.orb(e,t[e])}return 128&t[t.length-1]&&(this.setn(8*t.length-1,0),this.ineg()),this}encode(){return this.toRaw()}decode(t,e,r){if(i(Buffer.isBuffer(t)),null!=r&&t.length>r)throw new n("UNKNOWN_ERROR","Script number overflow.");if(e&&!f.isMinimal(t))throw new n("UNKNOWN_ERROR","Non-minimal script number.");return this.fromRaw(t)}[o](){return`<ScriptNum: ${this.toString(10)}>`}static isMinimal(t){if(i(Buffer.isBuffer(t)),0===t.length)return!0;if(0==(127&t[t.length-1])){if(1===t.length)return!1;if(0==(128&t[t.length-2]))return!1}return!0}static decode(t,e,r){return(new this).decode(t,e,r)}static isScriptNum(t){return t instanceof f}}t.exports=f},9840:(t,e,r)=>{const i=r(1676),s=r(3029),n=r(4429),{inspectSymbol:o}=r(5666);class h{constructor(t){this.items=t||[]}get length(){return this.items.length}set length(t){this.items.length=t}[Symbol.iterator](){return this.items[Symbol.iterator]()}values(){return this.items.values()}entries(){return this.items.entries()}[o](){return`<Stack: ${this.toString()}>`}toString(){const t=[];for(const e of this.items)t.push(e.toString("hex"));return t.join(" ")}toASM(t){const e=[];for(const r of this.items)e.push(s.toASM(r,t));return e.join(" ")}clone(){return new this.constructor(this.items.slice())}clear(){return this.items.length=0,this}get(t){return t<0&&(t+=this.items.length),t<0||t>=this.items.length?null:this.items[t]}pop(){return this.items.pop()||null}shift(){return this.items.shift()||null}remove(t){if(t<0&&(t+=this.items.length),t<0||t>=this.items.length)return null;const e=this.items.splice(t,1);return 0===e.length?null:e[0]}set(t,e){return t<0&&(t+=this.items.length),i(Buffer.isBuffer(e)),i(t>=0&&t<=this.items.length),this.items[t]=e,this}push(t){return i(Buffer.isBuffer(t)),this.items.push(t),this}unshift(t){return i(Buffer.isBuffer(t)),this.items.unshift(t),this}insert(t,e){return t<0&&(t+=this.items.length),i(Buffer.isBuffer(e)),i(t>=0&&t<=this.items.length),this.items.splice(t,0,e),this}erase(t,e){t<0&&(t=this.items.length+t),e<0&&(e=this.items.length+e),this.items.splice(t,e-t)}swap(t,e){t<0&&(t=this.items.length+t),e<0&&(e=this.items.length+e);const r=this.items[t],i=this.items[e];this.items[t]=i,this.items[e]=r}getData(t){return this.get(t)}popData(){return this.pop()}shiftData(){return this.shift()}removeData(t){return this.remove(t)}setData(t,e){return this.set(t,e)}pushData(t){return this.push(t)}unshiftData(t){return this.unshift(t)}insertData(t,e){return this.insert(t,e)}getLength(t){const e=this.get(t);return e?e.length:-1}getString(t,e){const r=this.get(t);return r?h.toString(r,e):null}popString(t){const e=this.pop();return e?h.toString(e,t):null}shiftString(t){const e=this.shift();return e?h.toString(e,t):null}removeString(t,e){const r=this.remove(t);return r?h.toString(r,e):null}setString(t,e,r){return this.set(t,h.fromString(e,r))}pushString(t,e){return this.push(h.fromString(t,e))}unshiftString(t,e){return this.unshift(h.fromString(t,e))}insertString(t,e,r){return this.insert(t,h.fromString(e,r))}getNum(t,e,r){const i=this.get(t);return i?h.toNum(i,e,r):null}popNum(t,e){const r=this.pop();return r?h.toNum(r,t,e):null}shiftNum(t,e){const r=this.shift();return r?h.toNum(r,t,e):null}removeNum(t,e,r){const i=this.remove(t);return i?h.toNum(i,e,r):null}setNum(t,e){return this.set(t,h.fromNum(e))}pushNum(t){return this.push(h.fromNum(t))}unshiftNum(t){return this.unshift(h.fromNum(t))}insertNum(t,e){return this.insert(t,h.fromNum(e))}getInt(t,e,r){const i=this.get(t);return i?h.toInt(i,e,r):-1}popInt(t,e){const r=this.pop();return r?h.toInt(r,t,e):-1}shiftInt(t,e){const r=this.shift();return r?h.toInt(r,t,e):-1}removeInt(t,e,r){const i=this.remove(t);return i?h.toInt(i,e,r):-1}setInt(t,e){return this.set(t,h.fromInt(e))}pushInt(t){return this.push(h.fromInt(t))}unshiftInt(t){return this.unshift(h.fromInt(t))}insertInt(t,e){return this.insert(t,h.fromInt(e))}getBool(t){const e=this.get(t);return!!e&&h.toBool(e)}popBool(){const t=this.pop();return!!t&&h.toBool(t)}shiftBool(){const t=this.shift();return!!t&&h.toBool(t)}removeBool(t){const e=this.remove(t);return!!e&&h.toBool(e)}setBool(t,e){return this.set(t,h.fromBool(e))}pushBool(t){return this.push(h.fromBool(t))}unshiftBool(t){return this.unshift(h.fromBool(t))}insertBool(t,e){return this.insert(t,h.fromBool(e))}static isStack(t){return t instanceof h}static toString(t,e){return i(Buffer.isBuffer(t)),t.toString(e||"utf8")}static fromString(t,e){return i("string"==typeof t),Buffer.from(t,e||"utf8")}static toNum(t,e,r){return n.decode(t,e,r)}static fromNum(t){return i(n.isScriptNum(t)),t.encode()}static toInt(t,e,r){return h.toNum(t,e,r).getInt()}static fromInt(t){if(i("number"==typeof t),t>=-1&&t<=16)return s.small[t+1];const e=n.fromNumber(t);return h.fromNum(e)}static toBool(t){i(Buffer.isBuffer(t));for(let e=0;e<t.length;e++)if(0!==t[e])return e!==t.length-1||128!==t[e];return!1}static fromBool(t){return i("boolean"==typeof t),h.fromInt(t?1:0)}}t.exports=h},8628:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(4240),o=r(3029),h=r(7911),f=r(9840),{encoding:u}=s,a=o.types,{inspectSymbol:c}=r(5666);class d extends f{constructor(t){super(),t&&this.fromOptions(t)}fromOptions(t){return i(t,"Witness data is required."),Array.isArray(t)?this.fromArray(t):t.items?this.fromArray(t.items):this}static fromOptions(t){return(new this).fromOptions(t)}toArray(){return this.items.slice()}fromArray(t){return i(Array.isArray(t)),this.items=t,this}static fromArray(t){return(new this).fromArray(t)}toItems(){return this.items.slice()}fromItems(t){return i(Array.isArray(t)),this.items=t,this}static fromItems(t){return(new this).fromItems(t)}toStack(){return new f(this.toArray())}fromStack(t){return this.fromArray(t.items)}static fromStack(t){return(new this).fromStack(t)}[c](){return`<Witness: ${this.toString()}>`}clone(){return(new this.constructor).inject(this)}inject(t){return this.items=t.items.slice(),this}compile(){return this}getInputType(){return this.isPubkeyhashInput()?a.WITNESSPUBKEYHASH:this.isScripthashInput()?a.WITNESSSCRIPTHASH:a.NONSTANDARD}getInputAddress(){return h.fromWitness(this)}isPubkeyInput(){return!1}getPubkeyInput(){return null}isPubkeyhashInput(){return 2===this.items.length&&o.isSignatureEncoding(this.items[0])&&o.isKeyEncoding(this.items[1])}getPubkeyhashInput(){return this.isPubkeyhashInput()?[this.items[0],this.items[1]]:[null,null]}isMultisigInput(){return!1}getMultisigInput(){return null}isScripthashInput(){return this.items.length>0&&!this.isPubkeyhashInput()}getScripthashInput(){return this.isScripthashInput()?this.items[this.items.length-1]:null}isUnknownInput(){return this.getInputType()===a.NONSTANDARD}test(t){for(const e of this.items)if(0!==e.length&&t.test(e))return!0;return!1}getRedeem(){if(0===this.items.length)return null;const t=this.items[this.items.length-1];return t?n.fromRaw(t):null}indexOf(t){for(let e=0;e<this.items.length;e++)if(this.items[e].equals(t))return e;return-1}getSize(){let t=0;for(const e of this.items)t+=u.sizeVarBytes(e);return t}getVarSize(){return u.sizeVarint(this.items.length)+this.getSize()}toWriter(t){t.writeVarint(this.items.length);for(const e of this.items)t.writeVarBytes(e);return t}toRaw(){const t=this.getVarSize();return this.toWriter(s.write(t)).render()}toJSON(){return this.toRaw().toString("hex")}fromJSON(t){return i("string"==typeof t,"Witness must be a string."),this.fromRaw(Buffer.from(t,"hex"))}static fromJSON(t){return(new this).fromJSON(t)}fromReader(t){const e=t.readVarint();for(let r=0;r<e;r++)this.items.push(t.readVarBytes());return this}fromRaw(t){return this.fromReader(s.read(t))}static fromReader(t){return(new this).fromReader(t)}static fromRaw(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new this).fromRaw(t)}fromString(t){if(!Array.isArray(t)){if(i("string"==typeof t),0===(t=t.trim()).length)return this;t=t.split(/\s+/)}for(const e of t)this.items.push(Buffer.from(e,"hex"));return this}static fromString(t){return(new this).fromString(t)}static isWitness(t){return t instanceof d}}t.exports=d},1456:(t,e)=>{e.search=function(t,e,r,i){let s=0,n=t.length-1;for(;s<=n;){const i=s+n>>>1,o=r(t[i],e);if(0===o)return i;o<0?s=i+1:n=i-1}return i?s:-1},e.insert=function(t,r,i,s){const n=e.search(t,r,i,!0);return s&&n<t.length&&0===i(t[n],r)?-1:(0===n?t.unshift(r):n===t.length?t.push(r):t.splice(n,0,r),n)},e.remove=function(t,r,i){const s=e.search(t,r,i,!1);return-1!==s&&(function(t,e){if(0===e)return void t.shift();let r=e+1;for(;r<t.length;)t[e++]=t[r++];t.pop()}(t,s),!0)}},7766:(t,e,r)=>{const i=r(1676);function s(t){switch(t){case 0:return 1;case 1:return 10;case 2:return 100;case 3:return 1e3;case 4:return 1e4;case 5:return 1e5;case 6:return 1e6;case 7:return 1e7;case 8:return 1e8}throw new Error("Exponent is too large.")}e.encode=function(t,e){i(Number.isSafeInteger(t),"Invalid integer value.");let r="";t<0&&(t=-t,r="-");const n=s(e);let o=t%n,h=(t-o)/n;for(o=o.toString(10),h=h.toString(10);o.length<e;)o="0"+o;return o=o.replace(/0+$/,""),i(o.length<=e,"Invalid integer value."),0===o.length&&(o="0"),0===e?`${r}${h}`:`${r}${h}.${o}`},e.decode=function(t,e){i("string"==typeof t),i(t.length<=32,"Fixed number string too large.");let r=1;t.length>0&&"-"===t[0]&&(t=t.substring(1),r=-1);let n=t,o="0";const h=t.indexOf(".");for(-1!==h&&(n=t.substring(0,h),o=t.substring(h+1)),n=n.replace(/^0+/,""),o=o.replace(/0+$/,""),i(n.length<=16-e,"Fixed number string exceeds 2^53-1."),i(o.length<=e,"Too many decimal places in fixed number string."),0===n.length&&(n="0");o.length<e;)o+="0";0===o.length&&(o="0"),i(/^\d+$/.test(n)&&/^\d+$/.test(o),"Non-numeric characters in fixed number string."),n=parseInt(n,10),o=parseInt(o,10);const f=s(e),u=function(t){switch(t){case 1:return 0;case 10:return 1;case 100:return 91;case 1e3:case 1e4:return 991;case 1e5:return 40991;case 1e6:return 740991;case 1e7:return 4740991;case 1e8:return 54740991}throw new Error("Exponent is too large.")}(f),a=function(t){switch(t){case 1:return 9007199254740991;case 10:return 900719925474099;case 100:return 90071992547409;case 1e3:return 9007199254740;case 1e4:return 900719925474;case 1e5:return 90071992547;case 1e6:return 9007199254;case 1e7:return 900719925;case 1e8:return 90071992}throw new Error("Exponent is too large.")}(f);return i(n<a||n===a&&o<=u,"Fixed number string exceeds 2^53-1."),r*(n*f+o)},e.toFloat=function(t,r){return parseFloat(e.encode(t,r))},e.fromFloat=function(t,r){return i("number"==typeof t&&isFinite(t)),i(Number.isSafeInteger(r)),e.decode(t.toFixed(r),r)}},5666:(t,e,r)=>{e.binary=r(1456),e.fixed=r(7766),e.util=r(1972),e.message=r(7489);const{inspect:{custom:i}}=r(1669);e.inspectSymbol=i||"inspect"},7489:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(2355),o=r(2581),h=e;h.MAGIC_STRING="Bitcoin Signed Message:\n",h.magicHash=(t,e=h.MAGIC_STRING)=>{i("string"==typeof e,"prefix must be a string."),i("string"==typeof t,"message must be a string");const r=s.write();return r.writeVarString(e),r.writeVarString(t,"utf8"),n.digest(r.render())},h.sign=(t,e,r)=>{i(e.getPrivateKey(),"Cannot sign without private key.");const n=h.magicHash(t,r),f=4!==e.getPublicKey().readInt8(0),[u,a]=o.signRecoverable(n,e.getPrivateKey()),c=s.write();return c.writeI8(a+27+(f?4:0)),c.writeBytes(u),c.render()},h.recover=(t,e,r)=>{i("string"==typeof t,"msg must be a string"),i(Buffer.isBuffer(e),"sig must be a buffer");const s=h.magicHash(t,r);i.strictEqual(e.length,65,"Invalid signature length");const n=e.readUInt8(0)-27;i(n<8,"Invalid signature parameter");const f=Boolean(4&n),u=3&n;return o.recover(s,e.slice(1),u,f)}},1972:(t,e,r)=>{const i=r(1676),s=e;s.bench=function(t){if(!process.hrtime){const e=Date.now();if(t){const[r,i]=t;return e-(1e3*r+i/1e6)}const r=e%1e3;return[(e-r)/1e3,1e6*r]}if(t){const[e,r]=process.hrtime(t);return 1e3*e+r/1e6}return process.hrtime()},s.now=function(){return Math.floor(Date.now()/1e3)},s.ms=function(){return Date.now()},s.date=function(t){return null==t&&(t=s.now()),new Date(1e3*t).toISOString().slice(0,-5)+"Z"},s.time=function(t){return null==t?s.now():new Date(t)/1e3|0},s.revHex=function(t){return i(Buffer.isBuffer(t)),Buffer.from(t).reverse().toString("hex")},s.fromRev=function(t){return i("string"==typeof t),i(0==(1&t.length)),Buffer.from(t,"hex").reverse()}},2676:(t,e,r)=>{const i=r(8889);t.exports=class{constructor(){}packet(t){const e=10+t.getSize(),r=i.write(e);r.writeU32(t.id),r.writeU8(t.cmd),r.seek(4),t.toWriter(r),r.writeU8(10);const s=r.render();return s.writeUInt32LE(s.length-10,5,!0),s}}},888:(t,e,r)=>{const i=r(2581),{derive:s}=r(8361),n=r(4951),o=r(5389),h=e;h.execute=function(t){try{return h.handle(t)}catch(t){return new o.ErrorResultPacket(t)}},h.handle=function(t){switch(t.cmd){case o.types.CHECK:return h.check(t.tx,t.view,t.flags);case o.types.CHECKINPUT:return h.checkInput(t.tx,t.index,t.coin,t.flags);case o.types.SIGN:return h.sign(t.tx,t.rings,t.type);case o.types.SIGNINPUT:return h.signInput(t.tx,t.index,t.coin,t.ring,t.type);case o.types.ECVERIFY:return h.ecVerify(t.msg,t.sig,t.key);case o.types.ECSIGN:return h.ecSign(t.msg,t.key);case o.types.MINE:return h.mine(t.data,t.target,t.min,t.max);case o.types.SCRYPT:return h.scrypt(t.passwd,t.salt,t.N,t.r,t.p,t.len);default:throw new Error(`Unknown command: "${t.cmd}".`)}},h.check=function(t,e,r){try{t.check(e,r)}catch(t){if("ScriptError"===t.type)return new o.CheckResultPacket(t);throw t}return new o.CheckResultPacket},h.checkInput=function(t,e,r,i){try{t.checkInput(e,r,i)}catch(t){if("ScriptError"===t.type)return new o.CheckInputResultPacket(t);throw t}return new o.CheckInputResultPacket},h.sign=function(t,e,r){const i=t.sign(e,r);return o.SignResultPacket.fromTX(t,i)},h.signInput=function(t,e,r,i,s){const n=t.signInput(t,e,r,i,s);return o.SignInputResultPacket.fromTX(t,e,n)},h.ecVerify=function(t,e,r){const s=i.verifyDER(t,e,r);return new o.ECVerifyResultPacket(s)},h.ecSign=function(t,e){const r=i.signDER(t,e);return new o.ECSignResultPacket(r)},h.mine=function(t,e,r,i){const s=n(t,e,r,i);return new o.MineResultPacket(s)},h.scrypt=function(t,e,r,i,n,h){const f=s(t,e,r,i,n,h);return new o.ScryptResultPacket(f)}},1362:(t,e,r)=>{const i=r(1676),s=r(8614),{format:n}=r(1669),o=r(6853),h=r(888),f=r(5625),u=r(2676),a=r(5389),c=r(1602);t.exports=class extends s{constructor(){super(),this.parent=new c,this.framer=new u,this.parser=new f,this.listening=!1,this.color=!1,this.init()}init(){this.parent.on("data",(t=>{this.parser.feed(t)})),this.parent.on("error",(t=>{this.emit("error",t)})),this.parent.on("exception",(t=>{this.send(new a.ErrorPacket(t)),setTimeout((()=>this.destroy()),1e3)})),this.parser.on("error",(t=>{this.emit("error",t)})),this.parser.on("packet",(t=>{this.emit("packet",t)}))}setEnv(t){this.color="1"===t.BCOIN_WORKER_ISTTY,this.set(t.BCOIN_WORKER_NETWORK)}set(t){return o.set(t)}write(t){return this.parent.write(t)}send(t){return this.write(this.framer.packet(t))}sendEvent(...t){return this.send(new a.EventPacket(t))}destroy(){return this.parent.destroy()}log(){const t=n.apply(null,arguments);this.send(new a.LogPacket(t))}listen(){i(!this.listening,"Already listening."),this.listening=!0,this.on("error",(t=>{this.send(new a.ErrorPacket(t))})),this.on("packet",(t=>{try{this.handlePacket(t)}catch(t){this.emit("error",t)}}))}handlePacket(t){let e;switch(t.cmd){case a.types.ENV:this.setEnv(t.env);break;case a.types.EVENT:this.emit("event",t.items),this.emit(...t.items);break;case a.types.ERROR:this.emit("error",t.error);break;default:e=h.execute(t),e.id=t.id,this.send(e)}}}},5389:(t,e,r)=>{const i=r(1676),s=r(8889),n=r(4240),o=r(8628),h=r(6521),f=r(6377),u=r(101),a=r(1101),c=r(4377),d=r(8521),{encoding:l}=s,m={ENV:0,EVENT:1,LOG:2,ERROR:3,ERRORRESULT:4,CHECK:5,CHECKRESULT:6,SIGN:7,SIGNRESULT:8,CHECKINPUT:9,CHECKINPUTRESULT:10,SIGNINPUT:11,SIGNINPUTRESULT:12,ECVERIFY:13,ECVERIFYRESULT:14,ECSIGN:15,ECSIGNRESULT:16,MINE:17,MINERESULT:18,SCRYPT:19,SCRYPTRESULT:20};class p{constructor(){this.id=++p.id>>>0,this.cmd=-1}getSize(){throw new Error("Abstract method.")}toWriter(){throw new Error("Abstract method.")}fromRaw(){throw new Error("Abstract method.")}static fromRaw(){throw new Error("Abstract method.")}}p.id=0;class b extends p{constructor(t){super(),this.cmd=m.ENV,this.env=t||{},this.json=JSON.stringify(this.env)}getSize(){return l.sizeVarString(this.json,"utf8")}toWriter(t){return t.writeVarString(this.json,"utf8"),t}fromRaw(t){const e=s.read(t,!0);return this.json=e.readVarString("utf8"),this.env=JSON.parse(this.json),this}static fromRaw(t){return(new b).fromRaw(t)}}class g extends p{constructor(t){super(),this.cmd=m.EVENT,this.items=t||[],this.json=JSON.stringify(this.items)}getSize(){return l.sizeVarString(this.json,"utf8")}toWriter(t){return t.writeVarString(this.json,"utf8"),t}fromRaw(t){const e=s.read(t,!0);return this.json=e.readVarString("utf8"),this.items=JSON.parse(this.json),this}static fromRaw(t){return(new g).fromRaw(t)}}class w extends p{constructor(t){super(),this.cmd=m.LOG,this.text=t||""}getSize(){return l.sizeVarString(this.text,"utf8")}toWriter(t){return t.writeVarString(this.text,"utf8"),t}fromRaw(t){const e=s.read(t,!0);return this.text=e.readVarString("utf8"),this}static fromRaw(t){return(new w).fromRaw(t)}}class S extends p{constructor(t){super(),this.cmd=m.ERROR,this.error=t||new Error}getSize(){const t=this.error;let e=0;switch(e+=l.sizeVarString(C(t.message),"utf8"),e+=l.sizeVarString(C(t.stack),"utf8"),e+=l.sizeVarString(C(t.type),"utf8"),typeof t.code){case"number":e+=1,e+=4;break;case"string":e+=1,e+=l.sizeVarString(t.code,"utf8");break;default:e+=1}return e}toWriter(t){const e=this.error;switch(t.writeVarString(C(e.message),"utf8"),t.writeVarString(C(e.stack),"utf8"),t.writeVarString(C(e.type),"utf8"),typeof e.code){case"number":t.writeU8(2),t.writeI32(e.code);break;case"string":t.writeU8(1),t.writeVarString(e.code,"utf8");break;default:t.writeU8(0)}return t}fromRaw(t){const e=s.read(t,!0),r=this.error;switch(r.message=e.readVarString("utf8"),r.stack=e.readVarString("utf8"),r.type=e.readVarString("utf8"),e.readU8()){case 2:r.code=e.readI32();break;case 1:r.code=e.readVarString("utf8");break;default:r.code=null}return this}static fromRaw(t){return(new S).fromRaw(t)}}class y extends S{constructor(t){super(t),this.cmd=m.ERRORRESULT}static fromRaw(t){return(new y).fromRaw(t)}}class I extends p{constructor(t,e,r){super(),this.cmd=m.CHECK,this.tx=t||null,this.view=e||null,this.flags=null!=r?r:null}getSize(){return this.tx.getSize()+this.view.getSize(this.tx)+4}toWriter(t){return this.tx.toWriter(t),this.view.toWriter(t,this.tx),t.writeI32(null!=this.flags?this.flags:-1),t}fromRaw(t){const e=s.read(t,!0);return this.tx=u.fromReader(e),this.view=c.fromReader(e,this.tx),this.flags=e.readI32(),-1===this.flags&&(this.flags=null),this}static fromRaw(t){return(new I).fromRaw(t)}}class v extends p{constructor(t){super(),this.cmd=m.CHECKRESULT,this.error=t||null}getSize(){const t=this.error;let e=0;return t?(e+=1,e+=l.sizeVarString(C(t.message),"utf8"),e+=l.sizeVarString(C(t.stack),"utf8"),e+=l.sizeVarString(C(t.code),"utf8"),e+=1,e+=4,e):(e+=1,e)}toWriter(t){const e=this.error;return e?(t.writeU8(1),t.writeVarString(C(e.message),"utf8"),t.writeVarString(C(e.stack),"utf8"),t.writeVarString(C(e.code),"utf8"),t.writeU8(-1===e.op?255:e.op),t.writeU32(-1===e.ip?4294967295:e.ip),t):(t.writeU8(0),t)}fromRaw(t){const e=s.read(t,!0);if(0===e.readU8())return this;const r=new d("");return r.message=e.readVarString("utf8"),r.stack=e.readVarString("utf8"),r.code=e.readVarString("utf8"),r.op=e.readU8(),r.ip=e.readU32(),255===r.op&&(r.op=-1),4294967295===r.ip&&(r.ip=-1),this.error=r,this}static fromRaw(t){return(new v).fromRaw(t)}}class E extends p{constructor(t,e,r){super(),this.cmd=m.SIGN,this.tx=t||null,this.rings=e||[],this.type=null!=r?r:1}getSize(){let t=0;t+=this.tx.getSize(),t+=this.tx.view.getSize(this.tx),t+=l.sizeVarint(this.rings.length);for(const e of this.rings)t+=e.getSize();return t+=1,t}toWriter(t){this.tx.toWriter(t),this.tx.view.toWriter(t,this.tx),t.writeVarint(this.rings.length);for(const e of this.rings)e.toWriter(t);return t.writeU8(this.type),t}fromRaw(t){const e=s.read(t,!0);this.tx=f.fromReader(e),this.tx.view.fromReader(e,this.tx);const r=e.readVarint();for(let t=0;t<r;t++){const t=a.fromReader(e);this.rings.push(t)}return this.type=e.readU8(),this}static fromRaw(t){return(new E).fromRaw(t)}}class _ extends p{constructor(t,e,r){super(),this.cmd=m.SIGNRESULT,this.total=t||0,this.script=r||[],this.witness=e||[]}fromTX(t,e){this.total=e;for(const e of t.inputs)this.script.push(e.script),this.witness.push(e.witness);return this}static fromTX(t,e){return(new _).fromTX(t,e)}getSize(){let t=0;t+=l.sizeVarint(this.total),t+=l.sizeVarint(this.script.length);for(let e=0;e<this.script.length;e++){const r=this.script[e],i=this.witness[e];t+=r.getVarSize(),t+=i.getVarSize()}return t}toWriter(t){i(this.script.length===this.witness.length),t.writeVarint(this.total),t.writeVarint(this.script.length);for(let e=0;e<this.script.length;e++)this.script[e].toWriter(t),this.witness[e].toWriter(t);return t}inject(t){i(this.script.length===t.inputs.length),i(this.witness.length===t.inputs.length);for(let e=0;e<t.inputs.length;e++){const r=t.inputs[e];r.script=this.script[e],r.witness=this.witness[e]}}fromRaw(t){const e=s.read(t,!0);this.total=e.readVarint();const r=e.readVarint();for(let t=0;t<r;t++)this.script.push(n.fromReader(e)),this.witness.push(o.fromReader(e));return this}static fromRaw(t){return(new _).fromRaw(t)}}class O extends p{constructor(t,e,r,i){super(),this.cmd=m.CHECKINPUT,this.tx=t||null,this.index=e,this.coin=r||null,this.flags=null!=i?i:null}getSize(){let t=0;return t+=this.tx.getSize(),t+=l.sizeVarint(this.index),t+=l.sizeVarint(this.coin.value),t+=this.coin.script.getVarSize(),t+=4,t}toWriter(t){return this.tx.toWriter(t),t.writeVarint(this.index),t.writeVarint(this.coin.value),this.coin.script.toWriter(t),t.writeI32(null!=this.flags?this.flags:-1),t}fromRaw(t){const e=s.read(t,!0);return this.tx=u.fromReader(e),this.index=e.readVarint(),this.coin=new h,this.coin.value=e.readVarint(),this.coin.script.fromReader(e),this.flags=e.readI32(),-1===this.flags&&(this.flags=null),this}static fromRaw(t){return(new O).fromRaw(t)}}class N extends v{constructor(t){super(t),this.cmd=m.CHECKINPUTRESULT}static fromRaw(t){return(new N).fromRaw(t)}}class B extends p{constructor(t,e,r,i,s){super(),this.cmd=m.SIGNINPUT,this.tx=t||null,this.index=e,this.coin=r||null,this.ring=i||null,this.type=null!=s?s:1}getSize(){let t=0;return t+=this.tx.getSize(),t+=l.sizeVarint(this.index),t+=l.sizeVarint(this.coin.value),t+=this.coin.script.getVarSize(),t+=this.ring.getSize(),t+=1,t}toWriter(t){return this.tx.toWriter(t),t.writeVarint(this.index),t.writeVarint(this.coin.value),this.coin.script.toWriter(t),this.ring.toWriter(t),t.writeU8(this.type),t}fromRaw(t){const e=s.read(t,!0);return this.tx=f.fromReader(e),this.index=e.readVarint(),this.coin=new h,this.coin.value=e.readVarint(),this.coin.script.fromReader(e),this.ring=a.fromReader(e),this.type=e.readU8(),this}static fromRaw(t){return(new B).fromRaw(t)}}class A extends p{constructor(t,e,r){super(),this.cmd=m.SIGNINPUTRESULT,this.value=t||!1,this.script=r||null,this.witness=e||null}fromTX(t,e,r){const s=t.inputs[e];return i(s),this.value=r,this.script=s.script,this.witness=s.witness,this}static fromTX(t,e,r){return(new A).fromTX(t,e,r)}getSize(){return 1+this.script.getVarSize()+this.witness.getVarSize()}toWriter(t){return t.writeU8(this.value?1:0),this.script.toWriter(t),this.witness.toWriter(t),t}inject(t,e){const r=t.inputs[e];i(r),r.script=this.script,r.witness=this.witness}fromRaw(t){const e=s.read(t,!0);return this.value=1===e.readU8(),this.script=n.fromReader(e),this.witness=o.fromReader(e),this}static fromRaw(t){return(new A).fromRaw(t)}}class M extends p{constructor(t,e,r){super(),this.cmd=m.ECVERIFY,this.msg=t||null,this.sig=e||null,this.key=r||null}getSize(){let t=0;return t+=l.sizeVarBytes(this.msg),t+=l.sizeVarBytes(this.sig),t+=l.sizeVarBytes(this.key),t}toWriter(t){return t.writeVarBytes(this.msg),t.writeVarBytes(this.sig),t.writeVarBytes(this.key),t}fromRaw(t){const e=s.read(t,!0);return this.msg=e.readVarBytes(),this.sig=e.readVarBytes(),this.key=e.readVarBytes(),this}static fromRaw(t){return(new M).fromRaw(t)}}class P extends p{constructor(t){super(),this.cmd=m.ECVERIFYRESULT,this.value=t}getSize(){return 1}toWriter(t){return t.writeU8(this.value?1:0),t}fromRaw(t){const e=s.read(t,!0);return this.value=1===e.readU8(),this}static fromRaw(t){return(new P).fromRaw(t)}}class R extends p{constructor(t,e){super(),this.cmd=m.ECSIGN,this.msg=t||null,this.key=e||null}getSize(){let t=0;return t+=l.sizeVarBytes(this.msg),t+=l.sizeVarBytes(this.key),t}toWriter(t){return t.writeVarBytes(this.msg),t.writeVarBytes(this.key),t}fromRaw(t){const e=s.read(t,!0);return this.msg=e.readVarBytes(),this.key=e.readVarBytes(),this}static fromRaw(t){return(new R).fromRaw(t)}}class x extends p{constructor(t){super(),this.cmd=m.ECSIGNRESULT,this.sig=t}getSize(){return l.sizeVarBytes(this.sig)}toWriter(t){return t.writeVarBytes(this.sig),t}fromRaw(t){const e=s.read(t,!0);return this.sig=e.readVarBytes(),this}static fromRaw(t){return(new x).fromRaw(t)}}class k extends p{constructor(t,e,r,i){super(),this.cmd=m.MINE,this.data=t||null,this.target=e||null,this.min=null!=r?r:-1,this.max=null!=i?i:-1}getSize(){return 120}toWriter(t){return t.writeBytes(this.data),t.writeBytes(this.target),t.writeU32(this.min),t.writeU32(this.max),t}fromRaw(t){const e=s.read(t,!0);return this.data=e.readBytes(80),this.target=e.readBytes(32),this.min=e.readU32(),this.max=e.readU32(),this}static fromRaw(t){return(new k).fromRaw(t)}}class T extends p{constructor(t){super(),this.cmd=m.MINERESULT,this.nonce=null!=t?t:-1}getSize(){return 5}toWriter(t){return t.writeU8(-1!==this.nonce?1:0),t.writeU32(this.nonce),t}fromRaw(t){const e=s.read(t,!0);return this.nonce=-1,1===e.readU8()&&(this.nonce=e.readU32()),this}static fromRaw(t){return(new T).fromRaw(t)}}class U extends p{constructor(t,e,r,i,s,n){super(),this.cmd=m.SCRYPT,this.passwd=t||null,this.salt=e||null,this.N=null!=r?r:-1,this.r=null!=i?i:-1,this.p=null!=s?s:-1,this.len=null!=n?n:-1}getSize(){let t=0;return t+=l.sizeVarBytes(this.passwd),t+=l.sizeVarBytes(this.salt),t+=16,t}toWriter(t){return t.writeVarBytes(this.passwd),t.writeVarBytes(this.salt),t.writeU32(this.N),t.writeU32(this.r),t.writeU32(this.p),t.writeU32(this.len),t}fromRaw(t){const e=s.read(t,!0);return this.passwd=e.readVarBytes(),this.salt=e.readVarBytes(),this.N=e.readU32(),this.r=e.readU32(),this.p=e.readU32(),this.len=e.readU32(),this}static fromRaw(t){return(new U).fromRaw(t)}}class z extends p{constructor(t){super(),this.cmd=m.SCRYPTRESULT,this.key=t||null}getSize(){return l.sizeVarBytes(this.key)}toWriter(t){return t.writeVarBytes(this.key),t}fromRaw(t){const e=s.read(t,!0);return this.key=e.readVarBytes(),this}static fromRaw(t){return(new z).fromRaw(t)}}function C(t){return"string"!=typeof t?"":t}e.types=m,e.EnvPacket=b,e.EventPacket=g,e.LogPacket=w,e.ErrorPacket=S,e.ErrorResultPacket=y,e.CheckPacket=I,e.CheckResultPacket=v,e.SignPacket=E,e.SignResultPacket=_,e.CheckInputPacket=O,e.CheckInputResultPacket=N,e.SignInputPacket=B,e.SignInputResultPacket=A,e.ECVerifyPacket=M,e.ECVerifyResultPacket=P,e.ECSignPacket=R,e.ECSignResultPacket=x,e.MinePacket=k,e.MineResultPacket=T,e.ScryptPacket=U,e.ScryptResultPacket=z},1602:(t,e,r)=>{const i=r(8614);t.exports=class extends i{constructor(){super(),this.init()}init(){process.stdin.on("data",(t=>{this.emit("data",t)})),process.stdin.on("error",(()=>{})),process.stdout.on("error",(()=>{})),process.stderr.on("error",(()=>{})),process.on("uncaughtException",(t=>{this.emit("exception",t)}))}write(t){return process.stdout.write(t)}destroy(){process.exit(0)}}},5625:(t,e,r)=>{const i=r(1676),s=r(8614),n=r(5389);class o{constructor(t,e,r){this.id=t,this.cmd=e,this.size=r}}t.exports=class extends s{constructor(){super(),this.waiting=9,this.header=null,this.pending=[],this.total=0}feed(t){for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=this.read(this.waiting);this.parse(t)}}read(t){if(i(this.total>=t,"Reading too much."),0===t)return Buffer.alloc(0);const e=this.pending[0];if(e.length>t){const r=e.slice(0,t);return this.pending[0]=e.slice(t),this.total-=r.length,r}if(e.length===t){const t=this.pending.shift();return this.total-=t.length,t}const r=Buffer.allocUnsafe(t);let s=0;for(;s<r.length;){const t=this.pending[0],e=t.copy(r,s);e===t.length?this.pending.shift():this.pending[0]=t.slice(e),s+=e}return i.strictEqual(s,r.length),this.total-=r.length,r}parse(t){let e,r=this.header;if(!r){try{r=this.parseHeader(t)}catch(t){return void this.emit("error",t)}return this.header=r,void(this.waiting=r.size+1)}this.waiting=9,this.header=null;try{e=this.parsePacket(r,t)}catch(t){return void this.emit("error",t)}10===t[t.length-1]?(e.id=r.id,this.emit("packet",e)):this.emit("error",new Error("No trailing newline."))}parseHeader(t){const e=t.readUInt32LE(0,!0),r=t.readUInt8(4,!0),i=t.readUInt32LE(5,!0);return new o(e,r,i)}parsePacket(t,e){switch(t.cmd){case n.types.ENV:return n.EnvPacket.fromRaw(e);case n.types.EVENT:return n.EventPacket.fromRaw(e);case n.types.LOG:return n.LogPacket.fromRaw(e);case n.types.ERROR:return n.ErrorPacket.fromRaw(e);case n.types.ERRORRESULT:return n.ErrorResultPacket.fromRaw(e);case n.types.CHECK:return n.CheckPacket.fromRaw(e);case n.types.CHECKRESULT:return n.CheckResultPacket.fromRaw(e);case n.types.SIGN:return n.SignPacket.fromRaw(e);case n.types.SIGNRESULT:return n.SignResultPacket.fromRaw(e);case n.types.CHECKINPUT:return n.CheckInputPacket.fromRaw(e);case n.types.CHECKINPUTRESULT:return n.CheckInputResultPacket.fromRaw(e);case n.types.SIGNINPUT:return n.SignInputPacket.fromRaw(e);case n.types.SIGNINPUTRESULT:return n.SignInputResultPacket.fromRaw(e);case n.types.ECVERIFY:return n.ECVerifyPacket.fromRaw(e);case n.types.ECVERIFYRESULT:return n.ECVerifyResultPacket.fromRaw(e);case n.types.ECSIGN:return n.ECSignPacket.fromRaw(e);case n.types.ECSIGNRESULT:return n.ECSignResultPacket.fromRaw(e);case n.types.MINE:return n.MinePacket.fromRaw(e);case n.types.MINERESULT:return n.MineResultPacket.fromRaw(e);case n.types.SCRYPT:return n.ScryptPacket.fromRaw(e);case n.types.SCRYPTRESULT:return n.ScryptResultPacket.fromRaw(e);default:throw new Error("Unknown packet.")}}}},7786:(t,e,r)=>{const i=new(r(1362));process.title="bcoin-worker",i.listen()},6401:(t,e,r)=>{if(process.env.BCRYPTO_FORCE_BIGINT||"js"!==process.env.NODE_BACKEND)try{if(t.exports=r(5228),!t.exports.native)throw new Error}catch(e){t.exports=r(9465)}else t.exports=r(9465)},3363:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(587):t.exports=r(8082)},4450:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(375):t.exports=r(3209)},8401:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(7120):t.exports=r(6496)},1808:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(7749):t.exports=r(9612)},2355:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(1962):t.exports=r(8269)},5258:(t,e,r)=>{const i=r(7494),s=Buffer.from([0]),n=Buffer.from([1]);class o{constructor(t,e,r,s){i(t&&"string"==typeof t.id),this.hash=t,this.minEntropy="SHA1"===t.id?10:24,this.K=Buffer.allocUnsafe(t.size),this.V=Buffer.allocUnsafe(t.size),this.rounds=0,e&&this.init(e,r,s)}init(t,e=null,r=null){i(Buffer.isBuffer(t)),i(!e||Buffer.isBuffer(e)),i(!r||Buffer.isBuffer(r));for(let t=0;t<this.V.length;t++)this.K[t]=0,this.V[t]=1;const s=h(t,e,r);if(s.length<this.minEntropy)throw new Error("Not enough entropy.");return this.update(s),this.rounds=1,this}reseed(t,e=null){if(i(Buffer.isBuffer(t)),i(!e||Buffer.isBuffer(e)),0===this.rounds)throw new Error("DRBG not initialized.");const r=h(t,e);if(r.length<this.minEntropy)throw new Error("Not enough entropy.");return this.update(r),this.rounds=1,this}generate(t,e=null){if(i(t>>>0===t),i(!e||Buffer.isBuffer(e)),0===this.rounds)throw new Error("DRBG not initialized.");if(this.rounds>281474976710656)throw new Error("Reseed is required.");e&&0===e.length&&(e=null),e&&this.update(e);const r=Math.ceil(t/this.hash.size),s=Buffer.allocUnsafe(r*this.hash.size);for(let t=0;t<r;t++)this.V=this.mac(this.V),this.V.copy(s,t*this.hash.size);return this.update(e),this.rounds+=1,s.slice(0,t)}randomBytes(t){return this.generate(t)}mac(t){return this.hash.mac(t,this.K)}hmac(){return this.hash.hmac().init(this.K)}update(t=null){i(!t||Buffer.isBuffer(t));const e=this.hmac();if(e.update(this.V),e.update(s),t&&e.update(t),this.K=e.final(),this.V=this.mac(this.V),t){const e=this.hmac();e.update(this.V),e.update(n),e.update(t),this.K=e.final(),this.V=this.mac(this.V)}return this}}function h(t,e=null,r=null){if(!e&&!r)return t;let i=t.length,s=0;e&&(i+=e.length),r&&(i+=r.length);const n=Buffer.allocUnsafe(i);return s+=t.copy(n,s),e&&(s+=e.copy(n,s)),r&&r.copy(n,s),n}o.native=0,t.exports=o},4189:(t,e,r)=>{const i=r(2357),s=r(6401);function n(t,e,r){if(i(Buffer.isBuffer(t)),i(e>>>0===e),i("boolean"==typeof r),e>=t.length)throw new Error("Invalid size.");const s=t[e],n=127&s;if(e+=1,0==(128&s))return[n,e];if(r&&0===n)throw new Error("Indefinite length.");let o=0;for(let s=0;s<n;s++){i(e<t.length);const s=t[e];if(e+=1,o>=1<<24)throw new Error("Length too large.");if(o*=256,o+=s,r&&0===o)throw new Error("Unexpected leading zeroes.")}if(r&&o<128)throw new Error("Non-minimal length.");return[o,e]}function o(t,e,r=!0){if(i(Buffer.isBuffer(t)),i(e>>>0===e),i("boolean"==typeof r),e>=t.length||2!==t[e])throw new Error("Invalid integer tag.");let o;if(e+=1,[o,e]=n(t,e,r),e+o>t.length)throw new Error("Integer body out of bounds.");if(r){if(0===o)throw new Error("Zero length integer.");if(128&t[e])throw new Error("Integers must be positive.");if(o>1&&0===t[e]&&0==(128&t[e+1]))throw new Error("Unexpected leading zeroes.")}for(;o>1&&0===t[e];)e+=1,o-=1;if(o>2048)throw new Error("Invalid integer size.");return[s.decode(t.slice(e,e+o)),e+=o]}function h(t){return i(t>>>0===t),t<=127?1:t<=255?2:(i(t<=65535),3)}function f(t,e,r){return i(Buffer.isBuffer(t)),i(e>>>0===e),i(r>>>0===r),r<=127?t[e++]=r:r<=255?(t[e++]=129,t[e++]=r):(i(r<=65535),t[e++]=130,t[e++]=r>>8,t[e++]=255&r),i(e<=t.length),e}e.readSize=n,e.readSeq=function(t,e,r=!0){if(i(Buffer.isBuffer(t)),i(e>>>0===e),i("boolean"==typeof r),e>=t.length||48!==t[e])throw new Error("Invalid sequence tag.");let s;if(e+=1,[s,e]=n(t,e,r),r&&e+s!==t.length)throw new Error("Trailing bytes.");return e},e.readInt=o,e.readVersion=function(t,e,r,s=!0){let n;if(i(Buffer.isBuffer(t)),i(e>>>0===e),i((255&r)===r),i("boolean"==typeof s),[n,e]=o(t,e,s),0!==n.cmpn(r))throw new Error("Invalid version.");return e},e.sizeSize=h,e.sizeSeq=function(t){return 1+h(t)+t},e.sizeInt=function(t){i(t instanceof s);const e=t.bitLength();let r=e+7>>>3;return e>0&&0==(7&e)&&(r+=t.testn(e-1)),0===e&&(r=1),1+h(r)+r},e.sizeVersion=function(t){return i((255&t)===t),3},e.writeSize=f,e.writeSeq=function(t,e,r){return i(Buffer.isBuffer(t)),i(e>>>0===e),t[e++]=48,f(t,e,r)},e.writeInt=function(t,e,r){i(Buffer.isBuffer(t)),i(e>>>0===e),i(r instanceof s);const n=r.bitLength();let o=n+7>>>3,h=0;return n>0&&0==(7&n)&&(h=r.testn(n-1)),0===n&&(o=1),t[e++]=2,e=f(t,e,h+o),h&&(t[e++]=0),0!==n?r.encode().copy(t,e):t[e]=0,i((e+=o)<=t.length),e},e.writeVersion=function(t,e,r){return i(Buffer.isBuffer(t)),i(e>>>0===e),i((255&r)===r),i(e+3<=t.length),t[e++]=2,t[e++]=1,t[e++]=r,e}},7494:t=>{t.exports=function t(e,r){if(!e){const e=new Error(r||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(e,t),e}}},8377:(t,e,r)=>{const{inspect:i}=r(1669);e.custom=i.custom||"inspect"},3556:(t,e,r)=>{const i=r(7494);t.exports=class{constructor(t,e,r=[],s=[]){i("function"==typeof t),i(e>>>0===e),i(Array.isArray(r)),i(Array.isArray(s)),this.hash=t,this.size=e,this.x=r,this.y=s,this.inner=new t,this.outer=new t}init(t){if(i(Buffer.isBuffer(t)),t.length>this.size){const e=new(0,this.hash);e.init(...this.x),e.update(t),t=e.final(...this.y),i(t.length<=this.size)}const e=Buffer.allocUnsafe(this.size);for(let r=0;r<t.length;r++)e[r]=54^t[r];for(let r=t.length;r<e.length;r++)e[r]=54;this.inner.init(...this.x),this.inner.update(e);for(let r=0;r<t.length;r++)e[r]=92^t[r];for(let r=t.length;r<e.length;r++)e[r]=92;return this.outer.init(...this.x),this.outer.update(e),this}update(t){return this.inner.update(t),this}final(){return this.outer.update(this.inner.final(...this.y)),this.outer.final(...this.y)}}},375:(t,e,r)=>{const i=r(7494),s=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,-1,-1,-1,-1,-1,-1,-1,9,10,11,12,13,14,15,16,-1,17,18,19,20,21,-1,22,23,24,25,26,27,28,29,30,31,32,-1,-1,-1,-1,-1,-1,33,34,35,36,37,38,39,40,41,42,43,-1,44,45,46,47,48,49,50,51,52,53,54,55,56,57,-1,-1,-1,-1,-1];e.native=0,e.encode=function(t){i(Buffer.isBuffer(t));let e=0,r=0;for(;r<t.length&&0===t[r];r++)e+=1;const s=Buffer.allocUnsafe(1+(138*t.length/100|0));s.fill(0);let n=0;for(;r<t.length;r++){let e=t[r],o=0;for(let t=s.length-1;t>=0&&!(0===e&&o>=n);t--,o++)e+=256*s[t],s[t]=e%58,e=e/58|0;i(0===e),n=o}for(r=s.length-n;r<s.length&&0===s[r];)r+=1;let o="";for(let t=0;t<e;t++)o+="1";for(;r<s.length;r++)o+="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"[s[r]];return o},e.decode=function(t){i("string"==typeof t);let e=0,r=0;for(;r<t.length&&"1"===t[r];r++)e+=1;const n=Buffer.allocUnsafe(1+(733*t.length/1e3|0));n.fill(0);let o=0;for(;r<t.length;r++){const e=t.charCodeAt(r),h=65408&e?-1:s[e];if(-1===h)throw new Error("Non-base58 character.");let f=h,u=0;for(let t=n.length-1;t>=0&&!(0===f&&u>=o);t--,u++)f+=58*n[t],n[t]=255&f,f>>>=8;i(0===f),o=u}for(r=0;r<n.length&&0===n[r];)r+=1;const h=Buffer.allocUnsafe(e+(n.length-r));let f;for(f=0;f<e;f++)h[f]=0;for(;r<n.length;)h[f++]=n[r++];return h},e.test=function(t){i("string"==typeof t);for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);if(65408&r)return!1;if(-1===s[r])return!1}return!0}},4074:(t,e,r)=>{const i=r(7494),s=r(6401),n=r(3363),o=r(2372);t.exports=class{constructor(t,e=(t=>t)){this.curve=t,this.encode=e,this.hash=new o,this.chacha=new n,this.key=Buffer.alloc(32,0),this.iv=Buffer.alloc(8,0),this.cache=[new s(1),new s(1)]}init(t){i(Array.isArray(t)),this.hash.init();for(const[e,r,i]of t)this.hash.update(o.digest(e)),this.hash.update(r),this.hash.update(this.encode(i));return this.key=this.hash.final(),this.cache[0]=new s(1),this.cache[1]=new s(1),this}encrypt(t){const e=2*this.curve.scalarSize,r=Buffer.alloc(e,0),i=r.slice(0,this.curve.scalarSize),s=r.slice(this.curve.scalarSize);return this.chacha.init(this.key,this.iv,t),this.chacha.encrypt(r),[this.curve.decodeScalar(i),this.curve.decodeScalar(s)]}refresh(t){let e=0;for(;;){this.iv[4]=e,this.iv[5]=e>>>8,this.iv[6]=e>>>16,this.iv[7]=e>>>24,e+=1;const[r,i]=this.encrypt(t);if(!(r.isZero()||r.cmp(this.curve.n)>=0||i.isZero()||i.cmp(this.curve.n)>=0)){this.cache[0]=r,this.cache[1]=i;break}}}generate(t){return i(t>>>0===t),1&t&&this.refresh(t>>>1),this.cache[1&t]}}},7120:(t,e,r)=>{const i=r(7494),s=Buffer.allocUnsafe(66),n="qpzry9x8gf2tvdw0s3jn54khce6mua7l",o=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1];function h(t){const e=t>>>25;return(33554431&t)<<5^996825010&-(e>>>0&1)^642813549&-(e>>>1&1)^513874426&-(e>>>2&1)^1027748829&-(e>>>3&1)^705979059&-(e>>>4&1)}function f(t,e){i("string"==typeof t),i(Buffer.isBuffer(e));let r,s=1;for(r=0;r<t.length;r++){const e=t.charCodeAt(r);if(65280&e||e>>>5==0)throw new Error("Invalid bech32 character.");s=h(s)^e>>>5}if(r+7+e.length>90)throw new Error("Invalid bech32 data length.");s=h(s);let o="";for(let e=0;e<t.length;e++){const r=t.charCodeAt(e);s=h(s)^31&r,o+=t[e]}o+="1";for(let t=0;t<e.length;t++){const r=e[t];if(r>>>5!=0)throw new Error("Invalid bech32 value.");s=h(s)^r,o+=n[r]}for(let t=0;t<6;t++)s=h(s);s^=1;for(let t=0;t<6;t++)o+=n[s>>>5*(5-t)&31];return o}function u(t){if(i("string"==typeof t),t.length<8||t.length>90)throw new Error("Invalid bech32 string length.");let e=0;for(;e<t.length&&"1"!==t[t.length-1-e];)e+=1;const r=t.length-(1+e);if(1+e>=t.length||e<6)throw new Error("Invalid bech32 data length.");e-=6;const s=Buffer.allocUnsafe(e);let n,f=1,u=!1,a=!1,c="";for(let e=0;e<r;e++){let r=t.charCodeAt(e);if(r<33||r>126)throw new Error("Invalid bech32 character.");r>=97&&r<=122?u=!0:r>=65&&r<=90&&(a=!0,r=r-65+97),c+=String.fromCharCode(r),f=h(f)^r>>>5}for(f=h(f),n=0;n<r;n++)f=h(f)^31&t.charCodeAt(n);for(n+=1;n<t.length;){const e=t.charCodeAt(n),i=65408&e?-1:o[e];if(-1===i)throw new Error("Invalid bech32 character.");e>=97&&e<=122?u=!0:e>=65&&e<=90&&(a=!0),f=h(f)^i,n+6<t.length&&(s[n-(1+r)]=i),n+=1}if(u&&a)throw new Error("Invalid bech32 casing.");if(1!==f)throw new Error("Invalid bech32 checksum.");return[c,s.slice(0,e)]}function a(t,e,r,s,n,o,h){i(Buffer.isBuffer(t)),i(e>>>0===e),i(Buffer.isBuffer(r)),i(s>>>0===s),i((255&n)===n),i((255&o)===o),i("boolean"==typeof h),i(0!==n),i(0!==o);const f=(1<<o)-1;let u=0,a=0;for(;e<t.length;e++){const i=t[e];if(i>>>n!=0)throw new Error("Invalid bits.");for(u=u<<n|i,a+=n;a>=o;)a-=o,r[s++]=u>>>a&f}if(h)a&&(r[s++]=u<<o-a&f);else if(a>=n||u<<o-a&f)throw new Error("Invalid bits.");return i(s<=r.length),r.slice(0,s)}e.native=0,e.serialize=f,e.deserialize=u,e.is=function(t){i("string"==typeof t);try{u(t)}catch(t){return!1}return!0},e.convertBits=function(t,e,r,s){i(Buffer.isBuffer(t));const n=function(t,e,r,s){i(t>>>0===t),i((255&e)===e),i((255&r)===r),i("boolean"==typeof s),i(0!==e),i(0!==r);let n=(t*e+(r-1))/r;return n>>>=0,s&&(n+=1),n}(t.length,e,r,s);return a(t,0,Buffer.allocUnsafe(n),0,e,r,s)},e.encode=function(t,e,r){if(i("string"==typeof t),i((255&e)===e),i(Buffer.isBuffer(r)),e<0||e>31)throw new Error("Invalid bech32 version.");if(r.length<2||r.length>40)throw new Error("Invalid bech32 data length.");const n=s;return n[0]=e,f(t,a(r,0,n,1,8,5,!0))},e.decode=function(t){const[e,r]=u(t);if(0===r.length||r.length>65)throw new Error("Invalid bech32 data length.");const i=r[0];if(i>31)throw new Error("Invalid bech32 version.");const s=a(r,1,r,0,5,8,!1);if(s.length<2||s.length>40)throw new Error("Invalid bech32 data length.");return[e,i,s]},e.test=function(t){let e;i("string"==typeof t);try{[,e]=u(t)}catch(t){return!1}return!(0===e.length||e.length>65||e[0]>31)}},9465:(t,e,r)=>{const{custom:i}=r(8377),s=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],n=[0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],o=[0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176],h={p192:null,p224:null,p521:null,k256:null,p25519:null,p448:null},f="function"==typeof BigInt;class u{constructor(t,e,r){this.words=[0],this.length=1,this.negative=0,this.red=null,this.from(t,e,r)}_iadd(t,e){let r=0,i=0;for(t.length<e.length&&([t,e]=[e,t]),t!==this&&this._alloc(t.length);i<e.length;i++){const s=(0|t.words[i])+(0|e.words[i])+r;this.words[i]=67108863&s,r=s>>>26}for(;0!==r&&i<t.length;i++){const e=(0|t.words[i])+r;this.words[i]=67108863&e,r=e>>>26}if(this.length=t.length,0!==r)this._alloc(this.length+1),this.words[this.length++]=r;else if(t!==this)for(;i<t.length;i++)this.words[i]=t.words[i];return this}_iaddn(t){if(this.words[0]+=t,this.words[0]<67108864)return this;let e=0;for(this._alloc(this.length+1),this.words[this.length]=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,this.words[e+1]+=1;return this.length=Math.max(this.length,e+1),this}iadd(t){if(v(u.isBN(t),"num","bignum"),this.negative===t.negative)this._iadd(this,t);else{const e=this.ucmp(t);if(0===e)return this.words[0]=0,this.length=1,this.negative=0,this;e<0?(this._isub(t,this),this.negative^=1):this._isub(this,t)}return this}iaddn(t){v(A(t),"num","smi");const e=t<0|0;return e&&(t=-t),this.negative===e?this._iaddn(t):1===this.length&&this.words[0]<t?(this.words[0]=t-this.words[0],this.negative^=1):this._isubn(t),this}add(t){return v(u.isBN(t),"num","bignum"),t.length>this.length?t.clone().iadd(this):this.clone().iadd(t)}addn(t){return this.clone().iaddn(t)}_isub(t,e){let r=0,i=0;for(I(t.length>=e.length),t!==this&&this._alloc(t.length);i<e.length;i++){const s=(0|t.words[i])-(0|e.words[i])+r;r=s>>26,this.words[i]=67108863&s}for(;0!==r&&i<t.length;i++){const e=(0|t.words[i])+r;r=e>>26,this.words[i]=67108863&e}if(I(0===r),t!==this)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=Math.max(this.length,i),this._strip()}_isubn(t){if(this.words[0]-=t,this.words[0]>=0)return this._normalize();I(1!==this.length),this._alloc(this.length+1);for(let t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.words[this.length]=0,this._strip()}isub(t){if(v(u.isBN(t),"num","bignum"),this.negative!==t.negative)this._iadd(this,t);else{const e=this.ucmp(t);if(0===e)return this.words[0]=0,this.length=1,this.negative=0,this;e<0?(this._isub(t,this),this.negative^=1):this._isub(this,t)}return this}isubn(t){v(A(t),"num","smi");const e=t<0|0;return e&&(t=-t),this.negative!==e?this._iaddn(t):1===this.length&&this.words[0]<t?(this.words[0]=t-this.words[0],this.negative^=1):this._isubn(t),this}sub(t){return this.clone().isub(t)}subn(t){return this.clone().isubn(t)}_mul(t,e){if(v(u.isBN(t),"num","bignum"),v(u.isBN(e),"out","bignum"),10===this.length&&10===t.length)return C(this,t,e);const r=this.length+t.length;return r<63?U(this,t,e):r<1024?z(this,t,e):function(t,e,r){if(!f||t.length+e.length>82595519)return z(t,e,r);const i=BigInt(0),s=BigInt(67108863),n=BigInt(26);let o=t.toBigInt()*e.toBigInt();const h=o<i|0;h&&(o=-o);let u=0;for(;o>i;)r.words[u++]=Number(o&s),o>>=n;return 0===u&&(r.words[u++]=0),r.length=u,r.negative=h,r}(this,t,e)}imul(t){return this.mul(t)._move(this)}imuln(t){v(A(t),"num","smi");const e=t<0|0;e&&(t=-t);let r=0;for(let e=0;e<this.length;e++){const i=this.words[e]*t,s=(67108863&i)+(67108863&r);r>>=26,r+=i/67108864|0,r+=s>>>26,this.words[e]=67108863&s}return this.negative^=e,0!==r?(this._alloc(this.length+1),this.words[this.length++]=r):this._strip(),this}mul(t){v(u.isBN(t),"num","bignum");const e=this.length+t.length,r=new u;r.words=new Array(e);for(let t=0;t<e;t++)r.words[t]=0;return this._mul(t,r)}muln(t){return this.clone().imuln(t)}mulShift(t,e){v(u.isBN(t),"num","bignum"),v(e>>>0===e,"bits","uint32");const r=this.mul(t),i=r.utestn(e-1);return r.iushrn(e),this.negative^t.negative?r.isubn(i):r.iaddn(i)}_div(t,e){v(u.isBN(t),"num","bignum"),I((7&e)===e),I(0!==e);const r=this,i=t;if(N(!i.isZero()),r.isZero())return[new u(0),new u(0)];const s=r.negative,n=i.negative;r.negative=0,i.negative=0;let o=null,h=null;return r.ucmp(i)<0?(1&e&&(o=new u(0)),2&e&&(h=r.clone())):1===i.length?(1&e&&(o=r.quon(i.words[0])),2&e&&(h=r.remn(i.words[0]))):[o,h]=r._wordDiv(i,e),r.negative=s,i.negative=n,1&e&&(o.negative=r.negative^i.negative,o._normalize()),2&e&&(h.negative=r.negative,h._normalize()),4&e&&(1&e&&(I(0!=(2&e)),0!==h.negative&&(0!==i.negative?o.iaddn(1):o.isubn(1))),2&e&&0!==h.negative&&(0!==i.negative?h.isub(i):h.iadd(i))),[o,h]}_wordDiv(t,e){let r,i=this.clone(),s=t,n=null;const o=0|s.words[s.length-1],h=26-P(o);0!==h?(s=s.clone(),i.iushln(h),s.iushln(h),r=0|s.words[s.length-1]):r=o;const f=i.length-s.length;if(I(f>=0),1&e){n=new u(0),n.length=f+1,n.words=new Array(n.length);for(let t=0;t<n.length;t++)n.words[t]=0}const a=i.clone();a._ishlnsubmul(s,1,f),0===a.negative&&(n&&(n.words[f]=1),i=a);for(let t=f-1;t>=0;t--){const e=(67108864*i.words[s.length+t]+i.words[s.length+t-1])/r|0;let o=Math.min(e,67108863);for(i._ishlnsubmul(s,o,t);0!==i.negative;)o-=1,i.negative=0,i._ishlnsubmul(s,1,t),i.ineg();n&&(n.words[t]=o)}return n&&n._strip(),2&e&&0!==h&&i.iushrn(h),[n,i]}_ishlnsubmul(t,e,r){let i=0,s=0;for(this._expand(t.length+r);s<t.length;s++){const n=(0|this.words[s+r])+i,o=t.words[s]*e,h=n-(67108863&o);i=(h>>26)-(o/67108864|0),this.words[s+r]=67108863&h}for(;s<this.length-r;s++){const t=(0|this.words[s+r])+i;i=t>>26,this.words[s+r]=67108863&t}if(0===i)return this._strip();I(-1===i),i=0;for(let t=0;t<this.length;t++){const e=-(0|this.words[t])+i;i=e>>26,this.words[t]=67108863&e}return this.negative=1,this._strip()}quorem(t){return this._div(t,3)}iquo(t){return this.quo(t)._move(this)}iquon(t){v(A(t),"num","smi"),N(0!==t);const e=t<0|0;e&&(t=-t);let r=0;for(let e=this.length-1;e>=0;e--){const i=(0|this.words[e])+67108864*r;this.words[e]=i/t|0,r=i%t}return this.negative^=e,this._strip()}quo(t){return this._div(t,1)[0]}quon(t){return this.clone().iquon(t)}irem(t){return this.rem(t)._move(this)}iremn(t){let e=this.remrn(t);return e<0&&(e=-e),this.words[0]=e,this.length=1,this._normalize()}rem(t){return this._div(t,2)[1]}remn(t){return this.clone().iremn(t)}remrn(t){v(A(t),"num","smi"),N(0!==t),t<0&&(t=-t);const e=(1<<26)%t;let r=0;for(let i=this.length-1;i>=0;i--)r=(e*r+(0|this.words[i]))%t;return 0!==this.negative?0|-r:r}divmod(t){return this._div(t,7)}idiv(t){return this.div(t)._move(this)}idivn(t){if(0===this.negative)return this.iquon(t);const e=this.remrn(t);return this.iquon(t),e<0&&(t<0?this.iaddn(1):this.isubn(1)),this}div(t){return this._div(t,7)[0]}divn(t){return this.clone().idivn(t)}imod(t){return this.ucmp(t)<0?(0!==this.negative&&(this._isub(t,this),this.negative=0),this):this.mod(t)._move(this)}imodn(t){return this.words[0]=this.modrn(t),this.length=1,this.negative=0,this}mod(t){return this._div(t,6)[1]}modn(t){return this.clone().imodn(t)}modrn(t){v(A(t),"num","smi");let e=this.remrn(t);return e<0&&(t<0?e-=t:e+=t),e}divRound(t){const[e,r]=this.quorem(t);if(r.isZero())return e;const i=1&t.words[0];t.iushrn(1);const s=r.ucmp(t);return t.iushln(1),t.words[0]|=i,s<0||t.isOdd()&&0===s?e:this.negative^t.negative?e.isubn(1):e.iaddn(1)}ipow(t){return this.pow(t)._move(this)}ipown(t){return this.pown(t)._move(this)}pow(t){v(u.isBN(t),"num","bignum");let e=P(t.words[t.length-1]),r=new u(1);for(let i=t.length-1;i>=0;i--){const s=t.words[i];for(let t=e-1;t>=0;t--)r=r.sqr(),s>>t&1&&(r=r.mul(this));e=26}return r}pown(t){if(v(A(t),"num","smi"),t<0&&(t=-t),0===t)return new u(1);if(1===t)return this.clone();let e=this;for(let r=P(t)-2;r>=0;r--)e=e.sqr(),t>>r&1&&(e=e.mul(this));return e}isqr(){return this.imul(this)}sqr(){return this.mul(this)}_rootrem(t,e){if(v(t>>>0===t,"num","uint32"),0===t)throw new RangeError("Zeroth root.");if(~t&this.negative)throw new RangeError("Negative with even root.");if(this.ucmpn(1)<=0)return[this.clone(),new u(0)];let r,i,s=new u(0),n=u.shift(1,this.bitLength()/t+1|0);if(0!==this.negative&&n.ineg(),2===t)do{s=n,n=this.quo(s),n.iadd(s),n.iushrn(1)}while(n.ucmp(s)<0);else do{s=n,n=s.pown(t-1),n=this.quo(n),r=s.muln(t-1),n.iadd(r),n=n.quon(t)}while(n.ucmp(s)<0);return e&&(n=s.pown(t),i=this.sub(n)),[s,i]}rootrem(t){return this._rootrem(t,1)}iroot(t){return this.root(t)._move(this)}root(t){return this._rootrem(t,0)[0]}isPower(t){if(v(t>>>0===t,"num","uint32"),0===t||~t&this.negative)return!1;const[,e]=this.rootrem(t);return 0===e.sign()}sqrtrem(){return this.rootrem(2)}isqrt(){return this.sqrt()._move(this)}sqrt(){return this.root(2)}isSquare(){return this.isPower(2)}iand(t){v(u.isBN(t),"num","bignum");let e=this,r=t;if(e===r)return e;if(0==(e.negative|r.negative))return e.iuand(r);if(1==(e.negative&r.negative))return e.iaddn(1),r.iaddn(1),e.iuor(r),e.isubn(1),r.isubn(1),e;0!==e.negative&&([e,r]=[r.clone(),e]);const i=e.bitLength();return r.iaddn(1),r.inotn(i),e.iuand(r),r.inotn(i),r.isubn(1),e._move(this)}iandn(t){return v(A(t),"num","smi"),0!=(this.negative|t<0)?this.iand(new u(t)):(this.words[0]&=t,this.length=1,this)}and(t){return this.clone().iand(t)}andn(t){return this.clone().iandn(t)}andrn(t){if(v(A(t),"num","smi"),0!=(this.negative|t<0)){const e=this.iand(new u(t));if(e.length>1)throw new RangeError("Number exceeds 26 bits.");return 0!==e.negative?-e.words[0]:e.words[0]}return this.words[0]&t}iuand(t){v(u.isBN(t),"num","bignum"),this.length=Math.min(this.length,t.length);for(let e=0;e<this.length;e++)this.words[e]&=t.words[e];return this._strip()}iuandn(t){return v(A(t),"num","smi"),this.words[0]&=Math.abs(t),this.length=1,this._normalize()}uand(t){return this.clone().iuand(t)}uandn(t){return this.clone().iuandn(t)}uandrn(t){v(A(t),"num","smi");const e=this.words[0]&Math.abs(t);return 0!==this.negative?0|-e:e}ior(t){v(u.isBN(t),"num","bignum");let e=this,r=t;return e===r?e:0==(e.negative|r.negative)?e.iuor(r):1==(e.negative&r.negative)?(e.iaddn(1),r.iaddn(1),e.iuand(r),e.isubn(1),r.isubn(1),e):(r=r.clone(),0!==e.negative&&([e,r]=[r,e]),r.iaddn(1),e.inotn(r.bitLength()),r.iuand(e),r.isubn(1),r._move(this))}iorn(t){return v(A(t),"num","smi"),0!=(this.negative|t<0)?this.ior(new u(t)):(this.words[0]|=t,this)}or(t){return this.clone().ior(t)}orn(t){return this.clone().iorn(t)}iuor(t){v(u.isBN(t),"num","bignum"),this._expand(t.length);for(let e=0;e<t.length;e++)this.words[e]|=t.words[e];return this}iuorn(t){return v(A(t),"num","smi"),this.words[0]|=Math.abs(t),this}uor(t){return this.clone().iuor(t)}uorn(t){return this.clone().iuorn(t)}ixor(t){v(u.isBN(t),"num","bignum");let e=this,r=t;return e===r?(e.words[0]=0,e.length=1,e.negative=0,e):0==(e.negative|r.negative)?e.iuxor(r):1==(e.negative&r.negative)?(e.iaddn(1),r.iaddn(1),e.iuxor(r),e.ineg(),r.isubn(1),e):(0!==e.negative&&([e,r]=[r.clone(),e]),r.iaddn(1),e.iuxor(r),e.iaddn(1),e.ineg(),r.isubn(1),e._move(this))}ixorn(t){return v(A(t),"num","smi"),0!=(this.negative|t<0)?this.ixor(new u(t)):(this.words[0]^=t,this)}xor(t){return this.clone().ixor(t)}xorn(t){return this.clone().ixorn(t)}iuxor(t){v(u.isBN(t),"num","bignum");let e=this,r=t;e.length<r.length&&([e,r]=[r,e]);let i=0;for(;i<r.length;i++)this.words[i]=e.words[i]^r.words[i];if(e!==this)for(this._alloc(e.length);i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this._strip()}iuxorn(t){return v(A(t),"num","smi"),this.words[0]^=Math.abs(t),this._normalize()}uxor(t){return this.clone().iuxor(t)}uxorn(t){return this.clone().iuxorn(t)}inot(){return 0!==this.negative?this.ineg().isubn(1):this.iaddn(1).ineg(),this}not(){return this.clone().inot()}inotn(t){v(t>>>0===t,"width","uint32");const e=t%26;let r=Math.ceil(t/26),i=0;for(this._expand(r),e>0&&(r-=1);i<r;i++)this.words[i]^=67108863;return e>0&&(this.words[i]^=(1<<e)-1),this._strip()}notn(t){return this.clone().inotn(t)}ishl(t){return v(u.isBN(t),"bits","bignum"),v(t.bitLength()<=32,"bits","uint32"),this.ishln(t.toNumber())}ishln(t){return this.iushln(t)}shl(t){return this.clone().ishl(t)}shln(t){return this.clone().ishln(t)}iushl(t){return v(u.isBN(t),"bits","bignum"),v(t.bitLength()<=32,"bits","uint32"),this.iushln(t.toNumber())}iushln(t){v(t>>>0===t,"bits","uint32");const e=t%26,r=(t-e)/26,i=(1<<e)-1<<26-e;if(0!==e){let t=0;for(let r=0;r<this.length;r++){const s=this.words[r]&i,n=(0|this.words[r])-s<<e;this.words[r]=n|t,t=s>>>26-e}0!==t&&(this._alloc(this.length+1),this.words[this.length++]=t)}if(0!==r){this._alloc(this.length+r);for(let t=this.length-1;t>=0;t--)this.words[t+r]=this.words[t];for(let t=0;t<r;t++)this.words[t]=0;this.length+=r}return this._strip()}ushl(t){return this.clone().iushl(t)}ushln(t){return this.clone().iushln(t)}_split(t,e){const r=t%26,i=Math.min((t-r)/26,this.length),s=(1<<r)-1;if(e){e._alloc(i);for(let t=0;t<i;t++)e.words[t]=this.words[t];e.length=i}if(0===i);else if(this.length>i){this.length-=i;for(let t=0;t<this.length;t++)this.words[t]=this.words[t+i]}else this.words[0]=0,this.length=1;let n=0;if(0!==r)for(let t=this.length-1;t>=0;t--){const e=0|this.words[t];this.words[t]=n<<26-r|e>>>r,n=e&s}return e&&(0!==n?(e._alloc(e.length+1),e.words[e.length++]=n):(0===e.length&&(e.words[e.length++]=0),e._strip())),this._strip()}ishr(t){return v(u.isBN(t),"bits","bignum"),v(t.bitLength()<=32,"bits","uint32"),this.ishrn(t.toNumber())}ishrn(t){return v(t>>>0===t,"bits","uint32"),0!==this.negative?(this.iaddn(1),this.iushrn(t),this.isubn(1),this):this.iushrn(t)}shr(t){return this.clone().ishr(t)}shrn(t){return this.clone().ishrn(t)}iushr(t){return v(u.isBN(t),"bits","bignum"),v(t.bitLength()<=32,"bits","uint32"),this.iushrn(t.toNumber())}iushrn(t){return v(t>>>0===t,"bits","uint32"),this._split(t,null)}ushr(t){return this.clone().iushr(t)}ushrn(t){return this.clone().iushrn(t)}setn(t,e){return v(t>>>0===t,"bit","uint32"),0!==this.negative?(this.iaddn(1),this.usetn(t,!e),this.isubn(1),this):this.usetn(t,e)}usetn(t,e){v(t>>>0===t,"bit","uint32");const r=t%26,i=(t-r)/26;return this._expand(i+1),e?this.words[i]|=1<<r:this.words[i]&=~(1<<r),this._strip()}testn(t){v(t>>>0===t,"bit","uint32");const e=t%26,r=(t-e)/26;if(this.length<=r)return this.negative;const i=this.words[r],s=i>>e&1;if(0!==this.negative){if(e>0&&i&(1<<e)-1)return 1^s;let t=r;for(;t--;)if(this.words[t]>0)return 1^s}return s}utestn(t){v(t>>>0===t,"bit","uint32");const e=t%26,r=(t-e)/26;return this.length<=r?0:this.words[r]>>e&1}imaskn(t){return v(t>>>0===t,"bits","uint32"),0!==this.negative&&(this.iaddn(1),this.inotn(t+1),this.ineg()),this.iumaskn(t)}maskn(t){return this.clone().imaskn(t)}iumaskn(t){v(t>>>0===t,"bits","uint32");const e=t%26;let r=(t-e)/26;return this.length<=r?this:(0!==e&&(r+=1),this.length=Math.min(r,this.length),0!==e&&(this.words[this.length-1]&=(1<<e)-1),0===this.length&&(this.words[this.length++]=0),this._strip())}umaskn(t){return this.clone().iumaskn(t)}andln(t){return this.words[0]&t}ineg(){return this.isZero()||(this.negative^=1),this}neg(){return this.clone().ineg()}iabs(){return this.negative=0,this}abs(){return this.clone().iabs()}cmp(t){if(v(u.isBN(t),"num","bignum"),this.negative!==t.negative)return t.negative-this.negative;const e=this.ucmp(t);return 0!==this.negative?0|-e:e}cmpn(t){v(A(t),"num","smi");const e=t<0|0;if(this.negative!==e)return e-this.negative;const r=this.ucmpn(t);return 0!==this.negative?0|-r:r}eq(t){return 0===this.cmp(t)}eqn(t){return 0===this.cmpn(t)}gt(t){return this.cmp(t)>0}gtn(t){return this.cmpn(t)>0}gte(t){return this.cmp(t)>=0}gten(t){return this.cmpn(t)>=0}lt(t){return this.cmp(t)<0}ltn(t){return this.cmpn(t)<0}lte(t){return this.cmp(t)<=0}lten(t){return this.cmpn(t)<=0}sign(){return 0!==this.negative?-1:1===this.length&&0===this.words[0]?0:1}isZero(){return 1===this.length&&0===this.words[0]}isNeg(){return 0!==this.negative}isPos(){return 0===this.negative}isOdd(){return 1==(1&this.words[0])}isEven(){return 0==(1&this.words[0])}ucmp(t){if(v(u.isBN(t),"num","bignum"),this.length<t.length)return-1;if(this.length>t.length)return 1;for(let e=this.length-1;e>=0;e--){const r=0|this.words[e],i=0|t.words[e];if(r!==i)return(r>i)-(r<i)}return 0}ucmpn(t){if(v(A(t),"num","smi"),this.length>1)return 1;const e=0|this.words[0];return t<0&&(t=-t),(e>t)-(e<t)}legendre(t){const e=f?u.red(t):u.mont(t);return this.toRed(e).redLegendre()}jacobi(t){if(v(u.isBN(t),"num","bignum"),t.isZero()||t.isEven())throw new Error("jacobi: `num` must be odd.");let e=this._cloneNormal(),r=t.clone(),i=1;for(r.isNeg()&&(e.isNeg()&&(i=-1),r.ineg());;){if(0===r.cmpn(1))return i;if(e.isZero())return 0;if(e.imod(r),e.isZero())return 0;const t=e.zeroBits();if(1&t){const t=r.andln(7);3!==t&&5!==t||(i=-i)}const s=e.iushrn(t);3===r.andln(3)&&3===s.andln(3)&&(i=-i),e=r,r=s}}kronecker(t){v(u.isBN(t),"num","bignum");const e=[0,1,0,-1,0,-1,0,1];let r=this._cloneNormal(),i=t.clone(),s=1;if(i.isZero())return 0===r.ucmpn(1)?s:0;if(!r.isOdd()&&!i.isOdd())return 0;const n=i.zeroBits();for(i.iushrn(n),1&n&&(s=e[r.andln(7)]),i.isNeg()&&(r.isNeg()&&(s=-s),i.ineg());;){if(r.isZero())return 0===i.cmpn(1)?s:0;const t=r.zeroBits();r.iushrn(t),1&t&&(s*=e[i.andln(7)]),(r.words[0]^67108863*r.negative)&i.words[0]&2&&(s=-s),i.imod(r),[r,i]=[i,r],i.negative=0}}igcd(t){return this.gcd(t)._move(this)}gcd(t){if(v(u.isBN(t),"num","bignum"),this.isZero())return t.abs();if(t.isZero())return this.abs();let e=this.clone(),r=t.clone();e.negative=0,r.negative=0;const i=e._factor2(r);for(0!==i&&(e.iushrn(i),r.iushrn(i));;){const t=e.zeroBits(),i=r.zeroBits();0!==t&&e.iushrn(t),0!==i&&r.iushrn(i);const s=e.ucmp(r);if(s<0)[e,r]=[r,e];else if(0===s||0===r.ucmpn(1))break;e._isub(e,r)}return r.iushln(i)}ilcm(t){return this.lcm(t)._move(this)}lcm(t){return v(u.isBN(t),"num","bignum"),this.isZero()||t.isZero()?new u(0):this.quo(this.gcd(t)).mul(t).iabs()}egcd(t){if(v(u.isBN(t),"num","bignum"),this.isZero())return[new u(0),new u(t.sign()),t.abs()];if(t.isZero())return[new u(this.sign()),new u(0),this.abs()];const e=this.clone(),r=t.clone();e.negative=0,r.negative=0;const i=new u(1),s=new u(0),n=new u(0),o=new u(1),h=e._factor2(r);0!==h&&(e.iushrn(h),r.iushrn(h));const f=r.clone(),a=e.clone();for(;!e.isZero();){let t=0;for(let r=1;0==(e.words[0]&r)&&t<26;r<<=1)t+=1;if(t>0)for(e.iushrn(t);t>0;)(i.isOdd()||s.isOdd())&&(i.iadd(f),s.isub(a)),i.iushrn(1),s.iushrn(1),t-=1;let h=0;for(let t=1;0==(r.words[0]&t)&&h<26;t<<=1)h+=1;if(h>0)for(r.iushrn(h);h>0;)(n.isOdd()||o.isOdd())&&(n.iadd(f),o.isub(a)),n.iushrn(1),o.iushrn(1),h-=1;e.cmp(r)>=0?(e.isub(r),i.isub(n),s.isub(o)):(r.isub(e),n.isub(i),o.isub(s))}return 0!==this.negative&&n.ineg(),0!==t.negative&&o.ineg(),[n,o,r.iushln(h)]}iinvert(t){return this.invert(t)._move(this)}invert(t){if(v(u.isBN(t),"num","bignum"),E(t.sign()>0,"invert"),0===t.cmpn(1))throw new RangeError("Not invertible.");const[e,,r]=this.egcd(t);if(0!==r.cmpn(1))throw new RangeError("Not invertible.");return e.imod(t)}ifermat(t){return this.fermat(t)._move(this)}fermat(t){const e=f?u.red(t):u.mont(t);return this.toRed(e).redFermat().fromRed()}ipowm(t,e,r,i){return this.powm(t,e,r,i)._move(this)}powm(t,e,r,i){const s=!f&&r?u.mont(e):u.red(e);return this.toRed(s).redPow(t,i).fromRed()}ipowmn(t,e,r){return this.powmn(t,e,r)._move(this)}powmn(t,e,r){const i=r?u.mont(e):u.red(e);return this.toRed(i).redPown(t).fromRed()}isqrtm(t){return this.sqrtm(t)._move(this)}sqrtm(t){let e;return v(u.isBN(t),"p","bignum"),e=3===t.andln(3)||5===t.andln(7)?u.red(t):u.mont(t),this.toRed(e).redSqrt().fromRed()}isqrtpq(t,e){return this.sqrtpq(t,e)._move(this)}sqrtpq(t,e){const r=this.sqrtm(t),i=this.sqrtm(e),[s,n]=t.egcd(e),o=i.mul(s).mul(t),h=r.mul(n).mul(e),f=t.mul(e);return o.iadd(h).imod(f)}isPrime(t,e,r){return v(e>>>0===e,"reps","uint32"),!!this.isPrimeMR(t,e+1,!0)&&!!this.isPrimeLucas(r)}isPrimeMR(t,e,r=!1){v(e>>>0===e,"reps","uint32"),v(e>0,"reps","integer"),v("boolean"==typeof r,"force2","boolean");const i=this;if(i.cmpn(7)<0)return 0===i.cmpn(2)||0===i.cmpn(3)||0===i.cmpn(5);if(i.isEven())return!1;const s=i.subn(1),n=s.subn(2),o=s.zeroBits(),h=s.ushrn(o),f=u.red(i),a=s.toRed(f),c=new u(1).toRed(f);t:for(let i=0;i<e;i++){let s;i===e-1&&r?s=new u(2):(s=u.random(t,0,n),s.iaddn(2));let d=s.toRed(f).redPow(h);if(0!==d.cmp(c)&&0!==d.cmp(a)){for(let t=1;t<o;t++){if(d=d.redSqr(),0===d.cmp(a))continue t;if(0===d.cmp(c))return!1}return!1}}return!0}isPrimeLucas(t=0){v(t>>>0===t,"limit","uint32");const e=this;if(e.cmpn(1)<=0)return!1;if(e.isEven())return 0===e.cmpn(2);let r=3;for(;;){if(r>1e4)throw new Error(`Cannot find (D/n) = -1 for ${e.toString(10)}.`);if(0!==t&&r>t)return!1;const i=new u(r*r-4).jacobi(e);if(-1===i)break;if(0===i)return 0===e.cmpn(r+2);if(40===r&&e.isSquare())return!1;r+=1}const i=e.addn(1),s=i.zeroBits(),n=e.subn(2);let o=new u(2),h=new u(r);i.iushrn(s);for(let t=i.bitLength();t>=0;t--)i.utestn(t)?(o=o.mul(h).iadd(e).isubn(r).imod(e),h=h.sqr().iadd(n).imod(e)):(h=h.mul(o).iadd(e).isubn(r).imod(e),o=o.sqr().iadd(n).imod(e));if(0===o.cmpn(2)||0===o.cmp(n)){let t=o.muln(r),i=h.ushln(1);if(t.cmp(i)<0&&([t,i]=[i,t]),t.isub(i).imod(e).isZero())return!0}for(let t=0;t<s-1;t++){if(o.isZero())return!0;if(0===o.cmpn(2))return!1;o=o.sqr().isubn(2).imod(e)}return!1}toTwos(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()}fromTwos(t){return v(t>>>0===t,"width","uint32"),E(t>0,"width"),this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()}toRed(t){if(v(t instanceof g,"ctx","reduction context"),this.red)throw new Error("Already in reduction context.");return t.convertTo(this)}fromRed(){return _(this.red,"fromRed"),this.red.convertFrom(this)}forceRed(t){if(v(t instanceof g,"ctx","reduction context"),this.red){if(!t.m.eq(this.red.m)||t.mont!==this.red.mont)throw new Error("Already in reduction context.")}else E(0===this.negative,"red"),E(this.ucmp(t.m)<0,"red");return this.clone()._forceRed(t)}redIAdd(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redIAdd"),this.red.iadd(this,t)}redAdd(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redAdd"),this.red.add(this,t)}redIAddn(t){return v(A(t),"num","smi"),_(this.red,"redIAddn"),this.red.iaddn(this,t)}redAddn(t){return v(A(t),"num","smi"),_(this.red,"redAddn"),this.red.addn(this,t)}redISub(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redISub"),this.red.isub(this,t)}redSub(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redSub"),this.red.sub(this,t)}redISubn(t){return v(A(t),"num","smi"),_(this.red,"redISubn"),this.red.isubn(this,t)}redSubn(t){return v(A(t),"num","smi"),_(this.red,"redSubn"),this.red.subn(this,t)}redIMul(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redIMul"),this.red.imul(this,t)}redMul(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redMul"),this.red.mul(this,t)}redIMuln(t){return v(A(t),"num","smi"),_(this.red,"redIMuln"),this.red.imuln(this,t)}redMuln(t){return v(A(t),"num","smi"),_(this.red,"redMuln"),this.red.muln(this,t)}redIDiv(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redIDiv"),this.red.idiv(this,t)}redDiv(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redDiv"),this.red.div(this,t)}redIDivn(t){return v(A(t),"num","smi"),_(this.red,"redIDivn"),this.red.idivn(this,t)}redDivn(t){return v(A(t),"num","smi"),_(this.red,"redDivn"),this.red.divn(this,t)}redIPow(t,e){return v(u.isBN(t),"num","bignum"),_(this.red,"redIPow"),O(!t.red,"redIPow"),this.red.ipow(this,t,e)}redPow(t,e){return v(u.isBN(t),"num","bignum"),_(this.red,"redPow"),O(!t.red,"redPow"),this.red.pow(this,t,e)}redIPown(t){return v(A(t),"num","smi"),_(this.red,"redIPown"),this.red.ipown(this,t)}redPown(t){return v(A(t),"num","smi"),_(this.red,"redPown"),this.red.pown(this,t)}redISqr(){return _(this.red,"redISqr"),this.red.isqr(this)}redSqr(){return _(this.red,"redSqr"),this.red.sqr(this)}redISqrt(){return _(this.red,"redISqrt"),this.red.isqrt(this)}redSqrt(){return _(this.red,"redSqrt"),this.red.sqrt(this)}redIDivSqrt(t){return _(this.red,"redIDivSqrt"),this.red.idivsqrt(this,t)}redDivSqrt(t){return _(this.red,"redDivSqrt"),this.red.divsqrt(this,t)}redIsSquare(){return _(this.red,"redIsSquare"),this.red.isSquare(this)}redIShl(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redIShl"),O(!t.red,"redIShl"),this.red.ishl(this,t)}redShl(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redShl"),O(!t.red,"redShl"),this.red.shl(this,t)}redIShln(t){return v(t>>>0===t,"num","uint32"),_(this.red,"redIShln"),this.red.ishln(this,t)}redShln(t){return v(t>>>0===t,"num","uint32"),_(this.red,"redShln"),this.red.shln(this,t)}redINeg(){return _(this.red,"redINeg"),this.red.ineg(this)}redNeg(){return _(this.red,"redNeg"),this.red.neg(this)}redEq(t){return v(u.isBN(t),"num","bignum"),_(this.red,"redEq"),this.red.eq(this,t)}redEqn(t){return v(A(t),"num","smi"),_(this.red,"redEqn"),this.red.eqn(this,t)}redIsHigh(){return _(this.red,"redIsHigh"),this.red.isHigh(this)}redIsLow(){return _(this.red,"redIsLow"),this.red.isLow(this)}redIsOdd(){return _(this.red,"redIsOdd"),this.red.isOdd(this)}redIsEven(){return _(this.red,"redIsEven"),this.red.isEven(this)}redLegendre(){return _(this.red,"redLegendre"),this.red.legendre(this)}redJacobi(){return _(this.red,"redJacobi"),this.red.jacobi(this)}redKronecker(){return _(this.red,"redKronecker"),this.red.kronecker(this)}redIInvert(){return _(this.red,"redIInvert"),this.red.iinvert(this)}redInvert(){return _(this.red,"redInvert"),this.red.invert(this)}redIFermat(){return _(this.red,"redIFermat"),this.red.ifermat(this)}redFermat(){return _(this.red,"redFermat"),this.red.fermat(this)}_move(t){return t.words=this.words,t.length=this.length,t.negative=this.negative,t.red=this.red,t}_alloc(t){for(;this.words.length<t;)this.words.push(0);return this}_expand(t){for(this._alloc(t);this.length<t;)this.words[this.length++]=0;return this}_strip(){for(;this.length>1&&0===this.words[this.length-1];)this.length-=1;return this._normalize()}_normalize(){return I(this.length>0),1===this.length&&0===this.words[0]&&(this.negative=0),this}_check(){return I(this.length>0),I(this.length<=this.words.length),1===this.length?(0===this.words[0]&&I(0===this.negative),this):(I(0!==this.words[this.length-1]),this)}_invertp(t){if(v(u.isBN(t),"p","bignum"),I(0===this.negative),I(t.sign()>0),this.isZero()||0===t.cmpn(1))throw new RangeError("Not invertible.");const e=this.clone(),r=t.clone(),i=new u(1),s=new u(0),n=r.clone();for(;e.cmpn(1)>0&&r.cmpn(1)>0;){let t=0;for(let r=1;0==(e.words[0]&r)&&t<26;r<<=1)t+=1;if(t>0)for(e.iushrn(t);t>0;)i.isOdd()&&i.iadd(n),i.iushrn(1),t-=1;let o=0;for(let t=1;0==(r.words[0]&t)&&o<26;t<<=1)o+=1;if(o>0)for(r.iushrn(o);o>0;)s.isOdd()&&s.iadd(n),s.iushrn(1),o-=1;e.cmp(r)>=0?(e.isub(r),i.isub(s)):(r.isub(e),s.isub(i))}const o=0===e.cmpn(1)?i:s;return o.ucmp(t)>=0&&(o._isub(o,t),o.ucmp(t)>=0&&o._isub(o,t)),o.isNeg()&&o.iadd(t),o}_factor2(t){if(1&(this.words[0]|t.words[0]))return 0;const e=Math.min(this.length,t.length);let r=0;for(let i=0;i<e;i++){const e=R(this.words[i]|t.words[i]);if(r+=e,26!==e)break}return r}_cloneNormal(){return this.red?this.fromRed():this.clone()}_forceRed(t){return this.red=t,this}clone(){const t=new u;t.words=new Array(this.length);for(let e=0;e<this.length;e++)t.words[e]=this.words[e];return t.length=this.length,t.negative=this.negative,t.red=this.red,t}inject(t){v(u.isBN(t),"num","bignum"),this._alloc(t.length);for(let e=0;e<t.length;e++)this.words[e]=t.words[e];return this.length=t.length,this.negative=t.negative,this.red=t.red,this}set(t,e){return this.fromNumber(t,e)}swap(t){v(u.isBN(t),"num","bignum");const e=this,r=t;return[e.words,r.words]=[r.words,e.words],[e.length,r.length]=[r.length,e.length],[e.negative,r.negative]=[r.negative,e.negative],[e.red,r.red]=[r.red,e.red],e}reverse(){const t=this.negative;return this.fromBuffer(this.toBuffer("be"),"le"),this.negative=t,this}byteLength(){return Math.ceil(this.bitLength()/8)}bitLength(){const t=P(this.words[this.length-1]);return 26*(this.length-1)+t}zeroBits(){if(this.isZero())return 0;if(this.isOdd())return 0;let t=0;for(let e=0;e<this.length;e++){const r=R(this.words[e]);if(t+=r,26!==r)break}return t}isSafe(){return this.length<=2||3===this.length&&1===this.words[2]}word(t){return v(t>>>0===t,"pos","uint32"),t>=this.length?0:this.words[t]}[i](){let t="BN";return this.red&&(t="BN-R"),`<${t}: ${this.toString(10)}>`}csign(){return-2*this.negative+1-this.czero()}czero(){const t=this.words[0]-1>>>31;return this.length-2>>>31&t}cneg(){return this.negative}cpos(){return 1^this.negative}ceq(t){v(u.isBN(t),"num","bignum");let e=0;for(let r=0;r<t.length;r++)e|=this.words[r%this.length]^t.words[r];return e|=this.length^t.length,e|=this.negative^t.negative,e-1>>>31}ceqn(t){const e=t>>31&1,r=(0|t)*(1|-e)&67108863;let i=0;return i|=this.words[0]^r,i|=1^this.length,i|=this.negative^e,i-1>>>31}cswap(t,e){v(u.isBN(t),"num","bignum");const r=this,i=t,s=67108863&-(1&(e>>31|-e>>31));r._alloc(i.words.length),i._alloc(r.words.length);for(let t=0;t<r.words.length;t++){const e=(r.words[t]^i.words[t])&s;r.words[t]^=e,i.words[t]^=e}const n=(r.length^i.length)&s,o=(r.negative^i.negative)&s;return r.length^=n,i.length^=n,r.negative^=o,i.negative^=o,this}cinject(t,e){v(u.isBN(t),"num","bignum");const r=this,i=t,s=1&(e>>31|-e>>31),n=s-1&67108863,o=67108863&~(s-1);r._alloc(i.length);for(let t=0;t<i.length;t++)r.words[t]=r.words[t]&n|i.words[t]&o;return r.length=r.length&n|i.length&o,r.negative=r.negative&n|i.negative&o,this}cset(t,e){const r=1&(e>>31|-e>>31),i=r-1&67108863,s=67108863&~(r-1),n=t>>31&1,o=(0|t)*(1|-n)&67108863;return this.words[0]=this.words[0]&i|o&s,this.length=this.length&i|1&s,this.negative=this.negative&i|n&s,this}toNumber(){let t=this.words[0];if(2===this.length)t+=67108864*this.words[1];else if(3===this.length&&1===this.words[2])t+=4503599627370496+67108864*this.words[1];else if(this.length>2)throw new RangeError("Number can only safely store up to 53 bits.");return 0!==this.negative?-t:t}toDouble(){let t=0;for(let e=this.length-1;e>=0;e--)t=67108864*t+this.words[e];return 0!==this.negative?-t:t}valueOf(){return this.toDouble()}toBigInt(){if(!f)throw new Error("BigInt is not supported!");const t=BigInt(52),e=BigInt(26);let r=this.length-1,i=BigInt(0);for(;r>=1;r-=2){const e=67108864*this.words[r],s=this.words[r-1];i=i<<t|BigInt(e+s)}return r>=0&&(i=i<<e|BigInt(this.words[0])),0!==this.negative?-i:i}toBool(){return!this.isZero()}toString(t,e){if(null==e&&(e=0),0===e&&(e=1),v((t=M(t))>>>0===t,"base","uint32"),v(e>>>0===e,"padding","uint32"),t<2||t>36)throw new RangeError("Base ranges between 2 and 36.");if(this._check(),16===t){let t="",r=0,i=0;for(let e=0;e<this.length;e++){const n=this.words[e],o=(16777215&(n<<r|i)).toString(16);i=n>>>24-r&16777215,t=0!==i||e!==this.length-1?s[6-o.length]+o+t:o+t,r+=2,r>=26&&(r-=26,e-=1)}for(0!==i&&(t=i.toString(16)+t);t.length%e!=0;)t="0"+t;return 0!==this.negative&&(t="-"+t),t}const r=n[t-1],i=o[t-1],h=this.clone();let f="";for(h.negative=0;!h.isZero();){const e=h.remrn(i).toString(t);h.iquon(i),f=h.isZero()?e+f:s[r-e.length]+e+f}for(this.isZero()&&(f="0");f.length%e!=0;)f="0"+f;return 0!==this.negative&&(f="-"+f),f}toJSON(){return this.toString(16,2)}toArray(t,e){return this.toArrayLike(Array,t,e)}toBuffer(t,e){return this.toArrayLike(Buffer,t,e)}toArrayLike(t,e,r){null==e&&(e="be"),null==r&&(r=0),v("function"==typeof t,"ArrayType","function"),v("be"===e||"le"===e,"endian","endianness"),v(r>>>0===r,"length","uint32"),this._check();const i=this.byteLength(),s=r||Math.max(1,i);if(i>s)throw new RangeError("Byte array longer than desired length.");const n=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(t,s);if("be"===e){let t=n.length-1,e=0;for(let r=0;r<this.length;r++){const i=(3&r)<<1,s=this.words[r]<<i|e;n[t--]=255&s,t>=0&&(n[t--]=s>>>8&255),t>=0&&(n[t--]=s>>>16&255),6===i?(t>=0&&(n[t--]=s>>>24&255),e=0):e=s>>>24}if(t>=0){for(n[t--]=e;t>=0;)n[t--]=0;e=0}I(0===e)}else{let t=0,e=0;for(let r=0;r<this.length;r++){const i=(3&r)<<1,s=this.words[r]<<i|e;n[t++]=255&s,t<n.length&&(n[t++]=s>>>8&255),t<n.length&&(n[t++]=s>>>16&255),6===i?(t<n.length&&(n[t++]=s>>>24&255),e=0):e=s>>>24}if(t<n.length){for(n[t++]=e;t<n.length;)n[t++]=0;e=0}I(0===e)}return n}encode(t,e){return this.toBuffer(t,e)}of(t,e){return this.fromNumber(t,e)}fromNumber(t,e){null==e&&(e="be"),v(B(t),"num","integer"),v("be"===e||"le"===e,"endian","endianness");const r=t<0|0;return r&&(t=-t),t<67108864?(this.words[0]=67108863&t,this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(this.words=[67108863&t,t/67108864&67108863,1],this.length=3),this.negative=r,"le"===e&&this.reverse(),this}fromDouble(t,e){null==e&&(e="be"),v("number"==typeof t,"num","double"),v("be"===e||"le"===e,"endian","endianness"),isFinite(t)||(t=0);const r=t<=-1|0;for(t<0&&(t=-t),t=Math.floor(t),this.words=[];t>0;){const e=t%67108864,r=(t-e)/67108864;this.words.push(e),t=r}return 0===this.words.length&&this.words.push(0),this.length=this.words.length,this.negative=r,"le"===e&&this.reverse(),this}fromBigInt(t,e){if(null==e&&(e="be"),v("bigint"==typeof t,"num","bigint"),v("be"===e||"le"===e,"endian","endianness"),!f)throw new Error("BigInt is not supported!");const r=t<BigInt(0)|0;return this._fromHex(t.toString(16),r),this.negative=r,"le"===e&&this.reverse(),this}fromBool(t){return v("boolean"==typeof t,"value","boolean"),this.words[0]=0|t,this.length=1,this.negative=0,this}fromString(t,e,r){if("le"!==e&&"be"!==e||([e,r]=[r,e]),e=M(e),null==r&&(r="be"),v("string"==typeof t,"string","string"),v(e>>>0===e,"base","uint32"),v("be"===r||"le"===r,"endian","endianness"),e<2||e>36)throw new Error("Base ranges between 2 and 36.");let i=0;return(t=t.replace(/\s+/g,"")).length>0&&45===t.charCodeAt(0)&&(i=1),16===e?this._fromHex(t,i):this._fromBase(t,e,i),this.negative=i,this._normalize(),"le"===r&&this.reverse(),this}_fromHex(t,e){this.length=Math.max(2,Math.ceil((t.length-e)/6)),this.words=new Array(this.length);for(let t=0;t<this.length;t++)this.words[t]=0;let r=0,i=t.length-6,s=0;for(;i>=e;i-=6){const e=x(t,i,i+6);this.words[s]|=e<<r&67108863,this.words[s+1]|=e>>>26-r&4194303,r+=24,r>=26&&(r-=26,s+=1)}if(i+6!==e){const n=x(t,e,i+6);this.words[s]|=n<<r&67108863,this.words[s+1]|=n>>>26-r&4194303}return this._strip()}_fromBase(t,e,r){this.words[0]=0,this.length=1,this.negative=0;let i=0,s=1;for(;s<=67108863;s*=e)i+=1;i-=1,s=s/e|0;const n=t.length-r,o=n%i,h=Math.min(n,n-o)+r;let f=r;for(;f<h;f+=i){const r=k(t,f,f+i,e);this.imuln(s),this._iaddn(r)}if(0!==o){const r=Math.pow(e,o),i=k(t,f,t.length,e);this.imuln(r),this._iaddn(i)}return this}fromJSON(t){if(u.isBN(t))return t.red?t.fromRed():t.clone();if(Array.isArray(t)){for(const e of t)v("string"==typeof e,"chunk","string");t=t.join("")}return this.fromString(t,16)}fromBN(t){return this.inject(t)}fromArray(t,e){return v(Array.isArray(t),"data","array"),this.fromArrayLike(t,e)}fromBuffer(t,e){return v(Buffer.isBuffer(t),"data","buffer"),this.fromArrayLike(t,e)}fromArrayLike(t,e){if(null==e&&(e="be"),v(t&&t.length>>>0===t.length,"data","array-like"),v("be"===e||"le"===e,"endian","endianness"),0===t.length)return this.words[0]=0,this.length=1,this.negative=0,this;this.length=Math.max(2,Math.ceil(t.length/3)),this.words=new Array(this.length),this.negative=0;for(let t=0;t<this.length;t++)this.words[t]=0;const r=t.length%3;let i=0,s=0,n=0;if("be"===e){for(let e=t.length-1;e>=2;e-=3){const r=t[e]|t[e-1]<<8|t[e-2]<<16;this.words[s]|=r<<i&67108863,this.words[s+1]=r>>>26-i&67108863,i+=24,i>=26&&(i-=26,s+=1)}switch(r){case 2:n=t[1]|t[0]<<8;break;case 1:n=t[0]}}else{const e=t.length-r;for(let r=0;r<e;r+=3){const e=t[r]|t[r+1]<<8|t[r+2]<<16;this.words[s]|=e<<i&67108863,this.words[s+1]=e>>>26-i&67108863,i+=24,i>=26&&(i-=26,s+=1)}switch(r){case 2:n=t[e]|t[e+1]<<8;break;case 1:n=t[e]}}return r>0&&(this.words[s]|=n<<i&67108863,this.words[s+1]=n>>>26-i&67108863),this._strip()}decode(t,e){return this.fromBuffer(t,e)}from(t,e,r){if(null==t)return this;if("le"!==e&&"be"!==e||([e,r]=[r,e]),"number"==typeof t)return this.fromNumber(t,r);if("bigint"==typeof t)return this.fromBigInt(t,r);if("string"==typeof t)return this.fromString(t,e,r);if("object"==typeof t){if(u.isBN(t))return this.fromBN(t,r);if(t.length>>>0===t.length)return this.fromArrayLike(t,r)}if("boolean"==typeof t)return this.fromBool(t);throw new TypeError("Non-numeric object passed to BN.")}static min(...t){let e=null;for(const r of t)v(u.isBN(r),"num","bignum"),(!e||r.cmp(e)<0)&&(e=r);return e||new u(0)}static max(...t){let e=null;for(const r of t)v(u.isBN(r),"num","bignum"),(!e||r.cmp(e)>0)&&(e=r);return e||new u(0)}static cmp(t,e){return v(u.isBN(t),"a","bignum"),t.cmp(e)}static ucmp(t,e){return v(u.isBN(t),"a","bignum"),t.ucmp(e)}static red(t){return new g(t)}static barrett(t){return new w(t)}static mont(t){return new S(t)}static _prime(t){if(h[t])return h[t];let e;if("p192"===t)e=new c;else if("p224"===t)e=new d;else if("p521"===t)e=new l;else if("k256"===t)e=new m;else if("p25519"===t)e=new p;else{if("p448"!==t)throw new Error(`Unknown prime: "${t}".`);e=new b}return h[t]=e,e}static prime(t){return u._prime(t).p.clone()}static pow(t,e){return 2===t?u.shift(1,e):(new u).fromNumber(t).pown(e)}static shift(t,e){return 1===t?new u(0).usetn(e,1):(new u).fromNumber(t).ishln(e)}static mask(t){return u.shift(1,t).isubn(1)}static randomBits(t,e){if(v(null!=t,"rng","rng"),v(e>>>0===e,"bits","uint32"),"object"==typeof t){v("function"==typeof t.randomBytes,"rng","rng");const r=e+7>>>3,i=8*r,s=t.randomBytes(r);if(v(Buffer.isBuffer(s),"bytes","buffer"),s.length!==r)throw new RangeError("Invalid number of bytes returned from RNG.");const n=u.fromBuffer(s);return i>e&&n.iushrn(i-e),n}v("function"==typeof t,"rng","rng");const r=t(e);if(v(u.isBN(r),"num","bignum"),E(0===r.negative,"RNG"),O(!r.red,"RNG"),r.bitLength()>e)throw new RangeError("Invalid number of bits returned from RNG.");return r}static random(t,e,r){if(e=u.cast(e,16),r=u.cast(r,16),e.cmp(r)>0)throw new RangeError("Minimum cannot be greater than maximum.");const i=r.sub(e).iabs(),s=i.bitLength();if(0===s)return e.clone();for(;;){const r=u.randomBits(t,s);if(!(r.cmp(i)>=0))return r.iadd(e),r}}static of(t,e){return(new u).of(t,e)}static fromNumber(t,e){return(new u).fromNumber(t,e)}static fromDouble(t,e){return(new u).fromDouble(t,e)}static fromBigInt(t,e){return(new u).fromBigInt(t,e)}static fromBool(t){return(new u).fromBool(t)}static fromString(t,e,r){return(new u).fromString(t,e,r)}static fromJSON(t){return(new u).fromJSON(t)}static fromBN(t){return(new u).fromBN(t)}static fromArray(t,e){return(new u).fromArray(t,e)}static fromBuffer(t,e){return(new u).fromBuffer(t,e)}static fromArrayLike(t,e){return(new u).fromArrayLike(t,e)}static decode(t,e){return(new u).decode(t,e)}static from(t,e,r){return(new u).from(t,e,r)}static cast(t,e,r){return u.isBN(t)?t:new u(t,e,r)}static isBN(t){return t instanceof u}}u.BN=u,u.wordSize=26,u.native=0;class a{constructor(t,e){this.name=t,this.p=new u(e,16),this.n=this.p.bitLength(),this.k=u.shift(1,this.n).isub(this.p),this.lo=this.p.clone(),this.one=this.p.clone()}ireduce(t){const e=0!==t.negative;let r=t.bitLength();for(I(r<=2*this.n),t.negative=0;r>this.n;)this.split(t,this.lo),this.imulK(t),t._iadd(t,this.lo),r=t.bitLength();const i=r<this.n?-1:t.ucmp(this.p);return 0===i?(t.words[0]=0,t.length=1):i>0&&t._isub(t,this.p),e&&!t.isZero()&&t._isub(this.p,t),t}split(t,e){t._split(this.n,e)}imulK(t){return t.imul(this.k)}}class c extends a{constructor(){super("p192","ffffffff ffffffff ffffffff fffffffeffffffff ffffffff")}imulK(t){const e=this.one.inject(t);return t.iushln(64)._iadd(t,e)}}class d extends a{constructor(){super("p224","ffffffff ffffffff ffffffff ffffffff00000000 00000000 00000001")}imulK(t){const e=this.one.inject(t);return t.iushln(96)._isub(t,e)}}class l extends a{constructor(){super("p521","000001ff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff")}imulK(t){return t}}class m extends a{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe fffffc2f")}split(t,e){const r=4194303,i=Math.min(t.length,9);e._alloc(i+1);for(let r=0;r<i;r++)e.words[r]=t.words[r];if(e.length=i,t.length<=9)return e._strip(),t.words[0]=0,void(t.length=1);let s=t.words[9],n=10;for(e.words[e.length++]=s&r,e._strip();n<t.length;n++){const e=0|t.words[n];t.words[n-10]=(e&r)<<4|s>>>22,s=e}s>>>=22,t.words[n-10]=s,0===s&&t.length>10?t.length-=10:t.length-=9,t._strip()}imulK(t){t._expand(t.length+2);let e=0;for(let r=0;r<t.length;r++){const i=t.words[r];e+=977*i,t.words[r]=67108863&e,e=64*i+Math.floor(e/67108864)}return 0===t.words[t.length-1]&&(t.length-=1,0===t.words[t.length-1]&&(t.length-=1)),t}}class p extends a{constructor(){super("p25519","7fffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffed")}imulK(t){let e=0;for(let r=0;r<t.length;r++){const i=19*t.words[r]+e;e=i>>>26,t.words[r]=67108863&i}return 0!==e&&(t._alloc(t.length+1),t.words[t.length++]=e),t}}class b extends a{constructor(){super("p448","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff")}imulK(t){const e=this.one.inject(t);return t.iushln(224)._iadd(t,e)}}class g{constructor(t){let e=null;"string"==typeof t&&(e=u._prime(t),t=e.p),v(u.isBN(t),"m","bignum"),O(!t.red,"reduction"),E(t.sign()>0,"reduction"),this.m=t,this.prime=e,this.mb=null,this.sm1=null}_verify1(t){E(0===t.negative,"red"),_(null!=t.red,"red")}_verify2(t,e){E(0==(t.negative|e.negative),"red"),_(null!=t.red&&t.red===e.red,"red")}get mont(){return!1}get coprime(){return!1}precompute(){if(null===this.sm1&&5===this.m.andln(7)){const t=new u(2).toRed(this),e=this.m.subn(1).iushrn(2);this.sm1=this.pow(t,e)}return this}convertTo(t){const e=t.mod(this.m);return e.red=this,e}convertFrom(t){const e=t.clone();return e.red=null,e}intTo(t){return t}intFrom(t){return t}imod(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.imod(this.m)._forceRed(this)}iadd(t,e){return this._verify2(t,e),t._iadd(t,e),t.ucmp(this.m)>=0&&t._isub(t,this.m),t}add(t,e){return t.length<e.length?this.iadd(e.clone(),t):this.iadd(t.clone(),e)}iaddn(t,e){return this._verify1(t),e<0?this.isubn(t,-e):(1===this.m.length&&(e%=this.m.words[0]),t._iaddn(e),t.ucmp(this.m)>=0&&t._isub(t,this.m),t)}addn(t,e){return this.iaddn(t.clone(),e)}isub(t,e){this._verify2(t,e);const r=t.ucmp(e);return 0===r?(t.words[0]=0,t.length=1,t):(r<0?(t._isub(e,t),t._isub(this.m,t)):t._isub(t,e),t)}sub(t,e){return this.isub(t.clone(),e)}isubn(t,e){return this._verify1(t),e<0?this.iaddn(t,-e):(1===this.m.length&&(e%=this.m.words[0]),1===t.length&&t.words[0]<e?(t.words[0]=e-t.words[0],t._isub(this.m,t)):t._isubn(e),t)}subn(t,e){return this.isubn(t.clone(),e)}imul(t,e){return this._verify2(t,e),this.imod(t.imul(e))}mul(t,e){return this._verify2(t,e),this.imod(t.mul(e))}imuln(t,e){if(this._verify1(t),t.isZero())return t;if(0===e)return t.words[0]=0,t.length=1,t;const r=e<0;if(r&&(e=-e),1===this.m.length&&(e%=this.m.words[0]),t.imuln(e),e<=16)for(;t.ucmp(this.m)>=0;)t._isub(t,this.m);else this.imod(t);return r&&this.ineg(t),t}muln(t,e){return this.imuln(t.clone(),e)}idiv(t,e){return this.div(t,e)._move(t)}div(t,e){return this.mul(t,this.invert(e))}idivn(t,e){return this.divn(t,e)._move(t)}divn(t,e){return this.div(t,this.convertTo(new u(e)))}ipow(t,e,r){return this.pow(t,e,r)._move(t)}pow(t,e,r){return this._verify1(t),e.isNeg()&&(t=this.invert(t)),f&&!this.prime?this.powInt(t,e,r):null!=r?this.climb(t,e,r):1===e.length?this.pown(t,e.words[0]):this.slide(t,e)}slide(t,e){const r=new Array(16);r[0]=new u(1).toRed(this),r[1]=t;for(let e=2;e<r.length;e++)r[e]=this.mul(r[e-1],t);let i=P(e.words[e.length-1]),s=r[0],n=0,o=0;for(let t=e.length-1;t>=0;t--){const h=e.words[t];for(let e=i-1;e>=0;e--){const i=h>>e&1;s!==r[0]&&(s=this.sqr(s)),0!==i||0!==n?(n<<=1,n|=i,o+=1,4!==o&&0!=(t|e)||(s=this.mul(s,r[n]),o=0,n=0)):o=0}i=26}return s}climb(t,e,r){const i=Math.max(e.bitLength(),r>>>0),s=i+7>>>3,n=e.toArray("le",s);let o=t.clone(),h=new u(1).toRed(this),f=0;for(let t=i-1;t>=0;t--){const e=n[t>>3]>>(7&t)&1;o.cswap(h,f^e),o=this.mul(o,h),h=this.mul(h,h),f=e}return o.cswap(h,f),h}powInt(t,e,r){null===this.mb&&(this.mb=this.m.toBigInt());const i=function(t,e,r,i){return null!=i?function(t,e,r,i){const s=Math.max(e.bitLength(),i>>>0),n=s+7>>>3,o=e.toArray("le",n);let h=BigInt(1),f=0;for(let e=s-1;e>=0;e--){const i=o[e>>3]>>(7&e)&1;[t,h]=T(t,h,f^i),t=t*h%r,h=h*h%r,f=i}return[t,h]=T(t,h,f),h}(t,e,r,i):function(t,e,r){let i=BigInt(1),s=P(e.words[e.length-1]);for(let n=e.length-1;n>=0;n--){const o=e.words[n];for(let e=s-1;e>=0;e--)i=i*i%r,o>>e&1&&(i=i*t%r);s=26}return i}(t,e,r)}(this.intFrom(t.toBigInt()),e,this.mb,r),s=this.intTo(i);return u.fromBigInt(s)._forceRed(this)}ipown(t,e){return this.pown(t,e)._move(t)}pown(t,e){if(this._verify1(t),e<0&&(t=this.invert(t),e=-e),0===e)return new u(1).toRed(this);if(1===e)return t.clone();let r=t;for(let i=P(e)-2;i>=0;i--)r=this.sqr(r),e>>i&1&&(r=this.mul(r,t));return r}isqr(t){return this.imul(t,t)}sqr(t){return this.mul(t,t)}isqrt(t){return this.sqrt(t)._move(t)}sqrt(t){return this._verify1(t),3===this.m.andln(3)?this.sqrt3mod4(t):5===this.m.andln(7)?null!=this.sm1?this.sqrt5mod8sm1(t):this.sqrt5mod8(t):this.sqrt0(t)}sqrt3mod4(t){const e=this.m.addn(1).iushrn(2),r=this.pow(t,e);if(!this.sqr(r).eq(t))throw new Error("X is not a square mod P.");return r}sqrt5mod8(t){const e=new u(1).toRed(this),r=this.m.ushrn(3),i=this.add(t,t),s=this.pow(i,r),n=this.mul(i,this.sqr(s)),o=this.mul(this.mul(s,t),this.isub(n,e));if(!this.sqr(o).eq(t))throw new Error("X is not a square mod P.");return o}sqrt5mod8sm1(t){const e=this.m.addn(3).iushrn(3);let r=this.pow(t,e);if(!this.sqr(r).eq(t)&&(r=this.mul(r,this.sm1),!this.sqr(r).eq(t)))throw new Error("X is not a square mod P.");return r}sqrt0(t){if(0===this.m.cmpn(1)||!this.m.isOdd())throw new Error("Invalid prime.");switch(this.jacobi(t)){case-1:throw new Error("X is not a square mod P.");case 0:return new u(0)._forceRed(this)}const e=new u(1).toRed(this),r=this.m.subn(1),i=r.zeroBits();r.iushrn(i);const s=new u(2).toRed(this);for(;-1!==this.jacobi(s);)this.iadd(s,e);let n=this.pow(t,r),o=this.pow(s,r),h=this.pow(t,r.iaddn(1).iushrn(1)),f=i;for(;;){let t=n,r=0;for(;0!==t.cmp(e);)t=this.sqr(t),r+=1;if(0===r)break;I(r<f),t=u.shift(1,f-r-1),t=this.pow(o,t),o=this.sqr(t),h=this.mul(h,t),n=this.mul(n,o),f=r}return h}idivsqrt(t,e){return this.divsqrt(t,e)._move(t)}divsqrt(t,e){if(this._verify2(t,e),e.isZero())throw new RangeError("Not invertible.");return 3===this.m.andln(3)?this.divsqrt3mod4(t,e):null!=this.sm1&&5===this.m.andln(7)?this.divsqrt5mod8(t,e):this.sqrt(this.div(t,e))}divsqrt3mod4(t,e){const r=this.m.subn(3).iushrn(2),i=this.sqr(t),s=this.mul(i,t),n=this.mul(s,i),o=this.mul(this.sqr(e),e),h=this.pow(this.mul(n,o),r),f=this.mul(this.mul(s,e),h);if(0===this.mul(e,this.sqr(f)).cmp(t))return f;throw new Error("X is not a square mod P.")}divsqrt5mod8(t,e){const r=this.m.subn(5).iushrn(3),i=this.mul(this.sqr(e),e),s=this.mul(this.sqr(i),e),n=this.pow(this.mul(t,s),r),o=this.mul(this.mul(t,i),n),h=this.mul(e,this.sqr(o));if(0===h.cmp(t))return o;if(0===this.ineg(h).cmp(t))return this.mul(o,this.sm1);throw new Error("X is not a square mod P.")}isSquare(t){let e;return e=this.prime||this.coprime?this.legendre(t):this.m.isOdd()?this.jacobi(t):this.kronecker(t),Boolean(~e>>>31)}ishl(t,e){return this._verify1(t),this.imod(t.iushl(e))}shl(t,e){return this.ishl(t.clone(),e)}ishln(t,e){if(this._verify1(t),t.iushln(e),e<=4)for(;t.ucmp(this.m)>=0;)t._isub(t,this.m);else this.imod(t);return t}shln(t,e){return this.ishln(t.clone(),e)}ineg(t){return this._verify1(t),t.isZero()||t._isub(this.m,t),t}neg(t){return this.ineg(t.clone())}eq(t,e){return this._verify2(t,e),0===t.ucmp(e)}eqn(t,e){if(this._verify1(t),1===this.m.length)return(e%=this.m.words[0])<0&&(e+=this.m.words[0]),0===t.ucmpn(e);if(e<0){this.m._isubn(-e);const r=t.ucmp(this.m);return this.m._iaddn(-e),0===r}return 0===t.ucmpn(e)}isHigh(t){return!this.isLow(t)}isLow(t){return this._verify1(t),t.ucmp(this.m.ushrn(1))<=0}isOdd(t){return this._verify1(t),t.isOdd()}isEven(t){return this._verify1(t),t.isEven()}legendre(t){if(this._verify1(t),this.m.isEven())throw new Error("legendre: `num` must be odd.");const e=this.m.subn(1).iushrn(1),r=this.pow(t,e),i=new u(1).toRed(this),s=r.czero(),n=r.ceq(i),o=r.ceq(this.ineg(i));if(0==(s|n|o))throw new Error("Invalid prime.");return I(s+n+o===1),n-o}jacobi(t){return this._verify1(t),t.jacobi(this.m)}kronecker(t){return this._verify1(t),t.kronecker(this.m)}iinvert(t){return this.invert(t)._move(t)}invert(t){return this._verify1(t),this.prime?this.imod(t._invertp(this.m)):t.invert(this.m)._forceRed(this)}ifermat(t){return this.fermat(t)._move(t)}fermat(t){if(this._verify1(t),t.isZero()||0===this.m.cmpn(1))throw new RangeError("Not invertible.");return this.pow(t,this.m.subn(2))}[i](){return this.prime?`<Red: ${this.prime.name}>`:`<Red: ${this.m.toString(10)}>`}}class w extends g{constructor(t){super(t),this.prime=null,this.n=this.m.bitLength(),this.n%26!=0&&(this.n+=26-this.n%26),this.k=2*this.n,this.w=this.k/26,this.b=u.shift(1,this.k).div(this.m)}convertTo(t){return t.length>this.w?super.convertTo(t):this.imod(t.clone())}_shift(t){let e=0,r=this.w;for(;r<t.length;)t.words[e++]=t.words[r++];0===e&&(t.words[e++]=0),t.length=e}imod(t){const e=t.negative;I(t.length<=this.w),t.negative=0;const r=t.mul(this.b);return this._shift(r),t._isub(t,r.mul(this.m)),t.ucmp(this.m)>=0&&t._isub(t,this.m),e&&!t.isZero()&&t._isub(this.m,t),t.red=this,t}}class S extends g{constructor(t){super(t),this.prime=null,this.n=this.m.bitLength(),this.n%26!=0&&(this.n+=26-this.n%26),this.r=u.shift(1,this.n),this.r2=u.shift(1,2*this.n).imod(this.m),this.ri=this.r._invertp(this.m).imod(this.m),this.mi=this.r.mul(this.ri).isubn(1).div(this.m),this.rib=null}get mont(){return!0}get coprime(){return!0}convertTo(t){return this.imod(t.ushln(this.n))}convertFrom(t){const e=this.imod(t.mul(this.ri));return e.red=null,e}intTo(t){return(t<<BigInt(this.n))%this.mb}intFrom(t){return null===this.rib&&(this.rib=this.ri.toBigInt()),t*this.rib%this.mb}iaddn(t,e){return this.iadd(t,this.convertTo(new u(e)))}isubn(t,e){return this.isub(t,this.convertTo(new u(e)))}imul(t,e){return this.mul(t,e)._move(t)}mul(t,e){if(this._verify2(t,e),t.isZero()||e.isZero())return new u(0)._forceRed(this);const r=t.mul(e),i=r.umaskn(this.n).mul(this.mi).iumaskn(this.n),s=r.iadd(i.mul(this.m)).iushrn(this.n);return s.ucmp(this.m)>=0&&s._isub(s,this.m),s._forceRed(this)}imuln(t,e){if(this._verify1(t),t.isZero())return t;if(0===e)return t.words[0]=0,t.length=1,t;const r=e<0;r&&(e=-e),1===this.m.length&&(e%=this.m.words[0]);const i=P(e);if(i>5)this.imul(t,this.convertTo(new u(e)));else if(0==(e&e-1))for(let e=0;e<i-1;e++)this.iadd(t,t);else{const r=t.clone();for(let s=i-2;s>=0;s--)this.iadd(t,t),e>>s&1&&this.iadd(t,r)}return r&&this.ineg(t),t}eqn(t,e){return this._verify1(t),0===e?t.isZero():0===t.ucmp(this.convertTo(new u(e)))}isLow(t){return this._verify1(t),this.convertFrom(t).ucmp(this.m.ushrn(1))<=0}isOdd(t){return this._verify1(t),this.convertFrom(t).isOdd()}isEven(t){return this._verify1(t),this.convertFrom(t).isEven()}invert(t){return this._verify1(t),this.imod(t._invertp(this.m).mul(this.r2))}}function y(t,e,r){const i=new t(e);return t.captureStackTrace&&t.captureStackTrace(i,r),i}function I(t,e){if(!t)throw y(Error,e||"Assertion failed.",I)}function v(t,e,r){if(!t)throw y(TypeError,`"${e}" must be a(n) ${r}.`,v)}function E(t,e){if(!t)throw y(RangeError,`"${e}" only works with positive numbers.`,E)}function _(t,e){if(!t)throw y(TypeError,`"${e}" only works with red numbers.`,_)}function O(t,e){if(!t)throw y(TypeError,`"${e}" only works with normal numbers.`,O)}function N(t){if(!t)throw y(RangeError,"Cannot divide by zero.",N)}function B(t){return Number.isSafeInteger(t)}function A(t){return B(t)&&t>=-67108863&&t<=67108863}function M(t){if(null==t)return 10;if("number"==typeof t)return t;switch(t){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function P(t){if(Math.clz32)return 32-Math.clz32(t);let e=t,r=0;return e>=4096&&(r+=13,e>>>=13),e>=64&&(r+=7,e>>>=7),e>=8&&(r+=4,e>>>=4),e>=2&&(r+=2,e>>>=2),r+e}function R(t){if(0===t)return 26;let e=t,r=0;return 0==(8191&e)&&(r+=13,e>>>=13),0==(127&e)&&(r+=7,e>>>=7),0==(15&e)&&(r+=4,e>>>=4),0==(3&e)&&(r+=2,e>>>=2),0==(1&e)&&(r+=1),r}function x(t,e,r){const i=Math.min(t.length,r);let s=0,n=0;for(let r=e;r<i;r++){const e=t.charCodeAt(r)-48;let i;s<<=4,i=e>=49&&e<=54?e-49+10:e>=17&&e<=22?e-17+10:e,s|=i,n|=i}if(-16&n)throw new Error("Invalid string.");return s}function k(t,e,r,i){const s=Math.min(t.length,r);let n=0;for(let r=e;r<s;r++){const e=t.charCodeAt(r)-48;let s;if(n*=i,s=e>=49?e-49+10:e>=17?e-17+10:e,e<0||e>207||s>=i)throw new Error("Invalid string.");n+=s}return n}function T(t,e,r){const i=BigInt(1),s=BigInt(r);return[t*(s^i)|e*s,e*(s^i)|t*s]}function U(t,e,r){const i=t.length+e.length;r.negative=t.negative^e.negative,r._alloc(i),r.length=i;const s=t.words[0]*e.words[0],n=67108863&s;let o=s/67108864|0,h=1;for(r.words[0]=n;h<r.length-1;h++){let i=o>>>26,s=67108863&o;const n=Math.max(0,h-t.length+1),f=Math.min(h,e.length-1);for(let r=n;r<=f;r++){const n=h-r,o=t.words[n]*e.words[r]+s;i+=o/67108864|0,s=67108863&o}r.words[h]=0|s,o=0|i}return 0!==o?r.words[h]=0|o:r.length-=1,r._strip()}function z(t,e,r){const i=t.length+e.length;r.negative=t.negative^e.negative,r._alloc(i),r.length=i;let s=0,n=0,o=0;for(;o<r.length-1;o++){let i=n;n=0;let h=67108863&s;const f=Math.max(0,o-t.length+1),u=Math.min(o,e.length-1);for(let r=f;r<=u;r++){const s=o-r,f=t.words[s]*e.words[r];let u=67108863&f;i=i+(f/67108864|0)|0,u=u+h|0,h=67108863&u,i=i+(u>>>26)|0,n+=i>>>26,i&=67108863}r.words[o]=h,s=i,i=n}return 0!==s?r.words[o]=s:r.length-=1,r._strip()}function C(t,e,r){const i=t.words,s=e.words,n=r.words,o=0|i[0],h=8191&o,f=o>>>13,u=0|i[1],a=8191&u,c=u>>>13,d=0|i[2],l=8191&d,m=d>>>13,p=0|i[3],b=8191&p,g=p>>>13,w=0|i[4],S=8191&w,y=w>>>13,I=0|i[5],v=8191&I,E=I>>>13,_=0|i[6],O=8191&_,N=_>>>13,B=0|i[7],A=8191&B,M=B>>>13,P=0|i[8],R=8191&P,x=P>>>13,k=0|i[9],T=8191&k,U=k>>>13,z=0|s[0],C=8191&z,q=z>>>13,H=0|s[1],L=8191&H,D=H>>>13,V=0|s[2],F=8191&V,K=V>>>13,j=0|s[3],W=8191&j,Y=j>>>13,J=0|s[4],X=8191&J,G=J>>>13,Z=0|s[5],$=8191&Z,Q=Z>>>13,tt=0|s[6],et=8191&tt,rt=tt>>>13,it=0|s[7],st=8191&it,nt=it>>>13,ot=0|s[8],ht=8191&ot,ft=ot>>>13,ut=0|s[9],at=8191&ut,ct=ut>>>13;let dt,lt,mt,pt=0;r.negative=t.negative^e.negative,r._alloc(20),r.length=19,dt=Math.imul(h,C),lt=Math.imul(h,q),lt=lt+Math.imul(f,C)|0,mt=Math.imul(f,q);let bt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(bt>>>26)|0,bt&=67108863,dt=Math.imul(a,C),lt=Math.imul(a,q),lt=lt+Math.imul(c,C)|0,mt=Math.imul(c,q),dt=dt+Math.imul(h,L)|0,lt=lt+Math.imul(h,D)|0,lt=lt+Math.imul(f,L)|0,mt=mt+Math.imul(f,D)|0;let gt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(gt>>>26)|0,gt&=67108863,dt=Math.imul(l,C),lt=Math.imul(l,q),lt=lt+Math.imul(m,C)|0,mt=Math.imul(m,q),dt=dt+Math.imul(a,L)|0,lt=lt+Math.imul(a,D)|0,lt=lt+Math.imul(c,L)|0,mt=mt+Math.imul(c,D)|0,dt=dt+Math.imul(h,F)|0,lt=lt+Math.imul(h,K)|0,lt=lt+Math.imul(f,F)|0,mt=mt+Math.imul(f,K)|0;let wt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(wt>>>26)|0,wt&=67108863,dt=Math.imul(b,C),lt=Math.imul(b,q),lt=lt+Math.imul(g,C)|0,mt=Math.imul(g,q),dt=dt+Math.imul(l,L)|0,lt=lt+Math.imul(l,D)|0,lt=lt+Math.imul(m,L)|0,mt=mt+Math.imul(m,D)|0,dt=dt+Math.imul(a,F)|0,lt=lt+Math.imul(a,K)|0,lt=lt+Math.imul(c,F)|0,mt=mt+Math.imul(c,K)|0,dt=dt+Math.imul(h,W)|0,lt=lt+Math.imul(h,Y)|0,lt=lt+Math.imul(f,W)|0,mt=mt+Math.imul(f,Y)|0;let St=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(St>>>26)|0,St&=67108863,dt=Math.imul(S,C),lt=Math.imul(S,q),lt=lt+Math.imul(y,C)|0,mt=Math.imul(y,q),dt=dt+Math.imul(b,L)|0,lt=lt+Math.imul(b,D)|0,lt=lt+Math.imul(g,L)|0,mt=mt+Math.imul(g,D)|0,dt=dt+Math.imul(l,F)|0,lt=lt+Math.imul(l,K)|0,lt=lt+Math.imul(m,F)|0,mt=mt+Math.imul(m,K)|0,dt=dt+Math.imul(a,W)|0,lt=lt+Math.imul(a,Y)|0,lt=lt+Math.imul(c,W)|0,mt=mt+Math.imul(c,Y)|0,dt=dt+Math.imul(h,X)|0,lt=lt+Math.imul(h,G)|0,lt=lt+Math.imul(f,X)|0,mt=mt+Math.imul(f,G)|0;let yt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(yt>>>26)|0,yt&=67108863,dt=Math.imul(v,C),lt=Math.imul(v,q),lt=lt+Math.imul(E,C)|0,mt=Math.imul(E,q),dt=dt+Math.imul(S,L)|0,lt=lt+Math.imul(S,D)|0,lt=lt+Math.imul(y,L)|0,mt=mt+Math.imul(y,D)|0,dt=dt+Math.imul(b,F)|0,lt=lt+Math.imul(b,K)|0,lt=lt+Math.imul(g,F)|0,mt=mt+Math.imul(g,K)|0,dt=dt+Math.imul(l,W)|0,lt=lt+Math.imul(l,Y)|0,lt=lt+Math.imul(m,W)|0,mt=mt+Math.imul(m,Y)|0,dt=dt+Math.imul(a,X)|0,lt=lt+Math.imul(a,G)|0,lt=lt+Math.imul(c,X)|0,mt=mt+Math.imul(c,G)|0,dt=dt+Math.imul(h,$)|0,lt=lt+Math.imul(h,Q)|0,lt=lt+Math.imul(f,$)|0,mt=mt+Math.imul(f,Q)|0;let It=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(It>>>26)|0,It&=67108863,dt=Math.imul(O,C),lt=Math.imul(O,q),lt=lt+Math.imul(N,C)|0,mt=Math.imul(N,q),dt=dt+Math.imul(v,L)|0,lt=lt+Math.imul(v,D)|0,lt=lt+Math.imul(E,L)|0,mt=mt+Math.imul(E,D)|0,dt=dt+Math.imul(S,F)|0,lt=lt+Math.imul(S,K)|0,lt=lt+Math.imul(y,F)|0,mt=mt+Math.imul(y,K)|0,dt=dt+Math.imul(b,W)|0,lt=lt+Math.imul(b,Y)|0,lt=lt+Math.imul(g,W)|0,mt=mt+Math.imul(g,Y)|0,dt=dt+Math.imul(l,X)|0,lt=lt+Math.imul(l,G)|0,lt=lt+Math.imul(m,X)|0,mt=mt+Math.imul(m,G)|0,dt=dt+Math.imul(a,$)|0,lt=lt+Math.imul(a,Q)|0,lt=lt+Math.imul(c,$)|0,mt=mt+Math.imul(c,Q)|0,dt=dt+Math.imul(h,et)|0,lt=lt+Math.imul(h,rt)|0,lt=lt+Math.imul(f,et)|0,mt=mt+Math.imul(f,rt)|0;let vt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(vt>>>26)|0,vt&=67108863,dt=Math.imul(A,C),lt=Math.imul(A,q),lt=lt+Math.imul(M,C)|0,mt=Math.imul(M,q),dt=dt+Math.imul(O,L)|0,lt=lt+Math.imul(O,D)|0,lt=lt+Math.imul(N,L)|0,mt=mt+Math.imul(N,D)|0,dt=dt+Math.imul(v,F)|0,lt=lt+Math.imul(v,K)|0,lt=lt+Math.imul(E,F)|0,mt=mt+Math.imul(E,K)|0,dt=dt+Math.imul(S,W)|0,lt=lt+Math.imul(S,Y)|0,lt=lt+Math.imul(y,W)|0,mt=mt+Math.imul(y,Y)|0,dt=dt+Math.imul(b,X)|0,lt=lt+Math.imul(b,G)|0,lt=lt+Math.imul(g,X)|0,mt=mt+Math.imul(g,G)|0,dt=dt+Math.imul(l,$)|0,lt=lt+Math.imul(l,Q)|0,lt=lt+Math.imul(m,$)|0,mt=mt+Math.imul(m,Q)|0,dt=dt+Math.imul(a,et)|0,lt=lt+Math.imul(a,rt)|0,lt=lt+Math.imul(c,et)|0,mt=mt+Math.imul(c,rt)|0,dt=dt+Math.imul(h,st)|0,lt=lt+Math.imul(h,nt)|0,lt=lt+Math.imul(f,st)|0,mt=mt+Math.imul(f,nt)|0;let Et=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Et>>>26)|0,Et&=67108863,dt=Math.imul(R,C),lt=Math.imul(R,q),lt=lt+Math.imul(x,C)|0,mt=Math.imul(x,q),dt=dt+Math.imul(A,L)|0,lt=lt+Math.imul(A,D)|0,lt=lt+Math.imul(M,L)|0,mt=mt+Math.imul(M,D)|0,dt=dt+Math.imul(O,F)|0,lt=lt+Math.imul(O,K)|0,lt=lt+Math.imul(N,F)|0,mt=mt+Math.imul(N,K)|0,dt=dt+Math.imul(v,W)|0,lt=lt+Math.imul(v,Y)|0,lt=lt+Math.imul(E,W)|0,mt=mt+Math.imul(E,Y)|0,dt=dt+Math.imul(S,X)|0,lt=lt+Math.imul(S,G)|0,lt=lt+Math.imul(y,X)|0,mt=mt+Math.imul(y,G)|0,dt=dt+Math.imul(b,$)|0,lt=lt+Math.imul(b,Q)|0,lt=lt+Math.imul(g,$)|0,mt=mt+Math.imul(g,Q)|0,dt=dt+Math.imul(l,et)|0,lt=lt+Math.imul(l,rt)|0,lt=lt+Math.imul(m,et)|0,mt=mt+Math.imul(m,rt)|0,dt=dt+Math.imul(a,st)|0,lt=lt+Math.imul(a,nt)|0,lt=lt+Math.imul(c,st)|0,mt=mt+Math.imul(c,nt)|0,dt=dt+Math.imul(h,ht)|0,lt=lt+Math.imul(h,ft)|0,lt=lt+Math.imul(f,ht)|0,mt=mt+Math.imul(f,ft)|0;let _t=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(_t>>>26)|0,_t&=67108863,dt=Math.imul(T,C),lt=Math.imul(T,q),lt=lt+Math.imul(U,C)|0,mt=Math.imul(U,q),dt=dt+Math.imul(R,L)|0,lt=lt+Math.imul(R,D)|0,lt=lt+Math.imul(x,L)|0,mt=mt+Math.imul(x,D)|0,dt=dt+Math.imul(A,F)|0,lt=lt+Math.imul(A,K)|0,lt=lt+Math.imul(M,F)|0,mt=mt+Math.imul(M,K)|0,dt=dt+Math.imul(O,W)|0,lt=lt+Math.imul(O,Y)|0,lt=lt+Math.imul(N,W)|0,mt=mt+Math.imul(N,Y)|0,dt=dt+Math.imul(v,X)|0,lt=lt+Math.imul(v,G)|0,lt=lt+Math.imul(E,X)|0,mt=mt+Math.imul(E,G)|0,dt=dt+Math.imul(S,$)|0,lt=lt+Math.imul(S,Q)|0,lt=lt+Math.imul(y,$)|0,mt=mt+Math.imul(y,Q)|0,dt=dt+Math.imul(b,et)|0,lt=lt+Math.imul(b,rt)|0,lt=lt+Math.imul(g,et)|0,mt=mt+Math.imul(g,rt)|0,dt=dt+Math.imul(l,st)|0,lt=lt+Math.imul(l,nt)|0,lt=lt+Math.imul(m,st)|0,mt=mt+Math.imul(m,nt)|0,dt=dt+Math.imul(a,ht)|0,lt=lt+Math.imul(a,ft)|0,lt=lt+Math.imul(c,ht)|0,mt=mt+Math.imul(c,ft)|0,dt=dt+Math.imul(h,at)|0,lt=lt+Math.imul(h,ct)|0,lt=lt+Math.imul(f,at)|0,mt=mt+Math.imul(f,ct)|0;let Ot=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,dt=Math.imul(T,L),lt=Math.imul(T,D),lt=lt+Math.imul(U,L)|0,mt=Math.imul(U,D),dt=dt+Math.imul(R,F)|0,lt=lt+Math.imul(R,K)|0,lt=lt+Math.imul(x,F)|0,mt=mt+Math.imul(x,K)|0,dt=dt+Math.imul(A,W)|0,lt=lt+Math.imul(A,Y)|0,lt=lt+Math.imul(M,W)|0,mt=mt+Math.imul(M,Y)|0,dt=dt+Math.imul(O,X)|0,lt=lt+Math.imul(O,G)|0,lt=lt+Math.imul(N,X)|0,mt=mt+Math.imul(N,G)|0,dt=dt+Math.imul(v,$)|0,lt=lt+Math.imul(v,Q)|0,lt=lt+Math.imul(E,$)|0,mt=mt+Math.imul(E,Q)|0,dt=dt+Math.imul(S,et)|0,lt=lt+Math.imul(S,rt)|0,lt=lt+Math.imul(y,et)|0,mt=mt+Math.imul(y,rt)|0,dt=dt+Math.imul(b,st)|0,lt=lt+Math.imul(b,nt)|0,lt=lt+Math.imul(g,st)|0,mt=mt+Math.imul(g,nt)|0,dt=dt+Math.imul(l,ht)|0,lt=lt+Math.imul(l,ft)|0,lt=lt+Math.imul(m,ht)|0,mt=mt+Math.imul(m,ft)|0,dt=dt+Math.imul(a,at)|0,lt=lt+Math.imul(a,ct)|0,lt=lt+Math.imul(c,at)|0,mt=mt+Math.imul(c,ct)|0;let Nt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,dt=Math.imul(T,F),lt=Math.imul(T,K),lt=lt+Math.imul(U,F)|0,mt=Math.imul(U,K),dt=dt+Math.imul(R,W)|0,lt=lt+Math.imul(R,Y)|0,lt=lt+Math.imul(x,W)|0,mt=mt+Math.imul(x,Y)|0,dt=dt+Math.imul(A,X)|0,lt=lt+Math.imul(A,G)|0,lt=lt+Math.imul(M,X)|0,mt=mt+Math.imul(M,G)|0,dt=dt+Math.imul(O,$)|0,lt=lt+Math.imul(O,Q)|0,lt=lt+Math.imul(N,$)|0,mt=mt+Math.imul(N,Q)|0,dt=dt+Math.imul(v,et)|0,lt=lt+Math.imul(v,rt)|0,lt=lt+Math.imul(E,et)|0,mt=mt+Math.imul(E,rt)|0,dt=dt+Math.imul(S,st)|0,lt=lt+Math.imul(S,nt)|0,lt=lt+Math.imul(y,st)|0,mt=mt+Math.imul(y,nt)|0,dt=dt+Math.imul(b,ht)|0,lt=lt+Math.imul(b,ft)|0,lt=lt+Math.imul(g,ht)|0,mt=mt+Math.imul(g,ft)|0,dt=dt+Math.imul(l,at)|0,lt=lt+Math.imul(l,ct)|0,lt=lt+Math.imul(m,at)|0,mt=mt+Math.imul(m,ct)|0;let Bt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,dt=Math.imul(T,W),lt=Math.imul(T,Y),lt=lt+Math.imul(U,W)|0,mt=Math.imul(U,Y),dt=dt+Math.imul(R,X)|0,lt=lt+Math.imul(R,G)|0,lt=lt+Math.imul(x,X)|0,mt=mt+Math.imul(x,G)|0,dt=dt+Math.imul(A,$)|0,lt=lt+Math.imul(A,Q)|0,lt=lt+Math.imul(M,$)|0,mt=mt+Math.imul(M,Q)|0,dt=dt+Math.imul(O,et)|0,lt=lt+Math.imul(O,rt)|0,lt=lt+Math.imul(N,et)|0,mt=mt+Math.imul(N,rt)|0,dt=dt+Math.imul(v,st)|0,lt=lt+Math.imul(v,nt)|0,lt=lt+Math.imul(E,st)|0,mt=mt+Math.imul(E,nt)|0,dt=dt+Math.imul(S,ht)|0,lt=lt+Math.imul(S,ft)|0,lt=lt+Math.imul(y,ht)|0,mt=mt+Math.imul(y,ft)|0,dt=dt+Math.imul(b,at)|0,lt=lt+Math.imul(b,ct)|0,lt=lt+Math.imul(g,at)|0,mt=mt+Math.imul(g,ct)|0;let At=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(At>>>26)|0,At&=67108863,dt=Math.imul(T,X),lt=Math.imul(T,G),lt=lt+Math.imul(U,X)|0,mt=Math.imul(U,G),dt=dt+Math.imul(R,$)|0,lt=lt+Math.imul(R,Q)|0,lt=lt+Math.imul(x,$)|0,mt=mt+Math.imul(x,Q)|0,dt=dt+Math.imul(A,et)|0,lt=lt+Math.imul(A,rt)|0,lt=lt+Math.imul(M,et)|0,mt=mt+Math.imul(M,rt)|0,dt=dt+Math.imul(O,st)|0,lt=lt+Math.imul(O,nt)|0,lt=lt+Math.imul(N,st)|0,mt=mt+Math.imul(N,nt)|0,dt=dt+Math.imul(v,ht)|0,lt=lt+Math.imul(v,ft)|0,lt=lt+Math.imul(E,ht)|0,mt=mt+Math.imul(E,ft)|0,dt=dt+Math.imul(S,at)|0,lt=lt+Math.imul(S,ct)|0,lt=lt+Math.imul(y,at)|0,mt=mt+Math.imul(y,ct)|0;let Mt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,dt=Math.imul(T,$),lt=Math.imul(T,Q),lt=lt+Math.imul(U,$)|0,mt=Math.imul(U,Q),dt=dt+Math.imul(R,et)|0,lt=lt+Math.imul(R,rt)|0,lt=lt+Math.imul(x,et)|0,mt=mt+Math.imul(x,rt)|0,dt=dt+Math.imul(A,st)|0,lt=lt+Math.imul(A,nt)|0,lt=lt+Math.imul(M,st)|0,mt=mt+Math.imul(M,nt)|0,dt=dt+Math.imul(O,ht)|0,lt=lt+Math.imul(O,ft)|0,lt=lt+Math.imul(N,ht)|0,mt=mt+Math.imul(N,ft)|0,dt=dt+Math.imul(v,at)|0,lt=lt+Math.imul(v,ct)|0,lt=lt+Math.imul(E,at)|0,mt=mt+Math.imul(E,ct)|0;let Pt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,dt=Math.imul(T,et),lt=Math.imul(T,rt),lt=lt+Math.imul(U,et)|0,mt=Math.imul(U,rt),dt=dt+Math.imul(R,st)|0,lt=lt+Math.imul(R,nt)|0,lt=lt+Math.imul(x,st)|0,mt=mt+Math.imul(x,nt)|0,dt=dt+Math.imul(A,ht)|0,lt=lt+Math.imul(A,ft)|0,lt=lt+Math.imul(M,ht)|0,mt=mt+Math.imul(M,ft)|0,dt=dt+Math.imul(O,at)|0,lt=lt+Math.imul(O,ct)|0,lt=lt+Math.imul(N,at)|0,mt=mt+Math.imul(N,ct)|0;let Rt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,dt=Math.imul(T,st),lt=Math.imul(T,nt),lt=lt+Math.imul(U,st)|0,mt=Math.imul(U,nt),dt=dt+Math.imul(R,ht)|0,lt=lt+Math.imul(R,ft)|0,lt=lt+Math.imul(x,ht)|0,mt=mt+Math.imul(x,ft)|0,dt=dt+Math.imul(A,at)|0,lt=lt+Math.imul(A,ct)|0,lt=lt+Math.imul(M,at)|0,mt=mt+Math.imul(M,ct)|0;let xt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(xt>>>26)|0,xt&=67108863,dt=Math.imul(T,ht),lt=Math.imul(T,ft),lt=lt+Math.imul(U,ht)|0,mt=Math.imul(U,ft),dt=dt+Math.imul(R,at)|0,lt=lt+Math.imul(R,ct)|0,lt=lt+Math.imul(x,at)|0,mt=mt+Math.imul(x,ct)|0;let kt=(pt+dt|0)+((8191&lt)<<13)|0;pt=(mt+(lt>>>13)|0)+(kt>>>26)|0,kt&=67108863,dt=Math.imul(T,at),lt=Math.imul(T,ct),lt=lt+Math.imul(U,at)|0,mt=Math.imul(U,ct);let Tt=(pt+dt|0)+((8191&lt)<<13)|0;return pt=(mt+(lt>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,n[0]=bt,n[1]=gt,n[2]=wt,n[3]=St,n[4]=yt,n[5]=It,n[6]=vt,n[7]=Et,n[8]=_t,n[9]=Ot,n[10]=Nt,n[11]=Bt,n[12]=At,n[13]=Mt,n[14]=Pt,n[15]=Rt,n[16]=xt,n[17]=kt,n[18]=Tt,0!==pt&&(n[19]=pt,r.length+=1),r}Math.imul||(C=U),u.Red=g,t.exports=u},587:(t,e,r)=>{const i=r(7494),s=0===new Int8Array(new Int16Array([1]).buffer)[0];class n{constructor(){this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),this.pos=-1,s&&(this.bytes=Buffer.alloc(64))}init(t,e,r){if(null==r&&(r=0),i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(Number.isSafeInteger(r)),16!==t.length&&32!==t.length)throw new RangeError("Invalid key size.");if(e.length>=24&&(t=n.derive(t,e.slice(0,16)),e=e.slice(16)),this.state[0]=1634760805,this.state[1]=t.length<32?824206446:857760878,this.state[2]=t.length<32?2036477238:2036477234,this.state[3]=1797285236,this.state[4]=f(t,0),this.state[5]=f(t,4),this.state[6]=f(t,8),this.state[7]=f(t,12),this.state[8]=f(t,16%t.length),this.state[9]=f(t,20%t.length),this.state[10]=f(t,24%t.length),this.state[11]=f(t,28%t.length),this.state[12]=r>>>0,8===e.length)this.state[13]=r/4294967296>>>0,this.state[14]=f(e,0),this.state[15]=f(e,4);else if(12===e.length)this.state[13]=f(e,0),this.state[14]=f(e,4),this.state[15]=f(e,8);else{if(16!==e.length)throw new RangeError("Invalid nonce size.");this.state[12]=f(e,0),this.state[13]=f(e,4),this.state[14]=f(e,8),this.state[15]=f(e,12)}return this.pos=0,this}encrypt(t){if(i(Buffer.isBuffer(t)),-1===this.pos)throw new Error("Context is not initialized.");for(let e=0;e<t.length;e++)0==(63&this.pos)&&(this._block(),this.pos=0),t[e]^=this.bytes[this.pos++];return t}_block(){for(let t=0;t<16;t++)this.stream[t]=this.state[t];for(let t=0;t<10;t++)o(this.stream,0,4,8,12),o(this.stream,1,5,9,13),o(this.stream,2,6,10,14),o(this.stream,3,7,11,15),o(this.stream,0,5,10,15),o(this.stream,1,6,11,12),o(this.stream,2,7,8,13),o(this.stream,3,4,9,14);for(let t=0;t<16;t++)this.stream[t]+=this.state[t];if(s)for(let t=0;t<16;t++)u(this.bytes,this.stream[t],4*t);this.state[12]+=1,0===this.state[12]&&(this.state[13]+=1)}destroy(){for(let t=0;t<16;t++)this.state[t]=0,this.stream[t]=0;if(s)for(let t=0;t<64;t++)this.bytes[t]=0;return this.pos=-1,this}static derive(t,e){if(i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),16!==t.length&&32!==t.length)throw new RangeError("Invalid key size.");if(16!==e.length)throw new RangeError("Invalid nonce size.");const r=new Uint32Array(16);r[0]=1634760805,r[1]=t.length<32?824206446:857760878,r[2]=t.length<32?2036477238:2036477234,r[3]=1797285236,r[4]=f(t,0),r[5]=f(t,4),r[6]=f(t,8),r[7]=f(t,12),r[8]=f(t,16%t.length),r[9]=f(t,20%t.length),r[10]=f(t,24%t.length),r[11]=f(t,28%t.length),r[12]=f(e,0),r[13]=f(e,4),r[14]=f(e,8),r[15]=f(e,12);for(let t=0;t<10;t++)o(r,0,4,8,12),o(r,1,5,9,13),o(r,2,6,10,14),o(r,3,7,11,15),o(r,0,5,10,15),o(r,1,6,11,12),o(r,2,7,8,13),o(r,3,4,9,14);const s=Buffer.alloc(32);return u(s,r[0],0),u(s,r[1],4),u(s,r[2],8),u(s,r[3],12),u(s,r[12],16),u(s,r[13],20),u(s,r[14],24),u(s,r[15],28),s}}function o(t,e,r,i,s){t[e]+=t[r],t[s]=h(t[s]^t[e],16),t[i]+=t[s],t[r]=h(t[r]^t[i],12),t[e]+=t[r],t[s]=h(t[s]^t[e],8),t[i]+=t[s],t[r]=h(t[r]^t[i],7)}function h(t,e){return t<<e|t>>>32-e}function f(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function u(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}n.native=0,t.exports=n},1637:(t,e,r)=>{const i=r(7494),s=r(6401),n=r(627),o=r(4189),h=r(2534),f=r(5258),u=r(5582);t.exports=class{constructor(t,e,r){i("string"==typeof t),i(e),this.id=t,this.type="ecdsa",this.hash=e,this.native=0,this._pre=r||null,this._curve=null,this._schnorr=null}get curve(){return this._curve||(this._curve=u.curve(this.id,this._pre),this._curve.precompute(n),this._pre=null),this._curve}get schnorr(){return this._schnorr||(this._schnorr=new h(this.curve,this.hash)),this._schnorr}get size(){return this.curve.fieldSize}get bits(){return this.curve.fieldBits}privateKeyGenerate(){const t=this.curve.randomScalar(n);return this.curve.encodeScalar(t)}privateKeyVerify(t){let e;i(Buffer.isBuffer(t));try{e=this.curve.decodeScalar(t)}catch(t){return!1}return!e.isZero()&&e.cmp(this.curve.n)<0}privateKeyExport(t){const e=this.publicKeyCreate(t,!1),{x:r,y:i}=this.publicKeyExport(e);return{d:Buffer.from(t),x:r,y:i}}privateKeyImport(t){i(t&&"object"==typeof t);const e=s.decode(t.d,this.curve.endian);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.encodeScalar(e)}privateKeyTweakAdd(t,e){const r=this.curve.decodeScalar(e);if(r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const s=i.add(r).imod(this.curve.n);if(s.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(s)}privateKeyTweakMul(t,e){const r=this.curve.decodeScalar(e);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const i=this.curve.decodeScalar(t);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const s=i.mul(r).imod(this.curve.n);if(s.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(s)}privateKeyReduce(t){i(Buffer.isBuffer(t)),t.length>this.curve.scalarSize&&(t=t.slice(0,this.curve.scalarSize));const e=s.decode(t,this.curve.endian).imod(this.curve.n);if(e.isZero())throw new Error("Invalid private key.");return this.curve.encodeScalar(e)}privateKeyNegate(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=e.neg().imod(this.curve.n);return this.curve.encodeScalar(r)}privateKeyInvert(t){const e=this.curve.decodeScalar(t);if(e.isZero()||e.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");const r=e.invert(this.curve.n);return this.curve.encodeScalar(r)}publicKeyCreate(t,e){const r=this.curve.decodeScalar(t);if(r.isZero()||r.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");return this.curve.g.mulBlind(r).encode(e)}publicKeyConvert(t,e){return this.curve.decodePoint(t).encode(e)}publicKeyFromUniform(t,e){const r=this.curve.decodeUniform(t);return this.curve.pointFromUniform(r).encode(e)}publicKeyToUniform(t,e=n.randomInt()){const r=this.curve.decodePoint(t),i=this.curve.pointToUniform(r,e);return this.curve.encodeUniform(i,n)}publicKeyFromHash(t,e){return this.curve.pointFromHash(t).encode(e)}publicKeyToHash(t){const e=this.curve.decodePoint(t);return this.curve.pointToHash(e,n)}publicKeyVerify(t){i(Buffer.isBuffer(t));try{this.curve.decodePoint(t)}catch(t){return!1}return!0}publicKeyExport(t){const{x:e,y:r}=this.curve.decodePoint(t);return{x:this.curve.encodeField(e.fromRed()),y:this.curve.encodeField(r.fromRed())}}publicKeyImport(t,e){i(t&&"object"==typeof t);const r=s.decode(t.x,this.curve.endian);if(r.cmp(this.curve.p)>=0)throw new Error("Invalid point.");if(null!=t.y){const i=s.decode(t.y,this.curve.endian);if(i.cmp(this.curve.p)>=0)throw new Error("Invalid point.");const n=this.curve.point(r,i);if(!n.validate())throw new Error("Invalid point.");return n.encode(e)}return this.curve.pointFromX(r,t.sign).encode(e)}publicKeyTweakAdd(t,e,r){const i=this.curve.decodeScalar(e);if(i.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");const s=this.curve.decodePoint(t);return this.curve.g.jmul(i).add(s).encode(r)}publicKeyTweakMul(t,e,r){const i=this.curve.decodeScalar(e);if(i.isZero()||i.cmp(this.curve.n)>=0)throw new Error("Invalid scalar.");return this.curve.decodePoint(t).mul(i).encode(r)}publicKeyCombine(t,e){i(Array.isArray(t));let r=this.curve.jpoint();for(const e of t){const t=this.curve.decodePoint(e);r=r.add(t)}return r.encode(e)}publicKeyNegate(t,e){return this.curve.decodePoint(t).neg().encode(e)}signatureNormalize(t){const[e,r]=this._decodeCompact(t);return r.cmp(this.curve.nh)>0&&r.ineg().imod(this.curve.n),this._encodeCompact(e,r)}signatureNormalizeDER(t){const[e,r]=this._decodeDER(t,!1);return r.cmp(this.curve.nh)>0&&r.ineg().imod(this.curve.n),this._encodeDER(e,r)}signatureExport(t){const[e,r]=this._decodeCompact(t);return this._encodeDER(e,r)}signatureImport(t){const[e,r]=this._decodeDER(t,!1);return this._encodeCompact(e,r)}isLowS(t){let e;i(Buffer.isBuffer(t));try{[,e]=this._decodeCompact(t)}catch(t){return!1}return e.cmp(this.curve.nh)<=0}isLowDER(t){let e;i(Buffer.isBuffer(t));try{[,e]=this._decodeDER(t,!1)}catch(t){return!1}return e.cmp(this.curve.nh)<=0}sign(t,e){const[r,i]=this._sign(t,e);return this._encodeCompact(r,i)}signRecoverable(t,e){const[r,i,s]=this._sign(t,e);return[this._encodeCompact(r,i),s]}signDER(t,e){const[r,i]=this._sign(t,e);return this._encodeDER(r,i)}signRecoverableDER(t,e){const[r,i,s]=this._sign(t,e);return[this._encodeDER(r,i),s]}_sign(t,e){const{n:r,nh:i}=this.curve,s=this.curve.g,o=this.curve.decodeScalar(e);if(o.isZero()||o.cmp(r)>=0)throw new Error("Invalid private key.");const h=this._reduce(t),u=this.curve.encodeScalar(h),a=new f(this.hash,e,u);for(;;){const t=a.generate(this.curve.scalarSize),e=this._truncate(t);if(e.isZero()||e.cmp(r)>=0)continue;const f=s.mulBlind(e);if(f.isInfinity())continue;const u=f.getX(),c=u.mod(r);if(c.isZero())continue;const d=this.curve.randomScalar(n),l=e.mul(d).fermat(r),m=o.mul(d).imod(r),p=h.mul(d).imod(r),b=c.mul(m).iadd(p).imod(r).mul(l).imod(r);if(b.isZero())continue;let g=f.isOdd()|!u.eq(c)<<1;return b.cmp(i)>0&&(b.ineg().imod(r),g^=1),[c,b,g]}}verify(t,e,r){let s,n;i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(Buffer.isBuffer(r));try{[s,n]=this._decodeCompact(e)}catch(t){return!1}try{return this._verify(t,s,n,r)}catch(t){return!1}}verifyDER(t,e,r){let s,n;i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(Buffer.isBuffer(r));try{[s,n]=this._decodeDER(e,!1)}catch(t){return!1}try{return this._verify(t,s,n,r)}catch(t){return!1}}_verify(t,e,r,i){const{n:s}=this.curve,n=this.curve.g,o=this._reduce(t),h=this.curve.decodePoint(i);if(e.isZero()||e.cmp(s)>=0)return!1;if(r.isZero()||r.cmp(s)>=0)return!1;const f=r.invert(s),u=o.mul(f).imod(s),a=e.mul(f).imod(s);return n.jmulAdd(u,h,a).eqXToP(e)}recover(t,e,r,s){let n,o,h;i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(r>>>0===r),i((3&r)===r,"The recovery param is more than two bits.");try{[n,o]=this._decodeCompact(e)}catch(t){return null}try{h=this._recover(t,n,o,r)}catch(t){return null}return h.encode(s)}recoverDER(t,e,r,s){let n,o,h;i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(r>>>0===r),i((3&r)===r,"The recovery param is more than two bits.");try{[n,o]=this._decodeDER(e,!1)}catch(t){return null}try{h=this._recover(t,n,o,r)}catch(t){return null}return h.encode(s)}_recover(t,e,r,i){const{p:s,n}=this.curve,o=this.curve.g,h=this._reduce(t);if(e.isZero()||e.cmp(n)>=0)throw new Error("Invalid R value.");if(r.isZero()||r.cmp(n)>=0)throw new Error("Invalid S value.");const f=0!=(1&i);let u=e;if(i>>>1){if(u.cmp(s.mod(n))>=0)throw new Error("Invalid R value.");u=u.add(n)}const a=this.curve.pointFromX(u,f),c=e.invert(n),d=h.mul(c).ineg().imod(n),l=r.mul(c).imod(n),m=o.mulAdd(d,a,l);if(m.isInfinity())throw new Error("Invalid point.");return m}derive(t,e,r){const i=this.curve.decodePoint(t),s=this.curve.decodeScalar(e);if(s.isZero()||s.cmp(this.curve.n)>=0)throw new Error("Invalid private key.");if(this.curve.h.cmpn(1)>0&&i.isSmall())throw new Error("Invalid point.");return i.mulConst(s,n).encode(r)}schnorrSign(t,e){return this.schnorr.sign(t,e)}schnorrVerify(t,e,r){return this.schnorr.verify(t,e,r)}schnorrVerifyBatch(t){return this.schnorr.verifyBatch(t)}_encodeCompact(t,e){return Buffer.concat([this.curve.encodeScalar(t),this.curve.encodeScalar(e)])}_decodeCompact(t){i(Buffer.isBuffer(t));const{n:e}=this.curve,r=this.curve.scalarSize;if(t.length!==2*r)throw new Error("Invalid signature size.");const s=t.slice(0,r),n=t.slice(r,2*r),o=this.curve.decodeScalar(s),h=this.curve.decodeScalar(n);if(o.cmp(e)>=0||h.cmp(e)>=0)throw new Error("Invalid signature.");return[o,h]}_encodeDER(t,e){const r=o.sizeInt(t)+o.sizeInt(e),s=Buffer.alloc(o.sizeSeq(r));let n=0;return n=o.writeSeq(s,n,r),n=o.writeInt(s,n,t),n=o.writeInt(s,n,e),i(n===s.length),s}_decodeDER(t,e){i(Buffer.isBuffer(t)),i("boolean"==typeof e);const{n:r}=this.curve;let s,n,h=0;if(h=o.readSeq(t,h,e),[s,h]=o.readInt(t,h,e),[n,h]=o.readInt(t,h,e),e&&h!==t.length)throw new Error("Trailing bytes.");if(s.cmp(r)>=0||n.cmp(r)>=0)throw new Error("Invalid signature.");return[s,n]}_truncate(t){i(Buffer.isBuffer(t));const e=this.curve.n.bitLength(),r=e+7>>>3;t.length>r&&(t=t.slice(0,r));const n=s.decode(t,this.curve.endian),o=8*t.length-e;return o>0&&n.iushrn(o),n}_reduce(t){return this._truncate(t).imod(this.curve.n)}}},5582:(t,e,r)=>{const{custom:i}=r(8377),s=r(6401),n=[-3,-1,-5,-7,0,7,5,1,3];class o{constructor(t,e,r){this.Point=null,this.id=null,this.ossl=null,this.type="base",this.endian="be",this.hash=null,this.prefix=null,this.context=!1,this.prime=null,this.p=null,this.red=null,this.fieldSize=0,this.fieldBits=0,this.signBit=0,this.n=null,this.h=null,this.q=null,this.z=null,this.g=null,this.nh=null,this.scalarSize=0,this.scalarBits=0,this.mask=null,this.zero=null,this.one=null,this.two=null,this.three=null,this.four=null,this.i2=null,this.i3=null,this.i4=null,this.i6=null,this.endo=null,this.hi=null,this._init(t,e,r)}_init(t,e,r){return B("function"==typeof t),B("string"==typeof e),B(r&&"object"==typeof r),B(null==r.red||r.red instanceof s.Red),B(null!=r.p,"Must pass a prime."),B(null==r.id||"string"==typeof r.id),B(null==r.ossl||"string"==typeof r.ossl),B(null==r.endian||"string"==typeof r.endian),B(null==r.hash||"string"==typeof r.hash),B(null==r.prefix||"string"==typeof r.prefix),B(null==r.context||"boolean"==typeof r.context),B(null==r.prime||"string"==typeof r.prime),this.Point=t,this.id=r.id||null,this.ossl=r.ossl||null,this.type=e,this.endian=r.endian||("short"===e?"be":"le"),this.hash=r.hash||null,this.prefix=r.prefix?Buffer.from(r.prefix,"binary"):null,this.context=r.context||!1,this.prime=r.prime||null,this.p=s.fromJSON(r.p),r.red?this.red=r.red:(this.red=r.prime?s.red(r.prime):s.mont(this.p),this.red.precompute()),this.fieldSize=this.p.byteLength(),this.fieldBits=this.p.bitLength(),this.signBit=8*this.fieldSize-1,"edwards"===this.type&&this.p.testn(this.signBit)&&(this.fieldSize+=1,this.signBit+=8),this.n=s.fromJSON(r.n||"0"),this.h=s.fromJSON(r.h||"1"),this.q=this.n.mul(this.h),this.z=s.fromJSON(r.z||"0").toRed(this.red),this.g=null,this.nh=this.n.ushrn(1),this.scalarSize=Math.max(this.n.byteLength(),this.p.byteLength()),this.scalarBits=this.n.bitLength(),this.mask=null,this.zero=new s(0).toRed(this.red),this.one=new s(1).toRed(this.red),this.two=new s(2).toRed(this.red),this.three=new s(3).toRed(this.red),this.four=new s(4).toRed(this.red),this.i2=this.two.redInvert(),this.i3=this.three.redInvert(),this.i4=this.i2.redSqr(),this.i6=this.i2.redMul(this.i3),this.endo=null,this.hi=null,this._scale=R(this._scale,this),this.isIsomorphic=R(this.isIsomorphic,this),this.isIsogenous=R(this.isIsogenous,this),B(this.p.sign()>0&&this.p.isOdd()),B(this.n.sign()>=0),B(this.h.sign()>0&&this.h.cmpn(255)<=0),B("be"===this.endian||"le"===this.endian),this}_finalize(t){return B(t&&"object"==typeof t),this.mask=new b(this),this.g=t.g?this.pointFromJSON(t.g):this.point(),this}_simpleMul(t,e){B(t instanceof h),B(e instanceof s),B(!e.red);const r=e.bitLength();e.isNeg()&&(t=t.neg());let i=this.jpoint();for(let s=r-1;s>=0;s--){const r=e.utestn(s);i=i.dbl(),1===r&&(i=i.add(t))}return i}_simpleMulAdd(t,e){B(Array.isArray(t)),B(Array.isArray(e)),B(t.length===e.length);const r=t.length,i=new Array(r),n=e;let o=0;for(let n=0;n<r;n++){const r=t[n],f=e[n];if(B(r instanceof h),B(f instanceof s),B(!f.red),n>0&&r.type!==t[n-1].type)throw new Error("Cannot mix points.");i[n]=f.isNeg()?r.neg():r,o=Math.max(o,f.bitLength())}let f=this.jpoint();for(let t=o-1;t>=0;t--){f=f.dbl();for(let e=0;e<r;e++){const r=i[e];1===n[e].utestn(t)&&(f=f.add(r))}}return f}_constMul(t,e,r){return B(t instanceof h),this.n.isZero()?this._simpleMul(t,e):"short"===this.type&&0===this.h.cmpn(1)?this._coZLadderMul(t,e):this._ladderMul(t,e)}_ladderMul(t,e){B(t instanceof h),B(e instanceof s),B(!e.red);const[r,i,n]=function(t,e){B(t instanceof s),B(e instanceof s);const r=t.abs().add(e),i=r.add(e),n=r.bitLength(),o=e.bitLength();r.cinject(i,n-o-1>>>31);return[1&t.isNeg(),r.bitLength(),r.toArray("le")]}(e,this.q);let o=t.toJ().clone(),f=this.jpoint().clone(),u=0;for(let t=i-1;t>=0;t--){const e=n[t>>3]>>(7&t)&1;o.swap(f,u^e),o=o.uadd(f),f=f.udbl(),u=e}return o.swap(f,u),f.swap(f.neg(),r),f}_coZLadderMul(t,e){B(t instanceof h),B(e instanceof s),B(!e.red);const r=t.toJ().clone(),[i,n,o,f]=function(t,e){B(t instanceof s),B(e instanceof s);const r=t.mod(e),i=e.sub(r),n=r.bitLength()-i.bitLength()>>>31;r.cinject(i,n);return[n,r.bitLength(),r.toArray("le"),r.ceq(e.subn(1))]}(e,this.n);let[u,a]=r.zdblu(),c=0;for(let t=n-2;t>=0;t--){const e=o[t>>3]>>(7&t)&1;u.swap(a,c^e),[u,a]=a.zaddc(u),[a,u]=u.zaddu(a),c=e}return u.swap(a,c),a.swap(r.neg(),f),a.swap(a.neg(),i),a}_fixedNafMul(t,e){B(t instanceof h),B(e instanceof s),B(t.pre);const{step:r,points:i}=t._getDoubles(0,0),n=function(t,e,r,i){B(i>>>0===i);const s=O(t,1,r),n=Math.ceil(s.length/i),o=new Array(n);let h=0;for(let t=0;t<s.length;t+=i){let e=0;for(let r=t+i-1;r>=t;r--)e=(e<<1)+s[r];o[h++]=e}return B(h===n),o}(e,0,e.bitLength()+1,r),o=((1<<r+1)-(r%2==0?2:1))/3;let f=this.jpoint(),u=this.jpoint();for(let t=o;t>0;t--){for(let e=0;e<n.length;e++){const r=n[e];r===t?u=u.add(i[e]):r===-t&&(u=u.add(i[e].neg()))}f=f.add(u)}return f}_wnafMul(t,e,r){B(e instanceof h),B(r instanceof s);const{width:i,points:n}=e._safeNAF(t),o=O(r,i,r.bitLength()+1);let f=this.jpoint();for(let t=o.length-1;t>=0;t--){let e=0;for(;t>=0&&0===o[t];t--)e+=1;if(t>=0&&(e+=1),f=f.dblp(e),t<0)break;const r=o[t];B(0!==r),f=r>0?f.add(n[r-1>>1]):f.add(n[-r-1>>1].neg())}return f}_wnafMulAdd(t,e,r){B(t>>>0===t),B(Array.isArray(e)),B(Array.isArray(r)),B(e.length===r.length);const i=e.length,n=new Array(i),o=new Array(i),f=new Array(i);let u=0;for(let t=0;t<i;t++){const i=e[t],a=r[t];if(B(i instanceof h),B(a instanceof s),t>0&&i.type!==e[t-1].type)throw new Error("Cannot mix points.");n[t]=null,o[t]=null,f[t]=0,u=Math.max(u,a.bitLength()+1)}let a=null,c=null,d=0;for(let t=0;t<i;t++){const i=e[t],s=r[t],h=i._getNAF(0);h?(n[d]=h.points,o[d]=O(s,h.width,u),d+=1):a?(n[d]=a._getJNAF(i),o[d]=N(c,s,u),a=null,c=null,d+=1):(a=i,c=s)}if(a){const e=a._safeNAF(t);n[d]=e.points,o[d]=O(c,e.width,u),d+=1}let l=this.jpoint();for(let t=u-1;t>=0;t--){let e=0;for(;t>=0;){let r=!0;for(let e=0;e<d;e++)f[e]=o[e][t],0!==f[e]&&(r=!1);if(!r)break;e+=1,t-=1}if(t>=0&&(e+=1),l=l.dblp(e),t<0)break;for(let t=0;t<d;t++){const e=f[t];0!==e&&(l=e>0?l.add(n[t][e-1>>1]):l.add(n[t][-e-1>>1].neg()))}}return l}_endoWnafMulAdd(t,e){throw new Error("Not implemented.")}_scale(t,e){switch(B(t instanceof o),B(t.p.eq(this.p)),t.type){case"short":return this._scaleShort(t,e);case"mont":return this._scaleMont(t,e);case"edwards":return this._scaleEdwards(t,e);default:throw new Error("Not implemented.")}}_scaleShort(t,e){throw new Error("Not implemented.")}_scaleMont(t,e){throw new Error("Not implemented.")}_scaleEdwards(t,e){throw new Error("Not implemented.")}isElliptic(){throw new Error("Not implemented.")}jinv(){throw new Error("Not implemented.")}precompute(t){return B(!this.g.isInfinity(),"Must have base point."),B(!this.n.isZero(),"Must have order."),this.g.precompute(this.n.bitLength()+1,t),this}scalar(t,e,r){const i=new s(t,e,r);return B(!i.red),this.n.isZero()?i:i.imod(this.n)}field(t,e,r){const i=s.cast(t,e,r);return i.red?i.forceRed(this.red):i.toRed(this.red)}point(t,e){throw new Error("Not implemented.")}jpoint(t,e,r){throw new Error("Not implemented.")}xpoint(t,e){throw new Error("Not implemented.")}cpoint(t,e,r,i){if(B(t instanceof s),B(e instanceof s),B(r instanceof s),B(i instanceof s),e.isZero()||i.isZero())return this.point();const n=e.redMul(i).redInvert(),o=t.redMul(i).redMul(n),h=r.redMul(e).redMul(n);return this.point(o,h)}solveX2(t){throw new Error("Not implemented.")}solveX(t){return this.solveX2(t).redSqrt()}solveY2(t){throw new Error("Not implemented.")}solveY(t){return this.solveY2(t).redSqrt()}validate(t){throw new Error("Not implemented.")}pointFromX(t,e){throw new Error("Not implemented.")}pointFromY(t,e){throw new Error("Not implemented.")}isIsomorphic(t){throw new Error("Not implemented.")}isIsogenous(t){throw new Error("Not implemented.")}pointFromShort(t){throw new Error("Not implemented.")}pointFromMont(t,e){throw new Error("Not implemented.")}pointFromEdwards(t){throw new Error("Not implemented.")}pointFromUniform(t){throw new Error("Not implemented.")}pointToUniform(t){throw new Error("Not implemented.")}pointFromHash(t,e=!1){B(Buffer.isBuffer(t)),B("boolean"==typeof e);const r=this.fieldBits+7>>>3;if(t.length!==2*r)throw new Error("Invalid hash size.");const i=t.slice(0,r),s=t.slice(r),n=this.decodeUniform(i),o=this.decodeUniform(s),h=this.pointFromUniform(n),f=this.pointFromUniform(o),u=h.uadd(f);return e?u.mulH():u}pointToHash(t,e){for(B(t instanceof this.Point);;){const r=this.randomField(e),i=this.pointFromUniform(r);if(i.neg().eq(i))continue;const s=t.uadd(i.neg()),n=P(e);let o;try{o=this.pointToUniform(s,n)}catch(t){if("Invalid point."===t.message)continue;throw t}const h=this.encodeUniform(r,e),f=this.encodeUniform(o,e);return Buffer.concat([h,f])}}randomScalar(t){const e=this.n.isZero()?this.p:this.n;return s.random(t,1,e)}randomField(t){return s.random(t,1,this.p).toRed(this.red)}randomPoint(t){let e;for(;;){const r=this.randomField(t),i=0!=(1&P(t));try{e=this.pointFromX(r,i)}catch(t){continue}return B(e.validate()),e.mulH()}}mulAll(t,e){return this.jmulAll(t,e)}mulAllSimple(t,e){return this.jmulAllSimple(t,e)}jmulAll(t,e){return B(Array.isArray(t)),B(0===t.length||t[0]instanceof h),this.endo&&t.length>0&&0===t[0].type?this._endoWnafMulAdd(t,e):this._wnafMulAdd(1,t,e)}jmulAllSimple(t,e){return this._simpleMulAdd(t,e)}mulH(t){return B(t instanceof s),this.imulH(t.clone())}imulH(t){B(t instanceof s),B(!t.red);const e=this.h.word(0);if(0==(e&e-1)){const e=this.h.bitLength();return t.iushln(e-1).imod(this.n)}return t.imuln(e).imod(this.n)}reduce(t){return this.mask.reduce(t)}splitHash(t){return this.mask.splitHash(t)}clamp(t){return this.mask.clamp(t)}encodeField(t){return B(t instanceof s),B(!t.red),t.encode(this.endian,this.fieldSize)}decodeField(t){if(B(Buffer.isBuffer(t)),t.length!==this.fieldSize)throw new Error("Invalid field element size.");return s.decode(t,this.endian)}encodeScalar(t){return B(t instanceof s),B(!t.red),t.encode(this.endian,this.scalarSize)}decodeScalar(t){if(B(Buffer.isBuffer(t)),t.length!==this.scalarSize)throw new Error("Invalid scalar size.");return s.decode(t,this.endian)}encodeUniform(t,e){B(t instanceof s);const r=this.fieldBits,i=r+7>>>3,n=8*i-r,o=t.fromRed();if(null!=e&&0!==n){const t=s.randomBits(e,n);o.iuor(t.iushln(r))}return o.encode(this.endian,i)}decodeUniform(t){B(Buffer.isBuffer(t));const e=this.fieldBits,r=e+7>>>3;if(t.length!==r)throw new Error("Invalid field size.");return s.decode(t,this.endian).iumaskn(e).toRed(this.red)}encodePoint(t,e){return B(t instanceof h),t.encode(e)}decodePoint(t){throw new Error("Not implemented.")}encodeX(t){throw new Error("Not implemented.")}decodeX(t){throw new Error("Not implemented.")}decodeEven(t){throw new Error("Not implemented.")}decodeSquare(t){throw new Error("Not implemented.")}toShort(){throw new Error("Not implemented.")}toMont(t){throw new Error("Not implemented.")}toEdwards(t){throw new Error("Not implemented.")}pointToJSON(t,e){return B(t instanceof h),t.toJSON(e)}pointFromJSON(t){throw new Error("Not implemented.")}toJSON(t){let e,r,i,s,n;return"edwards"===this.type&&(e=this.prefix?this.prefix.toString():null,r=this.context),this.n.isZero()||(i=this.n.toJSON()),this.z.isZero()||(s=this.z.fromRed(),this.z.redIsHigh()&&s.isub(this.p),s=s.toString(16)),this.endo&&(n=this.endo.toJSON()),{id:this.id,ossl:this.ossl,type:this.type,endian:this.endian,hash:this.hash,prefix:e,context:r,prime:this.prime,p:this.p.toJSON(),a:void 0,b:void 0,d:void 0,n:i,h:this.h.toString(16),s:void 0,z:s,c:void 0,g:this.g.toJSON(t),endo:n}}static fromJSON(t){return new this(t)}}class h{constructor(t,e){B(t instanceof o),B(e>>>0===e),this.curve=t,this.type=e,this.pre=null}_init(){throw new Error("Not implemented.")}_getNAF(t){if(B(t>>>0===t),this.pre&&this.pre.naf)return this.pre.naf;if(0===t)return null;const e=1<<t-1,r=new Array(e),i=1===e?null:this.dbl();r[0]=this;for(let t=1;t<e;t++)r[t]=r[t-1].add(i);return new w(t,r)}_safeNAF(t){return this._getNAF(t)}_getDoubles(t,e){if(B(t>>>0===t),B(e>>>0===e),this.pre&&this.pre.doubles)return this.pre.doubles;if(0===t)return null;const r=Math.ceil(e/t)+1,i=new Array(r);let s=this,n=0;i[n++]=s;for(let r=0;r<e;r+=t){for(let e=0;e<t;e++)s=s.dbl();i[n++]=s}return B(n===r),new S(t,i)}_getBeta(){return null}_getBlinding(t){if(this.pre&&this.pre.blinding)return this.pre.blinding;if(!t)return null;if(this.curve.n.isZero())return null;const e=this.curve.randomScalar(t),r=this.mul(e);return new y(e,r)}_hasDoubles(t){if(B(t instanceof s),!this.pre||!this.pre.doubles)return!1;const{step:e,points:r}=this.pre.doubles,i=t.bitLength()+1;return r.length>=Math.ceil(i/e)+1}_getJNAF(t){return B(t instanceof h),B(t.type===this.type),[this,this.add(t),this.add(t.neg()),t]}_blind(t,e){if(B(t instanceof s),B(!t.red),this.pre&&this.pre.blinding){const{blind:e,unblind:r}=this.pre.blinding;return[this,t.sub(e),r]}return e?this.pre?this.curve.n.isZero()?[this,t,null]:[this,this.curve.randomScalar(e).mul(this.curve.n).iadd(t),null]:[this.randomize(e),t,null]:[this,t,null]}clone(){throw new Error("Not implemented.")}swap(t,e){throw new Error("Not implemented.")}precompute(t,e){return B(t>>>0===t),this.pre||(this.pre=new g),this.pre.naf||(this.pre.naf=this._getNAF(8)),this.pre.doubles||(this.pre.doubles=this._getDoubles(4,t)),this.pre.beta||(this.pre.beta=this._getBeta()),this.pre.blinding||(this.pre.blinding=this._getBlinding(e)),this}validate(){return this.curve.validate(this)}normalize(){return this}scale(t){throw new Error("Not implemented.")}randomize(t){const e=this.curve.randomField(t);return this.scale(e)}neg(){throw new Error("Not implemented.")}add(t){throw new Error("Not implemented.")}sub(t){return B(t instanceof h),this.add(t.neg())}dbl(){throw new Error("Not implemented.")}dblp(t){B(t>>>0===t);let e=this;for(let r=0;r<t;r++)e=e.dbl();return e}uadd(t){throw new Error("Not implemented.")}usub(t){return B(t instanceof h),this.uadd(t.neg())}udbl(){throw new Error("Not implemented.")}zaddu(t){throw new Error("Not implemented.")}zaddc(t){throw new Error("Not implemented.")}zdblu(){throw new Error("Not implemented.")}diffAdd(t,e){throw new Error("Not implemented.")}diffAddDbl(t,e){throw new Error("Not implemented.")}recover(){throw new Error("Not implemented.")}getX(){throw new Error("Not implemented.")}getY(){throw new Error("Not implemented.")}eq(t){throw new Error("Not implemented.")}isInfinity(){throw new Error("Not implemented.")}isOdd(){throw new Error("Not implemented.")}isEven(){throw new Error("Not implemented.")}isSquare(){throw new Error("Not implemented.")}eqX(t){throw new Error("Not implemented.")}eqXToP(t){throw new Error("Not implemented.")}isSmall(){return!this.isInfinity()&&this.jmulH().isInfinity()}hasTorsion(){return!this.isInfinity()&&!this.jmul(this.curve.n).isInfinity()}mul(t){return this.jmul(t)}muln(t){return this.jmuln(t)}mulSimple(t){return this.jmulSimple(t)}mulBlind(t,e){return this.jmulBlind(t,e)}mulConst(t,e){return this.jmulConst(t,e)}mulAdd(t,e,r){return this.jmulAdd(t,e,r)}mulAddSimple(t,e,r){return this.jmulAddSimple(t,e,r)}mulH(){return this.jmulH()}div(t){return this.jdiv(t)}divn(t){return this.jdivn(t)}divH(){return this.jdivH()}jmul(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo&&0===this.type?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(4,this,t)}jmuln(t){return B((0|t)===t),this.jmulSimple(new s(t))}jmulSimple(t){return this.curve._simpleMul(this,t)}jmulBlind(t,e=null){const[r,i,s]=this._blind(t,e),n=r.jmul(i);return s?n.add(s):n}jmulConst(t,e=null){const[r,i,s]=this._blind(t,e),n=this.curve._constMul(r,i,e);return s?n.uadd(s):n}jmulAdd(t,e,r){return this.curve.endo&&0===this.type?this.curve._endoWnafMulAdd([this,e],[t,r]):this.curve._wnafMulAdd(1,[this,e],[t,r])}jmulAddSimple(t,e,r){return this.curve._simpleMulAdd([this,e],[t,r])}jmulH(){const t=this.curve.h.word(0);if(0==(t&t-1)){const t=this.curve.h.bitLength();return this.toJ().dblp(t-1)}return this.jmulSimple(this.curve.h)}jdiv(t){return B(t instanceof s),B(!t.red),this.jmul(t.invert(this.curve.n))}jdivn(t){return B(!this.curve.n.isZero()),0===this.curve.h.cmpn(t)?this.jdivH():this.jdiv(new s(t))}jdivH(){return this.curve.n.isZero()||0===this.curve.h.cmpn(1)?this.toJ():(null===this.curve.hi&&(this.curve.hi=this.curve.h.invert(this.curve.n)),this.jmul(this.curve.hi))}ladder(t){throw new Error("Not implemented.")}ladderSimple(t){throw new Error("Not implemented.")}ladderBlind(t,e){throw new Error("Not implemented.")}ladderConst(t,e){throw new Error("Not implemented.")}toP(){return this.normalize()}toJ(){return this}toX(){return this}encode(t){throw new Error("Not implemented.")}static decode(t,e){throw new Error("Not implemented.")}encodeX(){throw new Error("Not implemented.")}static decodeX(t,e){throw new Error("Not implemented.")}static decodeEven(t,e){throw new Error("Not implemented.")}static decodeSquare(t,e){throw new Error("Not implemented.")}toJSON(t){throw new Error("Not implemented.")}static fromJSON(t,e){throw new Error("Not implemented.")}[i](){return"<Point>"}}class f extends o{constructor(t){super(u,"short",t),this.a=s.fromJSON(t.a).toRed(this.red),this.b=s.fromJSON(t.b).toRed(this.red),this.c=s.fromJSON(t.c||"0").toRed(this.red),this.ai=this.a.isZero()?this.zero:this.a.redInvert(),this.zi=this.z.isZero()?this.zero:this.z.redInvert(),this.zeroA=this.a.isZero(),this.threeA=this.a.eq(this.three.redNeg()),this.redN=this.n.toRed(this.red),this.smallGap=!1,this._finalize(t)}_finalize(t){return super._finalize(t),null!=t.endo?this.endo=I.fromJSON(this,t.endo):this.endo=this._getEndomorphism(),!this.n.isZero()&&this.n.cmp(this.p)<0&&(this.smallGap=this.p.div(this.n).cmpn(100)<=0),this}static _isomorphism(t,e,r,i){B(t instanceof s),B(e instanceof s),B(r instanceof s),B(null==i||"boolean"==typeof i),B(!t.isZero()&&!e.isZero());const n=r.redDiv(t),o=n.redSqrt();if(null!=i?o.redIsOdd()!==i&&o.redINeg():1!==o.redJacobi()&&o.redINeg(),1!==o.redJacobi())throw new Error("Invalid `a` coefficient.");const h=n.redMul(o),f=t.redMul(n),u=e.redMul(h);return B(f.eq(r)),[f,u]}_short(t,e){return f._isomorphism(this.a,this.b,t,e)}_mont(t,e){const[r,i]=this._findRS(e),s=i.redInvert(),n=r.redMuln(3).redMul(s);return null!=t?c._isomorphism(n,s,t):[n,s]}_edwards(t,e){const[r,i]=this._findRS(e),s=r.redMuln(3),n=i.redMuln(2),o=s.redAdd(n),h=s.redSub(n);return null!=t?m._isomorphism(o,h,t):[o,h]}_findRS(t){B(null==t||"boolean"==typeof t),B(this.h.word(0)>=4),B(!this.n.isZero());const e=this.one.redNeg();let r;for(;;){e.redIAdd(this.one);try{r=this.pointFromX(e)}catch(t){continue}if(r=r.mul(this.n),!r.isInfinity()&&r.y.isZero())break}const i=r.x,s=i.redSqr().redMuln(3).redIAdd(this.a).redSqrt();return null!=t&&s.redIsOdd()!==t&&s.redINeg(),[i,s]}_scale0(t,e){const r=this.a.redDiv(this.field(t)),i=this.b.redDiv(this.field(e)),s=r.redSqrt();r.redMul(s).eq(i)||s.redINeg(),B(r.redMul(s).eq(i));const n=s.redSqrt(),o=s.redMul(n);return B(!n.isZero()),[s,o]}_scale1(t,e){const r=this.g.x.redDiv(this.field(t)),i=this.g.y.redDiv(this.field(e)),s=r.redSqrt();return r.redMul(s).eq(i)||s.redINeg(),B(r.redMul(s).eq(i)),B(!s.isZero()),[r,i]}_scaleShort(t){return B(t instanceof f),this.g.isInfinity()||t.g.isInfinity()?this._scale0(t.a,t.b):this._scale1(t.g.x,t.g.y)}_scaleMont(t){if(B(t instanceof c),this.g.isInfinity()||t.g.isInfinity()){const[e,r]=t._short();return this._scale0(e,r)}const{x:e,y:r}=t.g,i=e.redAdd(t.a3).redMul(t.bi),s=r.redMul(t.bi);return this._scale1(i,s)}_scaleEdwards(t){if(B(t instanceof m),this.g.isInfinity()||t.g.isInfinity()){const[e,r]=t._short();return this._scale0(e,r)}const{x:e,y:r,z:i}=t.g,s=t.a.redMuln(5),n=t.d.redMuln(5),o=t.d.redSub(t.a),h=n.redSub(t.a),f=t.d.redSub(s),u=r.redAdd(i),a=r.redSub(i),c=h.redMul(r).redIAdd(f.redMul(i)),d=a.redMuln(12),l=o.redMul(u).redMul(i),p=a.redMul(e).redIMuln(4),b=d.redMul(p).redInvert(),g=c.redMul(p).redMul(b),w=l.redMul(d).redMul(b);return this._scale1(g,w)}_getEndomorphism(t=0){if(this.n.isZero()||this.g.isInfinity())return null;if(!this.zeroA||1!==this.p.modrn(3)||1!==this.n.modrn(3))return null;const[e,r]=this._getEndoRoots(this.p),i=[e,r][1&t].toRed(this.red),[s,n]=this._getEndoRoots(this.n),o=this.point(this.g.x.redMul(i),this.g.y);let h;this.g.mul(s).eq(o)?h=s:(B(this.g.mul(n).eq(o)),h=n);const f=this._getEndoBasis(h),u=this._getEndoPrecomp(f);return new I(i,h,f,u)}_getEndoRoots(t){const e=t===this.p?this.red:s.mont(t),r=new s(2).toRed(e),i=new s(3).toRed(e),n=r.redInvert(),o=i.redNeg().redSqrt().redMul(n),h=o.redNeg();return[o.redSub(n).fromRed(),h.redSub(n).fromRed()].sort(s.cmp)}_getEndoBasis(t){const[e,r,i,s,n,o]=this._egcdSqrt(t),h=i,f=s.neg(),u=e.sqr().iadd(r.sqr()),a=n.sqr().iadd(o.sqr());let c,d;return u.cmp(a)<=0?(c=e,d=r.neg()):(c=n,d=o.neg()),[new v(h,f),new v(c,d)]}_egcdSqrt(t){B(t instanceof s),B(!t.red),B(t.sign()>0),B(this.n.sign()>0);const e=this.n.ushrn(this.n.bitLength()>>>1);let r,i,n,o,h,f=t,u=this.n.clone(),a=new s(1),c=new s(0),d=new s(0),l=new s(1),m=0,p=0;for(;!f.isZero()&&m<2;){const t=u.quo(f),s=u.sub(t.mul(f)),b=d.sub(t.mul(a)),g=l.sub(t.mul(c));0===p&&s.cmp(e)<0&&(r=h,i=a,n=s,o=b,p=1),h=s,u=f,f=s,d=a,a=b,l=c,c=g,m+=p}return B(0!==p,"Could not find r < sqrt(n)."),[r,i,n,o,d,a]}_getEndoPrecomp(t){B(Array.isArray(t)),B(2===t.length),B(t[0]instanceof v),B(t[1]instanceof v);const[e,r]=t,i=e.a.mul(r.b).isub(e.b.mul(r.a)),n=i.bitLength()+16,o=s.shift(1,n),h=o.mul(r.b).divRound(i),f=o.mul(e.b).divRound(i);return B(i.eq(this.n)),[h,f]}_endoSplit(t){B(t instanceof s),B(!t.red),B(!this.n.isZero());const[e,r]=this.endo.basis,i=r.b.mul(t).divRound(this.n),n=e.b.neg().mul(t).divRound(this.n),o=i.mul(e.a),h=n.mul(r.a),f=i.ineg().mul(e.b),u=n.mul(r.b);return[t.sub(o).isub(h),f.isub(u)]}_endoBeta(t){return B(t instanceof u),[t,t._getBeta()]}_endoWnafMulAdd(t,e){B(Array.isArray(t)),B(Array.isArray(e)),B(t.length===e.length),B(null!=this.endo);const r=t.length,i=new Array(2*r),s=new Array(2*r);for(let n=0;n<r;n++){const[r,o]=this._endoBeta(t[n]),[h,f]=this._endoSplit(e[n]);i[2*n+0]=r,s[2*n+0]=h,i[2*n+1]=o,s[2*n+1]=f}return this._wnafMulAdd(1,i,s)}_icart(t){const{a:e,b:r,i3:i,one:s}=this,n=i.redSqr().redMul(i),o=this.p.ushln(1).isubn(1).idivn(3),h=t.clone();h.cinject(s,h.czero());const f=h.redSqr(),u=f.redSqr(),a=u.redMul(f),c=h.redMuln(6).redFermat(),d=e.redMuln(3).redISub(u).redMul(c),l=d.redSqr(),m=a.redMul(n),p=f.redMul(i),b=l.redISub(r).redISub(m).redPow(o).redIAdd(p),g=h.redMul(b).redIAdd(d);return this.point(b,g)}_sswu(t){const{b:e,z:r,ai:i,zi:s,one:n}=this,o=this.p.subn(2),h=r.redSqr(),f=e.redNeg().redMul(i),u=e.redMul(s).redMul(i),a=t.redSqr(),c=a.redSqr(),d=h.redMul(c).redIAdd(r.redMul(a)).redPow(o),l=f.redMul(n.redAdd(d));l.cinject(u,d.czero());const m=r.redMul(a).redMul(l),p=this.solveY2(l),b=this.solveY2(m),g=0|p.redIsSquare(),w=l.cinject(m,1^g),S=p.cinject(b,1^g).redSqrt();return S.cinject(S.redNeg(),S.redIsOdd()^t.redIsOdd()),this.point(w,S)}_sswui(t,e){const{a:r,b:i,z:s}=this,{x:n,y:o}=t,h=3&e,f=r.redSqr().redMul(n.redSqr()),u=r.redMul(i).redMul(n).redIMuln(2),a=i.redSqr().redMuln(3),c=r.redMul(n).redIAdd(i),[d,l]=A(f.redISub(u).redISub(a)),m=c.redSub(l).redINeg(),p=c.redAdd(l).redINeg(),b=c.redMul(s).redIMuln(2),g=i.redMul(s).redIMuln(2);m.cinject(p,1&h),b.cinject(g,h>>>1);const[w,S]=M(m,b);if(S.cinject(S.redNeg(),S.redIsOdd()^o.redIsOdd()),!(d&w))throw new Error("Invalid point.");return S}_svdwf(t){const{c:e,z:r,zi:i,i2:s,i3:n}=this,o=this.p.subn(2),h=this.solveY2(r),f=n.redMul(i.redSqr()),u=t.redSqr(),a=u.redSqr(),c=u.redAdd(h),d=u.redMul(c).redPow(o),l=a.redMul(d).redMul(e),m=c.redSqr().redMul(c),p=e.redSub(r).redMul(s).redISub(l),b=l.redSub(e.redAdd(r).redMul(s)),g=r.redSub(m.redMul(d).redMul(f)),w=this.solveY2(p),S=this.solveY2(b),y=this.solveY2(g),I=0|w.redIsSquare(),v=0|S.redIsSquare();return p.cinject(b,(1^I)&v),w.cinject(S,(1^I)&v),p.cinject(g,(1^I)&(1^v)),w.cinject(y,(1^I)&(1^v)),[p,w]}_svdw(t){const[e,r]=this._svdwf(t),i=r.redSqrt();return i.cinject(i.redNeg(),i.redIsOdd()^t.redIsOdd()),this.point(e,i)}_svdwi(t,e){const{b:r,c:i,z:s,two:n}=this,{x:o,y:h}=t,f=3&e,u=s.redSqr(),a=u.redMul(s),c=u.redSqr(),d=a.redAdd(r),l=d.redMuln(2),m=o.redSqr(),p=o.redMuln(2).redIAdd(s),b=o.redMul(u),g=i.redSub(p),w=i.redAdd(p),S=m.redMul(u).redIAdd(c).redIMuln(9),y=o.redMul(a).redIMuln(18),I=d.redMul(o.redSub(s)).redIMuln(12),[v,E]=A(S.redISub(y).redIAdd(I)),_=f-2>>>31|v,O=E.redMul(s),N=a.redISub(b).redIMuln(3).redISub(l),B=d.redMul(g),P=d.redMul(w),R=N.redAdd(O),x=N.redSub(O),k=n.clone();B.cinject(P,(1^f)-1>>>31),B.cinject(R,(2^f)-1>>>31),B.cinject(x,(3^f)-1>>>31),k.cinject(w,(0^f)-1>>>31),k.cinject(g,(1^f)-1>>>31);const[T,U]=M(B,k),[z]=this._svdwf(U),C=z.ceq(o);if(U.cinject(U.redNeg(),U.redIsOdd()^h.redIsOdd()),!(_&T&C))throw new Error("Invalid point.");return U}isElliptic(){const{a:t,b:e}=this,r=t.redSqr().redMul(t);return!e.redSqr().redMuln(27).redIAdd(r.redMuln(4)).isZero()}jinv(){const{a:t,b:e}=this,r=t.redSqr().redMul(t),i=e.redSqr(),s=r.redMuln(4),n=s.redMuln(1728),o=i.redMuln(27).redIAdd(s);if(o.isZero())throw new Error("Curve is not elliptic.");return n.redDiv(o).fromRed()}point(t,e,r=0){return new u(this,t,e,r)}jpoint(t,e,r){return new a(this,t,e,r)}solveY2(t){B(t instanceof s);const e=t.redSqr().redMul(t).redIAdd(this.b);return this.zeroA||(this.threeA?e.redIAdd(t.redMuln(-3)):e.redIAdd(this.a.redMul(t))),e}validate(t){if(B(t instanceof u),t.inf)return!0;const{x:e,y:r}=t,i=this.solveY2(e);return r.redSqr().eq(i)}pointFromX(t,e=null){B(t instanceof s),B(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveY(t);return null!=e&&r.redIsOdd()!==e&&r.redINeg(),this.point(t,r)}isIsomorphic(t){if(B(t instanceof o),!t.p.eq(this.p))return!1;let e,r;try{[e,r]=this._scale(t)}catch(t){return!1}if("short"===t.type){const i=this.field(t.a).redMul(e.redSqr()),s=this.field(t.b).redMul(r.redSqr());return this.a.eq(i)&&this.b.eq(s)}if("mont"===t.type){const{a3:r,bi:i}=t,s=this.field(r.redMul(i)).redMul(e);return this.solveY2(s).isZero()}if("edwards"===t.type){const r=this.field(t.ad6).redMul(e);return this.solveY2(r).isZero()}return!1}isIsogenous(t){return B(t instanceof o),!1}pointFromShort(t){if(B(t instanceof u),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const[e,r]=this._scale(t.curve),i=this.field(t.x),s=this.field(t.y),n=i.redMul(e),o=s.redMul(r);return this.point(n,o)}throw new Error("Not implemented.")}pointFromMont(t){if(B(t instanceof d),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const{a3:e,bi:r}=t.curve,[i,s]=this._scale(t.curve),n=t.x.redAdd(e).redMul(r),o=t.y.redMul(r);return this.point(this.field(n).redMul(i),this.field(o).redMul(s))}throw new Error("Not implemented.")}pointFromEdwards(t){if(B(t instanceof p),this.isIsomorphic(t.curve)){const{a:e,d:r,ad6:i}=t.curve,[s,n]=this._scale(t.curve);if(t.isInfinity())return this.point();if(t.x.isZero()){const t=this.field(i).redMul(s);return this.point(t,this.zero)}const{x:o,y:h,z:f}=t,u=e.redMuln(5),a=r.redMuln(5),c=r.redSub(e),d=a.redSub(e),l=r.redSub(u),m=h.redAdd(f),p=h.redSub(f),b=d.redMul(h).redIAdd(l.redMul(f)),g=p.redMuln(12),w=c.redMul(m).redMul(f),S=p.redMul(o).redIMuln(4);return this.cpoint(this.field(b).redMul(s),this.field(g),this.field(w).redMul(n),this.field(S))}throw new Error("Not implemented.")}pointFromUniform(t){if(B(t instanceof s),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(!this.a.isZero())return this._sswu(t);if(!this.c.isZero())return this._svdw(t);throw new Error("Not implemented.")}pointToUniform(t,e){if(B(t instanceof u),B(e>>>0===e),this.z.isZero()||this.b.isZero())throw new Error("Not implemented.");if(t.isInfinity())throw new Error("Invalid point.");if(!this.a.isZero())return this._sswui(t,e);if(!this.c.isZero())return this._svdwi(t,e);throw new Error("Not implemented.")}mulAll(t,e){return super.mulAll(t,e).toP()}mulAllSimple(t,e){return super.mulAllSimple(t,e).toP()}decodePoint(t){return u.decode(this,t)}encodeX(t){return B(t instanceof h),t.encodeX()}decodeEven(t){return u.decodeEven(this,t)}decodeSquare(t){return u.decodeSquare(this,t)}toShort(t,e,r=null){const[i,s]=this._short(t,e),n=new f({red:this.red,prime:this.prime,p:this.p,a:i,b:s,n:this.n,h:this.h});if(null!=r){const[,t]=n._scale(this);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromShort(this.g)),n}toMont(t,e,r=null){const[i,s]=this._mont(t,e),n=new c({red:this.red,prime:this.prime,p:this.p,a:i,b:s,n:this.n,h:this.h});if(null!=r){const[,t]=this._scale(n);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromShort(this.g)),n}toEdwards(t,e,r=null){const[i,s]=this._edwards(t,e),n=new m({red:this.red,prime:this.prime,p:this.p,a:i,d:s,n:this.n,h:this.h});if(null!=r){const[,t]=this._scale(n);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromShort(this.g),n.g.normalize()),n}pointFromJSON(t){return u.fromJSON(this,t)}toJSON(t){const e=super.toJSON(t);return e.a=this.a.fromRed().toJSON(),e.b=this.b.fromRed().toJSON(),this.c.isZero()||(e.c=this.c.fromRed().toJSON()),e}}class u extends h{constructor(t,e,r,i){B(t instanceof f),super(t,0),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=1,null!=e&&this._init(e,r,i)}_init(t,e,r){B(t instanceof s),B(e instanceof s),this.x=t,this.y=e,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=0|r}_safeNAF(t){return B(t>>>0===t),this.pre&&this.pre.naf?this.pre.naf:t>1?this.toJ()._getNAF(t):this._getNAF(t)}_getBeta(){if(!this.curve.endo)return null;if(this.pre&&this.pre.beta)return this.pre.beta;const t=this.x.redMul(this.curve.endo.beta),e=this.curve.point(t,this.y);return this.pre&&(e.pre=this.pre.map((t=>{const e=t.x.redMul(this.curve.endo.beta);return this.curve.point(e,t.y)})),this.pre.beta=e),e}_getJNAF(t){if(B(t instanceof u),this.inf|t.inf)return super._getJNAF(t);const e=[this,null,null,t];return this.y.eq(t.y)?(e[1]=this.add(t),e[2]=this.toJ().add(t.neg())):this.y.eq(t.y.redNeg())?(e[1]=this.toJ().add(t),e[2]=this.add(t.neg())):(e[1]=this.toJ().add(t),e[2]=this.toJ().add(t.neg())),e}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.inf)}swap(t,e){B(t instanceof u);const r=1&(e>>31|-e>>31),i=this.inf,s=t.inf;return this.x.cswap(t.x,e),this.y.cswap(t.y,e),this.inf=i&(1^r)|s&r,t.inf=s&(1^r)|i&r,this}scale(t){return this.toJ().scale(t)}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(t){if(B(t instanceof u),this.inf)return t;if(t.inf)return this;if(this.x.eq(t.x))return this.y.eq(t.y)?this.dbl():this.curve.point();if(this.y.eq(t.y)){const e=this.x.redNeg().redISub(t.x),r=this.y.redNeg();return this.curve.point(e,r)}const e=this.x.redSub(t.x),r=this.y.redSub(t.y).redDiv(e),i=r.redSqr().redISub(this.x).redISub(t.x),s=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const t=this.x.redSqr().redIMuln(3).redIAdd(this.curve.a),e=this.y.redMuln(2),r=t.redDiv(e),i=r.redSqr().redISub(this.x).redISub(this.x),s=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)}uadd(t){B(t instanceof u);const e=this.y.redAdd(t.y),r=this.x.redAdd(t.x).redSqr(),i=this.x.redMul(t.x),s=r.redISub(i).redIAdd(this.curve.a),n=e.czero()&s.czero();e.cinject(this.x.redSub(t.x),n),s.cinject(this.y.redSub(t.y),n);const o=e.czero()&(1^(this.inf|t.inf));e.cinject(this.curve.one,e.czero());const h=s.redMul(e.redFermat()),f=h.redSqr().redISub(this.x).redISub(t.x),a=h.redMul(this.x.redSub(f)).redISub(this.y),c=o|this.inf&t.inf;return f.cinject(t.x,this.inf),a.cinject(t.y,this.inf),f.cinject(this.x,t.inf),a.cinject(this.y,t.inf),f.cinject(this.curve.zero,c),a.cinject(this.curve.zero,c),this.curve.point(f,a,c)}udbl(){return this.uadd(this)}recover(t,e,r,i){if(B(t instanceof s),B(e instanceof s),B(r instanceof s),B(i instanceof s),this.inf)return this.curve.jpoint();const n=e.redMul(i),o=n.redSqr(),h=o.redMul(n),f=this.x.redMul(n),u=t.redMul(i),a=r.redMul(e),c=this.curve.b.redMul(h).redIMuln(2),d=f.redMul(u).redIAdd(this.curve.a.redMul(o)),l=f.redAdd(u),m=f.redISub(u),p=c.redIAdd(d.redMul(l)),b=a.redMul(m.redSqr()),g=p.redISub(b),w=this.y.redMul(h).redIMuln(2),S=t.redMul(w),y=g.redMul(e),I=e.redMul(w),v=S.redMul(I),E=y.redMul(I.redSqr()),_=I;return this.curve.jpoint(v,E,_)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(t){return B(t instanceof u),this===t||(this.inf?0!==t.inf:!t.inf&&this.x.eq(t.x)&&this.y.eq(t.y))}isInfinity(){return 0!==this.inf}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}isSquare(){return!this.inf&&-1!==this.y.redJacobi()}eqX(t){return B(t instanceof s),B(!t.red),!this.inf&&this.getX().eq(t)}eqXToP(t){return B(t instanceof s),B(!t.red),B(!this.curve.n.isZero()),!this.inf&&this.getX().imod(this.curve.n).eq(t)}mul(t){return super.mul(t).toP()}muln(t){return super.muln(t).toP()}mulSimple(t){return super.mulSimple(t).toP()}mulBlind(t,e){return super.mulBlind(t,e).toP()}mulConst(t,e){return super.mulConst(t,e).toP()}mulAdd(t,e,r){return super.mulAdd(t,e,r).toP()}mulAddSimple(t,e,r){return super.mulAddSimple(t,e,r).toP()}mulH(){return super.mulH().toP()}div(t){return super.div(t).toP()}divn(t){return super.divn(t).toP()}divH(){return super.divH().toP()}toP(){return this}toJ(){return this.inf?this.curve.jpoint():this.curve.jpoint(this.x,this.y,this.curve.one)}encode(t){null==t&&(t=!0),B("boolean"==typeof t);const{fieldSize:e}=this.curve;if(this.inf)throw new Error("Invalid point.");if(t){const t=Buffer.allocUnsafe(1+e),r=this.curve.encodeField(this.getX());return t[0]=2|this.y.redIsOdd(),r.copy(t,1),t}const r=Buffer.allocUnsafe(1+2*e),i=this.curve.encodeField(this.getX()),s=this.curve.encodeField(this.getY());return r[0]=4,i.copy(r,1),s.copy(r,1+e),r}static decode(t,e){B(t instanceof f),B(Buffer.isBuffer(e));const r=t.fieldSize;if(e.length<1+r)throw new Error("Not a point.");const i=e[0];switch(i){case 2:case 3:{if(e.length!==1+r)throw new Error("Invalid point size for compressed.");const s=t.decodeField(e.slice(1,1+r));if(s.cmp(t.p)>=0)throw new Error("Invalid point.");const n=t.pointFromX(s,3===i);return B(!n.isInfinity()),n}case 4:case 6:case 7:{if(e.length!==1+2*r)throw new Error("Invalid point size for uncompressed.");const s=t.decodeField(e.slice(1,1+r)),n=t.decodeField(e.slice(1+r,1+2*r));if(s.cmp(t.p)>=0||n.cmp(t.p)>=0)throw new Error("Invalid point.");if(4!==i&&i!==(6|n.isOdd()))throw new Error("Invalid hybrid encoding.");const o=t.point(s,n);if(!o.validate())throw new Error("Invalid point.");return B(!o.isInfinity()),o}default:throw new Error("Unknown point format.")}}encodeX(){return this.curve.encodeField(this.getX())}static decodeEven(t,e){B(t instanceof f);const r=t.decodeField(e);if(r.cmp(t.p)>=0)throw new Error("Invalid point.");return t.pointFromX(r,!1)}static decodeSquare(t,e){B(t instanceof f);const r=t.decodeField(e);if(r.cmp(t.p)>=0)throw new Error("Invalid point.");return t.pointFromX(r)}toJSON(t){if(this.inf)return[];const e=this.getX().toJSON(),r=this.getY().toJSON();return!0===t&&this.pre?[e,r,this.pre.toJSON()]:[e,r]}static fromJSON(t,e){if(B(t instanceof f),B(Array.isArray(e)),B(0===e.length||2===e.length||3===e.length),0===e.length)return t.point();const r=s.fromJSON(e[0]),i=s.fromJSON(e[1]),n=t.point(r,i);return e.length>2&&null!=e[2]&&(n.pre=g.fromJSON(n,e[2])),n}[i](){return this.inf?"<ShortPoint: Infinity>":"<ShortPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class a extends h{constructor(t,e,r,i){B(t instanceof f),super(t,1),this.x=this.curve.one,this.y=this.curve.one,this.z=this.curve.zero,this.zOne=0,null!=e&&this._init(e,r,i)}_init(t,e,r){B(t instanceof s),B(e instanceof s),B(null==r||r instanceof s),this.x=t,this.y=e,this.z=r||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=0|this.z.eq(this.curve.one)}clone(){return this.curve.jpoint(this.x.clone(),this.y.clone(),this.z.clone())}swap(t,e){B(t instanceof a);const r=1&(e>>31|-e>>31),i=this.zOne,s=t.zOne;return this.x.cswap(t.x,e),this.y.cswap(t.y,e),this.z.cswap(t.z,e),this.zOne=i&(1^r)|s&r,t.zOne=s&(1^r)|i&r,this}validate(){const{a:t,b:e}=this.curve;if(this.isInfinity())return!0;if(this.zOne)return this.curve.validate(this.toP());const r=this.y.redSqr(),i=this.x.redSqr().redMul(this.x),s=this.z.redSqr(),n=s.redSqr(),o=n.redMul(s),h=i.redIAdd(e.redMul(o));return this.curve.zeroA||(this.curve.threeA?h.redIAdd(n.redIMuln(-3).redMul(this.x)):h.redIAdd(t.redMul(n).redMul(this.x))),r.eq(h)}normalize(){if(this.zOne)return this;if(this.isInfinity())return this;const t=this.z.redInvert(),e=t.redSqr();return this.x=this.x.redMul(e),this.y=this.y.redMul(e).redMul(t),this.z=this.curve.one,this.zOne=1,this}scale(t){if(B(t instanceof s),this.isInfinity())return this.curve.jpoint();const e=t.redSqr(),r=this.x.redMul(e),i=this.y.redMul(e).redMul(t),n=this.z.redMul(t);return this.curve.jpoint(r,i,n)}neg(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)}add(t){return B(t instanceof h),0===t.type?this._mixedAdd(t):this._add(t)}_add(t){return B(t instanceof a),this.isInfinity()?t:t.isInfinity()?this:this.zOne&&t.zOne?this._addAA(t):this.zOne?t._addJA(this):t.zOne?this._addJA(t):this._addJJ(t)}_mixedAdd(t){return B(t instanceof u),this.isInfinity()?t.toJ():t.isInfinity()?this:this.zOne?this._addAA(t):this._addJA(t)}_addJJ(t){const e=this.z.redSqr(),r=t.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(e),n=this.y.redMul(t.z).redMul(r),o=t.y.redMul(this.z).redMul(e),h=s.redISub(i),f=o.redISub(n);if(h.isZero())return f.isZero()?this.dbl():this.curve.jpoint();const u=h.redSqr(),a=h.redMul(u),c=i.redMul(u),d=f.redSqr().redISub(a).redISub(c).redISub(c),l=f.redMul(c.redISub(d)).redISub(n.redMul(a)),m=this.z.redMul(t.z).redMul(h);return this.curve.jpoint(d,l,m)}_addJA(t){const e=this.z.redSqr(),r=t.x.redMul(e),i=t.y.redMul(this.z).redMul(e),s=r.redISub(this.x),n=i.redISub(this.y).redIMuln(2);if(s.isZero())return n.isZero()?this.dbl():this.curve.jpoint();const o=s.redMuln(2).redSqr(),h=s.redMul(o),f=this.x.redMul(o),u=n.redSqr().redISub(h).redISub(f).redISub(f),a=n.redMul(f.redISub(u)).redISub(this.y.redMul(h).redIMuln(2)),c=this.z.redMul(s).redIMuln(2);return this.curve.jpoint(u,a,c)}_addAA(t){const e=t.x.redSub(this.x),r=t.y.redSub(this.y).redIMuln(2);if(e.isZero())return r.isZero()?this.dbl():this.curve.jpoint();const i=e.redSqr().redIMuln(4),s=e.redMul(i),n=this.x.redMul(i),o=r.redSqr().redISub(s).redISub(n).redISub(n),h=r.redMul(n.redISub(o)).redISub(this.y.redMul(s).redIMuln(2)),f=e.redIMuln(2);return this.curve.jpoint(o,h,f)}dbl(){return this.isInfinity()?this:this.y.isZero()?this.curve.jpoint():this.zOne?this._dblA():this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}_dblJ(){const t=this.x.redSqr(),e=this.y.redSqr(),r=this.z.redSqr(),i=this.x.redMul(e).redIMuln(4),s=t.redIMuln(3).redIAdd(this.curve.a.redMul(r.redSqr())),n=s.redSqr().redISub(i).redISub(i),o=n,h=s.redMul(i.redISub(n)).redISub(e.redSqr().redIMuln(8)),f=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(o,h,f)}_dblA(){const t=this.x.redSqr(),e=this.y.redSqr(),r=e.redSqr(),i=e.redIAdd(this.x).redSqr().redISub(t).redISub(r).redIMuln(2),s=t.redIMuln(3).redIAdd(this.curve.a),n=s.redSqr().redISub(i).redISub(i),o=n,h=s.redMul(i.redISub(n)).redISub(r.redIMuln(8)),f=this.y.redMuln(2);return this.curve.jpoint(o,h,f)}_dbl0(){const t=this.x.redSqr(),e=this.y.redSqr(),r=e.redSqr(),i=e.redIAdd(this.x).redSqr().redISub(t).redISub(r).redIMuln(2),s=t.redIMuln(3),n=s.redSqr().redISub(i).redISub(i),o=s.redMul(i.redISub(n)).redISub(r.redIMuln(8)),h=this.y.redMul(this.z).redIMuln(2);return this.curve.jpoint(n,o,h)}_dbl3(){const t=this.z.redSqr(),e=this.y.redSqr(),r=this.x.redMul(e),i=this.x.redSub(t),s=this.x.redAdd(t),n=i.redMul(s).redIMuln(3),o=r.redIMuln(4),h=o.redMuln(2),f=e.redSqr().redIMuln(8),u=n.redSqr().redISub(h),a=this.y.redAdd(this.z).redSqr().redISub(e).redISub(t),c=n.redMul(o.redISub(u)).redISub(f);return this.curve.jpoint(u,c,a)}dblp(t){return B(t>>>0===t),this.curve.zeroA||this.curve.threeA?super.dblp(t):0===t||this.isInfinity()?this:this._dblp(t)}_dblp(t){const{a:e,i2:r}=this.curve;let i=this.x,s=this.z,n=this.y.redMuln(2),o=s.redPown(4);for(let r=0;r<t;r++){if(n.isZero())return this.curve.jpoint();const h=i.redSqr(),f=n.redSqr(),u=f.redSqr(),a=h.redIMuln(3).redIAdd(e.redMul(o)),c=i.redMul(f),d=a.redSqr().redISub(c).redISub(c),l=d,m=a.redMul(c.redISub(d)).redIMuln(2).redISub(u),p=n.redMul(s);r+1<t&&(o=o.redMul(u)),i=l,n=m,s=p}return this.curve.jpoint(i,n.redMul(r),s)}uadd(t){return B(t instanceof h),0===t.type?this._uadd(t.toJ()):this._uadd(t)}_uadd(t){B(t instanceof a);const{zero:e,one:r}=this.curve,i=this.z.redSqr(),s=t.z.redSqr(),n=this.x.redMul(s),o=t.x.redMul(i),h=this.y.redMul(s).redMul(t.z),f=t.y.redMul(i).redMul(this.z),u=this.z.redMul(t.z),c=n.redAdd(o),d=h.redAdd(f),l=c.redSqr().redISub(n.redMul(o));if(!this.curve.zeroA){const t=u.redPown(4);this.curve.threeA?l.redIAdd(t.redIMuln(-3)):l.redIAdd(this.curve.a.redMul(t))}const m=d.czero()&l.czero();d.cinject(n.redSub(o),m),l.cinject(h.redSub(f),m);const p=d.redSqr(),b=c.redMul(p),g=p.redSqr();g.cinject(e,m);const w=l.redSqr(),S=u.redMul(d),y=b.redMuln(3).redISub(w).redISub(w),I=w.redISub(b).redIMuln(4),v=l.redMul(y).redISub(g).redIMuln(4),E=S.redIMuln(2),_=this.z.czero(),O=t.z.czero(),N=E.czero()&(1^(_|O));return I.cinject(t.x,_),v.cinject(t.y,_),E.cinject(t.z,_),I.cinject(this.x,O),v.cinject(this.y,O),E.cinject(this.z,O),I.cinject(r,N),v.cinject(r,N),E.cinject(e,N),this.curve.jpoint(I,v,E)}udbl(){const t=this._udbl(),e=this.z.czero()|this.y.czero();return t.x.cinject(this.curve.one,e),t.y.cinject(this.curve.one,e),t.z.cinject(this.curve.zero,e),t}_udbl(){return this.curve.zeroA?this._dbl0():this.curve.threeA?this._dbl3():this._dblJ()}zaddu(t){B(t instanceof a);const e=this.x.redSub(t.x),r=this.y.redSub(t.y),i=e.redSqr(),s=this.x.redMul(i),n=t.x.redMul(i),o=s,h=r.redSqr().redISub(s).redISub(n),f=this.y.redMul(s.redSub(n)),u=r.redMul(o.redSub(h)).redISub(f),c=this.z.redMul(e),d=c;return[this.curve.jpoint(h,u,d),this.curve.jpoint(o,f,c)]}zaddc(t){B(t instanceof a);const e=this.x.redSub(t.x),r=this.y.redSub(t.y),i=this.y.redAdd(t.y),s=e.redSqr(),n=this.x.redMul(s),o=t.x.redMul(s),h=i.redSqr().redISub(n).redISub(o),f=r.redSqr().redISub(n).redISub(o),u=this.y.redMul(o.redISub(n)),c=t.y.redMuln(2).redIAdd(r),d=n.redISub(h),l=h.redAdd(d).redISub(f),m=c.redMul(d).redIAdd(u),p=r.redMul(l).redIAdd(u),b=this.z.redMul(e),g=b;return[this.curve.jpoint(f,p,g),this.curve.jpoint(h,m,b)]}zdblu(){const t=this.x.redSqr(),e=this.y.redSqr(),r=e.redSqr(),i=this.x.redAdd(e).redSqr(),s=t.redMuln(3);if(!this.curve.zeroA){const t=this.z.redPown(4);this.curve.threeA?s.redIAdd(t.redIMuln(-3)):s.redIAdd(this.curve.a.redMul(t))}const n=i.redISub(t).redISub(r).redIMuln(2),o=s.redSqr().redISub(n).redISub(n),h=r.redIMuln(8),f=n.redSub(o).redMul(s).redISub(h),u=this.y.redMul(this.z).redIMuln(2),a=u;return[this.curve.jpoint(o,f,a),this.curve.jpoint(n,h,u)]}recover(t,e,r,i){return this.toP().recover(t,e,r,i)}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.y.fromRed()}eq(t){if(B(t instanceof a),this===t)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return!1;if(this.z.eq(t.z))return this.x.eq(t.x)&&this.y.eq(t.y);const e=this.z.redSqr(),r=t.z.redSqr(),i=this.x.redMul(r),s=t.x.redMul(e);if(!i.eq(s))return!1;const n=e.redMul(this.z),o=r.redMul(t.z),h=this.y.redMul(o),f=t.y.redMul(n);return h.eq(f)}isInfinity(){return this.z.isZero()}isOdd(){return!this.isInfinity()&&(this.normalize(),this.y.redIsOdd())}isEven(){return!this.isInfinity()&&(this.normalize(),this.y.redIsEven())}isSquare(){return!this.isInfinity()&&-1!==this.y.redMul(this.z).redJacobi()}eqX(t){if(B(t instanceof s),B(!t.red),this.isInfinity())return!1;const e=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(e);return this.x.eq(r)}eqXToP(t){if(B(t instanceof s),B(!t.red),!this.curve.smallGap)return this.toP().eqXToP(t);if(this.isInfinity())return!1;const e=this.z.redSqr(),r=t.toRed(this.curve.red).redMul(e);if(this.x.eq(r))return!0;const i=t.clone(),n=this.curve.redN.redMul(e);for(;;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.eq(r))break}return!0}toP(){return this.isInfinity()?this.curve.point():(this.normalize(),this.curve.point(this.x,this.y))}toJ(){return this}encode(t){return this.toP().encode(t)}static decode(t,e){return u.decode(t,e).toJ()}encodeX(){return this.toP().encodeX()}static decodeEven(t,e){return u.decodeEven(t,e).toJ()}static decodeSquare(t,e){return u.decodeSquare(t,e).toJ()}toJSON(t){return this.toP().toJSON(t)}static fromJSON(t,e){return u.fromJSON(t,e).toJ()}[i](){return this.isInfinity()?"<JPoint: Infinity>":"<JPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class c extends o{constructor(t){super(d,"mont",t),this.a=s.fromJSON(t.a).toRed(this.red),this.b=s.fromJSON(t.b).toRed(this.red),this.bi=this.b.redInvert(),this.a2=this.a.redAdd(this.two),this.a24=this.a2.redMul(this.i4),this.a3=this.a.redMul(this.i3),this.a0=this.a.redMul(this.bi),this.b0=this.bi.redSqr(),this._finalize(t)}static _isomorphism(t,e,r){B(t instanceof s),B(e instanceof s),B(r instanceof s);const i=t.clone(),n=r.clone();if(1!==e.redDiv(r).redJacobi())throw new Error("Invalid `b` coefficient.");return[i,n]}_short(t,e){const{a:r,b:i,three:s}=this,n=r.redSqr(),o=n.redMul(r),h=i.redSqr(),u=h.redMul(i),a=s.redSub(n),c=h.redMuln(3),d=o.redMuln(2).redISub(r.redMuln(9)),l=u.redMuln(27),m=a.redDiv(c),p=d.redDiv(l);return null!=t?f._isomorphism(m,p,t,e):[m,p]}_mont(t){return c._isomorphism(this.a,this.b,t)}_edwards(t,e=!1){B("boolean"==typeof e);const{two:r,bi:i}=this,s=this.a.redAdd(r).redMul(i),n=this.a.redSub(r).redMul(i);return e&&s.swap(n),null!=t?m._isomorphism(s,n,t):[s,n]}_scaleShort(t){B(t instanceof f);const[e,r]=t._scale(this);return[this.field(e.redInvert()),this.field(r.redInvert())]}_scaleMont(t){return B(t instanceof c),this.g.isInfinity()||t.g.isInfinity()?this.field(t.b).redDivSqrt(this.b):this.g.y.redDiv(this.field(t.g.y))}_scaleEdwards(t,e){B(t instanceof m);const r=t._scale(this,e);return this.field(r)}_solveY0(t){B(t instanceof s);const e=this.a0,r=this.b0,i=t.redSqr();return i.redMul(t).redIAdd(e.redMul(i)).redIAdd(r.redMul(t))}_elligator2(t){const e=this.a0.redNeg(),r=this.one.redAdd(this.z.redMul(t.redSqr()));r.cinject(this.one,r.czero());const i=e.redMul(r.redFermat()),s=i.redNeg().redISub(this.a0),n=this._solveY0(i),o=this._solveY0(s),h=0|n.redIsSquare(),f=i.cinject(s,1^h),u=n.cinject(o,1^h).redSqrt();u.cinject(u.redNeg(),u.redIsOdd()^t.redIsOdd());const a=this.b.redMul(f),c=this.b.redMul(u);return this.point(a,c)}_invert2(t,e){const{x:r,y:i}=t,s=1&e,n=r.redMul(this.bi),o=i.redMul(this.bi),h=n.redAdd(this.a0),f=n;h.cswap(f,s);const u=h.redINeg(),a=f.redMul(this.z),[c,d]=M(u,a);if(d.cinject(d.redNeg(),d.redIsOdd()^o.redIsOdd()),!c)throw new Error("Invalid point.");return d}_constMul(t,e,r){B(t instanceof d);const i=t.toX(),[s,n]=i.ladderConst(e,r),o=t.recover(n,s);return e.isNeg()?o.neg():o}isElliptic(){const t=this.a.redSqr();return!this.b.redMul(t.redSub(this.four)).isZero()}jinv(){const{a:t,three:e,four:r}=this,i=t.redSqr(),s=i.redSub(e).redPown(3).redIMuln(256),n=i.redSub(r);if(n.isZero())throw new Error("Curve is not elliptic.");return s.redDiv(n).fromRed()}point(t,e,r=0){return new d(this,t,e,r)}jpoint(t,e,r){return B(null==t&&null==e&&null==r),this.point()}xpoint(t,e){return new l(this,t,e)}solveY2(t){B(t instanceof s);const e=t.redSqr();return e.redMul(t).redIAdd(this.a.redMul(e)).redIAdd(t).redMul(this.bi)}validate(t){if(B(t instanceof d),t.isInfinity())return!0;const{x:e,y:r}=t,i=this.solveY2(e);return r.redSqr().eq(i)}pointFromX(t,e=null){B(t instanceof s),B(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveY(t);return null!=e&&r.redIsOdd()!==e&&r.redINeg(),this.point(t,r)}isIsomorphic(t,e){if(B(t instanceof o),!t.p.eq(this.p))return!1;if("mont"===t.type){const e=this.field(t.a),r=this.field(t.b);return!!this.a.eq(e)&&(!this.b.isZero()&&1===r.redDiv(this.b).redJacobi())}return t.isIsomorphic(this,e)}isIsogenous(t){return B(t instanceof o),"mont"!==t.type&&t.isIsogenous(this)}pointFromShort(t){if(B(t instanceof u),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const{a3:e,b:r}=this,[i,s]=this._scale(t.curve),n=this.field(t.x).redMul(i),o=this.field(t.y).redMul(s),h=r.redMul(n).redISub(e),f=r.redMul(o);return this.point(h,f)}throw new Error("Not implemented.")}pointFromMont(t){if(B(t instanceof d),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();const e=this._scale(t.curve),r=this.field(t.x),i=this.field(t.y),s=r,n=e.redMul(i);return this.point(s,n)}throw new Error("Not implemented.")}pointFromEdwards(t){B(t instanceof p),B(t.curve.p.eq(this.p));const e=this.field(t.x),r=this.field(t.y),i=this.field(t.z);if(this.isIsogenous(t.curve)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.zero);const s=i.redSqr().redIMuln(2),n=r.redSqr(),o=e.redSqr(),h=s.redISub(o).redISub(n).redMul(r),f=o.redMul(e);return this.cpoint(n,o,h,f)}if(this.isIsomorphic(t.curve,!0)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.zero);const s=this._scale(t.curve,!0),n=r.redAdd(i),o=r.redSub(i),h=s.redMul(i).redMul(n),f=e.redMul(o);return this.cpoint(n,o,h,f)}if(this.isIsomorphic(t.curve,!1)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.zero);const s=this._scale(t.curve,!1),n=i.redAdd(r),o=i.redSub(r),h=s.redMul(i).redMul(n),f=e.redMul(o);return this.cpoint(n,o,h,f)}throw new Error("Not implemented.")}pointFromUniform(t){if(B(t instanceof s),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");return this._elligator2(t)}pointToUniform(t,e){if(B(t instanceof d),B(e>>>0===e),this.z.isZero()||this.a.isZero())throw new Error("Not implemented.");if(t.isInfinity())throw new Error("Invalid point.");return this._invert2(t,e)}decodePoint(t,e){return d.decode(this,t,e)}encodeX(t){return B(t instanceof l),t.encode()}decodeX(t){return l.decode(this,t)}toShort(t,e,r=null){const[i,s]=this._short(t,e),n=new f({red:this.red,prime:this.prime,p:this.p,a:i,b:s,n:this.n,h:this.h});if(null!=r){const[,t]=n._scale(this);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromMont(this.g)),n}toMont(t,e=null){const[r,i]=this._mont(t),s=new c({red:this.red,prime:this.prime,p:this.p,a:r,b:i,n:this.n,h:this.h,z:this.z});if(null!=e){const t=s._scale(this);t.redIsOdd()!==e&&t.redINeg()}return this.g.isInfinity()||(s.g=s.pointFromMont(this.g)),s}toEdwards(t,e,r=null){const[i,s]=this._edwards(t,e),n=new m({red:this.red,prime:this.prime,p:this.p,a:i,d:s,n:this.n,h:this.h,z:this.z});if(null!=r){const t=n._scale(this,e);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromMont(this.g),n.g.normalize()),n}pointFromJSON(t){return d.fromJSON(this,t)}toJSON(t){const e=super.toJSON(t);return e.a=this.a.fromRed().toJSON(),e.b=this.b.fromRed().toJSON(),e}}class d extends h{constructor(t,e,r,i){B(t instanceof c),super(t,0),this.x=this.curve.zero,this.y=this.curve.zero,this.inf=1,null!=e&&this._init(e,r,i)}_init(t,e,r){B(t instanceof s),B(e instanceof s),this.x=t,this.y=e,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=0|r}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.inf)}swap(t,e){B(t instanceof d);const r=1&(e>>31|-e>>31),i=this.inf,s=t.inf;return this.x.cswap(t.x,e),this.y.cswap(t.y,e),this.inf=i&(1^r)|s&r,t.inf=s&(1^r)|i&r,this}scale(t){return this.clone()}randomize(t){return this.clone()}neg(){return this.inf?this:this.curve.point(this.x,this.y.redNeg())}add(t){if(B(t instanceof d),this.inf)return t;if(t.inf)return this;if(this.x.eq(t.x))return this.y.eq(t.y)?this.dbl():this.curve.point();const e=t.x.redSub(this.x),r=t.y.redSub(this.y).redDiv(e),i=this.curve.b.redMul(r.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(t.x),s=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,s)}dbl(){if(this.inf)return this;if(this.y.isZero())return this.curve.point();const t=this.x.redSqr().redIMuln(3),e=this.curve.a.redMul(this.x).redIMuln(2),r=t.redIAdd(e).redIAdd(this.curve.one),i=this.curve.b.redMul(this.y).redIMuln(2),s=r.redDiv(i),n=this.curve.b.redMul(s.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(this.x),o=s.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,o)}uadd(t){B(t instanceof d);const e=t.x.redSub(this.x),r=t.y.redSub(this.y),i=this.x.redSqr().redIMuln(3),s=this.curve.a.redMul(this.x).redIMuln(2),n=i.redIAdd(s).redIAdd(this.curve.one),o=this.curve.b.redMul(this.y).redIMuln(2),h=e.czero()&r.czero();r.cinject(n,h),e.cinject(o,h);const f=e.czero()&(1^(this.inf|t.inf));e.cinject(this.curve.one,e.czero());const u=r.redMul(e.redFermat()),a=this.curve.b.redMul(u.redSqr()).redISub(this.curve.a).redISub(this.x).redISub(t.x),c=u.redMul(this.x.redSub(a)).redISub(this.y),l=f|this.inf&t.inf;return a.cinject(t.x,this.inf),c.cinject(t.y,this.inf),a.cinject(this.x,t.inf),c.cinject(this.y,t.inf),a.cinject(this.curve.zero,l),c.cinject(this.curve.zero,l),this.curve.point(a,c,l)}udbl(){return this.uadd(this)}recover(t,e){if(B(t instanceof l),B(e instanceof l),this.inf)return this.curve.point();const r=this.x.redMul(t.z),i=t.x.redAdd(r),s=t.x.redSub(r).redSqr().redMul(e.x),n=this.curve.a.redMul(t.z).redIMuln(2),o=i.redIAdd(n),h=this.x.redMul(t.x).redIAdd(t.z),f=o.redMul(h),u=n.redMul(t.z),a=f.redISub(u).redMul(e.z),c=this.curve.b.redMul(this.y).redIMuln(2).redMul(t.z).redMul(e.z),d=c.redMul(t.x),m=a.redISub(s),p=c.redMul(t.z);if(p.isZero())return this.curve.point();const b=p.redInvert(),g=d.redMul(b),w=m.redMul(b);return this.curve.point(g,w)}getX(){if(this.inf)throw new Error("Invalid point.");return this.x.fromRed()}getY(){if(this.inf)throw new Error("Invalid point.");return this.y.fromRed()}eq(t){return B(t instanceof d),this===t||(this.inf?0!==t.inf:!t.inf&&this.x.eq(t.x)&&this.y.eq(t.y))}isInfinity(){return 0!==this.inf}isOdd(){return!this.inf&&this.y.redIsOdd()}isEven(){return!this.inf&&this.y.redIsEven()}toP(){return this}toJ(){return this}toX(){return this.inf?this.curve.xpoint():this.curve.xpoint(this.x,this.curve.one)}encode(){return this.toX().encode()}static decode(t,e,r){return B(t instanceof c),t.decodeX(e).toP(r)}toJSON(t){return this.inf?[]:[this.getX().toJSON(),this.getY().toJSON()]}static fromJSON(t,e){if(B(t instanceof c),B(Array.isArray(e)),B(0===e.length||2===e.length||3===e.length),0===e.length)return t.point();const r=s.fromJSON(e[0]),i=s.fromJSON(e[1]);return t.point(r,i)}[i](){return this.inf?"<MontPoint: Infinity>":"<MontPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+">"}}class l extends h{constructor(t,e,r){B(t instanceof c),super(t,2),this.x=this.curve.one,this.z=this.curve.zero,null!=e&&this._init(e,r)}_init(t,e){B(t instanceof s),B(null==e||e instanceof s),this.x=t,this.z=e||this.curve.one,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red))}clone(){return this.curve.xpoint(this.x.clone(),this.z.clone())}swap(t,e){return B(t instanceof l),this.x.cswap(t.x,e),this.z.cswap(t.z,e),this}precompute(t,e){return this}validate(){if(this.isInfinity())return!0;const{x:t,z:e}=this,r=t.redSqr(),i=r.redMul(t),s=e.redSqr(),n=this.curve.a.redMul(r).redMul(e);return-1!==i.redIAdd(n).redIAdd(t.redMul(s)).redMul(this.curve.bi).redMul(e).redJacobi()}normalize(){return this.isInfinity()||this.z.eq(this.curve.one)||(this.x=this.x.redDiv(this.z),this.z=this.curve.one),this}scale(t){if(B(t instanceof s),this.isInfinity())return this.curve.xpoint();const e=this.x.redMul(t),r=this.z.redMul(t);return this.curve.xpoint(e,r)}neg(){return this}dbl(){const t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),r=t.redSub(e),i=t.redMul(e),s=r.redMul(e.redIAdd(this.curve.a24.redMul(r)));return this.curve.xpoint(i,s)}diffAdd(t,e){B(t instanceof l),B(e instanceof l);const r=t.x.redAdd(t.z),i=t.x.redSub(t.z),s=e.x.redAdd(e.z),n=e.x.redSub(e.z).redMul(r),o=s.redMul(i),h=this.z.redMul(n.redAdd(o).redSqr()),f=this.x.redMul(n.redISub(o).redSqr());return this.curve.xpoint(h,f)}diffAddDbl(t,e){B(t instanceof l),B(e instanceof l);const r=e.x.redAdd(e.z),i=r.redSqr(),s=e.x.redSub(e.z),n=s.redSqr(),o=i.redSub(n),h=t.x.redAdd(t.z),f=t.x.redSub(t.z).redMul(r),u=h.redMul(s),a=this.z.redMul(f.redAdd(u).redSqr()),c=this.x.redMul(f.redISub(u).redSqr()),d=i.redMul(n),m=o.redMul(n.redIAdd(this.curve.a24.redMul(o)));return[this.curve.xpoint(a,c),this.curve.xpoint(d,m)]}getX(){if(this.isInfinity())throw new Error("Invalid point.");return this.normalize(),this.x.fromRed()}getY(t){return this.toP(t).getY()}eq(t){if(B(t instanceof l),this===t)return!0;if(this.isInfinity())return t.isInfinity();if(t.isInfinity())return!1;if(this.z.eq(t.z))return this.x.eq(t.x);const e=this.x.redMul(t.z),r=t.x.redMul(this.z);return e.eq(r)}isInfinity(){return this.z.isZero()}isOdd(){return!1}isEven(){return!1}hasTorsion(){return!this.isInfinity()&&(!!this.x.isZero()||super.hasTorsion())}jmul(t){return this.ladder(t)[1]}jmulSimple(t){return this.ladderSimple(t)[1]}jmulBlind(t,e){return this.ladderBlind(t,e)[1]}jmulConst(t,e){return this.ladderConst(t,e)[1]}jmulAdd(t,e,r){throw new Error("Not implemented.")}jmulAddSimple(t,e,r){throw new Error("Not implemented.")}ladder(t){B(t instanceof s),B(!t.red);const e=t.bitLength();let r=this,i=this.curve.xpoint();for(let s=e-1;s>=0;s--)0===t.utestn(s)?[r,i]=this.diffAddDbl(r,i):[i,r]=this.diffAddDbl(i,r);return[r,i]}ladderSimple(t){B(t instanceof s),B(!t.red);const e=t.bitLength();let r=this,i=this.curve.xpoint();for(let s=e-1;s>=0;s--)0===t.utestn(s)?(r=this.diffAdd(r,i),i=i.dbl()):(i=this.diffAdd(i,r),r=r.dbl());return[r,i]}ladderBlind(t,e){return e?this.randomize(e).ladder(t):this.ladder(t)}ladderConst(t,e){B(t instanceof s),B(!t.red);const r=Math.max(t.bitLength(),this.curve.fieldBits),i=r+7>>>3,n=t.toArray("le",i),o=e?this.randomize(e):this;let h=o.clone(),f=this.curve.xpoint().clone(),u=0;for(let t=r-1;t>=0;t--){const e=n[t>>3]>>(7&t)&1;h.swap(f,u^e),[h,f]=o.diffAddDbl(h,f),u=e}return h.swap(f,u),[h,f]}toP(t=null){return B(null==t||"boolean"==typeof t),this.isInfinity()?this.curve.point():(this.normalize(),this.curve.pointFromX(this.x,t))}toJ(){return this}toX(){return this}encode(){return this.curve.encodeField(this.getX())}static decode(t,e){B(t instanceof c);const r=t.decodeField(e);r.iumaskn(t.fieldBits);const i=t.xpoint(r,t.one);return B(!i.isInfinity()),i}toJSON(t){return this.toP().toJSON(t)}static fromJSON(t,e){return d.fromJSON(t,e).toX()}[i](){return this.isInfinity()?"<XPoint: Infinity>":"<XPoint: x="+this.x.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class m extends o{constructor(t){super(p,"edwards",t),this.a=s.fromJSON(t.a).toRed(this.red),this.d=s.fromJSON(t.d).toRed(this.red),this.s=s.fromJSON(t.s||"0").toRed(this.red),this.si=this.s.isZero()?this.zero:this.s.redInvert(),this.k=this.d.redMuln(2),this.smi=-this.d.redNeg().word(0),this.ad6=this.a.redAdd(this.d).redMul(this.i6),this.twisted=!this.a.eq(this.one),this.oneA=this.a.eq(this.one),this.mOneA=this.a.eq(this.one.redNeg()),this.smallD=null!=this.prime&&1===this.d.redNeg().length,this.alt=null,this._finalize(t)}static _isomorphism(t,e,r){B(t instanceof s),B(e instanceof s),B(r instanceof s);const i=r.clone(),n=r.redMul(e).redDiv(t);if(1!==t.redDiv(r).redJacobi())throw new Error("Invalid `a` coefficient.");return[i,n]}_short(t,e){const{a:r,d:i}=this,s=r.redSqr(),n=s.redMul(r),o=i.redSqr(),h=o.redMul(i),u=r.redMul(i).redIMuln(14),a=s.redMul(i),c=r.redMul(o),d=a.redIAdd(c).redIMuln(33),l=s.redAdd(u).redIAdd(o).redDivn(-48),m=d.redISub(n).redISub(h).redDivn(864);return null!=t?f._isomorphism(l,m,t,e):[l,m]}_mont(t,e=!1){let r,i;B("boolean"==typeof e),e?(r=this.d.redAdd(this.a),i=this.d.redSub(this.a)):(r=this.a.redAdd(this.d),i=this.a.redSub(this.d));const s=i.redInvert(),n=r.redMuln(2).redMul(s),o=s.redMuln(4);return null!=t?c._isomorphism(n,o,t):[n,o]}_edwards(t){return m._isomorphism(this.a,this.d,t)}_scaleShort(t){B(t instanceof f);const[e,r]=t._scale(this);return[this.field(e.redInvert()),this.field(r.redInvert())]}_scaleMont(t,e=!1){if(B(t instanceof c),B("boolean"==typeof e),this.g.isInfinity()||t.g.isInfinity()){const[r]=t._edwards(null,e);return this.field(r).redDivSqrt(this.a)}const r=t.g.x.redDiv(t.g.y);return this.g.x.redDiv(this.field(r))}_scaleEdwards(t){return B(t instanceof m),this.g.isInfinity()||t.g.isInfinity()?this.field(t.a).redDivSqrt(this.a):this.g.x.redDiv(this.field(t.g.x))}_mulA(t){return B(t instanceof s),this.oneA?t.clone():this.mOneA?t.redNeg():this.a.redMul(t)}_mulD(t){return B(t instanceof s),this.smallD?t.redMuln(this.smi):this.d.redMul(t)}_elligator1(t){const{s:e,si:r,i2:i,one:s,two:n}=this,o=r.redSqr().redIMuln(2),h=e.redSqr().redMul(i),f=h.redSqr(),u=o.redAdd(h),a=u.redSqr().redISub(n),c=o.redSub(s),d=this.p.subn(2),l=this.p.subn(1).iushrn(1),m=this.p.addn(1).iushrn(2),p=s.redSub(t),b=s.redAdd(t),g=p.redMul(b.redPow(d)),w=g.redSqr(),S=w.redMul(g),y=S.redMul(w).redAdd(a.redMul(S)).redIAdd(g),I=y.redPow(l),v=w.redAdd(f).redPow(l),E=I.redMul(v),_=I.redMul(g),O=I.redMul(y).redPow(m).redMul(E),N=s.redAdd(_),B=u.redMul(_),A=N.redSqr(),M=c.redMul(e).redMul(_).redMul(N),P=O.cinject(this.one,g.czero()),R=B.redSub(A),x=B.redAdd(A);return this.cpoint(M,P,R,x)}_invert1(t,e){const{s:r,si:i,i2:s,one:n}=this,{x:o,y:h,z:f}=t,u=1&e,a=i.redSqr().redIMuln(2),c=r.redSqr().redMul(s),d=c.redSqr(),l=a.redAdd(c),m=a.redSub(n),p=this.p.subn(2),b=this.p.subn(1).iushrn(1),g=this.p.addn(1).iushrn(2),w=h.redSub(f),S=h.redAdd(f).redIMuln(2),y=w.redMul(S.redPow(p)),I=n.redAdd(y.redMul(l)),v=I.redSqr().redISub(n),E=v.redPow(g),_=E.redSqr().ceq(v),O=E.redSub(I),N=n.redAdd(O),B=m.redMul(r).redMul(O).redMul(N).redMul(o.redMul(f)),A=O.redSqr().redIAdd(d),M=B.redMul(A).redPow(b).redMul(O),P=n.redSub(M),R=n.redAdd(M),x=P.redMul(R.redPow(p));if(x.cinject(x.redNeg(),x.redIsOdd()^u),!_)throw new Error("Invalid point.");return x}_alt(){return this.alt||(this.alt=this.toMont()),this.alt}isElliptic(){const t=this.a.redMul(this.d),e=this.a.redSub(this.d);return!t.redMul(e).isZero()}jinv(){const{a:t,d:e}=this,r=t.redMul(e),i=t.redSub(e).redPown(4),s=t.redSqr(),n=e.redSqr(),o=s.redAdd(r.redMuln(14)).redIAdd(n).redPown(3).redIMuln(16),h=r.redMul(i);if(h.isZero())throw new Error("Curve is not elliptic.");return o.redDiv(h).fromRed()}point(t,e,r,i){return new p(this,t,e,r,i)}jpoint(t,e,r){return B(null==t&&null==e&&null==r),this.point()}cpoint(t,e,r,i){B(t instanceof s),B(e instanceof s),B(r instanceof s),B(i instanceof s);const n=t.redMul(i),o=r.redMul(e),h=e.redMul(i),f=t.redMul(r);return this.point(n,o,h,f)}solveX2(t){B(t instanceof s);const e=t.redSqr(),r=this._mulD(e).redISub(this.a);return e.redISub(this.one).redDiv(r)}solveX(t){const e=t.redSqr(),r=this._mulD(e).redISub(this.a);return e.redISub(this.one).redDivSqrt(r)}solveY2(t){B(t instanceof s);const e=t.redSqr(),r=this._mulA(e).redISub(this.one),i=this._mulD(e).redISub(this.one);return r.redDiv(i)}solveY(t){const e=t.redSqr(),r=this._mulA(e).redISub(this.one),i=this._mulD(e).redISub(this.one);return r.redDivSqrt(i)}validate(t){if(B(t instanceof p),t.zOne){const e=t.x.redSqr(),r=t.y.redSqr(),i=this._mulD(e).redMul(r),s=this._mulA(e).redIAdd(r),n=this.one.redAdd(i),o=t.t,h=t.x.redMul(t.y);return s.eq(n)&&o.eq(h)}const e=t.x.redSqr(),r=t.y.redSqr(),i=t.z.redSqr(),s=i.redSqr(),n=this._mulD(e).redMul(r),o=this._mulA(e).redIAdd(r).redMul(i),h=s.redIAdd(n),f=t.t.redMul(t.z),u=t.x.redMul(t.y);return o.eq(h)&&f.eq(u)}pointFromX(t,e=null){B(t instanceof s),B(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveY(t);if(null!=e){if(r.isZero()&&e)throw new Error("Invalid point.");r.redIsOdd()!==e&&r.redINeg()}return this.point(t,r)}pointFromY(t,e=null){B(t instanceof s),B(null==e||"boolean"==typeof e),t.red||(t=t.toRed(this.red));const r=this.solveX(t);if(null!=e){if(r.isZero()&&e)throw new Error("Invalid point.");r.redIsOdd()!==e&&r.redINeg()}return this.point(r,t)}isIsomorphic(t,e=!1){if(B(t instanceof o),B("boolean"==typeof e),!t.p.eq(this.p))return!1;if("short"===t.type)return t.isIsomorphic(this);if("mont"===t.type){const r=this.field(t.a);let i,s;return e?(i=this.d.redAdd(this.a),s=this.d.redSub(this.a)):(i=this.a.redAdd(this.d),s=this.a.redSub(this.d)),r.redMul(s).eq(i.redIMuln(2))}if("edwards"===t.type){const e=this.field(t.a),r=this.field(t.d);return this.a.redMul(r).eq(e.redMul(this.d))}return!1}isIsogenous(t){if(B(t instanceof o),!t.p.eq(this.p))return!1;if("mont"===t.type){if(!this.a.eq(this.one))return!1;const e=this.field(t.a),r=this.field(t.b),i=this.two.redSub(this.d.redMuln(4));return e.eq(i)&&r.eq(this.one)}if("edwards"===t.type){const e=this.field(t.a),r=this.field(t.d);return e.eq(this.a.redNeg())&&r.eq(this.d.redSub(this.a))}return!1}pointFromShort(t){if(B(t instanceof u),this.isIsomorphic(t.curve)){if(t.isInfinity())return this.point();if(t.y.isZero())return this.point(this.zero,this.one.redNeg());const{a:e,d:r}=this,[i,s]=this._scale(t.curve),n=e.redMuln(5),o=r.redMuln(5),h=this.field(t.x).redMul(i),f=this.field(t.y).redMul(s),u=h.redMuln(6),a=h.redMuln(12),c=u.redSub(e).redISub(r),d=f.redMuln(6),l=a.redSub(n).redIAdd(r),m=a.redAdd(e).redISub(o);return this.cpoint(c,d,l,m)}throw new Error("Not implemented.")}pointFromMont(t){B(t instanceof d),B(t.curve.p.eq(this.p));const e=this.field(t.x),r=this.field(t.y);if(this.isIsogenous(t.curve)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point();const i=e.redSqr(),s=i.redMul(e),n=s.redMul(e),o=n.redMul(e),h=r.redSqr(),f=r.redMuln(4),u=i.redSub(this.one),a=i.redMuln(2),c=h.redMuln(4),d=s.redIMuln(2),l=e.redMul(h).redIMuln(4),m=i.redMul(h).redIMuln(2),p=h.redIMuln(2),b=f.redMul(u),g=n.redISub(a).redIAdd(c).redIAdd(this.one),w=o.redSub(d).redISub(l).redIAdd(e).redINeg(),S=o.redISub(m).redISub(d).redISub(p).redIAdd(e);return this.cpoint(b,g,w,S).divn(4)}if(this.isIsomorphic(t.curve,!0)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(t.curve,!0).redMul(e),s=r,n=e.redAdd(this.one),o=e.redSub(this.one);return this.cpoint(i,s,n,o)}if(this.isIsomorphic(t.curve,!1)){if(t.isInfinity())return this.point();if(t.x.isZero())return this.point(this.zero,this.one.redNeg());const i=this._scale(t.curve,!1).redMul(e),s=r,n=e.redSub(this.one),o=e.redAdd(this.one);return this.cpoint(i,s,n,o)}throw new Error("Not implemented.")}pointFromEdwards(t){B(t instanceof p),B(t.curve.p.eq(this.p));const e=this.field(t.curve.a),r=this.field(t.x),i=this.field(t.y),s=this.field(t.z),n=this.field(t.t);if(this.isIsogenous(t.curve)){const t=r.redMul(i),n=r.redSqr(),o=i.redSqr(),h=s.redSqr(),f=e.redMul(n),u=t.redIMuln(2),a=o.redSub(f),c=o.redAdd(f),d=h.redIMuln(2).redISub(c),l=this.cpoint(u,a,c,d);return this.twisted?l:l.divn(4)}if(this.isIsomorphic(t.curve)){const e=this._scale(t.curve),o=e.redMul(r),h=i,f=s,u=e.redMul(n);return this.point(o,h,f,u)}throw new Error("Not implemented.")}pointFromUniform(t,e=null){B(t instanceof s),B(t.red===this.red),B(null==e||e instanceof c),e||(e=this._alt());const r=e.field(t),i=e.pointFromUniform(r);return this.pointFromMont(i)}pointToUniform(t,e,r=null){B(t instanceof p),B(e>>>0===e),B(null==r||r instanceof c),r||(r=this._alt());const i=r.pointFromEdwards(t),s=r.pointToUniform(i,e);return this.field(s)}pointFromHash(t,e,r=null){B(null==r||r instanceof c),r||(r=this._alt());const i=r.pointFromHash(t,e);return this.pointFromMont(i)}pointToHash(t,e,r=null){B(null==r||r instanceof c),r||(r=this._alt());const i=r.pointFromEdwards(t);return r.pointToHash(i,e)}decodePoint(t){return p.decode(this,t)}toShort(t,e,r=null){const[i,s]=this._short(t,e),n=new f({red:this.red,prime:this.prime,p:this.p,a:i,b:s,n:this.n,h:this.h});if(null!=r){const[,t]=n._scale(this);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromEdwards(this.g)),n}toMont(t,e,r=null){const[i,s]=this._mont(t,e),n=new c({red:this.red,prime:this.prime,p:this.p,a:i,b:s,n:this.n,h:this.h,z:this.z});if(null!=r){const t=this._scale(n,e);t.redIsOdd()!==r&&t.redINeg()}return this.g.isInfinity()||(n.g=n.pointFromEdwards(this.g)),n}toEdwards(t,e=null){const[r,i]=this._edwards(t),s=new m({red:this.red,prime:this.prime,p:this.p,a:r,d:i,n:this.n,h:this.h,z:this.z});if(null!=e){const t=s._scale(this);t.redIsOdd()!==e&&t.redINeg()}return this.g.isInfinity()||(s.g=s.pointFromEdwards(this.g),s.g.normalize()),s}pointFromJSON(t){return p.fromJSON(this,t)}toJSON(t){const e=super.toJSON(t);return e.a=this.a.fromRed().toJSON(),e.d=this.d.fromRed().toJSON(),this.s.isZero()||(e.s=this.s.fromRed().toJSON()),e}}class p extends h{constructor(t,e,r,i,s){B(t instanceof m),super(t,3),this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=1,null!=e&&this._init(e,r,i,s)}_init(t,e,r,i){B(t instanceof s),B(e instanceof s),B(null==r||r instanceof s),B(null==i||i instanceof s),this.x=t,this.y=e,this.z=r||this.curve.one,this.t=i||null,this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=0|this.z.eq(this.curve.one),this._check(),this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redDiv(this.z)))}_check(){if(this.z.isZero())throw new Error("Invalid point.")}clone(){return this.curve.point(this.x.clone(),this.y.clone(),this.z.clone(),this.t.clone())}swap(t,e){B(t instanceof p);const r=1&(e>>31|-e>>31),i=this.zOne,s=t.zOne;return this.x.cswap(t.x,e),this.y.cswap(t.y,e),this.z.cswap(t.z,e),this.t.cswap(t.t,e),this.zOne=i&(1^r)|s&r,t.zOne=s&(1^r)|i&r,this}normalize(){if(this.zOne)return this;const t=this.z.redInvert();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t=this.t.redMul(t),this.z=this.curve.one,this.zOne=1,this}scale(t){B(t instanceof s);const e=this.x.redMul(t),r=this.y.redMul(t),i=this.z.redMul(t),n=this.t.redMul(t);return this.curve.point(e,r,i,n)}neg(){const t=this.x.redNeg(),e=this.y,r=this.z,i=this.t.redNeg();return this.curve.point(t,e,r,i)}add(t){return B(t instanceof p),this.isInfinity()?t:t.isInfinity()?this:this.zOne?t._add(this,0):this._add(t,0)}_add(t,e){return this.curve.mOneA?this._addM1(t,e):this._addA(t,e)}_addM1(t,e){const r=t.zOne&(1^e),i=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),s=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),n=this.t.redMul(this.curve.k).redMul(t.t),o=r?this.z.redAdd(this.z):this.z.redMul(t.z).redIMuln(2),h=s.redSub(i),f=o.redSub(n),u=o.redIAdd(n),a=s.redIAdd(i),c=h.redMul(f),d=u.redMul(a),l=h.redMul(a),m=f.redMul(u);return this.curve.point(c,d,m,l)}_addA(t,e){const r=t.zOne&(1^e),i=this.x.redMul(t.x),s=this.y.redMul(t.y),n=this.curve._mulD(this.t).redMul(t.t),o=r?this.z.clone():this.z.redMul(t.z),h=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(i).redISub(s),f=o.redSub(n),u=o.redIAdd(n),a=s.redISub(this.curve._mulA(i)),c=h.redMul(f),d=u.redMul(a),l=h.redMul(a),m=f.redMul(u);return this.curve.point(c,d,m,l)}dbl(){return this.isInfinity()?this:this._dbl(0)}_dbl(t){const e=this.zOne&(1^t),r=this.x.redSqr(),i=this.y.redSqr(),s=e?this.curve.two:this.z.redSqr().redIMuln(2),n=this.curve._mulA(r),o=this.x.redAdd(this.y).redSqr().redISub(r).redISub(i),h=n.redAdd(i),f=h.redSub(s),u=n.redISub(i),a=o.redMul(f),c=h.redMul(u),d=o.redMul(u),l=f.redMul(h);return this.curve.point(a,c,l,d)}uadd(t){return B(t instanceof p),this._add(t,1)}udbl(){return this._dbl(1)}getX(){return this.normalize(),this.x.fromRed()}getY(){return this.normalize(),this.y.fromRed()}eq(t){if(B(t instanceof p),B(!this.z.isZero()),B(!t.z.isZero()),this===t)return!0;if(this.z.eq(t.z))return this.x.eq(t.x)&&this.y.eq(t.y);const e=this.x.redMul(t.z),r=t.x.redMul(this.z);if(!e.eq(r))return!1;const i=this.y.redMul(t.z),s=t.y.redMul(this.z);return i.eq(s)}isInfinity(){return B(!this.z.isZero()),!!this.x.isZero()&&this.y.eq(this.z)}isOdd(){return this.normalize(),this.x.redIsOdd()}isEven(){return this.normalize(),this.x.redIsEven()}toP(){return this.normalize()}toJ(){return this}encode(){const t=this.getY();return t.setn(this.curve.signBit,this.x.redIsOdd()),this.curve.encodeField(t)}static decode(t,e){B(t instanceof m);const r=t.decodeField(e),i=0!==r.testn(t.signBit);if(r.setn(t.signBit,0),r.cmp(t.p)>=0)throw new Error("Invalid point.");return t.pointFromY(r,i)}toJSON(t){if(this.isInfinity())return[];const e=this.getX().toJSON(),r=this.getY().toJSON();return!0===t&&this.pre?[e,r,this.pre.toJSON()]:[e,r]}static fromJSON(t,e){if(B(t instanceof m),B(Array.isArray(e)),B(0===e.length||2===e.length||3===e.length),0===e.length)return t.point();const r=s.fromJSON(e[0]),i=s.fromJSON(e[1]),n=t.point(r,i);return e.length>2&&null!=e[2]&&(n.pre=g.fromJSON(n,e[2])),n}[i](){return this.isInfinity()?"<EdwardsPoint: Infinity>":"<EdwardsPoint: x="+this.x.fromRed().toString(16,2)+" y="+this.y.fromRed().toString(16,2)+" z="+this.z.fromRed().toString(16,2)+">"}}class b{constructor(t){B(t instanceof o);const e=t.fieldBits,r=7&e||8;this.curve=t,this.h=255&-t.h.word(0),this.n=(1<<r)-1,this.b=1<<r-1,this.and=s.mask(e).iuxorn(255^this.h),this.or=s.shift(1,e-1)}reduce(t){return B(t instanceof s),B(!t.red),t.iuand(this.and),t.iuor(this.or),t}clamp(t){B(Buffer.isBuffer(t)),B(t.length===this.curve.scalarSize);let e=0,r=this.curve.scalarSize-1;return"be"===this.curve.endian&&([e,r]=[r,e]),t[e]&=this.h,t[r]&=this.n,t[r]|=this.b,t}splitHash(t){B(Buffer.isBuffer(t)),B(t.length===2*this.curve.fieldSize);let e=0;"be"===this.curve.endian&&(e=this.curve.fieldSize-this.curve.scalarSize);const r=t.slice(e,e+this.curve.scalarSize),i=t.slice(this.curve.fieldSize);return this.clamp(r),[r,i]}}class g{constructor(){this.naf=null,this.doubles=null,this.blinding=null,this.beta=null}map(t){B("function"==typeof t);const e=new this.constructor;return this.naf&&(e.naf=this.naf.map(t)),this.doubles&&(e.doubles=this.doubles.map(t)),e}toJSON(){return{naf:this.naf?this.naf.toJSON():null,doubles:this.doubles?this.doubles.toJSON():null,blinding:this.blinding?this.blinding.toJSON():void 0}}fromJSON(t,e){return B(t instanceof h),B(e&&"object"==typeof e),null!=e.naf&&(this.naf=w.fromJSON(t,e.naf)),null!=e.doubles&&(this.doubles=S.fromJSON(t,e.doubles)),null!=e.blinding&&(this.blinding=y.fromJSON(t,e.blinding)),this}static fromJSON(t,e){return(new this).fromJSON(t,e)}}class w{constructor(t,e){this.width=t,this.points=e}map(t){B("function"==typeof t);const{width:e}=this,r=[];for(const e of this.points)r.push(t(e));return new this.constructor(e,r)}toJSON(){return{width:this.width,points:this.points.slice(1).map((t=>t.toJSON()))}}static fromJSON(t,e){B(t instanceof h),B(e&&"object"==typeof e),B(e.width>>>0===e.width),B(Array.isArray(e.points));const{curve:r}=t,{width:i}=e,s=[t];for(const t of e.points)s.push(r.pointFromJSON(t));return new this(i,s)}}class S{constructor(t,e){this.step=t,this.points=e}map(t){B("function"==typeof t);const{step:e}=this,r=[];for(const e of this.points)r.push(t(e));return new this.constructor(e,r)}toJSON(){return{step:this.step,points:this.points.slice(1).map((t=>t.toJSON()))}}static fromJSON(t,e){B(t instanceof h),B(e&&"object"==typeof e),B(e.step>>>0===e.step),B(Array.isArray(e.points));const{curve:r}=t,{step:i}=e,s=[t];for(const t of e.points)s.push(r.pointFromJSON(t));return new this(i,s)}}class y{constructor(t,e){this.blind=t,this.unblind=e}toJSON(){return{blind:this.blind.toJSON(),unblind:this.unblind.toJSON()}}static fromJSON(t,e){B(t instanceof h),B(e&&"object"==typeof e);const{curve:r}=t;return new this(s.fromJSON(e.blind),r.pointFromJSON(e.unblind))}}class I{constructor(t,e,r,i){this.beta=t,this.lambda=e,this.basis=r,this.pre=i}toJSON(){return{beta:this.beta.fromRed().toJSON(),lambda:this.lambda.toJSON(),basis:[this.basis[0].toJSON(),this.basis[1].toJSON()],pre:[this.pre[0].toJSON(),this.pre[1].toJSON()]}}static fromJSON(t,e){return B(t instanceof o),B(e&&"object"==typeof e),B(Array.isArray(e.basis)),B(Array.isArray(e.pre)),B(2===e.basis.length),B(2===e.pre.length),new this(s.fromJSON(e.beta).toRed(t.red),s.fromJSON(e.lambda),[v.fromJSON(e.basis[0]),v.fromJSON(e.basis[1])],[s.fromJSON(e.pre[0]),s.fromJSON(e.pre[1])])}}class v{constructor(t,e){this.a=t,this.b=e}toJSON(){return{a:this.a.toJSON(),b:this.b.toJSON()}}static fromJSON(t){return B(t&&"object"==typeof t),new this(s.fromJSON(t.a),s.fromJSON(t.b))}}const E={__proto__:null,P192:class extends f{constructor(t){super({id:"P192",ossl:"prime192v1",type:"short",endian:"be",hash:"SHA256",prime:"p192",p:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff fffffffc"],b:["64210519 e59c80e7 0fa7e9ab 72243049","feb8deec c146b9b1"],n:["ffffffff ffffffff ffffffff 99def836","146bc9b1 b4d22831"],h:"1",z:"-5",g:[["188da80e b03090f6 7cbf20eb 43a18800","f4ff0afd 82ff1012"],["07192b95 ffc8da78 631011ed 6b24cdd5","73f977a1 1e794811"],t]})}},P224:class extends f{constructor(t){super({id:"P224",ossl:"secp224r1",type:"short",endian:"be",hash:"SHA256",prime:"p224",p:["ffffffff ffffffff ffffffff ffffffff","00000000 00000000 00000001"],a:["ffffffff ffffffff ffffffff fffffffe","ffffffff ffffffff fffffffe"],b:["b4050a85 0c04b3ab f5413256 5044b0b7","d7bfd8ba 270b3943 2355ffb4"],n:["ffffffff ffffffff ffffffff ffff16a2","e0b8f03e 13dd2945 5c5c2a3d"],h:"1",z:"1f",g:[["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3","56c21122 343280d6 115c1d21"],["bd376388 b5f723fb 4c22dfe6 cd4375a0","5a074764 44d58199 85007e34"],t]})}},P256:class extends f{constructor(t){super({id:"P256",ossl:"prime256v1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff ffffffff"],a:["ffffffff 00000001 00000000 00000000","00000000 ffffffff ffffffff fffffffc"],b:["5ac635d8 aa3a93e7 b3ebbd55 769886bc","651d06b0 cc53b0f6 3bce3c3e 27d2604b"],n:["ffffffff 00000000 ffffffff ffffffff","bce6faad a7179e84 f3b9cac2 fc632551"],h:"1",z:"-a",g:[["6b17d1f2 e12c4247 f8bce6e5 63a440f2","77037d81 2deb33a0 f4a13945 d898c296"],["4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16","2bce3357 6b315ece cbb64068 37bf51f5"],t]})}},P384:class extends f{constructor(t){super({id:"P384",ossl:"secp384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 ffffffff"],a:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff fffffffe","ffffffff 00000000 00000000 fffffffc"],b:["b3312fa7 e23ee7e4 988e056b e3f82d19","181d9c6e fe814112 0314088f 5013875a","c656398d 8a2ed19d 2a85c8ed d3ec2aef"],n:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff c7634d81 f4372ddf","581a0db2 48b0a77a ecec196a ccc52973"],h:"1",z:"-c",g:[["aa87ca22 be8b0537 8eb1c71e f320ad74","6e1d3b62 8ba79b98 59f741e0 82542a38","5502f25d bf55296c 3a545e38 72760ab7"],["3617de4a 96262c6f 5d9e98bf 9292dc29","f8f41dbd 289a147c e9da3113 b5f0b8c0","0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"],t]})}},P521:class extends f{constructor(t){super({id:"P521",ossl:"secp521r1",type:"short",endian:"be",hash:"SHA512",prime:"p521",p:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff"],a:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffc"],b:["00000051 953eb961 8e1c9a1f 929a21a0","b68540ee a2da725b 99b315f3 b8b48991","8ef109e1 56193951 ec7e937b 1652c0bd","3bb1bf07 3573df88 3d2c34f1 ef451fd4","6b503f00"],n:["000001ff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffff","fffffffa 51868783 bf2f966b 7fcc0148","f709a5d0 3bb5c9b8 899c47ae bb6fb71e","91386409"],h:"1",z:"-4",g:[["000000c6 858e06b7 0404e9cd 9e3ecb66","2395b442 9c648139 053fb521 f828af60","6b4d3dba a14b5e77 efe75928 fe1dc127","a2ffa8de 3348b3c1 856a429b f97e7e31","c2e5bd66"],["00000118 39296a78 9a3bc004 5c8a5fb4","2c7d1bd9 98f54449 579b4468 17afbd17","273e662c 97ee7299 5ef42640 c550b901","3fad0761 353c7086 a272c240 88be9476","9fd16650"],t]})}},SECP256K1:class extends f{constructor(t){super({id:"SECP256K1",ossl:"secp256k1",type:"short",endian:"be",hash:"SHA256",prime:"k256",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe fffffc2f"],a:"0",b:"7",n:["ffffffff ffffffff ffffffff fffffffe","baaedce6 af48a03b bfd25e8c d0364141"],h:"1",z:"1",c:["0a2d2ba9 3507f1df 233770c2 a797962c","c61f6d15 da14ecd4 7d8d27ae 1cd5f852"],g:[["79be667e f9dcbbac 55a06295 ce870b07","029bfcdb 2dce28d9 59f2815b 16f81798"],["483ada77 26a3c465 5da4fbfc 0e1108a8","fd17b448 a6855419 9c47d08f fb10d4b8"],t],endo:{beta:["7ae96a2b 657c0710 6e64479e ac3434e9","9cf04975 12f58995 c1396c28 719501ee"],lambda:["5363ad4c c05c30e0 a5261c02 8812645a","122e22ea 20816678 df02967c 1b23bd72"],basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],pre:["3086d221a7d46bcde86c90e49284eb153dab","-e4437ed6010e88286f547fa90abfe4c42212"]}})}},BRAINPOOLP256:class extends f{constructor(t){super({id:"BRAINPOOLP256",ossl:"brainpoolP256r1",type:"short",endian:"be",hash:"SHA256",prime:null,p:["a9fb57db a1eea9bc 3e660a90 9d838d72","6e3bf623 d5262028 2013481d 1f6e5377"],a:["7d5a0975 fc2c3057 eef67530 417affe7","fb8055c1 26dc5c6c e94a4b44 f330b5d9"],b:["26dc5c6c e94a4b44 f330b5d9 bbd77cbf","95841629 5cf7e1ce 6bccdc18 ff8c07b6"],n:["a9fb57db a1eea9bc 3e660a90 9d838d71","8c397aa3 b561a6f7 901e0e82 974856a7"],h:"1",z:"-2",g:[["8bd2aeb9 cb7e57cb 2c4b482f fc81b7af","b9de27e1 e3bd23c2 3a4453bd 9ace3262"],["547ef835 c3dac4fd 97f8461a 14611dc9","c2774513 2ded8e54 5c1d54c7 2f046997"],t]})}},BRAINPOOLP384:class extends f{constructor(t){super({id:"BRAINPOOLP384",ossl:"brainpoolP384r1",type:"short",endian:"be",hash:"SHA384",prime:null,p:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b4 12b1da19 7fb71123","acd3a729 901d1a71 87470013 3107ec53"],a:["7bc382c6 3d8c150c 3c72080a ce05afa0","c2bea28e 4fb22787 139165ef ba91f90f","8aa5814a 503ad4eb 04a8c7dd 22ce2826"],b:["04a8c7dd 22ce2826 8b39b554 16f0447c","2fb77de1 07dcd2a6 2e880ea5 3eeb62d5","7cb43902 95dbc994 3ab78696 fa504c11"],n:["8cb91e82 a3386d28 0f5d6f7e 50e641df","152f7109 ed5456b3 1f166e6c ac0425a7","cf3ab6af 6b7fc310 3b883202 e9046565"],h:"1",z:"-5",g:[["1d1c64f0 68cf45ff a2a63a81 b7c13f6b","8847a3e7 7ef14fe3 db7fcafe 0cbd10e8","e826e034 36d646aa ef87b2e2 47d4af1e"],["8abe1d75 20f9c2a4 5cb1eb8e 95cfd552","62b70b29 feec5864 e19c054f f9912928","0e464621 77918111 42820341 263c5315"],t]})}},BRAINPOOLP512:class extends f{constructor(t){super({id:"BRAINPOOLP512",ossl:"brainpoolP512r1",type:"short",endian:"be",hash:"SHA512",prime:null,p:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330871","7d4d9b00 9bc66842 aecda12a e6a380e6","2881ff2f 2d82c685 28aa6056 583a48f3"],a:["7830a331 8b603b89 e2327145 ac234cc5","94cbdd8d 3df91610 a83441ca ea9863bc","2ded5d5a a8253aa1 0a2ef1c9 8b9ac8b5","7f1117a7 2bf2c7b9 e7c1ac4d 77fc94ca"],b:["3df91610 a83441ca ea9863bc 2ded5d5a","a8253aa1 0a2ef1c9 8b9ac8b5 7f1117a7","2bf2c7b9 e7c1ac4d 77fc94ca dc083e67","984050b7 5ebae5dd 2809bd63 8016f723"],n:["aadd9db8 dbe9c48b 3fd4e6ae 33c9fc07","cb308db3 b3c9d20e d6639cca 70330870","553e5c41 4ca92619 41866119 7fac1047","1db1d381 085ddadd b5879682 9ca90069"],h:"1",z:"7",g:[["81aee4bd d82ed964 5a21322e 9c4c6a93","85ed9f70 b5d916c1 b43b62ee f4d0098e","ff3b1f78 e2d0d48d 50d1687b 93b97d5f","7c6d5047 406a5e68 8b352209 bcb9f822"],["7dde385d 566332ec c0eabfa9 cf7822fd","f209f700 24a57b1a a000c55b 881f8111","b2dcde49 4a5f485e 5bca4bd8 8a2763ae","d1ca2b2f a8f05406 78cd1e0f 3ad80892"],t]})}},X25519:class extends c{constructor(){super({id:"X25519",ossl:"X25519",type:"mont",endian:"le",hash:"SHA512",prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"76d06",b:"1",n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000009"],["5f51e65e 475f794b 1fe122d3 88b72eb3","6dc2b281 92839e4d d6163a5d 81312c14"]]})}},X448:class extends c{constructor(){super({id:"X448",ossl:"X448",type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"262a6",b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000000 00000000 00000000","00000000 00000005"],["7d235d12 95f5b1f6 6c98ab6e 58326fce","cbae5d34 f55545d0 60f75dc2 8df3f6ed","b8027e23 46430d21 1312c4b1 50677af7","6fd7223d 457b5b1a"]]})}},MONT448:class extends c{constructor(){super({id:"MONT448",ossl:null,type:"mont",endian:"le",hash:"SHAKE256",prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:["b2cf97d2 d43459a9 31ed36b1 fc4e3cb5","5d93f8d2 22746997 60ccffc6 49961ed6","c5b05fca c24864ed 6fb59697 931b78da","84ddecd8 ca2b5cfb"],b:"1",n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["ac0d24cc c6c75cb0 eb71f81e 7a6edf51","48e88aee 009a2a24 e795687e c28e125a","3e6730a6 0d46367b aa7fe99d 152128dc","41321bc7 7817f059"],["5a4437f6 80c0d0db 9b061276 d5d0ffcc","e786ff33 b6a53d30 98746425 82e66f09","4433dae7 7244a6e2 6b11e905 7228f483","556c41a5 913f55fe"]]})}},ED25519:class extends m{constructor(t){super({id:"ED25519",ossl:"ED25519",type:"edwards",endian:"le",hash:"SHA512",prefix:"SigEd25519 no Ed25519 collisions",context:!1,prime:"p25519",p:["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff ffffffed"],a:"-1",d:["52036cee 2b6ffe73 8cc74079 7779e898","00700a4d 4141d8ab 75eb4dca 135978a3"],n:["10000000 00000000 00000000 00000000","14def9de a2f79cd6 5812631a 5cf5d3ed"],h:"8",z:"2",g:[["216936d3 cd6e53fe c0a4e231 fdd6dc5c","692cc760 9525a7b2 c9562d60 8f25d51a"],["66666666 66666666 66666666 66666666","66666666 66666666 66666666 66666658"],t]})}},ISO448:class extends m{constructor(t){super({id:"ISO448",ossl:null,type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["d78b4bdc 7f0daf19 f24f38c2 9373a2cc","ad461572 42a50f37 809b1da3 412a12e7","9ccc9c81 264cfe9a d0809970 58fb61c4","243cc32d baa156b9"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["79a70b2b 70400553 ae7c9df4 16c792c6","1128751a c9296924 0c25a07d 728bdc93","e21f7787 ed697224 9de732f3 8496cd11","69871309 3e9c04fc"],["7fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 80000000","00000000 00000000 00000000 00000000","00000000 00000001"],t]})}},ED448:class extends m{constructor(t){super({id:"ED448",ossl:"ED448",type:"edwards",endian:"le",hash:"SHAKE256",prefix:"SigEd448",context:!0,prime:"p448",p:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff"],a:"1",d:["ffffffff ffffffff ffffffff ffffffff","ffffffff ffffffff fffffffe ffffffff","ffffffff ffffffff ffffffff ffffffff","ffffffff ffff6756"],n:["3fffffff ffffffff ffffffff ffffffff","ffffffff ffffffff ffffffff 7cca23e9","c44edb49 aed63690 216cc272 8dc58f55","2378c292 ab5844f3"],h:"4",z:"-1",g:[["4f1970c6 6bed0ded 221d15a6 22bf36da","9e146570 470f1767 ea6de324 a3d3a464","12ae1af7 2ab66511 433b80e1 8b00938e","2626a82b c70cc05e"],["693f4671 6eb6bc24 88762037 56c9c762","4bea7373 6ca39840 87789c1e 05a0c2d7","3ad3ff1c e67c39c4 fdbd132c 4ed7c8ad","9808795b f230fa14"],t]})}}},_={__proto__:null,P192:null,P224:null,P256:null,P384:null,P521:null,SECP256K1:null,BRAINPOOLP256:null,BRAINPOOLP384:null,BRAINPOOLP512:null,X25519:null,X448:null,MONT448:null,ED25519:null,ISO448:null,ED448:null};function O(t,e,r){B(t instanceof s),B(!t.red),B(e>>>0===e),B(r>>>0===r);const i=new Array(r),n=1<<e+1,o=t.abs(),h=1|t.sign();let f=0;for(;!o.isZero();){let t=0;o.isOdd()&&(t=o.andln(n-1),t&n>>>1&&(t-=n),o.isubn(t)),i[f++]=t*h;let r=1;o.isZero()||0!==o.andln(n-1)||(r=e+1);for(let t=1;t<r;t++)i[f++]=0;o.iushrn(r)}for(B(f<=r);f<r;f++)i[f]=0;return i}function N(t,e,r){const i=function(t,e,r){B(t instanceof s),B(e instanceof s),B(!t.red),B(!e.red),B(r>>>0===r);const i=[new Array(r),new Array(r)],n=t.abs(),o=e.abs(),h=1|t.sign(),f=1|e.sign();let u=0,a=0,c=0;for(;n.cmpn(-a)>0||o.cmpn(-c)>0;){let t=n.andln(3)+a&3,e=o.andln(3)+c&3,r=0,s=0;if(3===t&&(t=-1),3===e&&(e=-1),1&t){const i=n.andln(7)+a&7;r=3!==i&&5!==i||2!==e?t:-t}if(1&e){const r=o.andln(7)+c&7;s=3!==r&&5!==r||2!==t?e:-e}i[0][u]=r*h,i[1][u]=s*f,2*a===r+1&&(a=1-a),2*c===s+1&&(c=1-c),n.iushrn(1),o.iushrn(1),u+=1}for(B(u<=r);u<r;u++)i[0][u]=0,i[1][u]=0;return i}(t,e,r),o=new Array(r);for(let t=0;t<r;t++){const e=i[0][t],r=i[1][t];o[t]=n[3*(e+1)+(r+1)]}return o}function B(t,e){if(!t){const t=new Error(e||"Assertion failed");throw Error.captureStackTrace&&Error.captureStackTrace(t,B),t}}function A(t){B(t instanceof s);try{return[1,t.redSqrt()]}catch(e){if("X is not a square mod P."===e.message)return[0,t.clone()];throw e}}function M(t,e){B(t instanceof s),B(e instanceof s);try{return[1,t.redDivSqrt(e)]}catch(e){if("Not invertible."===e.message||"X is not a square mod P."===e.message)return[0,t.clone()];throw e}}function P(t){return s.randomBits(t,32).toNumber()}function R(t,e){const r=new WeakMap;return function(i,s){const n=1&s,o=r.get(i);if(o&&null!==o[n])return o[n];const h=t.call(e,i,s);return r.has(i)||r.set(i,[null,null]),r.get(i)[n]=h,h}}e.Curve=o,e.Point=h,e.ShortCurve=f,e.ShortPoint=u,e.JPoint=a,e.MontCurve=c,e.MontPoint=d,e.XPoint=l,e.EdwardsCurve=m,e.EdwardsPoint=p,e.curves=E,e.curve=function(t,...e){B("string"==typeof t);const r=t.toUpperCase();let i=_[r];if(!i){const s=E[r];if(!s)throw new Error(`Curve not found: "${t}".`);i=new s(...e),_[r]=i}return i},e.register=function(t,e){B("string"==typeof t),B("function"==typeof e);const r=t.toUpperCase();if(E[r])throw new Error(`Curve already registered: "${t}".`);E[r]=e,_[r]=null}},7749:(t,e,r)=>{const i=r(7494),s=r(7918),n=r(3614),o=r(3556),h=new n;class f{constructor(){this.ctx=new s}init(){return this.ctx.init(),this}update(t){return this.ctx.update(t),this}final(){const t=Buffer.allocUnsafe(32);return this.ctx._final(t),h.init(),h.update(t),h._final(t),t.slice(0,20)}static hash(){return new f}static hmac(){return new o(f,64)}static digest(t){return f.ctx.init().update(t).final()}static root(t,e){return i(Buffer.isBuffer(t)&&20===t.length),i(Buffer.isBuffer(e)&&20===e.length),f.ctx.init().update(t).update(e).final()}static multi(t,e,r){const{ctx:i}=f;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return f.hmac().init(e).update(t).final()}}f.native=0,f.id="HASH160",f.size=20,f.bits=160,f.blockSize=64,f.zero=Buffer.alloc(20,0),f.ctx=new f,t.exports=f},1962:(t,e,r)=>{const i=r(7494),s=r(7918),n=r(3556);class o{constructor(){this.ctx=new s}init(){return this.ctx.init(),this}update(t){return this.ctx.update(t),this}final(){const t=Buffer.allocUnsafe(32);return this.ctx._final(t),this.ctx.init(),this.ctx.update(t),this.ctx._final(t),t}static hash(){return new o}static hmac(){return new n(o,64)}static digest(t){return o.ctx.init().update(t).final()}static root(t,e){return i(Buffer.isBuffer(t)&&32===t.length),i(Buffer.isBuffer(e)&&32===e.length),o.ctx.init().update(t).update(e).final()}static multi(t,e,r){const{ctx:i}=o;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return o.hmac().init(e).update(t).final()}}o.native=0,o.id="HASH256",o.size=32,o.bits=256,o.blockSize=64,o.zero=Buffer.alloc(32,0),o.ctx=new o,t.exports=o},8884:(t,e,r)=>{const i=r(7494),s=(global.crypto||global.msCrypto||{}).subtle||{};function n(t,e,r,s,n){"string"==typeof e&&(e=Buffer.from(e,"utf8")),"string"==typeof r&&(r=Buffer.from(r,"utf8")),null==r&&(r=Buffer.alloc(0)),i(t&&"string"==typeof t.id),i(Buffer.isBuffer(e)),i(Buffer.isBuffer(r)),i(s>>>0===s),i(n>>>0===n);const o=t.size,h=Math.ceil(n/o),f=Buffer.allocUnsafe(h*o),u=Buffer.allocUnsafe(r.length+4);r.copy(u,0),e.length>t.blockSize&&(e=t.digest(e),i(e.length<=t.blockSize));for(let i=0;i<h;i++){const n=i+1;u[r.length+0]=n>>>24,u[r.length+1]=n>>>16,u[r.length+2]=n>>>8,u[r.length+3]=n;const h=t.mac(u,e);let a=h;for(let r=1;r<s;r++){a=t.mac(a,e);for(let t=0;t<o;t++)h[t]^=a[t]}h.copy(f,i*o)}return f.slice(0,n)}e.native=0,e.derive=n,e.deriveAsync=async function(t,e,r,o,h){"string"==typeof e&&(e=Buffer.from(e,"utf8")),"string"==typeof r&&(r=Buffer.from(r,"utf8")),null==r&&(r=Buffer.alloc(0)),i(t&&"string"==typeof t.id),i(Buffer.isBuffer(e)),i(Buffer.isBuffer(r)),i(o>>>0===o),i(h>>>0===h);const f=function(t){switch(t.id){case"SHA1":return"SHA-1";case"SHA256":return"SHA-256";case"SHA384":return"SHA-384";case"SHA512":return"SHA-512";default:return null}}(t);if(!s.importKey||!s.deriveBits||!f)return n(t,e,r,o,h);const u={name:"PBKDF2",salt:r,iterations:o,hash:f},a=await s.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]),c=await s.deriveBits(u,a,8*h);return Buffer.from(c)}},1960:t=>{t.exports=JSON.parse('{"naf":{"width":8,"points":[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","0ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","02de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","02972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","0d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["049370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","091b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","0673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","0a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","09414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["078c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","04f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","073867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["0336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","060660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","0b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["04e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["0c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","021ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","0c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","09731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","0cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","0712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]},"doubles":{"step":4,"points":[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","04e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["06f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["0948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","0e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","067c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["0928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","0d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["08ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]}}')},3614:(t,e,r)=>{const i=r(7494),s=r(3556),n=Buffer.alloc(8,0),o=Buffer.alloc(64,0);o[0]=128;const h=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),f=new Uint8Array([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=new Uint8Array([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=new Uint8Array([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]);class c{constructor(){this.state=new Uint32Array(5),this.msg=new Uint32Array(16),this.block=Buffer.allocUnsafe(64),this.size=-1}init(){return this.state[0]=1732584193,this.state[1]=4023233417,this.state[2]=2562383102,this.state[3]=271733878,this.state[4]=3285377520,this.size=0,this}update(t){return i(Buffer.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(Buffer.allocUnsafe(20))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,s=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,s,s+i),r+=i,e-=i,s+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,s),s+=64,e-=64;e>0&&t.copy(this.block,0,s,s+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;b(n,r>>>0,0),b(n,r*(1/4294967296)>>>0,4),this._update(o,1+(119-e&63)),this._update(n,8);for(let e=0;e<5;e++)b(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<16;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],s=this.state[1],n=this.state[2],o=this.state[3],c=this.state[4],b=i,g=s,w=n,S=o,y=c;for(let i=0;i<16;i++)r[i]=(v=e+4*i,(I=t)[v++]+256*I[v++]+65536*I[v++]+16777216*I[v]);var I,v;for(let t=0;t<80;t++){let e=i+l(t,s,n,o)+r[h[t]]+m(t),I=d(e,u[t]),v=I+c;i=c,c=o,o=d(n,10),n=s,s=v,e=b+l(79-t,g,w,S)+r[f[t]]+p(t),I=d(e,a[t]),v=I+y,b=y,y=S,S=d(w,10),w=g,g=v}const E=this.state[1]+n+S;this.state[1]=this.state[2]+o+y,this.state[2]=this.state[3]+c+b,this.state[3]=this.state[4]+i+g,this.state[4]=this.state[0]+s+w,this.state[0]=E}static hash(){return new c}static hmac(){return new s(c,64)}static digest(t){return c.ctx.init().update(t).final()}static root(t,e){return i(Buffer.isBuffer(t)&&20===t.length),i(Buffer.isBuffer(e)&&20===e.length),c.ctx.init().update(t).update(e).final()}static multi(t,e,r){const{ctx:i}=c;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return c.hmac().init(e).update(t).final()}}function d(t,e){return t<<e|t>>>32-e}function l(t,e,r,i){return t<=15?e^r^i:t<=31?e&r|~e&i:t<=47?(e|~r)^i:t<=63?e&i|r&~i:e^(r|~i)}function m(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function p(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}function b(t,e,r){return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}c.native=0,c.id="RIPEMD160",c.size=20,c.bits=160,c.blockSize=64,c.zero=Buffer.alloc(20,0),c.ctx=new c,t.exports=c},2534:(t,e,r)=>{const i=r(7494),s=r(4074),n=r(6401);t.exports=class{constructor(t,e){this.curve=t,this.hash=e,this.rng=new s(this.curve,this.encode.bind(this))}check(){if(3!==this.curve.p.andln(3))throw new Error(`Schnorr is not supported for ${this.curve.id}.`)}encode(t){i(Buffer.isBuffer(t));const{fieldSize:e}=this.curve;if(t.length===1+e)return t;if(t.length!==1+2*e)throw new Error("Invalid point.");const r=Buffer.allocUnsafe(1+e);return r[0]=2|1&t[t.length-1],t.copy(r,1,1,1+e),r}hashInt(...t){const e=new this.hash;e.init();for(const r of t)e.update(r);let r=e.final();return r.length>this.curve.scalarSize&&(r=r.slice(0,this.curve.scalarSize)),n.decode(r,this.curve.endian).imod(this.curve.n)}hashNonce(t,e){return this.hashInt(t,e)}hashChallenge(t,e,r){return this.hashInt(t,this.encode(e),r)}sign(t,e){return i(Buffer.isBuffer(t)),this.check(),this._sign(t,e)}_sign(t,e){const{n:r}=this.curve,i=this.curve.g,s=this.curve.decodeScalar(e);if(s.isZero()||s.cmp(r)>=0)throw new Error("Invalid private key.");const n=i.mulBlind(s),o=this.hashNonce(e,t);if(o.isZero())throw new Error("Signing failed (k' = 0).");const h=i.mulBlind(o);h.isSquare()||o.ineg().imod(r);const f=h.encodeX(),u=n.encode(),a=this.hashChallenge(f,u,t),c=o.add(a.mul(s)).imod(r);return Buffer.concat([f,this.curve.encodeScalar(c)])}verify(t,e,r){if(i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(Buffer.isBuffer(r)),this.check(),e.length!==this.curve.fieldSize+this.curve.scalarSize)return!1;try{return this._verify(t,e,r)}catch(t){return!1}}_verify(t,e,r){const{p:i,n:s}=this.curve,n=this.curve.g,o=e.slice(0,this.curve.fieldSize),h=e.slice(this.curve.fieldSize),f=this.curve.decodeField(o),u=this.curve.decodeScalar(h),a=this.curve.decodePoint(r);if(f.cmp(i)>=0||u.cmp(s)>=0)return!1;const c=this.hashChallenge(o,r,t),d=n.jmulAdd(u,a,c.ineg().imod(s));return!!d.isSquare()&&!!d.eqX(f)}verifyBatch(t){i(Array.isArray(t)),this.check();for(const e of t){i(Array.isArray(e)&&3===e.length);const[t,r,s]=e;if(i(Buffer.isBuffer(t)),i(Buffer.isBuffer(r)),i(Buffer.isBuffer(s)),r.length!==this.curve.fieldSize+this.curve.scalarSize)return!1}try{return this._verifyBatch(t)}catch(t){return!1}}_verifyBatch(t){const{n:e}=this.curve,r=this.curve.g,i=new Array(1+2*t.length),s=new Array(1+2*t.length),o=new n(0);this.rng.init(t),i[0]=r,s[0]=o;for(let r=0;r<t.length;r++){const[n,h,f]=t[r],u=h.slice(0,this.curve.fieldSize),a=h.slice(this.curve.fieldSize),c=this.curve.decodeSquare(u),d=this.curve.decodeScalar(a),l=this.curve.decodePoint(f);if(d.cmp(e)>=0)return!1;const m=this.hashChallenge(u,f,n),p=this.rng.generate(r),b=m.mul(p).imod(e);o.iadd(d.mul(p)).imod(e),i[1+2*r+0]=c,s[1+2*r+0]=p,i[1+2*r+1]=l,s[1+2*r+1]=b}return o.ineg().imod(e),this.curve.jmulAll(i,s).isInfinity()}}},5482:(t,e,r)=>{const i=r(7494),s=r(5522),n=r(2372),o=Buffer.alloc(64),h=new Uint32Array(16),f=new Uint32Array(16);function u(t){const e=h,r=f;for(let r=0;r<16;r++)e[r]=S(t,4*r);for(let t=0;t<16;t++)r[t]=e[t];for(let t=0;t<8;t+=2)r[4]^=a(r[0]+r[12],7),r[8]^=a(r[4]+r[0],9),r[12]^=a(r[8]+r[4],13),r[0]^=a(r[12]+r[8],18),r[9]^=a(r[5]+r[1],7),r[13]^=a(r[9]+r[5],9),r[1]^=a(r[13]+r[9],13),r[5]^=a(r[1]+r[13],18),r[14]^=a(r[10]+r[6],7),r[2]^=a(r[14]+r[10],9),r[6]^=a(r[2]+r[14],13),r[10]^=a(r[6]+r[2],18),r[3]^=a(r[15]+r[11],7),r[7]^=a(r[3]+r[15],9),r[11]^=a(r[7]+r[3],13),r[15]^=a(r[11]+r[7],18),r[1]^=a(r[0]+r[3],7),r[2]^=a(r[1]+r[0],9),r[3]^=a(r[2]+r[1],13),r[0]^=a(r[3]+r[2],18),r[6]^=a(r[5]+r[4],7),r[7]^=a(r[6]+r[5],9),r[4]^=a(r[7]+r[6],13),r[5]^=a(r[4]+r[7],18),r[11]^=a(r[10]+r[9],7),r[8]^=a(r[11]+r[10],9),r[9]^=a(r[8]+r[11],13),r[10]^=a(r[9]+r[8],18),r[12]^=a(r[15]+r[14],7),r[13]^=a(r[12]+r[15],9),r[14]^=a(r[13]+r[12],13),r[15]^=a(r[14]+r[13],18);for(let t=0;t<16;t++)e[t]+=r[t];for(let r=0;r<16;r++)i=t,s=e[r],n=4*r,i[n++]=s,s>>>=8,i[n++]=s,s>>>=8,i[n++]=s,s>>>=8,i[n++]=s;var i,s,n}function a(t,e){return t<<e|t>>>32-e}function c(t,e,r,i){const s=o;p(s,t,0,64*(2*i-1),64);for(let n=0;n<2*i;n++)b(s,t,0,64*n,64),u(s),p(e,s,r+64*n,0,64);for(let s=0;s<i;s++)p(t,e,64*s,r+2*s*64,64);for(let s=0;s<i;s++)p(t,e,64*(s+i),r+64*(2*s+1),64)}function d(t,e){return S(t,64*(2*e-1))}function l(t,e,r,i,s,n){const o=n,h=n;p(o,t,0,e,128*r);for(let t=0;t<i;t++)p(s,o,t*(128*r),0,128*r),c(o,h,128*r,r);for(let t=0;t<i;t++)b(o,s,0,(d(o,r)&i-1)*(128*r),128*r),c(o,h,128*r,r);p(t,o,e,0,128*r)}async function m(t,e,r,i,s,n){const o=n,h=n;p(o,t,0,e,128*r);for(let t=0;t<i;t++)p(s,o,t*(128*r),0,128*r),c(o,h,128*r,r),await g();for(let t=0;t<i;t++)b(o,s,0,(d(o,r)&i-1)*(128*r),128*r),c(o,h,128*r,r),await g();p(t,o,e,0,128*r)}function p(t,e,r,i,s){e.copy(t,r,i,i+s)}function b(t,e,r,i,s){for(let n=0;n<s;n++)t[r+n]^=e[i+n]}function g(){return new Promise((t=>setImmediate(t)))}function w(){for(let t=0;t<64;t++)o[t]=0;for(let t=0;t<16;t++)h[t]=0,f[t]=0}function S(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}e.native=0,e.derive=function(t,e,r,o,h,f){if("string"==typeof t&&(t=Buffer.from(t,"utf8")),"string"==typeof e&&(e=Buffer.from(e,"utf8")),null==e&&(e=Buffer.alloc(0)),i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(r>>>0===r),i(o>>>0===o),i(h>>>0===h),i(f>>>0===f),o*h>=1<<30)throw new Error("EFBIG");if(0!=(r&r-1)||0===r)throw new Error("EINVAL");if(r>4294967295)throw new Error("EINVAL");const u=Buffer.allocUnsafe(256*o),a=Buffer.allocUnsafe(128*o*r),c=s.derive(n,t,e,1,128*h*o);for(let t=0;t<h;t++)l(c,128*t*o,o,r,a,u);return w(),s.derive(n,t,c,1,f)},e.deriveAsync=async function(t,e,r,o,h,f){if("string"==typeof t&&(t=Buffer.from(t,"utf8")),"string"==typeof e&&(e=Buffer.from(e,"utf8")),null==e&&(e=Buffer.alloc(0)),i(Buffer.isBuffer(t)),i(Buffer.isBuffer(e)),i(r>>>0===r),i(o>>>0===o),i(h>>>0===h),i(f>>>0===f),o*h>=1<<30)throw new Error("EFBIG");if(0!=(r&r-1)||0===r)throw new Error("EINVAL");if(r>4294967295)throw new Error("EINVAL");const u=Buffer.allocUnsafe(256*o),a=Buffer.allocUnsafe(128*o*r),c=await s.deriveAsync(n,t,e,1,128*h*o);for(let t=0;t<h;t++)await m(c,128*t*o,o,r,a,u);return w(),s.deriveAsync(n,t,c,1,f)}},7480:(t,e,r)=>{const i=r(1637),s=r(2372),n=r(1960);t.exports=new i("SECP256K1",s,n)},2095:(t,e,r)=>{const i=r(7494),s=r(3556),n=Buffer.alloc(8,0),o=Buffer.alloc(64,0);o[0]=128;const h=new Uint32Array([1518500249,1859775393,2400959708,3395469782]);class f{constructor(){this.state=new Uint32Array(5),this.msg=new Uint32Array(80),this.block=Buffer.allocUnsafe(64),this.size=-1}init(){return this.state[0]=1732584193,this.state[1]=4023233417,this.state[2]=2562383102,this.state[3]=271733878,this.state[4]=3285377520,this.size=0,this}update(t){return i(Buffer.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(Buffer.allocUnsafe(20))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,s=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,s,s+i),r+=i,e-=i,s+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,s),s+=64,e-=64;e>0&&t.copy(this.block,0,s,s+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;c(n,r*(1/4294967296)>>>0,0),c(n,r>>>0,4),this._update(o,1+(119-e&63)),this._update(n,8);for(let e=0;e<5;e++)c(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<80;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],s=this.state[1],n=this.state[2],o=this.state[3],f=this.state[4],c=0;for(;c<16;c++)r[c]=(l=e+4*c,16777216*(d=t)[l++]+65536*d[l++]+256*d[l++]+d[l]);for(var d,l;c<80;c++)r[c]=u(r[c-3]^r[c-8]^r[c-14]^r[c-16],1);for(c=0;c<80;c++){const t=c/20|0,e=u(i,5)+a(t,s,n,o)+f+r[c]+h[t];f=o,o=n,n=u(s,30),s=i,i=e>>>0}this.state[0]+=i,this.state[1]+=s,this.state[2]+=n,this.state[3]+=o,this.state[4]+=f}static hash(){return new f}static hmac(){return new s(f,64)}static digest(t){return f.ctx.init().update(t).final()}static root(t,e){return i(Buffer.isBuffer(t)&&20===t.length),i(Buffer.isBuffer(e)&&20===e.length),f.ctx.init().update(t).update(e).final()}static multi(t,e,r){const{ctx:i}=f;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return f.hmac().init(e).update(t).final()}}function u(t,e){return t<<e|t>>>32-e}function a(t,e,r,i){return 0===t?function(t,e,r){return t&e^~t&r}(e,r,i):1===t||3===t?function(t,e,r){return t^e^r}(e,r,i):2===t?function(t,e,r){return t&e^t&r^e&r}(e,r,i):0}function c(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}f.native=0,f.id="SHA1",f.size=20,f.bits=160,f.blockSize=64,f.zero=Buffer.alloc(20,0),f.ctx=new f,t.exports=f},7918:(t,e,r)=>{const i=r(7494),s=r(3556),n=Buffer.alloc(8,0),o=Buffer.alloc(64,0);o[0]=128;const h=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);class f{constructor(){this.state=new Uint32Array(8),this.msg=new Uint32Array(64),this.block=Buffer.allocUnsafe(64),this.size=-1}init(){return this.state[0]=1779033703,this.state[1]=3144134277,this.state[2]=1013904242,this.state[3]=2773480762,this.state[4]=1359893119,this.state[5]=2600822924,this.state[6]=528734635,this.state[7]=1541459225,this.size=0,this}update(t){return i(Buffer.isBuffer(t)),this._update(t,t.length),this}final(){return this._final(Buffer.allocUnsafe(32))}_update(t,e){i(-1!==this.size,"Context is not initialized.");let r=63&this.size,s=0;if(this.size+=e,r>0){let i=64-r;if(i>e&&(i=e),t.copy(this.block,r,s,s+i),r+=i,e-=i,s+=i,r<64)return;this._transform(this.block,0)}for(;e>=64;)this._transform(t,s),s+=64,e-=64;e>0&&t.copy(this.block,0,s,s+e)}_final(t){i(-1!==this.size,"Context is not initialized.");const e=63&this.size,r=8*this.size;m(n,r*(1/4294967296)>>>0,0),m(n,r>>>0,4),this._update(o,1+(119-e&63)),this._update(n,8);for(let e=0;e<8;e++)m(t,this.state[e],4*e),this.state[e]=0;for(let t=0;t<64;t++)this.msg[t]=0;for(let t=0;t<64;t++)this.block[t]=0;return this.size=-1,t}_transform(t,e){const r=this.msg;let i=this.state[0],s=this.state[1],n=this.state[2],o=this.state[3],f=this.state[4],m=this.state[5],p=this.state[6],b=this.state[7],g=0;for(;g<16;g++)r[g]=(S=e+4*g,16777216*(w=t)[S++]+65536*w[S++]+256*w[S++]+w[S]);for(var w,S,y;g<64;g++)r[g]=(((y=r[g-2])>>>17|y<<15)^(y>>>19|y<<13)^y>>>10)+r[g-7]+c(r[g-15])+r[g-16];for(g=0;g<64;g++){const t=b+a(f)+d(f,m,p)+h[g]+r[g],e=u(i)+l(i,s,n);b=p,p=m,m=f,f=o+t>>>0,o=n,n=s,s=i,i=t+e>>>0}this.state[0]+=i,this.state[1]+=s,this.state[2]+=n,this.state[3]+=o,this.state[4]+=f,this.state[5]+=m,this.state[6]+=p,this.state[7]+=b}static hash(){return new f}static hmac(){return new s(f,64)}static digest(t){return f.ctx.init().update(t).final()}static root(t,e){return i(Buffer.isBuffer(t)&&32===t.length),i(Buffer.isBuffer(e)&&32===e.length),f.ctx.init().update(t).update(e).final()}static multi(t,e,r){const{ctx:i}=f;return i.init(),i.update(t),i.update(e),r&&i.update(r),i.final()}static mac(t,e){return f.hmac().init(e).update(t).final()}}function u(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function a(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function c(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function d(t,e,r){return r^t&(e^r)}function l(t,e,r){return t&e|r&(t|e)}function m(t,e,r){return t[r++]=e>>>24,t[r++]=e>>>16,t[r++]=e>>>8,t[r++]=e,r}f.native=0,f.id="SHA256",f.size=32,f.bits=256,f.blockSize=64,f.zero=Buffer.alloc(32,0),f.ctx=new f,t.exports=f},3209:(t,e,r)=>{const{base58:i}=r(8758);i.native=2,t.exports=i},6496:(t,e,r)=>{const{bech32:i}=r(8758);i.native=2,t.exports=i},8758:(t,e,r)=>{const i=r(6417),s=i.randomBytes.bind(i),n=r(7494),o=r(9777)("bcrypto",__dirname);o.hashes={__proto__:null,BLAKE2B160:0,BLAKE2B256:1,BLAKE2B384:2,BLAKE2B512:3,BLAKE2S128:4,BLAKE2S160:5,BLAKE2S224:6,BLAKE2S256:7,GOST94:8,HASH160:9,HASH256:10,KECCAK224:11,KECCAK256:12,KECCAK384:13,KECCAK512:14,MD2:15,MD4:16,MD5:17,MD5SHA1:18,RIPEMD160:19,SHA1:20,SHA224:21,SHA256:22,SHA384:23,SHA512:24,SHA3_224:25,SHA3_256:26,SHA3_384:27,SHA3_512:28,SHAKE128:29,SHAKE256:30,WHIRLPOOL:31},o.curves={ecdsa:{__proto__:null,P192:0,P224:1,P256:2,P384:3,P521:4,SECP256K1:5},ecdh:{__proto__:null,X25519:0,X448:1},eddsa:{__proto__:null,ED25519:0,ED448:1,ED1174:2}},o.hash=function(t){n(t&&"string"==typeof t.id);const e=o.hashes[t.id];return n(e>>>0===e),e},o.entropy=function(t=32){return s(t)},o.hint=function(){const t=s(2);return 256*t[0]+t[1]},o.encode=function(t){n(Array.isArray(t));let e=0;for(const r of t)n(null==r||Buffer.isBuffer(r)),e+=2,r&&(n(r.length<=65535),e+=r.length);const r=Buffer.alloc(e);let i=0;for(const e of t)e?(r[i++]=e.length>>8,r[i++]=e.length,i+=e.copy(r,i)):(r[i++]=0,r[i++]=0);return r},o.decode=function(t,e){n(Buffer.isBuffer(t)),n(e>>>0===e);const r=[];let i=0;for(let s=0;s<e;s++){n(i+2<=t.length);const e=256*t[i++]+t[i++];n(i+e<=t.length),r.push(t.slice(i,i+e)),i+=e}return r},t.exports=o},5228:(t,e,r)=>{const{custom:i}=r(8377),s=(1n<<8n)-1n,n=(1n<<16n)-1n,o=(1n<<32n)-1n,h=(1n<<64n)-1n,f=(1n<<128n)-1n,u=(1n<<256n)-1n,a=9007199254740991n,c=0===new Int8Array(new Int16Array([1]).buffer)[0]?"be":"le",d={p192:null,p224:null,p521:null,k256:null,p25519:null,p448:null};class l{constructor(t,e,r){this.n=0n,this.red=null,this.from(t,e,r)}get negative(){return this.n<0n?1:0}set negative(t){(1&t)!==this.negative&&(this.n=-this.n)}get length(){return ut(this.n,26)}iadd(t){return _(l.isBN(t),"num","bignum"),this.n+=t.n,this}iaddn(t){return _(P(t),"num","smi"),this.n+=BigInt(t),this}add(t){return this.clone().iadd(t)}addn(t){return this.clone().iaddn(t)}isub(t){return _(l.isBN(t),"num","bignum"),this.n-=t.n,this}isubn(t){return _(P(t),"num","smi"),this.n-=BigInt(t),this}sub(t){return this.clone().isub(t)}subn(t){return this.clone().isubn(t)}imul(t){return _(l.isBN(t),"num","bignum"),this.n*=t.n,this}imuln(t){return _(P(t),"num","smi"),this.n*=BigInt(t),this}mul(t){return this.clone().imul(t)}muln(t){return this.clone().imuln(t)}mulShift(t,e){return _(l.isBN(t),"num","bignum"),_(e-1>>>0==e-1,"bits","uint32"),new l(function(t,e,r){const i=BigInt(r),s=t<0n^e<0n;let n=t*e;s&&(n=-n);const o=n>>i-1n&1n;return n>>=i,n+=o,s&&(n=-n),n}(this.n,t.n,e))}quorem(t){_(l.isBN(t),"num","bignum"),A(0n!==t.n);const[e,r]=function(t,e){E(0n!==e);const r=t/e;return[r,t-r*e]}(this.n,t.n);return[new l(e),new l(r)]}iquo(t){return _(l.isBN(t),"num","bignum"),A(0n!==t.n),this.n/=t.n,this}iquon(t){return _(P(t),"num","smi"),A(0!==t),this.n/=BigInt(t),this}quo(t){return this.clone().iquo(t)}quon(t){return this.clone().iquon(t)}irem(t){return _(l.isBN(t),"num","bignum"),A(0n!==t.n),this.n%=t.n,this}iremn(t){return _(P(t),"num","smi"),A(0!==t),this.n%=BigInt(t),this}rem(t){return this.clone().irem(t)}remn(t){return this.clone().iremn(t)}remrn(t){return _(P(t),"num","smi"),A(0!==t),k(this.n,t)}divmod(t){_(l.isBN(t),"num","bignum"),A(0n!==t.n);const[e,r]=function(t,e){E(0n!==e);let r=t/e,i=t-r*e;return i<0n&&(e<0n?(r+=1n,i-=e):(r-=1n,i+=e)),[r,i]}(this.n,t.n);return[new l(e),new l(r)]}idiv(t){return _(l.isBN(t),"num","bignum"),A(0n!==t.n),this.n=T(this.n,t.n),this}idivn(t){return _(P(t),"num","smi"),A(0!==t),this.n=T(this.n,BigInt(t)),this}div(t){return this.clone().idiv(t)}divn(t){return this.clone().idivn(t)}imod(t){return _(l.isBN(t),"num","bignum"),A(0n!==t.n),this.n=U(this.n,t.n),this}imodn(t){return _(P(t),"num","smi"),A(0!==t),this.n=U(this.n,BigInt(t)),this}mod(t){return this.clone().imod(t)}modn(t){return this.clone().imodn(t)}modrn(t){return _(P(t),"num","smi"),A(0!==t),function(t,e){let r=k(t,e);return r<0&&(e<0?r-=e:r+=e),r}(this.n,t)}divRound(t){return _(l.isBN(t),"num","bignum"),A(0n!==t.n),new l(function(t,e){E(0n!==e);const r=e<0n?-(-e>>1n):e>>1n;return t<0n^e<0n?(t-r)/e:(t+r)/e}(this.n,t.n))}ipow(t){return _(l.isBN(t),"num","bignum"),this.n**=G(t.n),this}ipown(t){return _(P(t),"num","smi"),this.n**=G(BigInt(t)),this}pow(t){return this.clone().ipow(t)}pown(t){return this.clone().ipown(t)}isqr(){return this.n*=this.n,this}sqr(){return this.clone().isqr()}rootrem(t){const[e,r]=C(this.n,t);return[new l(e),new l(r)]}iroot(t){return this.n=q(this.n,t),this}root(t){return this.clone().iroot(t)}isPower(t){return H(this.n,t)}sqrtrem(){const[t,e]=C(this.n,2);return[new l(t),new l(e)]}isqrt(){return this.n=q(this.n,2),this}sqrt(){return this.clone().isqrt()}isSquare(){return L(this.n)}iand(t){return _(l.isBN(t),"num","bignum"),this.n&=t.n,this}iandn(t){return _(P(t),"num","smi"),this.n&=BigInt(t),this}and(t){return this.clone().iand(t)}andn(t){return this.clone().iandn(t)}andrn(t){_(P(t),"num","smi");const e=this.n&BigInt(t);if(e<-0x3ffffffn||e>0x3ffffffn)throw new RangeError("Number exceeds 26 bits.");return Number(e)}iuand(t){return _(l.isBN(t),"num","bignum"),this.n=V(this.n,t.n),this}iuandn(t){return _(P(t),"num","smi"),this.n=F(this.n,t),this}uand(t){return this.clone().iuand(t)}uandn(t){return this.clone().iuandn(t)}uandrn(t){return _(P(t),"num","smi"),Number(F(this.n,t))}ior(t){return _(l.isBN(t),"num","bignum"),this.n|=t.n,this}iorn(t){return _(P(t),"num","smi"),this.n|=BigInt(t),this}or(t){return this.clone().ior(t)}orn(t){return this.clone().iorn(t)}iuor(t){return _(l.isBN(t),"num","bignum"),this.n=K(this.n,t.n),this}iuorn(t){return _(P(t),"num","smi"),this.n=K(this.n,BigInt(t)),this}uor(t){return this.clone().iuor(t)}uorn(t){return this.clone().iuorn(t)}ixor(t){return _(l.isBN(t),"num","bignum"),this.n^=t.n,this}ixorn(t){return _(P(t),"num","smi"),this.n^=BigInt(t),this}xor(t){return this.clone().ixor(t)}xorn(t){return this.clone().ixorn(t)}iuxor(t){return _(l.isBN(t),"num","bignum"),this.n=j(this.n,t.n),this}iuxorn(t){return _(P(t),"num","smi"),this.n=j(this.n,BigInt(t)),this}uxor(t){return this.clone().ixor(t)}uxorn(t){return this.clone().iuxorn(t)}inot(){return this.n=~this.n,this}not(){return this.clone().inot()}inotn(t){return _(t>>>0===t,"width","uint32"),this.n=Y(this.n,t),this}notn(t){return this.clone().inotn(t)}ishl(t){return _(l.isBN(t),"bits","bignum"),_(t.n>=0n&&t.n<=o,"bits","uint32"),this.n<<=t.n,this}ishln(t){return _(t>>>0===t,"bits","uint32"),this.n<<=BigInt(t),this}shl(t){return this.clone().ishl(t)}shln(t){return this.clone().ishln(t)}iushl(t){return _(l.isBN(t),"bits","bignum"),_(t.n>=0n&&t.n<=o,"bits","uint32"),this.n<<=t.n,this}iushln(t){return _(t>>>0===t,"bits","uint32"),this.n<<=BigInt(t),this}ushl(t){return this.clone().iushl(t)}ushln(t){return this.clone().iushln(t)}ishr(t){return _(l.isBN(t),"bits","bignum"),_(t.n>=0n&&t.n<=o,"bits","uint32"),this.n>>=t.n,this}ishrn(t){return _(t>>>0===t,"bits","uint32"),this.n>>=BigInt(t),this}shr(t){return this.clone().ishr(t)}shrn(t){return this.clone().ishrn(t)}iushr(t){return _(l.isBN(t),"bits","bignum"),_(t.n>=0n&&t.n<=o,"bits","uint32"),this.n=W(this.n,t.n),this}iushrn(t){return _(t>>>0===t,"bits","uint32"),this.n=W(this.n,BigInt(t)),this}ushr(t){return this.clone().iushr(t)}ushrn(t){return this.clone().iushrn(t)}setn(t,e){return _(t>>>0===t,"bit","uint32"),this.n=J(this.n,t,e),this}usetn(t,e){return _(t>>>0===t,"bit","uint32"),this.n=function(t,e,r){const i=t<0n;return i&&(t=-t),t=J(t,e,r),i&&(t=-t),t}(this.n,t,e),this}testn(t){return _(t>>>0===t,"bit","uint32"),X(this.n,t)}utestn(t){return _(t>>>0===t,"bit","uint32"),function(t,e){return X(G(t),e)}(this.n,t)}imaskn(t){return _(t>>>0===t,"bits","uint32"),this.n=this.n&D(t),this}maskn(t){return this.clone().imaskn(t)}iumaskn(t){return _(t>>>0===t,"bits","uint32"),this.n=function(t,e){const r=t<0n;return r&&(t=-t),t&=D(e),r&&(t=-t),t}(this.n,t),this}umaskn(t){return this.clone().iumaskn(t)}andln(t){return(e=this.n)<0n&&(e=-e),Number(e&BigInt(67108863&t));var e}ineg(){return this.n=-this.n,this}neg(){return this.clone().ineg()}iabs(){return this.n=G(this.n),this}abs(){return this.clone().iabs()}cmp(t){return _(l.isBN(t),"num","bignum"),Z(this.n,t.n)}cmpn(t){return _(P(t),"num","smi"),$(this.n,t)}eq(t){return _(l.isBN(t),"num","bignum"),this.n===t.n}eqn(t){return _(P(t),"num","smi"),this.n==t}gt(t){return _(l.isBN(t),"num","bignum"),this.n>t.n}gtn(t){return _(P(t),"num","smi"),this.n>t}gte(t){return _(l.isBN(t),"num","bignum"),this.n>=t.n}gten(t){return _(P(t),"num","smi"),this.n>=t}lt(t){return _(l.isBN(t),"num","bignum"),this.n<t.n}ltn(t){return _(P(t),"num","smi"),this.n<t}lte(t){return _(l.isBN(t),"num","bignum"),this.n<=t.n}lten(t){return _(P(t),"num","smi"),this.n<=t}sign(){return(this.n>0n)-(this.n<0n)}isZero(){return 0n===this.n}isNeg(){return this.n<0n}isPos(){return this.n>=0n}isOdd(){return 1n===(1n&this.n)}isEven(){return 0n===(1n&this.n)}ucmp(t){return _(l.isBN(t),"num","bignum"),Q(this.n,t.n)}ucmpn(t){return _(P(t),"num","smi"),e=t,$(G(this.n),Math.abs(e));var e}legendre(t){return _(l.isBN(t),"num","bignum"),B(!t.red,"legendre"),tt(this.n,t.n)}jacobi(t){return _(l.isBN(t),"num","bignum"),et(this.n,t.n)}kronecker(t){return _(l.isBN(t),"num","bignum"),rt(this.n,t.n)}igcd(t){return _(l.isBN(t),"num","bignum"),this.n=it(this.n,t.n),this}gcd(t){return this.clone().igcd(t)}ilcm(t){var e,r;return _(l.isBN(t),"num","bignum"),this.n=(e=this.n,r=t.n,0n===e||0n===r?0n:G(e/it(e,r)*r)),this}lcm(t){return this.clone().ilcm(t)}egcd(t){_(l.isBN(t),"p","bignum");const[e,r,i]=st(this.n,t.n);return[new l(e),new l(r),new l(i)]}iinvert(t){return _(l.isBN(t),"num","bignum"),O(t.n>=1n,"iinvert"),this.n=nt(this.n,t.n),this}invert(t){return this.clone().iinvert(t)}ifermat(t){return _(l.isBN(t),"num","bignum"),O(t.n>=1n,"ifermat"),B(!t.red,"ifermat"),this.n=ot(this.n,t.n),this}fermat(t){return this.clone().ifermat(t)}ipowm(t,e,r,i){return _(l.isBN(t),"y","bignum"),_(l.isBN(e),"m","bignum"),O(e.n>=1n,"ipowm"),B(!this.red&&!t.red&&!e.red,"ipowm"),this.n=ht(this.n,t.n,e.n,i),this}powm(t,e,r,i){return this.clone().ipowm(t,e,r,i)}ipowmn(t,e,r){return _(P(t),"y","smi"),_(l.isBN(e),"m","bignum"),O(e.n>=1n,"ipowmn"),B(!this.red&&!e.red,"ipowmn"),this.n=ht(this.n,BigInt(t),e.n),this}powmn(t,e,r){return this.clone().ipowmn(t,e,r)}isqrtm(t){return _(l.isBN(t),"p","bignum"),O(t.n>=1n,"isqrtm"),B(!this.red&&!t.red,"isqrtm"),this.n=ft(this.n,t.n),this}sqrtm(t){return this.clone().isqrtm(t)}isqrtpq(t,e){return _(l.isBN(t),"p","bignum"),_(l.isBN(e),"q","bignum"),O(t.n>=1n,"isqrtpq"),O(e.n>=1n,"isqrtpq"),B(!this.red&&!t.red&&!e.red,"isqrtpq"),this.n=function(t,e,r){E(e>0n),E(r>0n);const i=ft(t,e),s=ft(t,r),[n,o]=st(e,r);return U(s*n*e+i*o*r,e*r)}(this.n,t.n,e.n),this}sqrtpq(t,e){return this.clone().isqrtpq(t,e)}isPrime(t,e,r){return _(e>>>0===e,"reps","uint32"),!!this.isPrimeMR(t,e+1,!0)&&!!this.isPrimeLucas(r)}isPrimeMR(t,e,r){return function(t,e,r,i=!1){if(_(r>>>0===r,"reps","uint32"),_(r>0,"reps","integer"),_("boolean"==typeof i,"force2","boolean"),t<7n)return 2n===t||3n===t||5n===t;if(0n===(1n&t))return!1;const s=t-1n,n=s-2n,o=dt(s),h=s>>BigInt(o);t:for(let f=0;f<r;f++){let u,a;if(f===r-1&&i?u=2n:(u=St(e,0n,n),u+=2n),a=ht(u,h,t),1n!==a&&a!==s){for(let e=1;e<o;e++){if(a=a*a%t,a===s)continue t;if(1n===a)return!1}return!1}}return!0}(this.n,t,e,r)}isPrimeLucas(t){return function(t,e=0){if(_(e>>>0===e,"limit","uint32"),t<=1n)return!1;if(0n===(1n&t))return 2n===t;let r=3n;for(;;){if(r>10000n)throw new Error(`Cannot find (D/n) = -1 for ${t.toString(10)}.`);if(0!==e&&r>e)return!1;const i=et(r*r-4n,t);if(-1===i)break;if(0===i)return t===r+2n;if(40n===r&&L(t))return!1;r+=1n}let i=t+1n;const s=dt(i),n=t-2n;let o=2n,h=r;i>>=BigInt(s);for(let e=BigInt(ct(i));e>=0n;e--)i&1n<<e?(o=U(o*h+t-r,t),h=U(h*h+n,t)):(h=U(h*o+t-r,t),o=U(o*o+n,t));if(2n===o||o===n){let e=o*r,i=h<<1n;if(e<i&&([e,i]=[i,e]),(e-i)%t===0n)return!0}for(let e=0;e<s-1;e++){if(0n===o)return!0;if(2n===o)return!1;o=U(o*o-2n,t)}return!1}(this.n,t)}toTwos(t){return _(t>>>0===t,"width","uint32"),new l(function(t,e){return t<0n?Y(-t,e)+1n:t}(this.n,t))}fromTwos(t){return _(t>>>0===t,"width","uint32"),O(t>0,"width"),new l(function(t,e){return X(t,e-1)?-(Y(t,e)+1n):t}(this.n,t))}toRed(t){if(_(t instanceof I,"ctx","reduction context"),this.red)throw new Error("Already in reduction context.");return t.convertTo(this)}fromRed(){return N(this.red,"fromRed"),this.red.convertFrom(this)}forceRed(t){if(_(t instanceof I,"ctx","reduction context"),this.red){if(t.n!==this.red.n||t.mont!==this.red.mont)throw new Error("Already in reduction context.")}else O(this.n>=0n,"red"),O(this.n<t.n,"red");return this.clone()._forceRed(t)}redIAdd(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redIAdd"),this.red.iadd(this,t)}redAdd(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redAdd"),this.red.add(this,t)}redIAddn(t){return _(P(t),"num","smi"),N(this.red,"redIAddn"),this.red.iaddn(this,t)}redAddn(t){return _(P(t),"num","smi"),N(this.red,"redAddn"),this.red.addn(this,t)}redISub(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redISub"),this.red.isub(this,t)}redSub(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redSub"),this.red.sub(this,t)}redISubn(t){return _(P(t),"num","smi"),N(this.red,"redISubn"),this.red.isubn(this,t)}redSubn(t){return _(P(t),"num","smi"),N(this.red,"redSubn"),this.red.subn(this,t)}redIMul(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redIMul"),this.red.imul(this,t)}redMul(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redMul"),this.red.mul(this,t)}redIMuln(t){return _(P(t),"num","smi"),N(this.red,"redIMuln"),this.red.imuln(this,t)}redMuln(t){return _(P(t),"num","smi"),N(this.red,"redMuln"),this.red.muln(this,t)}redIDiv(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redIDiv"),this.red.idiv(this,t)}redDiv(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redDiv"),this.red.div(this,t)}redIDivn(t){return _(P(t),"num","smi"),N(this.red,"redIDivn"),this.red.idivn(this,t)}redDivn(t){return _(P(t),"num","smi"),N(this.red,"redDivn"),this.red.divn(this,t)}redIPow(t,e){return _(l.isBN(t),"num","bignum"),N(this.red,"redIPow"),B(!t.red,"redIPow"),this.red.ipow(this,t,e)}redPow(t,e){return _(l.isBN(t),"num","bignum"),N(this.red,"redPow"),B(!t.red,"redPow"),this.red.pow(this,t,e)}redIPown(t){return _(P(t),"num","smi"),N(this.red,"redIPown"),this.red.ipown(this,t)}redPown(t){return _(P(t),"num","smi"),N(this.red,"redPown"),this.red.pown(this,t)}redISqr(){return N(this.red,"redISqr"),this.red.isqr(this)}redSqr(){return N(this.red,"redSqr"),this.red.sqr(this)}redISqrt(){return N(this.red,"redISqrt"),this.red.isqrt(this)}redSqrt(){return N(this.red,"redSqrt"),this.red.sqrt(this)}redIDivSqrt(t){return N(this.red,"redIDivSqrt"),this.red.idivsqrt(this,t)}redDivSqrt(t){return N(this.red,"redDivSqrt"),this.red.divsqrt(this,t)}redIsSquare(){return N(this.red,"redIsSquare"),this.red.isSquare(this)}redIShl(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redIShl"),B(!t.red,"redIShl"),this.red.ishl(this,t)}redShl(t){return _(l.isBN(t),"num","bignum"),_(t.n>=0n&&t.n<=o,"num","uint32"),N(this.red,"redShl"),B(!t.red,"redShl"),this.red.shl(this,t)}redIShln(t){return _(t>>>0===t,"num","uint32"),N(this.red,"redIShln"),this.red.ishln(this,t)}redShln(t){return _(t>>>0===t,"num","uint32"),N(this.red,"redShln"),this.red.shln(this,t)}redINeg(){return N(this.red,"redINeg"),this.red.ineg(this)}redNeg(){return N(this.red,"redNeg"),this.red.neg(this)}redEq(t){return _(l.isBN(t),"num","bignum"),N(this.red,"redEq"),this.red.eq(this,t)}redEqn(t){return _(P(t),"num","smi"),N(this.red,"redEqn"),this.red.eqn(this,t)}redIsHigh(){return N(this.red,"redIsHigh"),this.red.isHigh(this)}redIsLow(){return N(this.red,"redIsLow"),this.red.isLow(this)}redIsOdd(){return N(this.red,"redIsOdd"),this.red.isOdd(this)}redIsEven(){return N(this.red,"redIsEven"),this.red.isEven(this)}redLegendre(){return N(this.red,"redLegendre"),this.red.legendre(this)}redJacobi(){return N(this.red,"redJacobi"),this.red.jacobi(this)}redKronecker(){return N(this.red,"redKronecker"),this.red.kronecker(this)}redIInvert(){return N(this.red,"redIInvert"),this.red.iinvert(this)}redInvert(){return N(this.red,"redInvert"),this.red.invert(this)}redIFermat(){return N(this.red,"redIFermat"),this.red.ifermat(this)}redFermat(){return N(this.red,"redFermat"),this.red.fermat(this)}_forceRed(t){return this.red=t,this}clone(){return(new l).inject(this)}inject(t){return _(l.isBN(t),"num","bignum"),this.n=t.n,this.red=t.red,this}set(t,e){return this.fromNumber(t,e)}swap(t){return _(l.isBN(t),"num","bignum"),[this.n,t.n]=[t.n,this.n],[this.red,t.red]=[t.red,this.red],this}reverse(){const t=this.n<0n,e="be"===c?"le":"be";return this.fromBuffer(this.toBuffer(e),c),t&&(this.n=-this.n),this}byteLength(){return at(this.n)}bitLength(){return ct(this.n)}zeroBits(){return dt(this.n)}isSafe(){return this.n<=a&&this.n>=-a}word(t){return _(t>>>0===t,"pos","uint32"),function(t,e){return Number(G(t)>>BigInt(26*e)&0x3ffffffn)}(this.n,t)}[i](){let t="BN";return this.red&&(t="BN-R"),`<${t}: ${this.toString(10)}>`}csign(){return-2*this.cneg()+1-this.czero()}czero(){return 0n===this.n|0}cneg(){return this.n<0n|0}cpos(){return this.n>=0n|0}ceq(t){return _(l.isBN(t),"num","bignum"),lt(this.n,t.n)}ceqn(t){const e=t>>31|1,r=((0|t)*e&67108863)*e;return 0n===(this.n^BigInt(r))|0}cswap(t,e){_(l.isBN(t),"num","bignum");const r=1&(e>>31|-e>>31);return[this.n,t.n]=mt(this.n,t.n,r),this}cinject(t,e){_(l.isBN(t),"num","bignum");const r=1&(e>>31|-e>>31);return this.n=function(t,e,r){const i=BigInt(r);return t*(1n^i)+e*i}(this.n,t.n,r),this}cset(t,e){const r=1&(e>>31|-e>>31),i=t>>31|1,s=((0|t)*i&67108863)*i;return this.n=function(t,e,r){const i=BigInt(r);return t*(1n^i)+BigInt(e)*i}(this.n,s,r),this}toNumber(){if(!this.isSafe())throw new RangeError("Number can only safely store up to 53 bits.");return Number(this.n)}toDouble(){return Number(this.n)}valueOf(){return this.toDouble()}toBigInt(){return this.n}toBool(){return 0n!==this.n}toString(t,e){return function(t,e,r){if(null==r&&(r=0),0===r&&(r=1),_((e=R(e))>>>0===e,"base","uint32"),_(r>>>0===r,"padding","uint32"),e<2||e>36)throw new RangeError("Base ranges between 2 and 36.");let i=!1;t<0n&&(i=!0,t=-t);let s=t.toString(e);for(;s.length%r;)s="0"+s;return i&&(s="-"+s),s}(this.n,t,e)}toJSON(){return this.toString(16,2)}toArray(t,e){const r=this.toBuffer(t,e);return Array.from?Array.from(r):Array.prototype.slice.call(r)}toBuffer(t,e){return pt(this.n,t,e)}toArrayLike(t,e,r){if(t===Buffer)return this.toBuffer(e,r);if(t===Array)return this.toArray(e,r);if(t===Int8Array||t===Uint8Array||t===Uint8ClampedArray){const i=this.toBuffer(e,r);return new t(i.buffer,i.byteOffset,i.byteLength)}return function(t,e,r,i){null==r&&(r="be"),null==i&&(i=0),_("function"==typeof e,"ArrayType","function"),_("be"===r||"le"===r,"endian","endianness"),_(i>>>0===i,"length","uint32");const s=at(t),n=i||Math.max(1,s);if(s>n)throw new RangeError("Byte array longer than desired length.");const o=function(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}(e,n);let h=G(t);if("be"===r){let t=n-1;for(;h>0n;)o[t--]=Number(0xffn&h),h>>=8n;for(;t>=0;t--)o[t]=0}else{let t=0;for(;h>0n;)o[t++]=Number(0xffn&h),h>>=8n;for(;t<n;t++)o[t]=0}return o}(this.n,t,e,r)}encode(t,e){return this.toBuffer(t,e)}of(t,e){return this.fromNumber(t,e)}fromNumber(t,e){return null==e&&(e="be"),_(M(t),"num","integer"),_("be"===e||"le"===e,"endian","endianness"),this.n=BigInt(t),"le"===e&&this.reverse(),this}fromDouble(t,e){return null==e&&(e="be"),_("number"==typeof t,"num","double"),_("be"===e||"le"===e,"endian","endianness"),isFinite(t)||(t=0),this.n=BigInt(Math.trunc(t)),"le"===e&&this.reverse(),this}fromBigInt(t,e){return null==e&&(e="be"),_("bigint"==typeof t,"num","bigint"),_("be"===e||"le"===e,"endian","endianness"),this.n=t,"le"===e&&this.reverse(),this}fromBool(t){return _("boolean"==typeof t,"value","boolean"),this.set(t?1:0)}fromString(t,e,r){return"le"!==e&&"be"!==e||([e,r]=[r,e]),null==r&&(r="be"),_("be"===r||"le"===r,"endian","endianness"),this.n=function(t,e){if(e=R(e),_("string"==typeof t,"str","string"),_(e>>>0===e,"base","uint32"),e<2||e>36)throw new RangeError("Base ranges between 2 and 36.");if(function(t){switch(t){case 2:case 8:case 10:case 16:return!0}return!1}(e))return function(t,e){let r,i=!1;switch((t=t.replace(/\s+/g,"")).length>0&&45===t.charCodeAt(0)&&(t=t.substring(1),i=!0),e){case 2:t="0b"+t;break;case 8:t="0o"+t;break;case 10:if(t.length>1){const e=t.charCodeAt(1);if(e<48||e>57)throw new Error("Invalid string.")}break;case 16:t="0x"+t;break;default:throw new Error("Invalid base.")}try{r=BigInt(t)}catch(t){throw new Error("Invalid string.")}return i&&(r=-r),r}(t,e);let r=!1,i=0;for(;i<t.length;i++){switch(t.charCodeAt(i)){case 9:case 10:case 13:case 32:continue}break}i<t.length&&45===t.charCodeAt(i)&&(r=!0,i+=1);const s=BigInt(e);let n=0n;for(;i<t.length;i++){let r=t.charCodeAt(i);switch(r){case 9:case 10:case 13:case 32:continue}if(r>=48&&r<=57?r-=48:r>=65&&r<=90?r-=55:r>=97&&r<=122?r-=87:r=e,r>=e)throw new Error("Invalid string.");n*=s,n+=BigInt(r)}return r&&(n=-n),n}(t,e),"le"===r&&this.reverse(),this}fromJSON(t){if(l.isBN(t))return t.red?t.fromRed():t.clone();if(Array.isArray(t)){for(const e of t)_("string"==typeof e,"chunk","string");t=t.join("")}return this.fromString(t,16)}fromBN(t){return this.inject(t)}fromArray(t,e){return _(Array.isArray(t),"data","array"),this.n=gt(t,e),this}fromBuffer(t,e){return this.n=bt(t,e),this}fromArrayLike(t,e){if(Buffer.isBuffer(t))return this.fromBuffer(t,e);if(Array.isArray(t))return this.fromArray(t,e);if(t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray){const r=Buffer.from(t.buffer,t.byteOffset,t.byteLength);return this.fromBuffer(r,e)}return this.n=gt(t,e),this}decode(t,e){return this.fromBuffer(t,e)}from(t,e,r){if(null==t)return this;if("le"!==e&&"be"!==e||([e,r]=[r,e]),"number"==typeof t)return this.fromNumber(t,r);if("bigint"==typeof t)return this.fromBigInt(t,r);if("string"==typeof t)return this.fromString(t,e,r);if("object"==typeof t){if(l.isBN(t))return this.fromBN(t,r);if(Buffer.isBuffer(t))return this.fromBuffer(t,r);if(t.length>>>0===t.length)return this.fromArrayLike(t,r)}if("boolean"==typeof t)return this.fromBool(t);throw new TypeError("Non-numeric object passed to BN.")}static min(...t){let e=null;for(const r of t)_(l.isBN(r),"num","bignum"),(!e||r.cmp(e)<0)&&(e=r);return e||new l(0)}static max(...t){let e=null;for(const r of t)_(l.isBN(r),"num","bignum"),(!e||r.cmp(e)>0)&&(e=r);return e||new l(0)}static cmp(t,e){return _(l.isBN(t),"a","bignum"),t.cmp(e)}static ucmp(t,e){return _(l.isBN(t),"a","bignum"),t.ucmp(e)}static red(t){return new I(t,!1)}static barret(t){return new I(t,!1)}static mont(t){return new I(t,!0)}static _prime(t){if(d[t])return d[t];let e;if("p192"===t)e=new p;else if("p224"===t)e=new b;else if("p521"===t)e=new g;else if("k256"===t)e=new w;else if("p25519"===t)e=new S;else{if("p448"!==t)throw new Error(`Unknown prime: "${t}".`);e=new y}return d[t]=e,e}static prime(t){return l._prime(t).p.clone()}static pow(t,e){return 2===t?l.shift(1,e):(new l).fromNumber(t).ipown(e)}static shift(t,e){return(new l).fromNumber(t).ishln(e)}static mask(t){return l.shift(1,t).isubn(1)}static randomBits(t,e){const r=wt(t,e);return new l(r)}static random(t,e,r){const i=l.cast(e,16),s=l.cast(r,16),n=St(t,i.n,s.n);return new l(n)}static of(t,e){return(new l).of(t,e)}static fromNumber(t,e){return(new l).fromNumber(t,e)}static fromDouble(t,e){return(new l).fromDouble(t,e)}static fromBigInt(t,e){return(new l).fromBigInt(t,e)}static fromBool(t){return(new l).fromBool(t)}static fromString(t,e,r){return(new l).fromString(t,e,r)}static fromJSON(t){return(new l).fromJSON(t)}static fromBN(t){return(new l).fromBN(t)}static fromArray(t,e){return(new l).fromArray(t,e)}static fromBuffer(t,e){return(new l).fromBuffer(t,e)}static fromArrayLike(t,e){return(new l).fromArrayLike(t,e)}static decode(t,e){return(new l).decode(t,e)}static from(t,e,r){return(new l).from(t,e,r)}static cast(t,e,r){return l.isBN(t)?t:new l(t,e,r)}static isBN(t){return t instanceof l}}l.BN=l,l.wordSize=26,l.native=1;class m{constructor(t,e){this.name=t,this.p=new l(e,16)}}class p extends m{constructor(){super("p192","ffffffff ffffffff ffffffff fffffffeffffffff ffffffff")}}class b extends m{constructor(){super("p224","ffffffff ffffffff ffffffff ffffffff00000000 00000000 00000001")}}class g extends m{constructor(){super("p521","000001ff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffffffffffff")}}class w extends m{constructor(){super("k256","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe fffffc2f")}}class S extends m{constructor(){super("p25519","7fffffff ffffffff ffffffff ffffffffffffffff ffffffff ffffffff ffffffed")}}class y extends m{constructor(){super("p448","ffffffff ffffffff ffffffff ffffffffffffffff ffffffff fffffffe ffffffffffffffff ffffffff ffffffff ffffffffffffffff ffffffff")}}class I{constructor(t,e){let r=null;"string"==typeof t&&(r=l._prime(t),t=r.p),_(l.isBN(t),"m","bignum"),B(!t.red,"reduction"),O(t.n>=1n,"reduction"),this.m=t,this.n=t.n,this.prime=r,this.coprime=e,this.sm1=null}_verify1(t){O(0===t.negative,"red"),N(null!=t.red,"red")}_verify2(t,e){O(0==(t.negative|e.negative),"red"),N(null!=t.red&&t.red===e.red,"red")}get mont(){return!1}precompute(){return null===this.sm1&&5n===(7n&this.n)&&(this.sm1=ht(2n,this.n-1n>>2n,this.n)),this}convertTo(t){const e=new l;return e.n=U(t.n,this.n),e.red=this,e}convertFrom(t){const e=t.clone();return e.red=null,e}iadd(t,e){return this._verify2(t,e),t.n+=e.n,t.n>=this.n&&(t.n-=this.n),t}add(t,e){return this.iadd(t.clone(),e)}iaddn(t,e){if(this._verify1(t),e<0)return this.isubn(t,-e);let r=BigInt(e);return this.n<0x4000000n&&(r%=this.n),t.n+=r,t.n>=this.n&&(t.n-=this.n),t}addn(t,e){return this.iaddn(t.clone(),e)}isub(t,e){return this._verify2(t,e),t.n-=e.n,t.n<0n&&(t.n+=this.n),t}sub(t,e){return this.isub(t.clone(),e)}isubn(t,e){if(this._verify1(t),e<0)return this.iaddn(t,-e);let r=BigInt(e);return this.n<0x4000000n&&(r%=this.n),t.n-=r,t.n<0n&&(t.n+=this.n),t}subn(t,e){return this.isubn(t.clone(),e)}imul(t,e){return this._verify2(t,e),t.n*=e.n,t.n%=this.n,t}mul(t,e){return this._verify2(t,e),this.imul(t.clone(),e)}imuln(t,e){return this._verify1(t),t.n*=BigInt(e),t.n=U(t.n,this.n),t}muln(t,e){return this.imuln(t.clone(),e)}idiv(t,e){return t.n*=nt(e.n,this.n),t.n%=this.n,t}div(t,e){return this.idiv(t.clone(),e)}idivn(t,e){return t.n*=nt(BigInt(e),this.n),t.n%=this.n,t}divn(t,e){return this.idivn(t.clone(),e)}ipow(t,e,r){return this._verify1(t),t.n=ht(t.n,e.n,this.n,r),t}pow(t,e,r){return this.ipow(t.clone(),e,r)}ipown(t,e){return this._verify1(t),t.n=ht(t.n,BigInt(e),this.n),t}pown(t,e){return this.ipown(t.clone(),e)}isqr(t){return this._verify1(t),t.n*=t.n,t.n%=this.n,t}sqr(t){return this.isqr(t.clone())}isqrt(t){return this._verify1(t),null!=this.sm1?t.n=function(t,e,r){let i=ht(t,e+3n>>3n,e);if(i*i%e!==t&&(i=i*r%e,i*i%e!==t))throw new Error("X is not a square mod P.");return i}(t.n,this.n,this.sm1):t.n=ft(t.n,this.n),t}sqrt(t){return this.isqrt(t.clone())}idivsqrt(t,e){return this._verify2(t,e),t.n=function(t,e,r,i){if(E(r>0n),(t<0n||t>=r)&&(t=U(t,r)),(e<0n||e>=r)&&(e=U(e,r)),0n===e)throw new RangeError("Not invertible.");return 3n===(3n&r)?function(t,e,r){const i=t*t%r,s=i*t%r,n=s*e*ht(s*i%r*(e*e*e%r),r-3n>>2n,r)%r;if(e*n*n%r===t)return n;throw new Error("X is not a square mod P.")}(t,e,r):null!=i&&5n===(7n&r)?function(t,e,r,i){const s=e*e*e%r,n=t*s*ht(t*(s*s*e%r),r-5n>>3n,r)%r,o=e*n*n%r;if(o===t)return n;if(o===U(-t,r))return n*i%r;throw new Error("X is not a square mod P.")}(t,e,r,i):ft(t*nt(e,r),r)}(t.n,e.n,this.n,this.sm1),t}divsqrt(t,e){return this.idivsqrt(t.clone(),e)}isSquare(t){let e;return this._verify1(t),e=this.prime||this.coprime?tt(t.n,this.n):1n&this.n?et(t.n,this.n):rt(t.n,this.n),Boolean(~e>>>31)}ishl(t,e){return this._verify1(t),t.n<<=e.n,t.n%=this.n,t}shl(t,e){return this.ishl(t.clone(),e)}ishln(t,e){return this._verify1(t),t.n<<=BigInt(e),t.n%=this.n,t}shln(t,e){return this.ishln(t.clone(),e)}ineg(t){return this._verify1(t),0n!==t.n&&(t.n=this.n-t.n),t}neg(t){return this.ineg(t.clone())}eq(t,e){return this._verify2(t,e),t.n===e.n}eqn(t,e){if(this._verify1(t),this.n<0x4000000n){const r=Number(this.n);return(e%=r)<0&&(e+=r),t.n==e}return e<0?t.n===BigInt(e)+this.n:t.n==e}isHigh(t){return!this.isLow(t)}isLow(t){return this._verify1(t),t.n<=this.n>>1n}isOdd(t){return this._verify1(t),t.isOdd()}isEven(t){return this._verify1(t),t.isEven()}legendre(t){return this._verify1(t),tt(t.n,this.n)}jacobi(t){return this._verify1(t),et(t.n,this.n)}kronecker(t){return this._verify1(t),rt(t.n,this.n)}iinvert(t){return this._verify1(t),t.n=nt(t.n,this.n),t}invert(t){return this.iinvert(t.clone())}ifermat(t){return this._verify1(t),t.n=ot(t.n,this.n),t}fermat(t){return this.ifermat(t.clone())}[i](){return this.prime?`<Red: ${this.prime.name}>`:`<Red: ${this.n.toString(10)}>`}}function v(t,e,r){const i=new t(e);return t.captureStackTrace&&t.captureStackTrace(i,r),i}function E(t,e){if(!t)throw v(Error,e||"Assertion failed.",E)}function _(t,e,r){if(!t)throw v(TypeError,`"${e}" must be a(n) ${r}.`,_)}function O(t,e){if(!t)throw v(RangeError,`"${e}" only works with positive numbers.`,O)}function N(t,e){if(!t)throw v(TypeError,`"${e}" only works with red numbers.`,N)}function B(t,e){if(!t)throw v(TypeError,`"${e}" only works with normal numbers.`,B)}function A(t){if(!t)throw v(RangeError,"Cannot divide by zero.",A)}function M(t){return Number.isSafeInteger(t)}function P(t){return M(t)&&t>=-67108863&&t<=67108863}function R(t){if(null==t)return 10;if("number"==typeof t)return t;switch(t){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function x(t){for(let e=t.length-1,r=0;e>r;e--,r++)[t[e],t[r]]=[t[r],t[e]];return t}function k(t,e){return E(0!==e),Number(t%BigInt(e))}function T(t,e){E(0n!==e);let r=t/e;return t>=0n||t-r*e<0n&&(e<0n?r+=1n:r-=1n),r}function U(t,e){E(0n!==e);let r=t%e;return r<0n&&(e<0n?r-=e:r+=e),r}function z(t,e,r){if(0===e)throw new RangeError("Zeroth root.");if(~e&t<0n)throw new RangeError("Negative with even root.");if(-1n===t||0n===t||1n===t)return[t,0n];const i=BigInt(e);let s,n,o=0n,h=1n<<BigInt(ct(t)/e+1|0);if(t<0n&&(h=-h),2===e)do{o=h,h=t/o,h+=o,h>>=1n}while(Q(h,o)<0);else do{o=h,h=o**(i-1n),h=t/h,s=o*(i-1n),h+=s,h/=i}while(Q(h,o)<0);return r&&(h=o**i,n=t-h),[o,n]}function C(t,e){return z(t,e,1)}function q(t,e){return z(t,e,0)[0]}function H(t,e){if(0===e||~e&t<0n)return!1;const[,r]=C(t,e);return 0n===r}function L(t){return H(t,2)}function D(t){return(1n<<BigInt(t))-1n}function V(t,e){const r=t<0n,i=G(t)&G(e);return r?-i:i}function F(t,e){return V(t,BigInt(e))}function K(t,e){const r=t<0n,i=G(t)|G(e);return r?-i:i}function j(t,e){const r=t<0n,i=G(t)^G(e);return r?-i:i}function W(t,e){return t<0n?-(-t>>e):t>>e}function Y(t,e){const r=t<0n;return r&&(t=-t),t^=D(e),r&&(t=-t),t}function J(t,e,r){return r?t|=1n<<BigInt(e):t&=~(1n<<BigInt(e)),t}function X(t,e){return Number(t>>BigInt(e)&1n)}function G(t){return t<0n?-t:t}function Z(t,e){return t<e?-1:t>e?1:0}function $(t,e){return t<e?-1:t>e?1:0}function Q(t,e){return Z(G(t),G(e))}function tt(t,e){if(O(e>0n,"legendre"),0n===(1n&e))throw new Error("legendre: `num` must be odd.");const r=ht(t,e-1n>>1n,e),i=lt(r,0n),s=lt(r,1n),n=lt(r,e-1n);if(0==(i|s|n))throw new Error("Invalid prime.");return E(i+s+n===1),s-n}function et(t,e){if(0n===e||0n===(1n&e))throw new Error("jacobi: `num` must be odd.");let r=t,i=e,s=1;for(i<0n&&(r<0n&&(s=-1),i=-i),r<0n&&(r=U(r,i));;){if(1n===i)return s;if(0n===r)return 0;if(r%=i,0n===r)return 0;const t=dt(r);if(1&t){const t=7n&i;3n!==t&&5n!==t||(s=-s)}const e=r>>BigInt(t);3n===(3n&i)&&3n===(3n&e)&&(s=-s),r=i,i=e}}function rt(t,e){const r=[0,1,0,-1,0,-1,0,1];let i=t,s=e,n=1;if(0n===s)return 1n===G(i)?n:0;if(0n===(1n&i)&&0n===(1n&s))return 0;const o=dt(s);for(s>>=BigInt(o),1&o&&(n=r[Number(7n&G(i))]),s<0n&&(i<0n&&(n=-n),s=-s);;){if(0n===i)return 1n===s?n:0;const t=dt(i);i>>=BigInt(t),1&t&&(n*=r[Number(7n&s)]),0n!==((i<0n?3n^-i:i)&s&2n)&&(n=-n),s=U(s,i),[i,s]=[s,i],s<0n&&(s=-s)}}function it(t,e){for(t=G(t),e=G(e);0n!==e;)[t,e]=[e,t%e];return t}function st(t,e){let r=0n,i=1n,s=1n,n=0n,o=G(e),h=G(t);for(;0n!==o;){const t=h/o;[h,o]=[o,h-t*o],[i,r]=[r,i-t*r],[n,s]=[s,n-t*s]}return h<0n&&(h=-h,i=-i,n=-n),t<0n&&(i=-i),e<0n&&(n=-n),[i,n,h]}function nt(t,e){if(E(e>0n),1n===e)throw new RangeError("Not invertible.");(t<0n||t>=e)&&(t=U(t,e));let r=0n,i=1n,s=e,n=t;for(;0n!==n;){const t=s/n;[r,i]=[i,r-t*i],[s,n]=[n,s-t*n]}if(s<0n&&(s=-s,r=-r),1n!==s)throw new RangeError("Not invertible.");return r<0n&&(r+=e),r}function ot(t,e){if(E(e>0n),1n===e)throw new RangeError("Not invertible.");const r=ht(t,e-2n,e);if(0n===r)throw new RangeError("Not invertible.");return r}function ht(t,e,r,i){return E(r>0n),e<0n?(t=nt(t,r),e=-e):t=U(t,r),null!=i?function(t,e,r,i){const s=Math.max(ct(e),i>>>0),n=pt(e,"le",s+7>>>3);let o=1n,h=0;for(let e=s-1;e>=0;e--){const i=n[e>>3]>>(7&e)&1;[t,o]=mt(t,o,h^i),t=t*o%r,o=o*o%r,h=i}return[t,o]=mt(t,o,h),o}(t,e,r,i):function(t,e,r){let i=1n;for(;e>0n;)1n===(1n&e)&&(i=i*t%r),t=t*t%r,e>>=1n;return i}(t,e,r)}function ft(t,e){return E(e>0n),(t<0n||t>=e)&&(t=U(t,e)),3n===(3n&e)?function(t,e){const r=ht(t,e+1n>>2n,e);if(r*r%e!==t)throw new Error("X is not a square mod P.");return r}(t,e):5n===(7n&e)?function(t,e){const r=t<<1n,i=ht(r,e>>3n,e);let s=i*i%e;if(s=s*r%e,s=U(s-1n,e),s=s*t%e,s=s*i%e,s*s%e!==t)throw new Error("X is not a square mod P.");return s}(t,e):function(t,e){if(1n===e||0n===(1n&e))throw new Error("Invalid prime.");switch(et(t,e)){case-1:throw new Error("X is not a square mod P.");case 0:return 0n}let r=e-1n;const i=BigInt(dt(r));r>>=i;let s=2n;for(;-1!==et(s,e);)s+=1n;let n=ht(t,r+1n>>1n,e),o=ht(t,r,e),h=ht(s,r,e),f=i;for(;;){let t=o,r=0n;for(;1n!==t;)t=t*t%e,r+=1n;if(0n===r)break;E(r<f),t=1n<<f-r-1n,t=ht(h,t,e),h=t*t%e,n=n*t%e,o=o*h%e,f=r}return n}(t,e)}function ut(t,e){if(0n===t)return 0;t<0n&&(t=-t);let r=0;for(;t>=u;)r+=256,t>>=256n;for(;t>=f;)r+=128,t>>=128n;for(;t>=h;)r+=64,t>>=64n;for(;t>=o;)r+=32,t>>=32n;for(;t>=n;)r+=16,t>>=16n;for(;t>=s;)r+=8,t>>=8n;for(;t>0n;)r+=1,t>>=1n;return(r+(e-1))/e>>>0}function at(t){return ut(t,8)}function ct(t){return ut(t,1)}function dt(t){if(0n===t)return 0;t<0n&&(t=-t);let e=0;for(;0n===(t&o);)e+=32,t>>=32n;for(;0n===(t&n);)e+=16,t>>=16n;for(;0n===(t&s);)e+=8,t>>=8n;for(;0n===(1n&t);)e+=1,t>>=1n;return e}function lt(t,e){return 0n===(t^e)|0}function mt(t,e,r){const i=BigInt(r);return[t*(1n^i)+e*i,e*(1n^i)+t*i]}function pt(t,e,r){null==e&&(e="be"),null==r&&(r=0),_("be"===e||"le"===e,"endian","endianness"),_(r>>>0===r,"length","uint32");let i=G(t).toString(16);1&i.length&&(i="0"+i);const s=i.length>>>1,n=r||Math.max(1,s);if(s>n)throw new RangeError("Byte array longer than desired length.");const o=i.padStart(2*n,"00"),h=Buffer.from(o,"hex");return"le"===e&&x(h),h}function bt(t,e){null==e&&(e="be"),_(Buffer.isBuffer(t),"data","buffer"),_("be"===e||"le"===e,"endian","endianness"),e!==c&&(t=x(Buffer.from(t)));const r=7&t.byteOffset;r&&(t=Buffer.from(t.buffer,t.byteOffset-r,r+t.byteLength));const i=new BigUint64Array(t.buffer,t.byteOffset,t.length>>>3),s=7&t.length,n=t.length-s;let o=0n;if("be"===c){for(let t=0;t<i.length;t++)o<<=64n,o|=i[t];for(let e=n;e<t.length;e++)o<<=8n,o|=BigInt(t[e]);r&&(o&=D(8*(t.length-r)))}else{for(let e=t.length-1;e>=n;e--)o<<=8n,o|=BigInt(t[e]);for(let t=i.length-1;t>=0;t--)o<<=64n,o|=i[t];r&&(o>>=BigInt(8*r))}return o}function gt(t,e){null==e&&(e="be"),_(t&&t.length>>>0===t.length,"data","array-like"),_("be"===e||"le"===e,"endian","endianness");let r=0n;if("be"===e)for(let e=0;e<t.length;e++)r<<=8n,r|=BigInt(255&t[e]);else for(let e=t.length-1;e>=0;e--)r<<=8n,r|=BigInt(255&t[e]);return r}function wt(t,e){if(_(null!=t,"rng","rng"),_(e>>>0===e,"bits","uint32"),"object"==typeof t){_("function"==typeof t.randomBytes,"rng","rng");const r=e+7>>>3,i=8*r,s=t.randomBytes(r);if(_(Buffer.isBuffer(s),"bytes","buffer"),s.length!==r)throw new RangeError("Invalid number of bytes returned from RNG.");let n=bt(s);return i>e&&(n>>=BigInt(i-e)),n}_("function"==typeof t,"rng","rng");const r=t(e);if(_(l.isBN(r),"num","bignum"),O(0===r.negative,"RNG"),B(!r.red,"RNG"),r.bitLength()>e)throw new RangeError("Invalid number of bits returned from RNG.");return r.n}function St(t,e,r){if(e>r)throw new RangeError("Minimum cannot be greater than maximum.");const i=G(r-e),s=ct(i);if(0===s)return e;for(;;){let r=wt(t,s);if(!(r>=i))return r+=e,r}}l.Red=I,t.exports=l},8082:(t,e,r)=>{const{ChaCha20:i}=r(8758);i.native=2,t.exports=i},8251:(t,e,r)=>{const i=r(7494),s=r(8758);class n extends s.ECDSA{constructor(t){super(s.curves.ecdsa[t]),this.id=t,this.type="ecdsa",this.size=this._size(),this.bits=this._bits(),this.native=2,this._randomize(s.entropy())}privateKeyGenerate(){return super.privateKeyGenerate(s.entropy())}privateKeyExport(t){const e=this.publicKeyCreate(t,!1),[r,i]=super.publicKeyExport(e);return{d:Buffer.from(t),x:r,y:i}}privateKeyImport(t){return i(t&&"object"==typeof t),super.privateKeyImport(t.d)}publicKeyExport(t){const[e,r]=super.publicKeyExport(t);return{x:e,y:r}}publicKeyImport(t,e){return i(t&&"object"==typeof t),super.publicKeyImport(t.x,t.y,t.sign,e)}publicKeyToUniform(t,e=s.hint()){return super.publicKeyToUniform(t,e)}publicKeyToHash(t){return super.publicKeyToHash(t,s.entropy())}}t.exports=n},9612:(t,e,r)=>{const i=r(8758),{Hash:s,HMAC:n,hashes:o}=i;class h extends s{constructor(){super(o.HASH160)}static hash(){return new h}static hmac(){return new n(o.HASH160)}static digest(t){return s.digest(o.HASH160,t)}static root(t,e){return s.root(o.HASH160,t,e)}static multi(t,e,r){return s.multi(o.HASH160,t,e,r)}static mac(t,e){return n.digest(o.HASH160,t,e)}}h.native=2,h.id="HASH160",h.size=20,h.bits=160,h.blockSize=64,h.zero=Buffer.alloc(20,0),h.ctx=new h,t.exports=h},8269:(t,e,r)=>{const i=r(8758),{Hash:s,HMAC:n,hashes:o}=i;class h extends s{constructor(){super(o.HASH256)}static hash(){return new h}static hmac(){return new n(o.HASH256)}static digest(t){return s.digest(o.HASH256,t)}static root(t,e){return s.root(o.HASH256,t,e)}static multi(t,e,r){return s.multi(o.HASH256,t,e,r)}static mac(t,e){return n.digest(o.HASH256,t,e)}}h.native=2,h.id="HASH256",h.size=32,h.bits=256,h.blockSize=64,h.zero=Buffer.alloc(32,0),h.ctx=new h,t.exports=h},958:(t,e,r)=>{const i=r(7494),s=r(8758),n=new s.Secp256k1;n._randomize(s.entropy(32)),e.id="SECP256K1",e.type="ecdsa",e.size=32,e.bits=256,e.native=2,e.privateKeyGenerate=function(){return n.privateKeyGenerate(s.entropy())},e.privateKeyVerify=function(t){return n.privateKeyVerify(t)},e.privateKeyExport=function(t){const e=n.publicKeyCreate(t,!1),[r,i]=n.publicKeyExport(e);return{d:Buffer.from(t),x:r,y:i}},e.privateKeyImport=function(t){return i(t&&"object"==typeof t),n.privateKeyImport(t.d)},e.privateKeyTweakAdd=function(t,e){return n.privateKeyTweakAdd(t,e)},e.privateKeyTweakMul=function(t,e){return n.privateKeyTweakMul(t,e)},e.privateKeyReduce=function(t){return n.privateKeyReduce(t)},e.privateKeyNegate=function(t){return n.privateKeyNegate(t)},e.privateKeyInvert=function(t){return n.privateKeyInvert(t)},e.publicKeyCreate=function(t,e){return n.publicKeyCreate(t,e)},e.publicKeyConvert=function(t,e){return n.publicKeyConvert(t,e)},e.publicKeyFromUniform=function(t,e){return n.publicKeyFromUniform(t,e)},e.publicKeyToUniform=function(t,e=s.hint()){return n.publicKeyToUniform(t,e)},e.publicKeyFromHash=function(t,e){return n.publicKeyFromHash(t,e)},e.publicKeyToHash=function(t){return n.publicKeyToHash(t,s.entropy())},e.publicKeyVerify=function(t){return n.publicKeyVerify(t)},e.publicKeyExport=function(t){const[e,r]=n.publicKeyExport(t);return{x:e,y:r}},e.publicKeyImport=function(t,e){return i(t&&"object"==typeof t),n.publicKeyImport(t.x,t.y,t.sign,e)},e.publicKeyTweakAdd=function(t,e,r){return n.publicKeyTweakAdd(t,e,r)},e.publicKeyTweakMul=function(t,e,r){return n.publicKeyTweakMul(t,e,r)},e.publicKeyCombine=function(t,e){return n.publicKeyCombine(t,e)},e.publicKeyNegate=function(t,e){return n.publicKeyNegate(t,e)},e.signatureNormalize=function(t){return n.signatureNormalize(t)},e.signatureNormalizeDER=function(t){return n.signatureNormalizeDER(t)},e.signatureExport=function(t){return n.signatureExport(t)},e.signatureImport=function(t){return n.signatureImport(t)},e.isLowS=function(t){return n.isLowS(t)},e.isLowDER=function(t){return n.isLowDER(t)},e.sign=function(t,e){return n.sign(t,e)},e.signRecoverable=function(t,e){return n.signRecoverable(t,e)},e.signDER=function(t,e){return n.signDER(t,e)},e.signRecoverableDER=function(t,e){return n.signRecoverableDER(t,e)},e.verify=function(t,e,r){try{return n.verify(t,e,r)}catch(t){if(t instanceof TypeError)throw t;return!1}},e.verifyDER=function(t,e,r){try{return n.verifyDER(t,e,r)}catch(t){if(t instanceof TypeError)throw t;return!1}},e.recover=function(t,e,r,i){try{return n.recover(t,e,r,i)}catch(t){if(t instanceof TypeError)throw t;return null}},e.recoverDER=function(t,e,r,i){try{return n.recoverDER(t,e,r,i)}catch(t){if(t instanceof TypeError)throw t;return null}},e.derive=function(t,e,r){return n.derive(t,e,r)},e.schnorrSign=function(t,e){return n.schnorrSign(t,e)},e.schnorrVerify=function(t,e,r){try{return n.schnorrVerify(t,e,r)}catch(t){if(t instanceof TypeError)throw t;return!1}},e.schnorrVerifyBatch=function(t){try{return n.schnorrVerifyBatch(t)}catch(t){if(t instanceof TypeError)throw t;return!1}}},1725:(t,e,r)=>{const i=r(8758),s=i.pbkdf2;e.native=2,e.derive=function(t,e,r,n,o){return"string"==typeof e&&(e=Buffer.from(e,"utf8")),"string"==typeof r&&(r=Buffer.from(r,"utf8")),null==r&&(r=Buffer.alloc(0)),s.derive(i.hash(t),e,r,n,o)},e.deriveAsync=async function(t,e,r,n,o){return"string"==typeof e&&(e=Buffer.from(e,"utf8")),"string"==typeof r&&(r=Buffer.from(r,"utf8")),null==r&&(r=Buffer.alloc(0)),new Promise(((h,f)=>{const u=(t,e)=>{t?f(t):h(e)};try{s.deriveAsync(i.hash(t),e,r,n,o,u)}catch(t){f(t)}}))}},7379:(t,e,r)=>{const i=r(7494),s=r(6417),n=s.randomFillSync.bind(s),o=new Uint32Array(1);function h(){!function(t){if(i(null!=t&&"object"==typeof t),i(t.buffer instanceof ArrayBuffer),null===f)try{n(new Uint32Array(1)),f=!0}catch(t){f=!1}f||(t=Buffer.from(t.buffer,t.byteOffset,t.byteLength)),n(t)}(o);const t=o[0];return o[0]=0,t}let f=null;e.native=1,e.randomBytes=function(t){i(t>>>0===t);const e=Buffer.alloc(t);return n(e,0,t),e},e.randomFill=function(t,e,r){return i(Buffer.isBuffer(t)),null==e&&(e=0),i(e>>>0===e),null==r&&(r=t.length-e),i(r>>>0===r),i(e+r<=t.length),t.fill(0,e,e+r),n(t,e,r),t},e.randomInt=h,e.randomRange=function(t,e){i(t>>>0===t),i(e>>>0===e),i(e>=t);const r=e-t;if(0===r)return t;const s=-r>>>0;let n,o;do{n=h(),o=n%r}while(n-o>s);return o+t}},3276:(t,e,r)=>{const i=r(8758),{Hash:s,HMAC:n,hashes:o}=i;class h extends s{constructor(){super(o.RIPEMD160)}static hash(){return new h}static hmac(){return new n(o.RIPEMD160)}static digest(t){return s.digest(o.RIPEMD160,t)}static root(t,e){return s.root(o.RIPEMD160,t,e)}static multi(t,e,r){return s.multi(o.RIPEMD160,t,e,r)}static mac(t,e){return n.digest(o.RIPEMD160,t,e)}}h.native=2,h.id="RIPEMD160",h.size=20,h.bits=160,h.blockSize=64,h.zero=Buffer.alloc(20,0),h.ctx=new h,t.exports=h},2174:(t,e,r)=>{const i=r(8758).scrypt;e.native=2,e.derive=function(t,e,r,s,n,o){return"string"==typeof t&&(t=Buffer.from(t,"utf8")),"string"==typeof e&&(e=Buffer.from(e,"utf8")),null==e&&(e=Buffer.alloc(0)),i.derive(t,e,r,s,n,o)},e.deriveAsync=async function(t,e,r,s,n,o){return"string"==typeof t&&(t=Buffer.from(t,"utf8")),"string"==typeof e&&(e=Buffer.from(e,"utf8")),null==e&&(e=Buffer.alloc(0)),new Promise(((h,f)=>{const u=(t,e)=>{t?f(t):h(e)};try{i.deriveAsync(t,e,r,s,n,o,u)}catch(t){f(t)}}))}},390:(t,e,r)=>{if(r(8758).Secp256k1&&"1"!==process.env.BCRYPTO_FORCE_TORSION)t.exports=r(958);else{const e=r(8251);t.exports=new e("SECP256K1")}},2096:(t,e,r)=>{const i=r(8758),{Hash:s,HMAC:n,hashes:o}=i;class h extends s{constructor(){super(o.SHA1)}static hash(){return new h}static hmac(){return new n(o.SHA1)}static digest(t){return s.digest(o.SHA1,t)}static root(t,e){return s.root(o.SHA1,t,e)}static multi(t,e,r){return s.multi(o.SHA1,t,e,r)}static mac(t,e){return n.digest(o.SHA1,t,e)}}h.native=2,h.id="SHA1",h.size=20,h.bits=160,h.blockSize=64,h.zero=Buffer.alloc(20,0),h.ctx=new h,t.exports=h},1347:(t,e,r)=>{const i=r(8758),{Hash:s,HMAC:n,hashes:o}=i;class h extends s{constructor(){super(o.SHA256)}static hash(){return new h}static hmac(){return new n(o.SHA256)}static digest(t){return s.digest(o.SHA256,t)}static root(t,e){return s.root(o.SHA256,t,e)}static multi(t,e,r){return s.multi(o.SHA256,t,e,r)}static mac(t,e){return n.digest(o.SHA256,t,e)}}h.native=2,h.id="SHA256",h.size=32,h.bits=256,h.blockSize=64,h.zero=Buffer.alloc(32,0),h.ctx=new h,t.exports=h},5522:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(8884):t.exports=r(1725)},627:(t,e,r)=>{t.exports=r(7379)},100:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(3614):t.exports=r(3276)},8361:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(5482):t.exports=r(2174)},2581:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(7480):t.exports=r(390)},8122:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(2095):t.exports=r(2096)},2372:(t,e,r)=>{"js"===process.env.NODE_BACKEND?t.exports=r(7918):t.exports=r(1347)},9777:(t,e,r)=>{const i=r(5747),s=r(5622),n=["Debug","Release","MinSizeRel","RelWithDebInfo"];function o(t,e){if("string"!=typeof t)throw new TypeError('"name" must be a string.');if("string"!=typeof e)throw new TypeError('"root" must be a string.');if(!i.existsSync)throw a(t);".node"!==s.extname(t)&&(t+=".node");const h=`${t}\0${e=function(t){if(0===t.indexOf("file:")){const e=r(8835);if(!e.fileURLToPath)throw new Error("File URLs are unsupported on this platform.");return s.resolve(e.fileURLToPath(t),"..")}return s.resolve(t)}(e)}`;if(o.cache[h])return o.cache[h];if(process.pkg&&!f(t)&&(t=s.resolve(process.execPath,"..",t)),f(t)){const r=s.resolve(e,t);if(!i.existsSync(r))throw a(r);const n=u(r);return o.cache[h]=n,n}for(;;){const r=s.join(e,"build");if(i.existsSync(r)){const e=[s.join(r,t)];for(const i of n)e.push(s.join(r,i,t));for(const t of e)if(i.existsSync(t)){const e=u(t);return o.cache[h]=e,e}}const f=s.dirname(e);if(f===e)break;e=f}throw a(t)}function h(t,e){const r=o(t,e);if(h.cache[r])return h.cache[r];if(!process.dlopen)throw new Error(`${t}: cannot open shared object file`);const i={exports:{}};return process.dlopen(i,r),h.cache[r]=i.exports,i.exports}function f(t){return"win32"===process.platform&&(t=t.replace("\\","/")),"/"===t[0]||t.startsWith("./")||t.startsWith("../")}function u(t){try{return i.realpathSync(t)}catch(e){return s.resolve(t)}}function a(t){const e=new Error(`Cannot find module '${t}'`);throw e.code="MODULE_NOT_FOUND",e}o.cache=Object.create(null),h.cache=Object.create(null),h.load=h,h.resolve=o,t.exports=h},1676:t=>{class e extends Error{constructor(t){"string"==typeof t&&(t={message:t}),null!==t&&"object"==typeof t||(t={});let e=null,r="fail",i=Boolean(t.generatedMessage);var s;null!=t.message&&(e="string"==typeof(s=t.message)?s:S(s)?d(s):c(s)),"string"==typeof t.operator&&(r=t.operator),null==e&&(e="fail"===r?"Assertion failed.":`${c(t.actual)} ${r} ${c(t.expected)}`,i=!0),super(e);let n=this.constructor;"function"==typeof t.stackStartFunction?n=t.stackStartFunction:"function"==typeof t.stackStartFn&&(n=t.stackStartFn),this.type="AssertionError",this.name="AssertionError [ERR_ASSERTION]",this.code="ERR_ASSERTION",this.generatedMessage=i,this.actual=t.actual,this.expected=t.expected,this.operator=r,Error.captureStackTrace&&Error.captureStackTrace(this,n)}}function r(t,i){if(!t){let s=!1;if(0===arguments.length)i="No value argument passed to `assert()`.",s=!0;else if(null==i)i="Assertion failed.",s=!0;else if(S(i))throw i;throw new e({message:i,actual:t,expected:!0,operator:"==",generatedMessage:s,stackStartFn:r})}}function i(t,r,s){if(!Object.is(t,r)){if(S(s))throw s;throw new e({message:s,actual:t,expected:r,operator:"strictEqual",stackStartFn:i})}}function s(t,r,i){if(Object.is(t,r)){if(S(i))throw i;throw new e({message:i,actual:t,expected:r,operator:"notStrictEqual",stackStartFn:s})}}function n(t,r,i){"string"==typeof r&&(i=r,r=void 0);let s=!1,o=null;a("function"==typeof t,"func","function");try{t()}catch(t){s=!0,o=t}if(s){if(l(o,r,i,n)){let t=!1;throw null==i&&(i="Got unwanted exception.",t=!0),new e({message:i,actual:o,expected:r,operator:"doesNotThrow",generatedMessage:t,stackStartFn:n})}throw o}}async function o(t,r,i){"string"==typeof r&&(i=r,r=void 0);let s=!1,n=null;"function"!=typeof t&&a(I(t),"func","promise");try{I(t)?await t:await t()}catch(t){s=!0,n=t}if(!s){let t=!1;throw null==i&&(i="Missing expected rejection.",t=!0),new e({message:i,actual:void 0,expected:r,operator:"rejects",generatedMessage:t,stackStartFn:o})}if(!l(n,r,i,o))throw n}async function h(t,r,i){"string"==typeof r&&(i=r,r=void 0);let s=!1,n=null;"function"!=typeof t&&a(I(t),"func","promise");try{I(t)?await t:await t()}catch(t){s=!0,n=t}if(s){if(l(n,r,i,h)){let t=!1;throw null==i&&(i="Got unwanted rejection.",t=!0),new e({message:i,actual:void 0,expected:r,operator:"doesNotReject",generatedMessage:t,stackStartFn:h})}throw n}}function f(t,r,i){if(!m(t,r,!1)){if(S(i))throw i;throw new e({message:i,actual:t,expected:r,operator:"deepStrictEqual",stackStartFn:f})}}function u(t,r,i){if(m(t,r,!0)){if(S(i))throw i;throw new e({message:i,actual:t,expected:r,operator:"notDeepStrictEqual",stackStartFn:u})}}function a(t,e,r){if(!t){let t;t=null==e?"Invalid type for parameter.":null==r?`Invalid type for "${e}".`:`"${e}" must be a(n) ${r}.`;const i=new TypeError(t);throw Error.captureStackTrace&&Error.captureStackTrace(i,a),i}}function c(t){switch(typeof t){case"undefined":return"undefined";case"object":return null===t?"null":`[${function(t){const e=function(t){return g(t).slice(8,-1)}(t);if(null==t)return e;if("Object"!==e&&"Error"!==e)return e;let r,i;try{r=t.constructor}catch(t){}if(null==r)return e;try{i=r.name}catch(t){return e}return"string"!=typeof i||0===i.length?e:i}(t)}]`;case"boolean":case"number":return`${t}`;case"string":return t.length>80&&(t=`${t.substring(0,77)}...`),JSON.stringify(t);case"symbol":return d(t);case"function":return`[${function(t){let e;try{e=t.name}catch(t){}return"string"!=typeof e||0===e.length?"Function":`Function: ${e}`}(t)}]`;case"bigint":return`${t}n`;default:return`[${typeof t}]`}}function d(t){try{return String(t)}catch(t){return"Object"}}function l(t,r,i,s){if(null==r)return!0;if(v(r))return r.test(t);if("function"!=typeof r){if(s===n||s===h)throw new TypeError('"expected" must not be an object.');if("object"!=typeof r)throw new TypeError('"expected" must be an object.');let f=!1;if(null==i&&(i=`Missing expected ${s===o?"rejection":"exception"}.`,f=!0),null==t||"object"!=typeof t)throw new e({actual:t,expected:r,message:i,operator:s.name,generatedMessage:f,stackStartFn:s});const u=Object.keys(r);if(S(r)&&u.push("name","message"),0===u.length)throw new TypeError('"expected" may not be an empty object.');for(const n of u){const o=r[n],h=t[n];if(!("string"==typeof h&&v(o)&&o.test(h)||n in t&&m(h,o,!1)))throw new e({actual:t,expected:r,message:i,operator:s.name,generatedMessage:f,stackStartFn:s})}return!0}return void 0!==r.prototype&&t instanceof r||!Error.isPrototypeOf(r)&&!0===r.call({},t)}function m(t,e,r){try{return p(t,e,null)}catch(t){return r}}function p(t,e,r){if(Object.is(t,e))return!0;if(!y(t)||!y(e))return!1;if(g(t)!==g(e))return!1;if(Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;if(w(t)&&w(e))return t.equals(e);if(t instanceof Date)return Object.is(t.getTime(),e.getTime());if(v(t))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(S(t)&&t.message!==e.message)return!1;if(t instanceof ArrayBuffer&&(t=new Uint8Array(t),e=new Uint8Array(e)),function(t){return ArrayBuffer.isView(t)}(t)&&!w(t)){if(w(e))return!1;const r=new Uint8Array(t.buffer),i=new Uint8Array(e.buffer);if(r.length!==i.length)return!1;for(let t=0;t<r.length;t++)if(r[t]!==i[t])return!1;return!0}if(function(t){return t instanceof Set}(t))return t.size===e.size&&new Set([...t,...e]).size===t.size;if(r){const i=r.a.get(t);if(null!=i){const t=r.b.get(e);if(null!=t)return i===t}r.p+=1}else r={a:new Map,b:new Map,p:0};r.a.set(t,r.p),r.b.set(e,r.p);const i=function(t,e,r){if(function(t){return t instanceof Map}(t)){if(t.size!==e.size)return!1;const i=new Set([...t.keys(),...e.keys()]);if(i.size!==t.size)return!1;for(const s of i)if(!p(t.get(s),e.get(s),r))return!1;return!0}if(function(t){return Array.isArray(t)}(t)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!p(t[i],e[i],r))return!1;return!0}const i=b(t),s=b(e);if(i.length!==s.length)return!1;const n=new Set([...i,...s]);if(n.size!==i.length)return!1;for(const i of n)if(!p(t[i],e[i],r))return!1;return!0}(t,e,r);return r.a.delete(t),r.b.delete(e),i}function b(t){const e=Object.keys(t);if(!Object.getOwnPropertySymbols)return e;if(!Object.getOwnPropertyDescriptor)return e;const r=Object.getOwnPropertySymbols(t);for(const i of r){const r=Object.getOwnPropertyDescriptor(t,i);r&&r.enumerable&&e.push(i)}return e}function g(t){if(void 0===t)return"[object Undefined]";if(null===t)return"[object Null]";try{return Object.prototype.toString.call(t)}catch(t){return"[object Object]"}}function w(t){return y(t)&&"function"==typeof t.writeUInt32LE&&"function"==typeof t.equals}function S(t){return t instanceof Error}function y(t){return t&&"object"==typeof t}function I(t){return t instanceof Promise}function v(t){return t instanceof RegExp}function E(t){if("string"!=typeof t)return!1;switch(t){case"ascii":case"binary":case"base64":case"hex":case"latin1":case"ucs2":case"utf8":case"utf16le":return!0}return!1}function _(t,e,r){if("string"==typeof e){if(!w(t))return null;const{constructor:i}=t;if(!i||"function"!=typeof i.from)return null;if(!E(r))return null;if("hex"===r&&1&e.length)return null;const s=i.from(e,r);return"hex"===r&&s.length!==e.length>>>1?null:s}return e}r.AssertionError=e,r.assert=r,r.strict=r,r.ok=r,r.equal=i,r.notEqual=s,r.strictEqual=i,r.notStrictEqual=s,r.fail=function t(r){let i=!1;if(S(r))throw r;throw null==r&&(r="Assertion failed.",i=!0),new e({message:r,actual:!1,expected:!0,operator:"fail",generatedMessage:i,stackStartFn:t})},r.throws=function t(r,i,s){"string"==typeof i&&(s=i,i=void 0);let n=!1,o=null;a("function"==typeof r,"func","function");try{r()}catch(t){n=!0,o=t}if(!n){let r=!1;throw null==s&&(s="Missing expected exception.",r=!0),new e({message:s,actual:void 0,expected:i,operator:"throws",generatedMessage:r,stackStartFn:t})}if(!l(o,i,s,t))throw o},r.doesNotThrow=n,r.rejects=o,r.doesNotReject=h,r.ifError=function t(r){if(null!=r){let i="ifError got unwanted exception: ";throw"object"==typeof r&&"string"==typeof r.message?0===r.message.length&&r.constructor?i+=r.constructor.name:i+=r.message:i+=c(r),new e({message:i,actual:r,expected:null,operator:"ifError",generatedMessage:!0,stackStartFn:t})}},r.deepEqual=f,r.notDeepEqual=u,r.deepStrictEqual=f,r.notDeepStrictEqual=u,r.bufferEqual=function t(r,i,s,n){if(E(s)||(n=s,s=null),null==s&&(s="hex"),i=_(r,i,s),a(w(r),"actual","buffer"),a(w(i),"expected","buffer"),r!==i&&!r.equals(i)){if(S(n))throw n;throw new e({message:n,actual:r.toString(s),expected:i.toString(s),operator:"bufferEqual",stackStartFn:t})}},r.notBufferEqual=function t(r,i,s,n){if(E(s)||(n=s,s=null),null==s&&(s="hex"),i=_(r,i,s),a(w(r),"actual","buffer"),a(w(i),"expected","buffer"),r===i||r.equals(i)){if(S(n))throw n;throw new e({message:n,actual:r.toString(s),expected:i.toString(s),operator:"notBufferEqual",stackStartFn:t})}},r.enforce=a,r.range=function t(e,r){if(!e){const e=new RangeError(null!=r?`"${r}" is out of range.`:"Parameter is out of range.");throw Error.captureStackTrace&&Error.captureStackTrace(e,t),e}},t.exports=r},1013:(t,e,r)=>{const{custom:i}=r(625);class s{constructor(t){if(this.map=new Map,null!=t)for(const[e,r]of t)this.set(e,r)}get size(){return this.map.size}get(t){const e=this.map.get(u(t));if(e)return e.value}has(t){return this.map.has(u(t))}set(t,e){return this.map.set(u(t),new o(t,e)),this}delete(t){return this.map.delete(u(t))}clear(){this.map.clear()}[Symbol.iterator](){return this.entries()}*entries(){for(const{key:t,value:e}of this.map.values())yield[t,e]}*keys(){for(const{key:t}of this.map.values())yield t}*values(){for(const{value:t}of this.map.values())yield t}forEach(t,e){if("function"!=typeof t)throw new TypeError(typeof t+" is not a function");for(const{key:r,value:i}of this.map.values())t.call(e,i,r,this)}toKeys(){const t=[];for(const{key:e}of this.map.values())t.push(e);return t}toValues(){const t=[];for(const{value:e}of this.map.values())t.push(e);return t}toArray(){return this.toValues()}[i](){const t=new Map;for(const{key:e,value:r}of this.map.values())t.set(a(e),r);return t}}class n{constructor(t){if(this.map=new Map,null!=t)for(const e of t)this.add(e)}get size(){return this.map.size}has(t){return this.map.has(u(t))}add(t){return this.map.set(u(t),t),this}delete(t){return this.map.delete(u(t))}clear(){this.map.clear()}[Symbol.iterator](){return this.keys()}*entries(){for(const t of this.map.values())yield[t,t]}keys(){return this.map.values()}values(){return this.map.values()}forEach(t,e){if("function"!=typeof t)throw new TypeError(typeof t+" is not a function");for(const r of this.map.values())t.call(e,r,r,this)}toKeys(){const t=[];for(const e of this.map.values())t.push(e);return t}toValues(){return this.toKeys()}toArray(){return this.toKeys()}[i](){const t=new Set;for(const e of this.map.values())t.add(a(e));return t}}class o{constructor(t,e){this.key=t,this.value=e}}const h="function"==typeof SharedArrayBuffer;function f(t,e){return Buffer.isBuffer(t)||(t=function(t){if(ArrayBuffer.isView(t))return Buffer.from(t.buffer,t.byteOffset,t.byteLength);if(function(t){return t instanceof ArrayBuffer||!!(h&&t instanceof SharedArrayBuffer)}(t))return Buffer.from(t,0,t.byteLength);throw new TypeError("Non-buffer passed to buffer map/set.")}(t)),t.toString(e)}function u(t){return f(t,"binary")}function a(t){return f(t,"hex")}e.BufferMap=s,e.BufferSet=n},625:(t,e,r)=>{const{inspect:i}=r(1669);e.custom=i.custom||"inspect"},8889:(t,e,r)=>{const i=r(6942),s=r(547),n=r(8052),o=r(5492),h=r(5232),f=r(2075),u=r(2780),a=r(1487);function c(t,e){return function(r,i){if(n(Buffer.isBuffer(r),"data","buffer"),n(i>>>0===i,"off","integer"),i+e>r.length)throw new o(i,"Out of bounds read");return t(r,i)}}function d(t){return function(e,r,i){if(n(Buffer.isBuffer(e),"data","buffer"),n(r>>>0===r,"off","integer"),n(i>>>0===i,"len","integer"),r+i>e.length)throw new o(r,"Out of bounds read");return t(e,r,i)}}function l(t){return function(e,r){return n(Buffer.isBuffer(e),"data","buffer"),n(r>>>0===r,"off","integer"),t(e,r)}}function m(t,e){return function(r,i,s){if(n(Buffer.isBuffer(r),"data","buffer"),n(s>>>0===s,"off","integer"),s+e>r.length)throw new o(s,"Out of bounds write");return t(r,i,s)}}function p(t){return function(e,r,i,s){if(n(Buffer.isBuffer(e),"data","buffer"),n(i>>>0===i,"off","integer"),n(s>>>0===s,"len","integer"),i+s>e.length)throw new o(i,"Out of bounds write");return t(e,r,i,s)}}function b(t,e){return function(r,i,s){if(n(Buffer.isBuffer(r),"data","buffer"),n(s>>>0===s,"off","integer"),s+e(i)>r.length)throw new o(s,"Out of bounds write");return t(r,i,s)}}e.custom=i,e.encoding=s,e.EncodingError=o,e.BufferReader=h,e.BufferWriter=f,e.StaticWriter=u,e.Struct=a,e.read=function(t,e){return new h(t,e)},e.write=function(t){return null!=t?new u(t):new f},e.pool=function(t){return u.pool(t)},e.readU=d(s.readU),e.readU64=c(s.readU64,8),e.readU56=c(s.readU56,7),e.readU48=c(s.readU48,6),e.readU40=c(s.readU40,5),e.readU32=c(s.readU32,4),e.readU24=c(s.readU24,3),e.readU16=c(s.readU16,2),e.readU8=c(s.readU8,1),e.readUBE=d(s.readUBE),e.readU64BE=c(s.readU64BE,8),e.readU56BE=c(s.readU56BE,7),e.readU48BE=c(s.readU48BE,6),e.readU40BE=c(s.readU40BE,5),e.readU32BE=c(s.readU32BE,4),e.readU24BE=c(s.readU24BE,3),e.readU16BE=c(s.readU16BE,2),e.readI=d(s.readI),e.readI64=c(s.readI64,8),e.readI56=c(s.readI56,7),e.readI48=c(s.readI48,6),e.readI40=c(s.readI40,5),e.readI32=c(s.readI32,4),e.readI24=c(s.readI24,3),e.readI16=c(s.readI16,2),e.readI8=c(s.readI8,1),e.readIBE=d(s.readIBE),e.readI64BE=c(s.readI64BE,8),e.readI56BE=c(s.readI56BE,7),e.readI48BE=c(s.readI48BE,6),e.readI40BE=c(s.readI40BE,5),e.readI32BE=c(s.readI32BE,4),e.readI24BE=c(s.readI24BE,3),e.readI16BE=c(s.readI16BE,2),e.readFloat=c(s.readFloat,4),e.readFloatBE=c(s.readFloatBE,4),e.readDouble=c(s.readDouble,8),e.readDoubleBE=c(s.readDoubleBE,8),e.writeU=p(s.writeU),e.writeU64=m(s.writeU64,8),e.writeU56=m(s.writeU56,7),e.writeU48=m(s.writeU48,6),e.writeU40=m(s.writeU40,5),e.writeU32=m(s.writeU32,4),e.writeU24=m(s.writeU24,3),e.writeU16=m(s.writeU16,2),e.writeU8=m(s.writeU8,1),e.writeUBE=p(s.writeUBE),e.writeU64BE=m(s.writeU64BE,8),e.writeU56BE=m(s.writeU56BE,7),e.writeU48BE=m(s.writeU48BE,6),e.writeU40BE=m(s.writeU40BE,5),e.writeU32BE=m(s.writeU32BE,4),e.writeU24BE=m(s.writeU24BE,3),e.writeU16BE=m(s.writeU16BE,2),e.writeI=p(s.writeI),e.writeI64=m(s.writeI64,8),e.writeI56=m(s.writeI56,7),e.writeI48=m(s.writeI48,6),e.writeI40=m(s.writeI40,5),e.writeI32=m(s.writeI32,4),e.writeI24=m(s.writeI24,3),e.writeI16=m(s.writeI16,2),e.writeI8=m(s.writeI8,1),e.writeIBE=p(s.writeIBE),e.writeI64BE=m(s.writeI64BE,8),e.writeI56BE=m(s.writeI56BE,7),e.writeI48BE=m(s.writeI48BE,6),e.writeI40BE=m(s.writeI40BE,5),e.writeI32BE=m(s.writeI32BE,4),e.writeI24BE=m(s.writeI24BE,3),e.writeI16BE=m(s.writeI16BE,2),e.writeFloat=m(s.writeFloat,4),e.writeFloatBE=m(s.writeFloatBE,4),e.writeDouble=m(s.writeDouble,8),e.writeDoubleBE=m(s.writeDoubleBE,8),e.readVarint=l(s.readVarint),e.writeVarint=b(s.writeVarint,s.sizeVarint),e.sizeVarint=s.sizeVarint,e.readVarint2=l(s.readVarint2),e.writeVarint2=b(s.writeVarint2,s.sizeVarint2),e.sizeVarint2=s.sizeVarint2,e.sliceBytes=s.sliceBytes,e.readBytes=s.readBytes,e.writeBytes=s.writeBytes,e.readString=s.readString,e.writeString=s.writeString,e.realloc=s.realloc,e.copy=s.copy,e.concat=s.concat,e.sizeVarBytes=s.sizeVarBytes,e.sizeVarlen=s.sizeVarlen,e.sizeVarString=s.sizeVarString},6942:(t,e,r)=>{const{inspect:i}=r(1669);e.custom=i.custom||"inspect"},547:(t,e,r)=>{const i=r(8052),s=r(5492),n=1/4294967296,{MAX_SAFE_INTEGER:o}=Number,h=new Float32Array(1),f=new Uint8Array(h.buffer),u=new Float64Array(1),a=new Uint8Array(u.buffer);h[0]=-1;const c=0===f[3];function d(t,e){const r=b(t,e+4),i=b(t,e);return Rt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function l(t,e){const r=g(t,e+4),i=b(t,e);return Rt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function m(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]+4294967296*t[e++]+1099511627776*t[e]}function p(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]+4294967296*t[e]}function b(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]}function g(t,e){return t[e++]+256*t[e++]+65536*t[e]}function w(t,e){return t[e++]+256*t[e]}function S(t,e){return t[e]}function y(t,e){const r=_(t,e),i=_(t,e+4);return Rt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function I(t,e){const r=O(t,e),i=_(t,e+3);return Rt(0==(4292870144&r),e,"Number exceeds 2^53-1"),4294967296*r+i}function v(t,e){return 1099511627776*t[e++]+4294967296*t[e++]+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function E(t,e){return 4294967296*t[e++]+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function _(t,e){return 16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function O(t,e){return 65536*t[e++]+256*t[e++]+t[e]}function N(t,e){return 256*t[e++]+t[e]}function B(t,e){const r=R(t,e+4),i=b(t,e);return Rt(Ot(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function A(t,e){const r=x(t,e+4),i=b(t,e);return Rt(Ot(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function M(t,e){const r=t[e+4]+256*t[e+5];return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e]+4294967296*(r|131070*(32768&r))}function P(t,e){return t[e++]+256*t[e++]+65536*t[e++]+16777216*t[e++]+4294967296*(t[e]|33554430*(128&t[e]))}function R(t,e){return t[e++]+256*t[e++]+65536*t[e++]+(t[e]<<24)}function x(t,e){const r=t[e++]+256*t[e++]+65536*t[e];return r|510*(8388608&r)}function k(t,e){const r=t[e++]+256*t[e];return r|131070*(32768&r)}function T(t,e){const r=t[e];return r|33554430*(128&r)}function U(t,e){const r=H(t,e),i=_(t,e+4);return Rt(Ot(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function z(t,e){const r=L(t,e),i=_(t,e+3);return Rt(Ot(r,i),"Number exceeds 2^53-1"),4294967296*r+i}function C(t,e){const r=256*t[e++]+t[e++];return 4294967296*(r|131070*(32768&r))+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function q(t,e){const r=t[e++];return 4294967296*(r|33554430*(128&r))+16777216*t[e++]+65536*t[e++]+256*t[e++]+t[e]}function H(t,e){return(t[e++]<<24)+65536*t[e++]+256*t[e++]+t[e]}function L(t,e){const r=65536*t[e++]+256*t[e++]+t[e];return r|510*(8388608&r)}function D(t,e){const r=256*t[e++]+t[e];return r|131070*(32768&r)}function V(t,e){return f[3]=t[e++],f[2]=t[e++],f[1]=t[e++],f[0]=t[e],h[0]}function F(t,e){return f[0]=t[e++],f[1]=t[e++],f[2]=t[e++],f[3]=t[e],h[0]}function K(t,e){return a[7]=t[e++],a[6]=t[e++],a[5]=t[e++],a[4]=t[e++],a[3]=t[e++],a[2]=t[e++],a[1]=t[e++],a[0]=t[e],u[0]}function j(t,e){return a[0]=t[e++],a[1]=t[e++],a[2]=t[e++],a[3]=t[e++],a[4]=t[e++],a[5]=t[e++],a[6]=t[e++],a[7]=t[e],u[0]}const W=c?V:F,Y=c?F:V,J=c?K:j,X=c?j:K;function G(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),Nt(t,e,r,!1)}function Z(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),Bt(t,e,r,!1)}function $(t,e,r){i(Number.isSafeInteger(e),"num","integer");const s=e*n|0;return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,t[r++]=s,t[r++]=s>>>8,r}function Q(t,e,r){i(Number.isSafeInteger(e),"num","integer");const s=e*n|0;return t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,t[r++]=s,r}function tt(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}function et(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e,e>>>=8,t[r++]=e,e>>>=8,t[r++]=e,r}function rt(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e,t[r++]=e>>>8,r}function it(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r]=e,r+1}function st(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),Nt(t,e,r,!0)}function nt(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),Bt(t,e,r,!0)}function ot(t,e,r){i(Number.isSafeInteger(e),"num","integer");const s=e*n|0;return t[r++]=s>>>8,t[r++]=s,t[r+3]=e,e>>>=8,t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+4}function ht(t,e,r){i(Number.isSafeInteger(e),"num","integer");const s=e*n|0;return t[r++]=s,t[r+3]=e,e>>>=8,t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+4}function ft(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r+3]=e,e>>>=8,t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+4}function ut(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r+2]=e,e>>>=8,t[r+1]=e,e>>>=8,t[r]=e,r+3}function at(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),t[r++]=e>>>8,t[r++]=e,r}function ct(t,e,r){return tt(t,e,r)}function dt(t,e,r){return et(t,e,r)}function lt(t,e,r){return ft(t,e,r)}function mt(t,e,r){return ut(t,e,r)}function pt(t,e,r){return i(Mt(e),"num","number"),u[0]=e,t[r++]=a[0],t[r++]=a[1],t[r++]=a[2],t[r++]=a[3],t[r++]=a[4],t[r++]=a[5],t[r++]=a[6],t[r++]=a[7],r}function bt(t,e,r){return i(Mt(e),"num","number"),u[0]=e,t[r++]=a[7],t[r++]=a[6],t[r++]=a[5],t[r++]=a[4],t[r++]=a[3],t[r++]=a[2],t[r++]=a[1],t[r++]=a[0],r}function gt(t,e,r){return i(Mt(e),"num","number"),h[0]=e,t[r++]=f[0],t[r++]=f[1],t[r++]=f[2],t[r++]=f[3],r}function wt(t,e,r){return i(Mt(e),"num","number"),h[0]=e,t[r++]=f[3],t[r++]=f[2],t[r++]=f[1],t[r++]=f[0],r}const St=c?wt:gt,yt=c?gt:wt,It=c?bt:pt,vt=c?pt:bt;function Et(t){return i(Number.isSafeInteger(t),"num","integer"),t<253?1:t<=65535?3:t<=4294967295?5:9}function _t(t,e){i(Buffer.isBuffer(t),"data","buffer");const r=Buffer.allocUnsafeSlow(e);return t.copy(r,0),r}function Ot(t,e){return t<0&&(t=~t,0===e&&(t+=1)),0==(4292870144&t)}function Nt(t,e,r,i){let s=!1;e<0&&(e=-e,s=!0);let o=e*n|0,h=0|e;return s&&(0===h?o=1+~o|0:(o=~o,h=1+~h)),i?(r=lt(t,o,r),r=lt(t,h,r)):(r=ct(t,h,r),r=ct(t,o,r)),r}function Bt(t,e,r,i){let s=!1;e<0&&(e=-e,s=!0);let o=e*n|0,h=0|e;return s&&(0===h?o=1+~o|0:(o=~o,h=1+~h)),i?lt(t,h,r=mt(t,o,r)):dt(t,o,r=ct(t,h,r))}class At{constructor(t,e){this.size=t,this.value=e}}function Mt(t){return"number"==typeof t&&isFinite(t)}function Pt(t,e){if(!t)throw new s(e,"Out of bounds read",Pt)}function Rt(t,e,r){if(!t)throw new s(e,r,Rt)}e.readU=function(t,e,r){switch(r){case 8:return d(t,e);case 7:return l(t,e);case 6:return m(t,e);case 5:return p(t,e);case 4:return b(t,e);case 3:return g(t,e);case 2:return w(t,e);case 1:return S(t,e);default:throw new s(e,"Invalid read length")}},e.readU64=d,e.readU56=l,e.readU48=m,e.readU40=p,e.readU32=b,e.readU24=g,e.readU16=w,e.readU8=S,e.readUBE=function(t,e,r){switch(r){case 8:return y(t,e);case 7:return I(t,e);case 6:return v(t,e);case 5:return E(t,e);case 4:return _(t,e);case 3:return O(t,e);case 2:return N(t,e);case 1:return S(t,e);default:throw new s(e,"Invalid read length")}},e.readU64BE=y,e.readU56BE=I,e.readU48BE=v,e.readU40BE=E,e.readU32BE=_,e.readU24BE=O,e.readU16BE=N,e.readI=function(t,e,r){switch(r){case 8:return B(t,e);case 7:return A(t,e);case 6:return M(t,e);case 5:return P(t,e);case 4:return R(t,e);case 3:return x(t,e);case 2:return k(t,e);case 1:return T(t,e);default:throw new s(e,"Invalid read length")}},e.readI64=B,e.readI56=A,e.readI48=M,e.readI40=P,e.readI32=R,e.readI24=x,e.readI16=k,e.readI8=T,e.readIBE=function(t,e,r){switch(r){case 8:return U(t,e);case 7:return z(t,e);case 6:return C(t,e);case 5:return q(t,e);case 4:return H(t,e);case 3:return L(t,e);case 2:return D(t,e);case 1:return T(t,e);default:throw new s(e,"Invalid read length")}},e.readI64BE=U,e.readI56BE=z,e.readI48BE=C,e.readI40BE=q,e.readI32BE=H,e.readI24BE=L,e.readI16BE=D,e.readFloat=W,e.readFloatBE=Y,e.readDouble=J,e.readDoubleBE=X,e.writeU=function(t,e,r,i){switch(i){case 8:return G(t,e,r);case 7:return Z(t,e,r);case 6:return $(t,e,r);case 5:return Q(t,e,r);case 4:return tt(t,e,r);case 3:return et(t,e,r);case 2:return rt(t,e,r);case 1:return it(t,e,r);default:throw new s(r,"Invalid write length")}},e.writeU64=G,e.writeU56=Z,e.writeU48=$,e.writeU40=Q,e.writeU32=tt,e.writeU24=et,e.writeU16=rt,e.writeU8=it,e.writeUBE=function(t,e,r,i){switch(i){case 8:return st(t,e,r);case 7:return nt(t,e,r);case 6:return ot(t,e,r);case 5:return ht(t,e,r);case 4:return ft(t,e,r);case 3:return ut(t,e,r);case 2:return at(t,e,r);case 1:return it(t,e,r);default:throw new s(r,"Invalid write length")}},e.writeU64BE=st,e.writeU56BE=nt,e.writeU48BE=ot,e.writeU40BE=ht,e.writeU32BE=ft,e.writeU24BE=ut,e.writeU16BE=at,e.writeI=function(t,e,r,i){switch(i){case 8:return G(t,e,r);case 7:return Z(t,e,r);case 6:return $(t,e,r);case 5:return Q(t,e,r);case 4:return et(t,e,r);case 3:return tt(t,e,r);case 2:return rt(t,e,r);case 1:return it(t,e,r);default:throw new s(r,"Invalid write length")}},e.writeI64=function(t,e,r){return G(t,e,r)},e.writeI56=function(t,e,r){return Z(t,e,r)},e.writeI48=function(t,e,r){return $(t,e,r)},e.writeI40=function(t,e,r){return Q(t,e,r)},e.writeI32=ct,e.writeI24=dt,e.writeI16=function(t,e,r){return rt(t,e,r)},e.writeI8=function(t,e,r){return it(t,e,r)},e.writeIBE=function(t,e,r,i){switch(i){case 8:return st(t,e,r);case 7:return nt(t,e,r);case 6:return ot(t,e,r);case 5:return ht(t,e,r);case 4:return ft(t,e,r);case 3:return ut(t,e,r);case 2:return at(t,e,r);case 1:return it(t,e,r);default:throw new s(r,"Invalid write length")}},e.writeI64BE=function(t,e,r){return st(t,e,r)},e.writeI56BE=function(t,e,r){return nt(t,e,r)},e.writeI48BE=function(t,e,r){return ot(t,e,r)},e.writeI40BE=function(t,e,r){return ht(t,e,r)},e.writeI32BE=lt,e.writeI24BE=mt,e.writeI16BE=function(t,e,r){return at(t,e,r)},e.writeFloat=St,e.writeFloatBE=yt,e.writeDouble=It,e.writeDoubleBE=vt,e.readVarint=function(t,e){let r,i;switch(Pt(e<t.length,e),t[e]){case 255:i=9,Pt(e+i<=t.length,e),r=d(t,e+1),Rt(r>4294967295,e,"Non-canonical varint");break;case 254:i=5,Pt(e+i<=t.length,e),r=b(t,e+1),Rt(r>65535,e,"Non-canonical varint");break;case 253:i=3,Pt(e+i<=t.length,e),r=w(t,e+1),Rt(r>=253,e,"Non-canonical varint");break;default:i=1,r=t[e]}return new At(i,r)},e.writeVarint=function(t,e,r){return i(Number.isSafeInteger(e),"num","integer"),e<253?(t[r++]=e,r):e<=65535?(t[r++]=253,rt(t,e,r)):e<=4294967295?(t[r++]=254,tt(t,e,r)):(t[r++]=255,G(t,e,r))},e.sizeVarint=Et,e.readVarint2=function(t,e){let r=0,i=0;for(;;){Pt(e<t.length,e);const s=t[e++];if(i+=1,Rt(r<=70368744177663-(127&s),e,"Number exceeds 2^53-1"),r=128*r+(127&s),0==(128&s))break;Rt(r!==o,e,"Number exceeds 2^53-1"),r+=1}return new At(i,r)},e.writeVarint2=function(t,e,r){i(Number.isSafeInteger(e),"num","integer");const s=[];let n=0;for(;s[n]=127&e|(n?128:0),!(e<=127);)e=(e-e%128)/128-1,n+=1;Pt(r+n+1<=t.length,r);do{t[r++]=s[n]}while(n--);return r},e.sizeVarint2=function(t){i(Number.isSafeInteger(t),"num","integer");let e=0;for(;e+=1,!(t<=127);)t=(t-t%128)/128-1;return e},e.sliceBytes=function(t,e,r){if(i(Buffer.isBuffer(t),"data","buffer"),i(e>>>0===e,"off","integer"),i(r>>>0===r,"size","integer"),e+r>t.length)throw new s(e,"Out of bounds read");return t.slice(e,e+r)},e.readBytes=function(t,e,r){if(i(Buffer.isBuffer(t),"data","buffer"),i(e>>>0===e,"off","integer"),i(r>>>0===r,"size","integer"),e+r>t.length)throw new s(e,"Out of bounds read");const n=Buffer.allocUnsafeSlow(r);return t.copy(n,0,e,e+r),n},e.writeBytes=function(t,e,r){if(i(Buffer.isBuffer(t),"data","buffer"),i(Buffer.isBuffer(e),"value","buffer"),i(r>>>0===r,"off","integer"),r+e.length>t.length)throw new s(r,"Out of bounds write");return e.copy(t,r,0,e.length)},e.readString=function(t,e,r,n){if(null==n&&(n="binary"),i(Buffer.isBuffer(t),"data","buffer"),i(e>>>0===e,"off","integer"),i(r>>>0===r,"size","integer"),i("string"==typeof n,"enc","string"),e+r>t.length)throw new s(e,"Out of bounds read");return t.toString(n,e,e+r)},e.writeString=function(t,e,r,n){if(null==n&&(n="binary"),i(Buffer.isBuffer(t),"data","buffer"),i("string"==typeof e,"str","string"),i(r>>>0===r,"off","integer"),i("string"==typeof n,"enc","string"),0===e.length)return 0;if(r+Buffer.byteLength(e,n)>t.length)throw new s(r,"Out of bounds write");return t.write(e,r,n)},e.realloc=_t,e.copy=function(t){return i(Buffer.isBuffer(t),"data","buffer"),_t(t,t.length)},e.concat=function(t,e){i(Buffer.isBuffer(t),"a","buffer"),i(Buffer.isBuffer(e),"b","buffer");const r=t.length+e.length,s=Buffer.allocUnsafeSlow(r);return t.copy(s,0),e.copy(s,t.length),s},e.sizeVarBytes=function(t){return i(Buffer.isBuffer(t),"data","buffer"),Et(t.length)+t.length},e.sizeVarlen=function(t){return Et(t)+t},e.sizeVarString=function(t,e){if(null==e&&(e="binary"),i("string"==typeof t,"str","string"),i("string"==typeof e,"enc","string"),0===t.length)return 1;const r=Buffer.byteLength(t,e);return Et(r)+r}},8052:t=>{t.exports=function t(e,r,i){if(!e){const e=new TypeError(`'${r}' must be a(n) ${i}.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,t),e}}},5492:t=>{class e extends Error{constructor(t,r,i){super(),this.type="EncodingError",this.name="EncodingError",this.code="ERR_ENCODING",this.message=`${r} (offset=${t}).`,Error.captureStackTrace&&Error.captureStackTrace(this,i||e)}}t.exports=e},5232:(t,e,r)=>{const i=r(8052),s=r(547),n=r(5492),o=Buffer.alloc(0);t.exports=class{constructor(t,e=!1){i(Buffer.isBuffer(t),"data","buffer"),i("boolean"==typeof e,"zeroCopy","boolean"),this.data=t,this.offset=0,this.zeroCopy=e,this.stack=[]}check(t){if(this.offset+t>this.data.length)throw new n(this.offset,"Out of bounds read",this.check)}getSize(){return this.data.length}left(){return this.check(0),this.data.length-this.offset}seek(t){if(i(Number.isSafeInteger(t),"off","integer"),this.offset+t<0)throw new n(this.offset,"Out of bounds read");return this.check(t),this.offset+=t,this}start(){return this.stack.push(this.offset),this.offset}end(){if(0===this.stack.length)throw new Error("Cannot end without a stack item.");const t=this.stack.pop();return this.offset-t}endData(t=!1){if(i("boolean"==typeof t,"zeroCopy","boolean"),0===this.stack.length)throw new Error("Cannot end without a stack item.");const e=this.stack.pop(),r=this.offset,s=r-e,n=this.data;if(s===n.length)return n;if(this.zeroCopy||t)return n.slice(e,r);const o=Buffer.allocUnsafeSlow(s);return n.copy(o,0,e,r),o}destroy(){return this.data=o,this.offset=0,this.stack.length=0,this}readU8(){this.check(1);const t=this.data[this.offset];return this.offset+=1,t}readU16(){this.check(2);const t=s.readU16(this.data,this.offset);return this.offset+=2,t}readU16BE(){this.check(2);const t=s.readU16BE(this.data,this.offset);return this.offset+=2,t}readU24(){this.check(3);const t=s.readU24(this.data,this.offset);return this.offset+=3,t}readU24BE(){this.check(3);const t=s.readU24BE(this.data,this.offset);return this.offset+=3,t}readU32(){this.check(4);const t=s.readU32(this.data,this.offset);return this.offset+=4,t}readU32BE(){this.check(4);const t=s.readU32BE(this.data,this.offset);return this.offset+=4,t}readU40(){this.check(5);const t=s.readU40(this.data,this.offset);return this.offset+=5,t}readU40BE(){this.check(5);const t=s.readU40BE(this.data,this.offset);return this.offset+=5,t}readU48(){this.check(6);const t=s.readU48(this.data,this.offset);return this.offset+=6,t}readU48BE(){this.check(6);const t=s.readU48BE(this.data,this.offset);return this.offset+=6,t}readU56(){this.check(7);const t=s.readU56(this.data,this.offset);return this.offset+=7,t}readU56BE(){this.check(7);const t=s.readU56BE(this.data,this.offset);return this.offset+=7,t}readU64(){this.check(8);const t=s.readU64(this.data,this.offset);return this.offset+=8,t}readU64BE(){this.check(8);const t=s.readU64BE(this.data,this.offset);return this.offset+=8,t}readI8(){this.check(1);const t=s.readI8(this.data,this.offset);return this.offset+=1,t}readI16(){this.check(2);const t=s.readI16(this.data,this.offset);return this.offset+=2,t}readI16BE(){this.check(2);const t=s.readI16BE(this.data,this.offset);return this.offset+=2,t}readI24(){this.check(3);const t=s.readI24(this.data,this.offset);return this.offset+=3,t}readI24BE(){this.check(3);const t=s.readI24BE(this.data,this.offset);return this.offset+=3,t}readI32(){this.check(4);const t=s.readI32(this.data,this.offset);return this.offset+=4,t}readI32BE(){this.check(4);const t=s.readI32BE(this.data,this.offset);return this.offset+=4,t}readI40(){this.check(5);const t=s.readI40(this.data,this.offset);return this.offset+=5,t}readI40BE(){this.check(5);const t=s.readI40BE(this.data,this.offset);return this.offset+=5,t}readI48(){this.check(6);const t=s.readI48(this.data,this.offset);return this.offset+=6,t}readI48BE(){this.check(6);const t=s.readI48BE(this.data,this.offset);return this.offset+=6,t}readI56(){this.check(7);const t=s.readI56(this.data,this.offset);return this.offset+=7,t}readI56BE(){this.check(7);const t=s.readI56BE(this.data,this.offset);return this.offset+=7,t}readI64(){this.check(8);const t=s.readI64(this.data,this.offset);return this.offset+=8,t}readI64BE(){this.check(8);const t=s.readI64BE(this.data,this.offset);return this.offset+=8,t}readFloat(){this.check(4);const t=s.readFloat(this.data,this.offset);return this.offset+=4,t}readFloatBE(){this.check(4);const t=s.readFloatBE(this.data,this.offset);return this.offset+=4,t}readDouble(){this.check(8);const t=s.readDouble(this.data,this.offset);return this.offset+=8,t}readDoubleBE(){this.check(8);const t=s.readDoubleBE(this.data,this.offset);return this.offset+=8,t}readVarint(){const{size:t,value:e}=s.readVarint(this.data,this.offset);return this.offset+=t,e}readVarint2(){const{size:t,value:e}=s.readVarint2(this.data,this.offset);return this.offset+=t,e}readBytes(t,e=!1){let r;return i(t>>>0===t,"size","integer"),i("boolean"==typeof e,"zeroCopy","boolean"),this.check(t),this.zeroCopy||e?r=this.data.slice(this.offset,this.offset+t):(r=Buffer.allocUnsafeSlow(t),this.data.copy(r,0,this.offset,this.offset+t)),this.offset+=t,r}readVarBytes(t=!1){return this.readBytes(this.readVarint(),t)}readChild(t){i(t>>>0===t,"size","integer"),this.check(t);const e=this.data.slice(0,this.offset+t),r=new this.constructor(e);return r.offset=this.offset,this.offset+=t,r}readString(t,e){null==e&&(e="binary"),i(t>>>0===t,"size","integer"),i("string"==typeof e,"enc","string"),this.check(t);const r=this.data.toString(e,this.offset,this.offset+t);return this.offset+=t,r}readHash(t){return t?this.readString(32,t):this.readBytes(32)}readVarString(t,e=0){null==t&&(t="binary"),i("string"==typeof t,"enc","string"),i(e>>>0===e,"limit","integer");const r=this.readVarint();if(0!==e&&r>e)throw new n(this.offset,"String exceeds limit");return this.readString(r,t)}readNullString(t){null==t&&(t="binary"),i("string"==typeof t,"enc","string");let e=this.offset;for(;e<this.data.length&&0!==this.data[e];e++);if(e===this.data.length)throw new n(this.offset,"No NUL terminator");const r=this.readString(e-this.offset,t);return this.offset=e+1,r}createChecksum(t){t&&"function"==typeof t.digest||i("function"==typeof t,"hash","function");let e=0;this.stack.length>0&&(e=this.stack[this.stack.length-1]);const r=this.data.slice(e,this.offset),n=t.digest?t.digest(r):t(r);return s.readU32(n,0)}verifyChecksum(t){const e=this.createChecksum(t);if(e!==this.readU32())throw new n(this.offset,"Checksum mismatch");return e}}},2780:(t,e,r)=>{const i=r(8052),s=r(547),n=r(5492),o=Buffer.alloc(0),h=102400;let f=null;class u{constructor(t){this.data=o,this.offset=0,null!=t&&this.init(t)}check(t){if(this.offset+t>this.data.length)throw new n(this.offset,"Out of bounds write",this.check)}init(t){return Buffer.isBuffer(t)?(this.data=t,this.offset=0,this):(i(t>>>0===t,"size","integer"),this.data=Buffer.allocUnsafeSlow(t),this.offset=0,this)}static pool(t){if(i(t>>>0===t,"size","integer"),t<=h){f||(f=Buffer.allocUnsafeSlow(h));const e=new u;return e.data=f.slice(0,t),e}return new u(t)}render(){const{data:t,offset:e}=this;if(e!==t.length)throw new n(e,"Out of bounds write");return this.destroy(),t}slice(){const{data:t,offset:e}=this;if(e>t.length)throw new n(e,"Out of bounds write");return this.destroy(),t.slice(0,e)}getSize(){return this.offset}seek(t){if(i(Number.isSafeInteger(t),"off","integer"),this.offset+t<0)throw new n(this.offset,"Out of bounds write");return this.check(t),this.offset+=t,this}destroy(){return this.data=o,this.offset=0,this}writeU8(t){return this.check(1),this.offset=s.writeU8(this.data,t,this.offset),this}writeU16(t){return this.check(2),this.offset=s.writeU16(this.data,t,this.offset),this}writeU16BE(t){return this.check(2),this.offset=s.writeU16BE(this.data,t,this.offset),this}writeU24(t){return this.check(3),this.offset=s.writeU24(this.data,t,this.offset),this}writeU24BE(t){return this.check(3),this.offset=s.writeU24BE(this.data,t,this.offset),this}writeU32(t){return this.check(4),this.offset=s.writeU32(this.data,t,this.offset),this}writeU32BE(t){return this.check(4),this.offset=s.writeU32BE(this.data,t,this.offset),this}writeU40(t){return this.check(5),this.offset=s.writeU40(this.data,t,this.offset),this}writeU40BE(t){return this.check(5),this.offset=s.writeU40BE(this.data,t,this.offset),this}writeU48(t){return this.check(6),this.offset=s.writeU48(this.data,t,this.offset),this}writeU48BE(t){return this.check(6),this.offset=s.writeU48BE(this.data,t,this.offset),this}writeU56(t){return this.check(7),this.offset=s.writeU56(this.data,t,this.offset),this}writeU56BE(t){return this.check(7),this.offset=s.writeU56BE(this.data,t,this.offset),this}writeU64(t){return this.check(8),this.offset=s.writeU64(this.data,t,this.offset),this}writeU64BE(t){return this.check(8),this.offset=s.writeU64BE(this.data,t,this.offset),this}writeI8(t){return this.check(1),this.offset=s.writeI8(this.data,t,this.offset),this}writeI16(t){return this.check(2),this.offset=s.writeI16(this.data,t,this.offset),this}writeI16BE(t){return this.check(2),this.offset=s.writeI16BE(this.data,t,this.offset),this}writeI24(t){return this.check(3),this.offset=s.writeI24(this.data,t,this.offset),this}writeI24BE(t){return this.check(3),this.offset=s.writeI24BE(this.data,t,this.offset),this}writeI32(t){return this.check(4),this.offset=s.writeI32(this.data,t,this.offset),this}writeI32BE(t){return this.check(4),this.offset=s.writeI32BE(this.data,t,this.offset),this}writeI40(t){return this.check(5),this.offset=s.writeI40(this.data,t,this.offset),this}writeI40BE(t){return this.check(5),this.offset=s.writeI40BE(this.data,t,this.offset),this}writeI48(t){return this.check(6),this.offset=s.writeI48(this.data,t,this.offset),this}writeI48BE(t){return this.check(6),this.offset=s.writeI48BE(this.data,t,this.offset),this}writeI56(t){return this.check(7),this.offset=s.writeI56(this.data,t,this.offset),this}writeI56BE(t){return this.check(7),this.offset=s.writeI56BE(this.data,t,this.offset),this}writeI64(t){return this.check(8),this.offset=s.writeI64(this.data,t,this.offset),this}writeI64BE(t){return this.check(8),this.offset=s.writeI64BE(this.data,t,this.offset),this}writeFloat(t){return this.check(4),this.offset=s.writeFloat(this.data,t,this.offset),this}writeFloatBE(t){return this.check(4),this.offset=s.writeFloatBE(this.data,t,this.offset),this}writeDouble(t){return this.check(8),this.offset=s.writeDouble(this.data,t,this.offset),this}writeDoubleBE(t){return this.check(8),this.offset=s.writeDoubleBE(this.data,t,this.offset),this}writeVarint(t){return this.offset=s.writeVarint(this.data,t,this.offset),this}writeVarint2(t){return this.offset=s.writeVarint2(this.data,t,this.offset),this}writeBytes(t){return i(Buffer.isBuffer(t),"value","buffer"),this.check(t.length),this.offset+=t.copy(this.data,this.offset),this}writeVarBytes(t){return i(Buffer.isBuffer(t),"value","buffer"),this.writeVarint(t.length),this.writeBytes(t),this}copy(t,e,r){return i(Buffer.isBuffer(t),"value","buffer"),i(e>>>0===e,"start","integer"),i(r>>>0===r,"end","integer"),i(r>=e,"start","integer"),this.check(r-e),this.offset+=t.copy(this.data,this.offset,e,r),this}writeString(t,e){if(null==e&&(e="binary"),i("string"==typeof t,"value","string"),i("string"==typeof e,"enc","string"),0===t.length)return this;const r=Buffer.byteLength(t,e);return this.check(r),this.offset+=this.data.write(t,this.offset,e),this}writeHash(t){return"string"!=typeof t?(i(Buffer.isBuffer(t),"value","buffer"),i(32===t.length,"value","32-byte hash"),this.writeBytes(t),this):(i(64===t.length,"value","32-byte hash"),this.check(32),this.offset+=this.data.write(t,this.offset,"hex"),this)}writeVarString(t,e){if(null==e&&(e="binary"),i("string"==typeof t,"value","string"),i("string"==typeof e,"enc","string"),0===t.length)return this.writeVarint(0),this;const r=Buffer.byteLength(t,e);return this.writeVarint(r),this.check(r),this.offset+=this.data.write(t,this.offset,e),this}writeNullString(t,e){return this.writeString(t,e),this.writeU8(0),this}writeChecksum(t){t&&"function"==typeof t.digest||i("function"==typeof t,"hash","function"),this.check(4);const e=this.data.slice(0,this.offset);return(t.digest?t.digest(e):t(e)).copy(this.data,this.offset,0,4),this.offset+=4,this}fill(t,e){return i((255&t)===t,"value","byte"),i(e>>>0===e,"size","integer"),this.check(e),this.data.fill(t,this.offset,this.offset+e),this.offset+=e,this}}t.exports=u},1487:(t,e,r)=>{const i=r(8052),s=r(5232),n=r(2075),o=r(2780),{custom:h}=r(6942);t.exports=class{constructor(){}inject(t){return i(t instanceof this.constructor,"obj","struct"),this.decode(t.encode())}clone(){return(new this.constructor).inject(this)}getSize(t){return-1}write(t,e){return t}read(t,e){return this}toString(){return Object.prototype.toString.call(this)}fromString(t,e){return this}getJSON(){return this}fromJSON(t,e){return this}fromOptions(t,e){return this}from(t,e){return this.fromOptions(t,e)}format(){return this.getJSON()}encode(t){const e=this.getSize(t),r=-1===e?new n:new o(e);return this.write(r,t),r.render()}decode(t,e){const r=new s(t);return this.read(r,e),this}toHex(t){return this.encode(t).toString("hex")}fromHex(t,e){i("string"==typeof t,"str","string");const r=t.length>>>1,s=Buffer.from(t,"hex");if(s.length!==r)throw new Error("Invalid hex string.");return this.decode(s,e)}toBase64(t){return this.encode(t).toString("base64")}fromBase64(t,e){i("string"==typeof t,"str","string");const r=Buffer.from(t,"base64");if(t.length>(4*r.length/3+3&-4)>>>0)throw new Error("Invalid base64 string.");return this.decode(r,e)}toJSON(){return this.getJSON()}[h](){return this.format()}static read(t,e){return(new this).read(t,e)}static decode(t,e){return(new this).decode(t,e)}static fromHex(t,e){return(new this).fromHex(t,e)}static fromBase64(t,e){return(new this).fromBase64(t,e)}static fromString(t,e){return(new this).fromString(t,e)}static fromJSON(t,e){return(new this).fromJSON(t,e)}static fromOptions(t,e){return(new this).fromOptions(t,e)}static from(t,e){return(new this).from(t,e)}toWriter(t,e){return this.write(t,e)}fromReader(t,e){return this.read(t,e)}toRaw(t){return this.encode(t)}fromRaw(t,e){return this.decode(t,e)}static fromReader(t,e){return this.read(t,e)}static fromRaw(t,e){return this.decode(t,e)}}},2075:(t,e,r)=>{const i=r(8052),s=r(547),n=r(5492);class o{constructor(t){this.type=t}}class h extends o{constructor(t,e){super(t),this.value=e}}class f extends o{constructor(t,e){super(t),this.data=e}}class u extends o{constructor(t,e,r){super(t),this.value=e,this.enc=r}}class a extends o{constructor(t,e){super(t),this.func=e}}class c extends o{constructor(t,e,r){super(t),this.value=e,this.size=r}}t.exports=class{constructor(){this.ops=[],this.offset=0}render(){const t=Buffer.allocUnsafeSlow(this.offset);let e=0;for(const r of this.ops)switch(r.type){case 0:e+=r.value;break;case 1:e=s.writeU8(t,r.value,e);break;case 2:e=s.writeU16(t,r.value,e);break;case 3:e=s.writeU16BE(t,r.value,e);break;case 4:e=s.writeU24(t,r.value,e);break;case 5:e=s.writeU24BE(t,r.value,e);break;case 6:e=s.writeU32(t,r.value,e);break;case 7:e=s.writeU32BE(t,r.value,e);break;case 8:e=s.writeU40(t,r.value,e);break;case 9:e=s.writeU40BE(t,r.value,e);break;case 10:e=s.writeU48(t,r.value,e);break;case 11:e=s.writeU48BE(t,r.value,e);break;case 12:e=s.writeU56(t,r.value,e);break;case 13:e=s.writeU56BE(t,r.value,e);break;case 14:e=s.writeU64(t,r.value,e);break;case 15:e=s.writeU64BE(t,r.value,e);break;case 16:e=s.writeI8(t,r.value,e);break;case 17:e=s.writeI16(t,r.value,e);break;case 18:e=s.writeI16BE(t,r.value,e);break;case 19:e=s.writeI24(t,r.value,e);break;case 20:e=s.writeI24BE(t,r.value,e);break;case 21:e=s.writeI32(t,r.value,e);break;case 22:e=s.writeI32BE(t,r.value,e);break;case 23:e=s.writeI40(t,r.value,e);break;case 24:e=s.writeI40BE(t,r.value,e);break;case 25:e=s.writeI48(t,r.value,e);break;case 26:e=s.writeI48BE(t,r.value,e);break;case 27:e=s.writeI56(t,r.value,e);break;case 28:e=s.writeI56BE(t,r.value,e);break;case 29:e=s.writeI64(t,r.value,e);break;case 30:e=s.writeI64BE(t,r.value,e);break;case 31:e=s.writeFloat(t,r.value,e);break;case 32:e=s.writeFloatBE(t,r.value,e);break;case 33:e=s.writeDouble(t,r.value,e);break;case 34:e=s.writeDoubleBE(t,r.value,e);break;case 35:e=s.writeVarint(t,r.value,e);break;case 36:e=s.writeVarint2(t,r.value,e);break;case 37:e+=r.data.copy(t,e);break;case 38:e+=t.write(r.value,e,r.enc);break;case 39:e+=r.func(t.slice(0,e)).copy(t,e,0,4);break;case 40:t.fill(r.value,e,e+r.size),e+=r.size;break;default:throw new Error("Invalid type.")}if(e!==t.length)throw new n(e,"Out of bounds write");return this.destroy(),t}getSize(){return this.offset}seek(t){if(i(Number.isSafeInteger(t),"off","integer"),this.offset+t<0)throw new n(this.offset,"Out of bounds write");return this.offset+=t,this.ops.push(new h(0,t)),this}destroy(){return this.ops.length=0,this.offset=0,this}writeU8(t){return this.offset+=1,this.ops.push(new h(1,t)),this}writeU16(t){return this.offset+=2,this.ops.push(new h(2,t)),this}writeU16BE(t){return this.offset+=2,this.ops.push(new h(3,t)),this}writeU24(t){return this.offset+=3,this.ops.push(new h(4,t)),this}writeU24BE(t){return this.offset+=3,this.ops.push(new h(5,t)),this}writeU32(t){return this.offset+=4,this.ops.push(new h(6,t)),this}writeU32BE(t){return this.offset+=4,this.ops.push(new h(7,t)),this}writeU40(t){return this.offset+=5,this.ops.push(new h(8,t)),this}writeU40BE(t){return this.offset+=5,this.ops.push(new h(9,t)),this}writeU48(t){return this.offset+=6,this.ops.push(new h(10,t)),this}writeU48BE(t){return this.offset+=6,this.ops.push(new h(11,t)),this}writeU56(t){return this.offset+=7,this.ops.push(new h(12,t)),this}writeU56BE(t){return this.offset+=7,this.ops.push(new h(13,t)),this}writeU64(t){return this.offset+=8,this.ops.push(new h(14,t)),this}writeU64BE(t){return this.offset+=8,this.ops.push(new h(15,t)),this}writeI8(t){return this.offset+=1,this.ops.push(new h(16,t)),this}writeI16(t){return this.offset+=2,this.ops.push(new h(17,t)),this}writeI16BE(t){return this.offset+=2,this.ops.push(new h(18,t)),this}writeI24(t){return this.offset+=3,this.ops.push(new h(19,t)),this}writeI24BE(t){return this.offset+=3,this.ops.push(new h(20,t)),this}writeI32(t){return this.offset+=4,this.ops.push(new h(21,t)),this}writeI32BE(t){return this.offset+=4,this.ops.push(new h(22,t)),this}writeI40(t){return this.offset+=5,this.ops.push(new h(23,t)),this}writeI40BE(t){return this.offset+=5,this.ops.push(new h(24,t)),this}writeI48(t){return this.offset+=6,this.ops.push(new h(25,t)),this}writeI48BE(t){return this.offset+=6,this.ops.push(new h(26,t)),this}writeI56(t){return this.offset+=7,this.ops.push(new h(27,t)),this}writeI56BE(t){return this.offset+=7,this.ops.push(new h(28,t)),this}writeI64(t){return this.offset+=8,this.ops.push(new h(29,t)),this}writeI64BE(t){return this.offset+=8,this.ops.push(new h(30,t)),this}writeFloat(t){return this.offset+=4,this.ops.push(new h(31,t)),this}writeFloatBE(t){return this.offset+=4,this.ops.push(new h(32,t)),this}writeDouble(t){return this.offset+=8,this.ops.push(new h(33,t)),this}writeDoubleBE(t){return this.offset+=8,this.ops.push(new h(34,t)),this}writeVarint(t){return this.offset+=s.sizeVarint(t),this.ops.push(new h(35,t)),this}writeVarint2(t){return this.offset+=s.sizeVarint2(t),this.ops.push(new h(36,t)),this}writeBytes(t){return i(Buffer.isBuffer(t),"value","buffer"),0===t.length||(this.offset+=t.length,this.ops.push(new f(37,t))),this}writeVarBytes(t){return i(Buffer.isBuffer(t),"value","buffer"),this.offset+=s.sizeVarint(t.length),this.ops.push(new h(35,t.length)),0===t.length||(this.offset+=t.length,this.ops.push(new f(37,t))),this}copy(t,e,r){i(Buffer.isBuffer(t),"value","buffer"),i(e>>>0===e,"start","integer"),i(r>>>0===r,"end","integer"),i(r>=e,"start","integer");const s=t.slice(e,r);return this.writeBytes(s),this}writeString(t,e){return null==e&&(e="binary"),i("string"==typeof t,"value","string"),i("string"==typeof e,"enc","string"),0===t.length||(this.offset+=Buffer.byteLength(t,e),this.ops.push(new u(38,t,e))),this}writeHash(t){return"string"!=typeof t?(i(Buffer.isBuffer(t),"value","buffer"),i(32===t.length,"value","32-byte hash"),this.writeBytes(t),this):(i(64===t.length,"value","32-byte hash"),this.writeString(t,"hex"),this)}writeVarString(t,e){if(null==e&&(e="binary"),i("string"==typeof t,"value","string"),i("string"==typeof e,"enc","string"),0===t.length)return this.ops.push(new h(35,0)),this;const r=Buffer.byteLength(t,e);return this.offset+=s.sizeVarint(r),this.offset+=r,this.ops.push(new h(35,r)),this.ops.push(new u(38,t,e)),this}writeNullString(t,e){return this.writeString(t,e),this.writeU8(0),this}writeChecksum(t){return t&&"function"==typeof t.digest&&(t=t.digest.bind(t)),i("function"==typeof t,"hash","function"),this.offset+=4,this.ops.push(new a(39,t)),this}fill(t,e){return i((255&t)===t,"value","byte"),i(e>>>0===e,"size","integer"),0===e||(this.offset+=e,this.ops.push(new c(40,t,e))),this}}},865:(t,e)=>{function r(t){h(this instanceof r,"this","N64"),h(0===t||1===t,"sign","bit"),this.hi=0,this.lo=0,this.sign=t}function i(t,e){if(!(this instanceof i))return new i(t,e);r.call(this,0),this.from(t,e)}function s(t,e){if(!(this instanceof s))return new s(t,e);r.call(this,1),this.from(t,e)}function n(t){if(null==t)return 10;if("number"==typeof t)return t;switch(t){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function o(t){if(Math.clz32)return 32-Math.clz32(t);let e=31;for(;e>=0&&0==(t&1<<e);e--);return e+1}function h(t,e,r){if(!t){const t=new TypeError(`'${e}' must be a(n) ${r}.`);throw Error.captureStackTrace&&Error.captureStackTrace(t,h),t}}function f(t){return"number"==typeof t&&isFinite(t)}function u(t){return Array.isArray?Array.isArray(t):"Array"==={}.toString.call(t).slice(8,-1)}function a(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}function c(t,e){return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24}function d(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function l(t,e,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255}function m(t,e,r){t[r]=e>>>24&255,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}r.prototype._add=function(t,e){const r=this.hi,i=this.lo,s=i+e|0,n=i>>31,o=e>>31,h=(r+t|0)+(1&(n&o|~(s>>31)&(n^o)));return this.hi=0|h,this.lo=s,this},r.prototype.iadd=function(t){return h(r.isN64(t),"operand","int64"),this._add(t.hi,t.lo)},r.prototype.iaddn=function(t){return h(f(t),"operand","number"),this._add(t>>31&-this.sign,0|t)},r.prototype.add=function(t){return this.clone().iadd(t)},r.prototype.addn=function(t){return this.clone().iaddn(t)},r.prototype._sub=function(t,e){return t=~t,-1==(e=~e)?(e=0,t+=1,t|=0):e+=1,this._add(t,e)},r.prototype.isub=function(t){return h(r.isN64(t),"operand","int64"),this._sub(t.hi,t.lo)},r.prototype.isubn=function(t){return h(f(t),"operand","number"),this._sub(t>>31&-this.sign,0|t)},r.prototype.sub=function(t){return this.clone().isub(t)},r.prototype.subn=function(t){return this.clone().isubn(t)},r.prototype._mul=function(t,e){const r=this.hi,i=this.lo,s=65535&r,n=i>>>16,o=65535&i,h=65535&t,f=e>>>16,u=65535&e;let a=0,c=0,d=0,l=0;l+=o*u,d+=l>>>16,l&=65535,d+=n*u,c+=d>>>16,d&=65535,d+=o*f,c+=d>>>16,d&=65535,c+=s*u,a+=c>>>16,c&=65535,c+=n*f,a+=c>>>16,c&=65535,c+=o*h,a+=c>>>16,c&=65535,a+=(r>>>16)*u+s*f+n*h+o*(t>>>16),a&=65535;const m=a<<16|c,p=d<<16|l;return this.hi=m,this.lo=p,this},r.prototype.imul=function(t){return h(r.isN64(t),"multiplicand","int64"),this._mul(t.hi,t.lo)},r.prototype.imuln=function(t){return h(f(t),"multiplicand","number"),this._mul(t>>31&-this.sign,0|t)},r.prototype.mul=function(t){return this.clone().imul(t)},r.prototype.muln=function(t){return this.clone().imuln(t)},r.prototype.idiv=function(t){let e=this;if(h(r.isN64(t),"divisor","int64"),t.isZero())throw new Error("Cannot divide by zero.");if(e.isZero())return e;if(e.eq(t))return e.set(1);if(e.isSafe()&&t.isSafe()){const r=function(t){return t<0?-Math.floor(-t):Math.floor(t)}(e.toDouble()/t.toDouble());return e.set(r)}let s=!1;e.sign&&(e.hi<0?t.hi<0?(e=e.ineg(),t=t.neg()):(e=e.ineg(),s=!0):t.hi<0&&(t=t.neg(),s=!0));const n=e.toU64(),o=t.toU64();if(n.lt(o))return e.set(0);if(n.ushrn(1).lt(o))return e.set(s?-1:1);const f=new i,u=new i;let a=n.bitLength();for(;a--;)u.ishln(1),u.lo|=n.testn(a),u.gte(o)&&(u.isub(o),f.setn(a,1));return e.hi=f.hi,e.lo=f.lo,s&&e.ineg(),e},r.prototype.idivn=function(t){return h(f(t),"divisor","number"),this.idiv(this._small(t))},r.prototype.div=function(t){return this.clone().idiv(t)},r.prototype.divn=function(t){return this.clone().idivn(t)},r.prototype.imod=function(t){const e=this;if(h(r.isN64(t),"divisor","int64"),t.isZero())throw new Error("Cannot divide by zero.");if(e.isZero())return e;if(e.eq(t))return e.set(0);if(e.isSafe()&&t.isSafe()){const r=e.toDouble()%t.toDouble();return e.set(r)}return e.isub(e.div(t).imul(t))},r.prototype.imodn=function(t){return h(f(t),"divisor","number"),this.imod(this._small(t))},r.prototype.mod=function(t){return this.clone().imod(t)},r.prototype.modn=function(t){return this.clone().imodn(t)},r.prototype.ipow=function(t){return h(r.isN64(t),"exponent","int64"),this.ipown(t.lo)},r.prototype.ipown=function(t){if(h(f(t),"exponent","number"),this.isZero())return this;const e=this.clone(),r=this;let i=t>>>0;for(r.set(1);i>0;)1&i&&r.imul(e),i>>>=1,e.imul(e);return r},r.prototype.pow=function(t){return this.clone().ipow(t)},r.prototype.pown=function(t){return this.clone().ipown(t)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this)},r.prototype.iand=function(t){return h(r.isN64(t),"operand","int64"),this.hi&=t.hi,this.lo&=t.lo,this},r.prototype.iandn=function(t){return h(f(t),"operand","number"),this.hi&=t>>31&-this.sign,this.lo&=0|t,this},r.prototype.and=function(t){return this.clone().iand(t)},r.prototype.andn=function(t){return this.clone().iandn(t)},r.prototype.ior=function(t){return h(r.isN64(t),"operand","int64"),this.hi|=t.hi,this.lo|=t.lo,this},r.prototype.iorn=function(t){return h(f(t),"operand","number"),this.hi|=t>>31&-this.sign,this.lo|=0|t,this},r.prototype.or=function(t){return this.clone().ior(t)},r.prototype.orn=function(t){return this.clone().iorn(t)},r.prototype.ixor=function(t){return h(r.isN64(t),"operand","int64"),this.hi^=t.hi,this.lo^=t.lo,this},r.prototype.ixorn=function(t){return h(f(t),"operand","number"),this.hi^=t>>31&-this.sign,this.lo^=0|t,this},r.prototype.xor=function(t){return this.clone().ixor(t)},r.prototype.xorn=function(t){return this.clone().ixorn(t)},r.prototype.inot=function(){return this.hi=~this.hi,this.lo=~this.lo,this},r.prototype.not=function(){return this.clone().inot()},r.prototype.ishl=function(t){return h(r.isN64(t),"bits","int64"),this.ishln(t.lo)},r.prototype.ishln=function(t){if(h(f(t),"bits","number"),0==(t&=63))return this;let e=this.hi,r=this.lo;return t<32?(e<<=t,e|=r>>>32-t,r<<=t):(e=r<<t-32,r=0),this.hi=e,this.lo=r,this},r.prototype.shl=function(t){return this.clone().ishl(t)},r.prototype.shln=function(t){return this.clone().ishln(t)},r.prototype.ishr=function(t){return h(r.isN64(t),"bits","int64"),this.ishrn(t.lo)},r.prototype.ishrn=function(t){if(!this.sign)return this.iushrn(t);if(h(f(t),"bits","number"),0==(t&=63))return this;let e=this.hi,r=this.lo;return t<32?(r>>>=t,r|=e<<32-t,e>>=t):(r=e>>t-32,e>>=31),this.hi=e,this.lo=r,this},r.prototype.shr=function(t){return this.clone().ishr(t)},r.prototype.shrn=function(t){return this.clone().ishrn(t)},r.prototype.iushr=function(t){return h(r.isN64(t),"bits","int64"),this.iushrn(t.lo)},r.prototype.iushrn=function(t){if(h(f(t),"bits","number"),0==(t&=63))return this;let e=this.hi,r=this.lo;return t<32?(r>>>=t,r|=e<<32-t,e>>>=t):(r=e>>>t-32,e=0),this.hi=0|e,this.lo=0|r,this},r.prototype.ushr=function(t){return this.clone().iushr(t)},r.prototype.ushrn=function(t){return this.clone().iushrn(t)},r.prototype.setn=function(t,e){return h(f(t),"bit","number"),(t&=63)<32?e?this.lo|=1<<t:this.lo&=~(1<<t):e?this.hi|=1<<t-32:this.hi&=~(1<<t-32),this},r.prototype.testn=function(t){return h(f(t),"bit","number"),(t&=63)<32?this.lo>>>t&1:this.hi>>>t-32&1},r.prototype.setb=function(t,e){return h(f(t),"pos","number"),h(f(e),"ch","number"),e&=255,(t&=7)<4?(this.lo&=~(255<<8*t),this.lo|=e<<8*t):(this.hi&=~(255<<8*(t-4)),this.hi|=e<<8*(t-4)),this},r.prototype.orb=function(t,e){return h(f(t),"pos","number"),h(f(e),"ch","number"),e&=255,(t&=7)<4?this.lo|=e<<8*t:this.hi|=e<<8*(t-4),this},r.prototype.getb=function(t){return h(f(t),"pos","number"),(t&=7)<4?this.lo>>8*t&255:this.hi>>8*(t-4)&255},r.prototype.imaskn=function(t){return h(f(t),"bit","number"),(t&=63)<32?(this.hi=0,this.lo&=(1<<t)-1):(this.hi&=(1<<t-32)-1,this.lo&=4294967295),this},r.prototype.maskn=function(t){return this.clone().imaskn(t)},r.prototype.andln=function(t){return h(f(t),"operand","number"),this.lo&t},r.prototype.ineg=function(){let t=~this.hi,e=~this.lo;return-1===e?(e=0,t+=1,t|=0):e+=1,this.hi=t,this.lo=e,this},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.iabs=function(){return this.isNeg()&&this.ineg(),this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._cmp=function(t,e){const r=this;let i=r.hi,s=r.lo;if(i===t&&s===e)return 0;let n=!1;if(r.sign){const e=i<0,r=t<0;if(e&&!r)return-1;if(!e&&r)return 1;n=e}return n||(i>>>=0,t>>>=0),i<t?-1:i>t?1:(s>>>=0,s<(e>>>=0)?-1:1)},r.prototype.cmp=function(t){return h(r.isN64(t),"value","int64"),this._cmp(t.hi,t.lo)},r.prototype.cmpn=function(t){return h(f(t),"value","number"),this._cmp(t>>31&-this.sign,0|t)},r.prototype.eq=function(t){return h(r.isN64(t),"value","int64"),this.hi===t.hi&&this.lo===t.lo},r.prototype.eqn=function(t){return h(f(t),"value","number"),this.hi===(t>>31&-this.sign)&&this.lo===(0|t)},r.prototype.gt=function(t){return this.cmp(t)>0},r.prototype.gtn=function(t){return this.cmpn(t)>0},r.prototype.gte=function(t){return this.cmp(t)>=0},r.prototype.gten=function(t){return this.cmpn(t)>=0},r.prototype.lt=function(t){return this.cmp(t)<0},r.prototype.ltn=function(t){return this.cmpn(t)<0},r.prototype.lte=function(t){return this.cmp(t)<=0},r.prototype.lten=function(t){return this.cmpn(t)<=0},r.prototype.isZero=function(){return 0===this.hi&&0===this.lo},r.prototype.isNeg=function(){return 1===this.sign&&this.hi<0},r.prototype.isOdd=function(){return 1==(1&this.lo)},r.prototype.isEven=function(){return 0==(1&this.lo)},r.prototype.clone=function(){const t=new this.constructor;return t.hi=this.hi,t.lo=this.lo,t},r.prototype.inject=function(t){return h(r.isN64(t),"value","int64"),this.hi=t.hi,this.lo=t.lo,this},r.prototype.set=function(t){h(function(t){return Number.isSafeInteger?Number.isSafeInteger(t):f(t)&&Math.floor(t)===t&&t>=-9007199254740991&&t<=9007199254740991}(t),"number","integer");let e=!1;return t<0&&(t=-t,e=!0),this.hi=t*(1/4294967296)|0,this.lo=0|t,e&&this.ineg(),this},r.prototype.join=function(t,e){return h(f(t),"hi","number"),h(f(e),"lo","number"),this.hi=0|t,this.lo=0|e,this},r.prototype._small=function(t){const e=new this.constructor;return e.hi=t>>31&-this.sign,e.lo=0|t,e},r.prototype.bitLength=function(){let t=this;return this.isNeg()&&(t=this.neg()),0===t.hi?o(t.lo):o(t.hi)+32},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.isSafe=function(){let t=this.hi;return this.isNeg()&&(t=~t,0===this.lo&&(t+=1)),0==(4292870144&t)},r.prototype.inspect=function(){let t="I64";return this.sign||(t="U64"),`<${t}: ${this.toString(10)}>`},r.prototype.readLE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),this.lo=c(t,e),this.hi=c(t,e+4),e+8},r.prototype.readBE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),this.hi=d(t,e),this.lo=d(t,e+4),e+8},r.prototype.readRaw=function(t,e){return this.readLE(t,e)},r.prototype.writeLE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),l(t,this.lo,e),l(t,this.hi,e+4),e+8},r.prototype.writeBE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),m(t,this.hi,e),m(t,this.lo,e+4),e+8},r.prototype.writeRaw=function(t,e){return this.writeLE(t,e)},r.prototype.toU64=function(){const t=new i;return t.hi=this.hi,t.lo=this.lo,t},r.prototype.toI64=function(){const t=new s;return t.hi=this.hi,t.lo=this.lo,t},r.prototype.toNumber=function(){if(!this.isSafe())throw new Error("Number exceeds 53 bits.");return this.toDouble()},r.prototype.toDouble=function(){let t=this.hi;return this.sign||(t>>>=0),4294967296*t+(this.lo>>>0)},r.prototype.toInt=function(){return this.sign?this.lo:this.lo>>>0},r.prototype.toBool=function(){return!this.isZero()},r.prototype.toBits=function(){return[this.hi,this.lo]},r.prototype.toObject=function(){return{hi:this.hi,lo:this.lo}},r.prototype.toString=function(t,e){if(null==e&&(e=0),h((t=n(t))>>>0===t,"base","integer"),h(e>>>0===e,"pad","integer"),t<2||t>16)throw new Error("Base ranges between 2 and 16.");if(e>64)throw new Error("Maximum padding is 64 characters.");let r=this,i=!1;r.isNeg()&&(r=r.neg(),i=!0);let s=r.hi>>>0,o=r.lo>>>0,f="";do{const e=s%t;s-=e,s/=t,o+=4294967296*e;const r=o%t;o-=r,o/=t;let i=r;i+=i<10?48:87,f=String.fromCharCode(i)+f}while(o>0||s>0);for(;f.length<e;)f="0"+f;return i&&(f="-"+f),f},r.prototype.toJSON=function(){return this.toString(16,16)},r.prototype.toBN=function(t){const e=this.isNeg();let r=this.hi,i=this.lo;e&&(r=~r,i=~i,-1===i?(i=0,r+=1,r|=0):i+=1),r>>>=0,i>>>=0;const s=new t(r);return s.ishln(32),s.iadd(new t(i)),e&&s.ineg(),s},r.prototype.toLE=function(t){h("function"==typeof t,"ArrayLike","constructor");const e=a(t,8);return this.writeLE(e,0),e},r.prototype.toBE=function(t){h("function"==typeof t,"ArrayLike","constructor");const e=a(t,8);return this.writeBE(e,0),e},r.prototype.toRaw=function(t){return this.toLE(t)},r.prototype.fromNumber=function(t){return this.set(t)},r.prototype.fromInt=function(t){return h(f(t),"integer","number"),this.join(t>>31&-this.sign,t)},r.prototype.fromBool=function(t){return h("boolean"==typeof t,"value","boolean"),this.hi=0,this.lo=t?1:0,this},r.prototype.fromBits=function(t,e){return this.join(t,e)},r.prototype.fromObject=function(t){return h(t&&"object"==typeof t,"number","object"),this.fromBits(t.hi,t.lo)},r.prototype.fromString=function(t,e){if(e=n(e),h("string"==typeof t,"string","string"),h(e>>>0===e,"base","integer"),e<2||e>16)throw new Error("Base ranges between 2 and 16.");let r=!1,i=0;if(t.length>0&&"-"===t[0]&&(i+=1,r=!0),t.length===i||t.length>i+64)throw new Error("Invalid string (bad length).");let s=0,o=0;for(;i<t.length;i++){let r=t.charCodeAt(i);if(r>=48&&r<=57?r-=48:r>=65&&r<=90?r-=55:r>=97&&r<=122?r-=87:r=e,r>=e)throw new Error("Invalid string (parse error).");if(o*=e,o+=r,s*=e,o>4294967295&&(r=o%4294967296,s+=(o-r)/4294967296,o=r),s>4294967295)throw new Error("Invalid string (overflow).")}return this.hi=0|s,this.lo=0|o,r&&this.ineg(),this},r.prototype.fromJSON=function(t){return this.fromString(t,16)},r.prototype.fromBN=function(t){h(t&&u(t.words),"number","big number");const e=this,r=t.clone(),i=r.isNeg();if(e.sign&&r.testn(63))throw new Error("Big number overflow.");let s=0;for(;!r.isZero();){if(8===s)throw new Error("Big number overflow.");e.orb(s,r.andln(255)),r.iushrn(8),s++}return i&&e.ineg(),e},r.prototype.fromLE=function(t){return this.readLE(t,0),this},r.prototype.fromBE=function(t){return this.readBE(t,0),this},r.prototype.fromRaw=function(t){return this.fromLE(t)},r.prototype.from=function(t,e){if(null==t)return this;if("number"==typeof t)return"number"==typeof e?this.fromBits(t,e):this.fromNumber(t);if("string"==typeof t)return this.fromString(t,e);if("object"==typeof t)return u(t.words)?this.fromBN(t):"number"==typeof t.length?this.fromRaw(t):this.fromObject(t);if("boolean"==typeof t)return this.fromBool(t);throw new TypeError("Non-numeric object passed to N64.")},r.min=function(t,e){return t.cmp(e)<0?t:e},r.max=function(t,e){return t.cmp(e)>0?t:e},r.random=function(){const t=new this;return t.hi=4294967296*Math.random()|0,t.lo=4294967296*Math.random()|0,t},r.pow=function(t,e){return(new this).fromInt(t).ipown(e)},r.shift=function(t,e){return(new this).fromInt(t).ishln(e)},r.readLE=function(t,e){const r=new this;return r.readLE(t,e),r},r.readBE=function(t,e){const r=new this;return r.readBE(t,e),r},r.readRaw=function(t,e){const r=new this;return r.readRaw(t,e),r},r.fromNumber=function(t){return(new this).fromNumber(t)},r.fromInt=function(t){return(new this).fromInt(t)},r.fromBool=function(t){return(new this).fromBool(t)},r.fromBits=function(t,e){return(new this).fromBits(t,e)},r.fromObject=function(t){return(new this).fromObject(t)},r.fromString=function(t,e){return(new this).fromString(t,e)},r.fromJSON=function(t){return(new this).fromJSON(t)},r.fromBN=function(t){return(new this).fromBN(t)},r.fromLE=function(t){return(new this).fromLE(t)},r.fromBE=function(t){return(new this).fromBE(t)},r.fromRaw=function(t){return(new this).fromRaw(t)},r.from=function(t,e){return(new this).from(t,e)},r.isN64=function(t){return t instanceof r},r.isU64=function(t){return t instanceof i},r.isI64=function(t){return t instanceof s},i.__proto__=r,i.prototype.__proto__=r.prototype,i.ULONG_MIN=0,i.ULONG_MAX=4294967295,i.UINT32_MIN=i(0,0),i.UINT32_MAX=i(0,4294967295),i.UINT64_MIN=i(0,0),i.UINT64_MAX=i(4294967295,4294967295),s.__proto__=r,s.prototype.__proto__=r.prototype,s.LONG_MIN=-2147483648,s.LONG_MAX=2147483647,s.INT32_MIN=s(4294967295,2147483648),s.INT32_MAX=s(0,2147483647),s.INT64_MIN=s(2147483648,0),s.INT64_MAX=s(2147483647,4294967295),e.N64=r,e.U64=i,e.I64=s},2357:t=>{t.exports=require("assert")},6417:t=>{t.exports=require("crypto")},8614:t=>{t.exports=require("events")},5747:t=>{t.exports=require("fs")},5622:t=>{t.exports=require("path")},8835:t=>{t.exports=require("url")},1669:t=>{t.exports=require("util")}},e={};return function r(i){if(e[i])return e[i].exports;var s=e[i]={exports:{}};return t[i](s,s.exports,r),s.exports}(7786)})();