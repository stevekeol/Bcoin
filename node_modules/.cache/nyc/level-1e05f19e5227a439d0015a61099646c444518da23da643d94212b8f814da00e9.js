/*!
 * blockstore/level.js - leveldb blockstore for bcoin
 * Copyright (c) 2019, Braydon Fuller (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_2b6bemgfmm(){var path="E:\\Projects\\Test\\bcoin\\lib\\blockstore\\level.js";var hash="50ea777b2399f0611276e95282f66e7e5074702f";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\blockstore\\level.js",statementMap:{"0":{start:{line:9,column:12},end:{line:9,column:26}},"1":{start:{line:10,column:11},end:{line:10,column:27}},"2":{start:{line:11,column:27},end:{line:11,column:48}},"3":{start:{line:12,column:15},end:{line:12,column:34}},"4":{start:{line:13,column:16},end:{line:13,column:35}},"5":{start:{line:29,column:4},end:{line:29,column:19}},"6":{start:{line:31,column:4},end:{line:31,column:37}},"7":{start:{line:33,column:4},end:{line:38,column:7}},"8":{start:{line:48,column:4},end:{line:48,column:36}},"9":{start:{line:57,column:4},end:{line:57,column:51}},"10":{start:{line:59,column:4},end:{line:59,column:25}},"11":{start:{line:60,column:4},end:{line:60,column:66}},"12":{start:{line:68,column:4},end:{line:68,column:51}},"13":{start:{line:70,column:4},end:{line:70,column:26}},"14":{start:{line:81,column:4},end:{line:81,column:66}},"15":{start:{line:92,column:4},end:{line:92,column:64}},"16":{start:{line:103,column:4},end:{line:103,column:65}},"17":{start:{line:114,column:4},end:{line:114,column:66}},"18":{start:{line:124,column:4},end:{line:124,column:60}},"19":{start:{line:134,column:4},end:{line:134,column:58}},"20":{start:{line:144,column:4},end:{line:144,column:60}},"21":{start:{line:154,column:17},end:{line:154,column:71}},"22":{start:{line:156,column:4},end:{line:157,column:18}},"23":{start:{line:157,column:6},end:{line:157,column:18}},"24":{start:{line:159,column:4},end:{line:159,column:29}},"25":{start:{line:174,column:14},end:{line:174,column:67}},"26":{start:{line:176,column:4},end:{line:181,column:5}},"27":{start:{line:177,column:6},end:{line:178,column:47}},"28":{start:{line:178,column:8},end:{line:178,column:47}},"29":{start:{line:180,column:6},end:{line:180,column:47}},"30":{start:{line:183,column:4},end:{line:183,column:15}},"31":{start:{line:195,column:4},end:{line:196,column:19}},"32":{start:{line:196,column:6},end:{line:196,column:19}},"33":{start:{line:198,column:4},end:{line:198,column:59}},"34":{start:{line:200,column:4},end:{line:200,column:16}},"35":{start:{line:212,column:4},end:{line:213,column:19}},"36":{start:{line:213,column:6},end:{line:213,column:19}},"37":{start:{line:215,column:4},end:{line:215,column:57}},"38":{start:{line:217,column:4},end:{line:217,column:16}},"39":{start:{line:227,column:4},end:{line:228,column:19}},"40":{start:{line:228,column:6},end:{line:228,column:19}},"41":{start:{line:230,column:4},end:{line:230,column:59}},"42":{start:{line:232,column:4},end:{line:232,column:16}},"43":{start:{line:244,column:4},end:{line:245,column:19}},"44":{start:{line:245,column:6},end:{line:245,column:19}},"45":{start:{line:247,column:4},end:{line:247,column:58}},"46":{start:{line:249,column:4},end:{line:249,column:16}},"47":{start:{line:260,column:4},end:{line:260,column:60}},"48":{start:{line:271,column:4},end:{line:271,column:58}},"49":{start:{line:282,column:4},end:{line:282,column:60}},"50":{start:{line:292,column:4},end:{line:292,column:59}},"51":{start:{line:300,column:0},end:{line:300,column:33}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:28,column:2},end:{line:28,column:3}},loc:{start:{line:28,column:23},end:{line:39,column:3}},line:28},"1":{name:"(anonymous_1)",decl:{start:{line:47,column:2},end:{line:47,column:3}},loc:{start:{line:47,column:17},end:{line:49,column:3}},line:47},"2":{name:"(anonymous_2)",decl:{start:{line:56,column:2},end:{line:56,column:3}},loc:{start:{line:56,column:15},end:{line:61,column:3}},line:56},"3":{name:"(anonymous_3)",decl:{start:{line:67,column:2},end:{line:67,column:3}},loc:{start:{line:67,column:16},end:{line:71,column:3}},line:67},"4":{name:"(anonymous_4)",decl:{start:{line:80,column:2},end:{line:80,column:3}},loc:{start:{line:80,column:32},end:{line:82,column:3}},line:80},"5":{name:"(anonymous_5)",decl:{start:{line:91,column:2},end:{line:91,column:3}},loc:{start:{line:91,column:30},end:{line:93,column:3}},line:91},"6":{name:"(anonymous_6)",decl:{start:{line:102,column:2},end:{line:102,column:3}},loc:{start:{line:102,column:26},end:{line:104,column:3}},line:102},"7":{name:"(anonymous_7)",decl:{start:{line:113,column:2},end:{line:113,column:3}},loc:{start:{line:113,column:32},end:{line:115,column:3}},line:113},"8":{name:"(anonymous_8)",decl:{start:{line:123,column:2},end:{line:123,column:3}},loc:{start:{line:123,column:25},end:{line:125,column:3}},line:123},"9":{name:"(anonymous_9)",decl:{start:{line:133,column:2},end:{line:133,column:3}},loc:{start:{line:133,column:23},end:{line:135,column:3}},line:133},"10":{name:"(anonymous_10)",decl:{start:{line:143,column:2},end:{line:143,column:3}},loc:{start:{line:143,column:25},end:{line:145,column:3}},line:143},"11":{name:"(anonymous_11)",decl:{start:{line:153,column:2},end:{line:153,column:3}},loc:{start:{line:153,column:31},end:{line:160,column:3}},line:153},"12":{name:"(anonymous_12)",decl:{start:{line:173,column:2},end:{line:173,column:3}},loc:{start:{line:173,column:35},end:{line:184,column:3}},line:173},"13":{name:"(anonymous_13)",decl:{start:{line:194,column:2},end:{line:194,column:3}},loc:{start:{line:194,column:26},end:{line:201,column:3}},line:194},"14":{name:"(anonymous_14)",decl:{start:{line:211,column:2},end:{line:211,column:3}},loc:{start:{line:211,column:24},end:{line:218,column:3}},line:211},"15":{name:"(anonymous_15)",decl:{start:{line:226,column:2},end:{line:226,column:3}},loc:{start:{line:226,column:26},end:{line:233,column:3}},line:226},"16":{name:"(anonymous_16)",decl:{start:{line:243,column:2},end:{line:243,column:3}},loc:{start:{line:243,column:20},end:{line:250,column:3}},line:243},"17":{name:"(anonymous_17)",decl:{start:{line:259,column:2},end:{line:259,column:3}},loc:{start:{line:259,column:24},end:{line:261,column:3}},line:259},"18":{name:"(anonymous_18)",decl:{start:{line:270,column:2},end:{line:270,column:3}},loc:{start:{line:270,column:22},end:{line:272,column:3}},line:270},"19":{name:"(anonymous_19)",decl:{start:{line:281,column:2},end:{line:281,column:3}},loc:{start:{line:281,column:24},end:{line:283,column:3}},line:281},"20":{name:"(anonymous_20)",decl:{start:{line:291,column:2},end:{line:291,column:3}},loc:{start:{line:291,column:18},end:{line:293,column:3}},line:291}},branchMap:{"0":{loc:{start:{line:156,column:4},end:{line:157,column:18}},type:"if",locations:[{start:{line:156,column:4},end:{line:157,column:18}},{start:{line:156,column:4},end:{line:157,column:18}}],line:156},"1":{loc:{start:{line:176,column:4},end:{line:181,column:5}},type:"if",locations:[{start:{line:176,column:4},end:{line:181,column:5}},{start:{line:176,column:4},end:{line:181,column:5}}],line:176},"2":{loc:{start:{line:177,column:6},end:{line:178,column:47}},type:"if",locations:[{start:{line:177,column:6},end:{line:178,column:47}},{start:{line:177,column:6},end:{line:178,column:47}}],line:177},"3":{loc:{start:{line:195,column:4},end:{line:196,column:19}},type:"if",locations:[{start:{line:195,column:4},end:{line:196,column:19}},{start:{line:195,column:4},end:{line:196,column:19}}],line:195},"4":{loc:{start:{line:212,column:4},end:{line:213,column:19}},type:"if",locations:[{start:{line:212,column:4},end:{line:213,column:19}},{start:{line:212,column:4},end:{line:213,column:19}}],line:212},"5":{loc:{start:{line:227,column:4},end:{line:228,column:19}},type:"if",locations:[{start:{line:227,column:4},end:{line:228,column:19}},{start:{line:227,column:4},end:{line:228,column:19}}],line:227},"6":{loc:{start:{line:244,column:4},end:{line:245,column:19}},type:"if",locations:[{start:{line:244,column:4},end:{line:245,column:19}},{start:{line:244,column:4},end:{line:245,column:19}}],line:244}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"50ea777b2399f0611276e95282f66e7e5074702f"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2b6bemgfmm=function(){return actualCoverage;};}return actualCoverage;}cov_2b6bemgfmm();const bdb=(cov_2b6bemgfmm().s[0]++,require('bdb'));const fs=(cov_2b6bemgfmm().s[1]++,require('bfile'));const AbstractBlockStore=(cov_2b6bemgfmm().s[2]++,require('./abstract'));const layout=(cov_2b6bemgfmm().s[3]++,require('./layout'));const{types}=(cov_2b6bemgfmm().s[4]++,require('./common'));/**
 * LevelDB Block Store
 *
 * @alias module:blockstore:LevelBlockStore
 * @abstract
 */class LevelBlockStore extends AbstractBlockStore{/**
   * Create a blockstore that stores blocks in LevelDB.
   * @constructor
   */constructor(options){cov_2b6bemgfmm().f[0]++;cov_2b6bemgfmm().s[5]++;super(options);cov_2b6bemgfmm().s[6]++;this.location=options.location;cov_2b6bemgfmm().s[7]++;this.db=bdb.create({location:this.location,cacheSize:options.cacheSize,compression:false,memory:options.memory});}/**
   * This method ensures that the storage directory exists
   * before opening.
   * @returns {Promise}
   */async ensure(){cov_2b6bemgfmm().f[1]++;cov_2b6bemgfmm().s[8]++;return fs.mkdirp(this.location);}/**
   * Opens the block storage.
   * @returns {Promise}
   */async open(){cov_2b6bemgfmm().f[2]++;cov_2b6bemgfmm().s[9]++;this.logger.info('Opening LevelBlockStore...');cov_2b6bemgfmm().s[10]++;await this.db.open();cov_2b6bemgfmm().s[11]++;await this.db.verify(layout.V.encode(),'levelblockstore',0);}/**
   * Closes the block storage.
   */async close(){cov_2b6bemgfmm().f[3]++;cov_2b6bemgfmm().s[12]++;this.logger.info('Closing LevelBlockStore...');cov_2b6bemgfmm().s[13]++;await this.db.close();}/**
   * This method stores merkle block data in LevelDB.
   * @param {Buffer} hash - The block hash
   * @param {Buffer} data - The block data
   * @returns {Promise}
   */async writeMerkle(hash,data){cov_2b6bemgfmm().f[4]++;cov_2b6bemgfmm().s[14]++;return this.db.put(layout.b.encode(types.MERKLE,hash),data);}/**
   * This method stores block undo coin data in LevelDB.
   * @param {Buffer} hash - The block hash
   * @param {Buffer} data - The block data
   * @returns {Promise}
   */async writeUndo(hash,data){cov_2b6bemgfmm().f[5]++;cov_2b6bemgfmm().s[15]++;return this.db.put(layout.b.encode(types.UNDO,hash),data);}/**
   * This method stores block data in LevelDB.
   * @param {Buffer} hash - The block hash
   * @param {Buffer} data - The block data
   * @returns {Promise}
   */async write(hash,data){cov_2b6bemgfmm().f[6]++;cov_2b6bemgfmm().s[16]++;return this.db.put(layout.b.encode(types.BLOCK,hash),data);}/**
   * This method stores serialized block filter data in LevelDB.
   * @param {Buffer} hash - The block hash
   * @param {Buffer} data - The serialized block filter data.
   * @returns {Promise}
   */async writeFilter(hash,data){cov_2b6bemgfmm().f[7]++;cov_2b6bemgfmm().s[17]++;return this.db.put(layout.b.encode(types.FILTER,hash),data);}/**
   * This method will retrieve merkle block data.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async readMerkle(hash){cov_2b6bemgfmm().f[8]++;cov_2b6bemgfmm().s[18]++;return this.db.get(layout.b.encode(types.MERKLE,hash));}/**
   * This method will retrieve block undo coin data.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async readUndo(hash){cov_2b6bemgfmm().f[9]++;cov_2b6bemgfmm().s[19]++;return this.db.get(layout.b.encode(types.UNDO,hash));}/**
   * This method will retrieve serialized block filter data.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async readFilter(hash){cov_2b6bemgfmm().f[10]++;cov_2b6bemgfmm().s[20]++;return this.db.get(layout.b.encode(types.FILTER,hash));}/**
   * This method will retrieve block filter header only.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async readFilterHeader(hash){cov_2b6bemgfmm().f[11]++;const data=(cov_2b6bemgfmm().s[21]++,await this.db.get(layout.b.encode(types.FILTER,hash)));cov_2b6bemgfmm().s[22]++;if(!data){cov_2b6bemgfmm().b[0][0]++;cov_2b6bemgfmm().s[23]++;return null;}else{cov_2b6bemgfmm().b[0][1]++;}cov_2b6bemgfmm().s[24]++;return data.slice(0,32);}/**
   * This method will retrieve block data. Smaller portions of the
   * block (e.g. transactions) can be returned using the offset and
   * length arguments. However, the entire block will be read as the
   * data is stored in a key/value database.
   * @param {Buffer} hash - The block hash
   * @param {Number} offset - The offset within the block
   * @param {Number} length - The number of bytes of the data
   * @returns {Promise}
   */async read(hash,offset,length){cov_2b6bemgfmm().f[12]++;let raw=(cov_2b6bemgfmm().s[25]++,await this.db.get(layout.b.encode(types.BLOCK,hash)));cov_2b6bemgfmm().s[26]++;if(offset){cov_2b6bemgfmm().b[1][0]++;cov_2b6bemgfmm().s[27]++;if(offset+length>raw.length){cov_2b6bemgfmm().b[2][0]++;cov_2b6bemgfmm().s[28]++;throw new Error('Out-of-bounds read.');}else{cov_2b6bemgfmm().b[2][1]++;}cov_2b6bemgfmm().s[29]++;raw=raw.slice(offset,offset+length);}else{cov_2b6bemgfmm().b[1][1]++;}cov_2b6bemgfmm().s[30]++;return raw;}/**
   * This will free resources for storing merkle block data.
   * The block data may not be immediately removed from disk, and will
   * be reclaimed during LevelDB compaction.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async pruneMerkle(hash){cov_2b6bemgfmm().f[13]++;cov_2b6bemgfmm().s[31]++;if(!(await this.hasMerkle(hash))){cov_2b6bemgfmm().b[3][0]++;cov_2b6bemgfmm().s[32]++;return false;}else{cov_2b6bemgfmm().b[3][1]++;}cov_2b6bemgfmm().s[33]++;await this.db.del(layout.b.encode(types.MERKLE,hash));cov_2b6bemgfmm().s[34]++;return true;}/**
   * This will free resources for storing the block undo coin data.
   * The block data may not be immediately removed from disk, and will
   * be reclaimed during LevelDB compaction.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async pruneUndo(hash){cov_2b6bemgfmm().f[14]++;cov_2b6bemgfmm().s[35]++;if(!(await this.hasUndo(hash))){cov_2b6bemgfmm().b[4][0]++;cov_2b6bemgfmm().s[36]++;return false;}else{cov_2b6bemgfmm().b[4][1]++;}cov_2b6bemgfmm().s[37]++;await this.db.del(layout.b.encode(types.UNDO,hash));cov_2b6bemgfmm().s[38]++;return true;}/**
   * This will free resources for storing the serialized block filter data.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async pruneFilter(hash){cov_2b6bemgfmm().f[15]++;cov_2b6bemgfmm().s[39]++;if(!(await this.hasFilter(hash))){cov_2b6bemgfmm().b[5][0]++;cov_2b6bemgfmm().s[40]++;return false;}else{cov_2b6bemgfmm().b[5][1]++;}cov_2b6bemgfmm().s[41]++;await this.db.del(layout.b.encode(types.FILTER,hash));cov_2b6bemgfmm().s[42]++;return true;}/**
   * This will free resources for storing the block data. The block
   * data may not be immediately removed from disk, and will be reclaimed
   * during LevelDB compaction.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async prune(hash){cov_2b6bemgfmm().f[16]++;cov_2b6bemgfmm().s[43]++;if(!(await this.has(hash))){cov_2b6bemgfmm().b[6][0]++;cov_2b6bemgfmm().s[44]++;return false;}else{cov_2b6bemgfmm().b[6][1]++;}cov_2b6bemgfmm().s[45]++;await this.db.del(layout.b.encode(types.BLOCK,hash));cov_2b6bemgfmm().s[46]++;return true;}/**
   * This will check if a merkle block data has been stored
   * and is available.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async hasMerkle(hash){cov_2b6bemgfmm().f[17]++;cov_2b6bemgfmm().s[47]++;return this.db.has(layout.b.encode(types.MERKLE,hash));}/**
   * This will check if a block undo coin data has been stored
   * and is available.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async hasUndo(hash){cov_2b6bemgfmm().f[18]++;cov_2b6bemgfmm().s[48]++;return this.db.has(layout.b.encode(types.UNDO,hash));}/**
   * This will check if a block filter has been stored
   * and is available.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async hasFilter(hash){cov_2b6bemgfmm().f[19]++;cov_2b6bemgfmm().s[49]++;return this.db.has(layout.b.encode(types.FILTER,hash));}/**
   * This will check if a block has been stored and is available.
   * @param {Buffer} hash - The block hash
   * @returns {Promise}
   */async has(hash){cov_2b6bemgfmm().f[20]++;cov_2b6bemgfmm().s[50]++;return this.db.has(layout.b.encode(types.BLOCK,hash));}}/*
 * Expose
 */cov_2b6bemgfmm().s[51]++;module.exports=LevelBlockStore;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxldmVsLmpzIl0sIm5hbWVzIjpbImJkYiIsInJlcXVpcmUiLCJmcyIsIkFic3RyYWN0QmxvY2tTdG9yZSIsImxheW91dCIsInR5cGVzIiwiTGV2ZWxCbG9ja1N0b3JlIiwiY29uc3RydWN0b3IiLCJvcHRpb25zIiwibG9jYXRpb24iLCJkYiIsImNyZWF0ZSIsImNhY2hlU2l6ZSIsImNvbXByZXNzaW9uIiwibWVtb3J5IiwiZW5zdXJlIiwibWtkaXJwIiwib3BlbiIsImxvZ2dlciIsImluZm8iLCJ2ZXJpZnkiLCJWIiwiZW5jb2RlIiwiY2xvc2UiLCJ3cml0ZU1lcmtsZSIsImhhc2giLCJkYXRhIiwicHV0IiwiYiIsIk1FUktMRSIsIndyaXRlVW5kbyIsIlVORE8iLCJ3cml0ZSIsIkJMT0NLIiwid3JpdGVGaWx0ZXIiLCJGSUxURVIiLCJyZWFkTWVya2xlIiwiZ2V0IiwicmVhZFVuZG8iLCJyZWFkRmlsdGVyIiwicmVhZEZpbHRlckhlYWRlciIsInNsaWNlIiwicmVhZCIsIm9mZnNldCIsImxlbmd0aCIsInJhdyIsIkVycm9yIiwicHJ1bmVNZXJrbGUiLCJoYXNNZXJrbGUiLCJkZWwiLCJwcnVuZVVuZG8iLCJoYXNVbmRvIiwicHJ1bmVGaWx0ZXIiLCJoYXNGaWx0ZXIiLCJwcnVuZSIsImhhcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FFQSxhLCs5UUFTWTsyRkFQWixLQUFNQSxDQUFBQSxHQUFHLDBCQUFHQyxPQUFPLENBQUMsS0FBRCxDQUFWLENBQVQsQ0FDQSxLQUFNQyxDQUFBQSxFQUFFLDBCQUFHRCxPQUFPLENBQUMsT0FBRCxDQUFWLENBQVIsQ0FDQSxLQUFNRSxDQUFBQSxrQkFBa0IsMEJBQUdGLE9BQU8sQ0FBQyxZQUFELENBQVYsQ0FBeEIsQ0FDQSxLQUFNRyxDQUFBQSxNQUFNLDBCQUFHSCxPQUFPLENBQUMsVUFBRCxDQUFWLENBQVosQ0FDQSxLQUFNLENBQUNJLEtBQUQsMkJB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QUEsU0FBTixDQUFnQnZCLElBQWhCLENBQXNCLG1EQUNwQixNQUFPLE1BQUtmLEVBQUwsQ0FBUTZDLEdBQVIsQ0FBWW5ELE1BQU0sQ0FBQ3dCLENBQVAsQ0FBU04sTUFBVCxDQUFnQmpCLEtBQUssQ0FBQ3dCLE1BQXRCLENBQThCSixJQUE5QixDQUFaLENBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUVFLEtBQU0wQixDQUFBQSxPQUFOLENBQWMxQixJQUFkLENBQW9CLG1EQUNsQixNQUFPLE1BQUtmLEVBQUwsQ0FBUTZDLEdBQVIsQ0FBWW5ELE1BQU0sQ0FBQ3dCLENBQVAsQ0FBU04sTUFBVCxDQUFnQmpCLEtBQUssQ0FBQzBCLElBQXRCLENBQTRCTixJQUE1QixDQUFaLENBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUVFLEtBQU00QixDQUFBQSxTQUFOLENBQWdCNUIsSUFBaEIsQ0FBc0IsbURBQ3BCLE1BQU8sTUFBS2YsRUFBTCxDQUFRNkMsR0FBUixDQUFZbkQsTUFBTSxDQUFDd0IsQ0FBUCxDQUFTTixNQUFULENBQWdCakIsS0FBSyxDQUFDOEIsTUFBdEIsQ0FBOEJWLElBQTlCLENBQVosQ0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQSxLQUVFLEtBQU04QixDQUFBQSxHQUFOLENBQVU5QixJQUFWLENBQWdCLG1EQUNkLE1BQU8sTUFBS2YsRUFBTCxDQUFRNkMsR0FBUixDQUFZbkQsTUFBTSxDQUFDd0IsQ0FBUCxDQUFTTixNQUFULENBQWdCakIsS0FBSyxDQUFDNEIsS0FBdEIsQ0FBNkJSLElBQTdCLENBQVosQ0FBUCxDQUNELENBL1E4QyxDQWtSakQ7QUFDQTtBQUNBLEcseUJBRUErQixNQUFNLENBQUNDLE9BQVAsQ0FBaUJuRCxlQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKiBibG9ja3N0b3JlL2xldmVsLmpzIC0gbGV2ZWxkYiBibG9ja3N0b3JlIGZvciBiY29pblxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTksIEJyYXlkb24gRnVsbGVyIChNSVQgTGljZW5zZSkuXHJcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9iY29pbi1vcmcvYmNvaW5cclxuICovXHJcblxyXG4ndXNlIHN0cmljdCc7XHJcblxyXG5jb25zdCBiZGIgPSByZXF1aXJlKCdiZGInKTtcclxuY29uc3QgZnMgPSByZXF1aXJlKCdiZmlsZScpO1xyXG5jb25zdCBBYnN0cmFjdEJsb2NrU3RvcmUgPSByZXF1aXJlKCcuL2Fic3RyYWN0Jyk7XHJcbmNvbnN0IGxheW91dCA9IHJlcXVpcmUoJy4vbGF5b3V0Jyk7XHJcbmNvbnN0IHt0eXBlc30gPSByZXF1aXJlKCcuL2NvbW1vbicpO1xyXG5cclxuLyoqXHJcbiAqIExldmVsREIgQmxvY2sgU3RvcmVcclxuICpcclxuICogQGFsaWFzIG1vZHVsZTpibG9ja3N0b3JlOkxldmVsQmxvY2tTdG9yZVxyXG4gKiBAYWJzdHJhY3RcclxuICovXHJcblxyXG5jbGFzcyBMZXZlbEJsb2NrU3RvcmUgZXh0ZW5kcyBBYnN0cmFjdEJsb2NrU3RvcmUge1xyXG4gIC8qKlxyXG4gICAqIENyZWF0ZSBhIGJsb2Nrc3RvcmUgdGhhdCBzdG9yZXMgYmxvY2tzIGluIExldmVsREIuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHN1cGVyKG9wdGlvbnMpO1xyXG5cclxuICAgIHRoaXMubG9jYXRpb24gPSBvcHRpb25zLmxvY2F0aW9uO1xyXG5cclxuICAgIHRoaXMuZGIgPSBiZGIuY3JlYXRlKHtcclxuICAgICAgbG9jYXRpb246IHRoaXMubG9jYXRpb24sXHJcbiAgICAgIGNhY2hlU2l6ZTogb3B0aW9ucy5jYWNoZVNpemUsXHJcbiAgICAgIGNvbXByZXNzaW9uOiBmYWxzZSxcclxuICAgICAgbWVtb3J5OiBvcHRpb25zLm1lbW9yeVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCBlbnN1cmVzIHRoYXQgdGhlIHN0b3JhZ2UgZGlyZWN0b3J5IGV4aXN0c1xyXG4gICAqIGJlZm9yZSBvcGVuaW5nLlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBlbnN1cmUoKSB7XHJcbiAgICByZXR1cm4gZnMubWtkaXJwKHRoaXMubG9jYXRpb24pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3BlbnMgdGhlIGJsb2NrIHN0b3JhZ2UuXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIG9wZW4oKSB7XHJcbiAgICB0aGlzLmxvZ2dlci5pbmZvKCdPcGVuaW5nIExldmVsQmxvY2tTdG9yZS4uLicpO1xyXG5cclxuICAgIGF3YWl0IHRoaXMuZGIub3BlbigpO1xyXG4gICAgYXdhaXQgdGhpcy5kYi52ZXJpZnkobGF5b3V0LlYuZW5jb2RlKCksICdsZXZlbGJsb2Nrc3RvcmUnLCAwKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsb3NlcyB0aGUgYmxvY2sgc3RvcmFnZS5cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgY2xvc2UoKSB7XHJcbiAgICB0aGlzLmxvZ2dlci5pbmZvKCdDbG9zaW5nIExldmVsQmxvY2tTdG9yZS4uLicpO1xyXG5cclxuICAgIGF3YWl0IHRoaXMuZGIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgbWV0aG9kIHN0b3JlcyBtZXJrbGUgYmxvY2sgZGF0YSBpbiBMZXZlbERCLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoYXNoIC0gVGhlIGJsb2NrIGhhc2hcclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YSAtIFRoZSBibG9jayBkYXRhXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHdyaXRlTWVya2xlKGhhc2gsIGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLnB1dChsYXlvdXQuYi5lbmNvZGUodHlwZXMuTUVSS0xFLCBoYXNoKSwgZGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCBzdG9yZXMgYmxvY2sgdW5kbyBjb2luIGRhdGEgaW4gTGV2ZWxEQi5cclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGFzaCAtIFRoZSBibG9jayBoYXNoXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgLSBUaGUgYmxvY2sgZGF0YVxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyB3cml0ZVVuZG8oaGFzaCwgZGF0YSkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGIucHV0KGxheW91dC5iLmVuY29kZSh0eXBlcy5VTkRPLCBoYXNoKSwgZGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCBzdG9yZXMgYmxvY2sgZGF0YSBpbiBMZXZlbERCLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoYXNoIC0gVGhlIGJsb2NrIGhhc2hcclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YSAtIFRoZSBibG9jayBkYXRhXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHdyaXRlKGhhc2gsIGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLnB1dChsYXlvdXQuYi5lbmNvZGUodHlwZXMuQkxPQ0ssIGhhc2gpLCBkYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgbWV0aG9kIHN0b3JlcyBzZXJpYWxpemVkIGJsb2NrIGZpbHRlciBkYXRhIGluIExldmVsREIuXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGhhc2ggLSBUaGUgYmxvY2sgaGFzaFxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhIC0gVGhlIHNlcmlhbGl6ZWQgYmxvY2sgZmlsdGVyIGRhdGEuXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHdyaXRlRmlsdGVyKGhhc2gsIGRhdGEpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLnB1dChsYXlvdXQuYi5lbmNvZGUodHlwZXMuRklMVEVSLCBoYXNoKSwgZGF0YSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCB3aWxsIHJldHJpZXZlIG1lcmtsZSBibG9jayBkYXRhLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoYXNoIC0gVGhlIGJsb2NrIGhhc2hcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgcmVhZE1lcmtsZShoYXNoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYi5nZXQobGF5b3V0LmIuZW5jb2RlKHR5cGVzLk1FUktMRSwgaGFzaCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBtZXRob2Qgd2lsbCByZXRyaWV2ZSBibG9jayB1bmRvIGNvaW4gZGF0YS5cclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGFzaCAtIFRoZSBibG9jayBoYXNoXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHJlYWRVbmRvKGhhc2gpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLmdldChsYXlvdXQuYi5lbmNvZGUodHlwZXMuVU5ETywgaGFzaCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBtZXRob2Qgd2lsbCByZXRyaWV2ZSBzZXJpYWxpemVkIGJsb2NrIGZpbHRlciBkYXRhLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoYXNoIC0gVGhlIGJsb2NrIGhhc2hcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgcmVhZEZpbHRlcihoYXNoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5kYi5nZXQobGF5b3V0LmIuZW5jb2RlKHR5cGVzLkZJTFRFUiwgaGFzaCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyBtZXRob2Qgd2lsbCByZXRyaWV2ZSBibG9jayBmaWx0ZXIgaGVhZGVyIG9ubHkuXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGhhc2ggLSBUaGUgYmxvY2sgaGFzaFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyByZWFkRmlsdGVySGVhZGVyKGhhc2gpIHtcclxuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmRiLmdldChsYXlvdXQuYi5lbmNvZGUodHlwZXMuRklMVEVSLCBoYXNoKSk7XHJcblxyXG4gICAgaWYgKCFkYXRhKVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICByZXR1cm4gZGF0YS5zbGljZSgwLCAzMik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIG1ldGhvZCB3aWxsIHJldHJpZXZlIGJsb2NrIGRhdGEuIFNtYWxsZXIgcG9ydGlvbnMgb2YgdGhlXHJcbiAgICogYmxvY2sgKGUuZy4gdHJhbnNhY3Rpb25zKSBjYW4gYmUgcmV0dXJuZWQgdXNpbmcgdGhlIG9mZnNldCBhbmRcclxuICAgKiBsZW5ndGggYXJndW1lbnRzLiBIb3dldmVyLCB0aGUgZW50aXJlIGJsb2NrIHdpbGwgYmUgcmVhZCBhcyB0aGVcclxuICAgKiBkYXRhIGlzIHN0b3JlZCBpbiBhIGtleS92YWx1ZSBkYXRhYmFzZS5cclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGFzaCAtIFRoZSBibG9jayBoYXNoXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldCAtIFRoZSBvZmZzZXQgd2l0aGluIHRoZSBibG9ja1xyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBsZW5ndGggLSBUaGUgbnVtYmVyIG9mIGJ5dGVzIG9mIHRoZSBkYXRhXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHJlYWQoaGFzaCwgb2Zmc2V0LCBsZW5ndGgpIHtcclxuICAgIGxldCByYXcgPSBhd2FpdCB0aGlzLmRiLmdldChsYXlvdXQuYi5lbmNvZGUodHlwZXMuQkxPQ0ssIGhhc2gpKTtcclxuXHJcbiAgICBpZiAob2Zmc2V0KSB7XHJcbiAgICAgIGlmIChvZmZzZXQgKyBsZW5ndGggPiByYXcubGVuZ3RoKVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignT3V0LW9mLWJvdW5kcyByZWFkLicpO1xyXG5cclxuICAgICAgcmF3ID0gcmF3LnNsaWNlKG9mZnNldCwgb2Zmc2V0ICsgbGVuZ3RoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gcmF3O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyB3aWxsIGZyZWUgcmVzb3VyY2VzIGZvciBzdG9yaW5nIG1lcmtsZSBibG9jayBkYXRhLlxyXG4gICAqIFRoZSBibG9jayBkYXRhIG1heSBub3QgYmUgaW1tZWRpYXRlbHkgcmVtb3ZlZCBmcm9tIGRpc2ssIGFuZCB3aWxsXHJcbiAgICogYmUgcmVjbGFpbWVkIGR1cmluZyBMZXZlbERCIGNvbXBhY3Rpb24uXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGhhc2ggLSBUaGUgYmxvY2sgaGFzaFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBwcnVuZU1lcmtsZShoYXNoKSB7XHJcbiAgICBpZiAoIWF3YWl0IHRoaXMuaGFzTWVya2xlKGhhc2gpKVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgYXdhaXQgdGhpcy5kYi5kZWwobGF5b3V0LmIuZW5jb2RlKHR5cGVzLk1FUktMRSwgaGFzaCkpO1xyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyB3aWxsIGZyZWUgcmVzb3VyY2VzIGZvciBzdG9yaW5nIHRoZSBibG9jayB1bmRvIGNvaW4gZGF0YS5cclxuICAgKiBUaGUgYmxvY2sgZGF0YSBtYXkgbm90IGJlIGltbWVkaWF0ZWx5IHJlbW92ZWQgZnJvbSBkaXNrLCBhbmQgd2lsbFxyXG4gICAqIGJlIHJlY2xhaW1lZCBkdXJpbmcgTGV2ZWxEQiBjb21wYWN0aW9uLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoYXNoIC0gVGhlIGJsb2NrIGhhc2hcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgcHJ1bmVVbmRvKGhhc2gpIHtcclxuICAgIGlmICghYXdhaXQgdGhpcy5oYXNVbmRvKGhhc2gpKVxyXG4gICAgICByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgYXdhaXQgdGhpcy5kYi5kZWwobGF5b3V0LmIuZW5jb2RlKHR5cGVzLlVORE8sIGhhc2gpKTtcclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgd2lsbCBmcmVlIHJlc291cmNlcyBmb3Igc3RvcmluZyB0aGUgc2VyaWFsaXplZCBibG9jayBmaWx0ZXIgZGF0YS5cclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGFzaCAtIFRoZSBibG9jayBoYXNoXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHBydW5lRmlsdGVyKGhhc2gpIHtcclxuICAgIGlmICghYXdhaXQgdGhpcy5oYXNGaWx0ZXIoaGFzaCkpXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICBhd2FpdCB0aGlzLmRiLmRlbChsYXlvdXQuYi5lbmNvZGUodHlwZXMuRklMVEVSLCBoYXNoKSk7XHJcblxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUaGlzIHdpbGwgZnJlZSByZXNvdXJjZXMgZm9yIHN0b3JpbmcgdGhlIGJsb2NrIGRhdGEuIFRoZSBibG9ja1xyXG4gICAqIGRhdGEgbWF5IG5vdCBiZSBpbW1lZGlhdGVseSByZW1vdmVkIGZyb20gZGlzaywgYW5kIHdpbGwgYmUgcmVjbGFpbWVkXHJcbiAgICogZHVyaW5nIExldmVsREIgY29tcGFjdGlvbi5cclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gaGFzaCAtIFRoZSBibG9jayBoYXNoXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHBydW5lKGhhc2gpIHtcclxuICAgIGlmICghYXdhaXQgdGhpcy5oYXMoaGFzaCkpXHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICBhd2FpdCB0aGlzLmRiLmRlbChsYXlvdXQuYi5lbmNvZGUodHlwZXMuQkxPQ0ssIGhhc2gpKTtcclxuXHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgd2lsbCBjaGVjayBpZiBhIG1lcmtsZSBibG9jayBkYXRhIGhhcyBiZWVuIHN0b3JlZFxyXG4gICAqIGFuZCBpcyBhdmFpbGFibGUuXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGhhc2ggLSBUaGUgYmxvY2sgaGFzaFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBoYXNNZXJrbGUoaGFzaCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGIuaGFzKGxheW91dC5iLmVuY29kZSh0eXBlcy5NRVJLTEUsIGhhc2gpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgd2lsbCBjaGVjayBpZiBhIGJsb2NrIHVuZG8gY29pbiBkYXRhIGhhcyBiZWVuIHN0b3JlZFxyXG4gICAqIGFuZCBpcyBhdmFpbGFibGUuXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGhhc2ggLSBUaGUgYmxvY2sgaGFzaFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBoYXNVbmRvKGhhc2gpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLmhhcyhsYXlvdXQuYi5lbmNvZGUodHlwZXMuVU5ETywgaGFzaCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVGhpcyB3aWxsIGNoZWNrIGlmIGEgYmxvY2sgZmlsdGVyIGhhcyBiZWVuIHN0b3JlZFxyXG4gICAqIGFuZCBpcyBhdmFpbGFibGUuXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IGhhc2ggLSBUaGUgYmxvY2sgaGFzaFxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBoYXNGaWx0ZXIoaGFzaCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZGIuaGFzKGxheW91dC5iLmVuY29kZSh0eXBlcy5GSUxURVIsIGhhc2gpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRoaXMgd2lsbCBjaGVjayBpZiBhIGJsb2NrIGhhcyBiZWVuIHN0b3JlZCBhbmQgaXMgYXZhaWxhYmxlLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoYXNoIC0gVGhlIGJsb2NrIGhhc2hcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgaGFzKGhhc2gpIHtcclxuICAgIHJldHVybiB0aGlzLmRiLmhhcyhsYXlvdXQuYi5lbmNvZGUodHlwZXMuQkxPQ0ssIGhhc2gpKTtcclxuICB9XHJcbn1cclxuXHJcbi8qXHJcbiAqIEV4cG9zZVxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTGV2ZWxCbG9ja1N0b3JlO1xyXG4iXX0=