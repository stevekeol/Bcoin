/*!
 * child.js - child processes for bcoin
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_2n2r71n67g(){var path="E:\\Projects\\Test\\bcoin\\lib\\workers\\child.js";var hash="36c6ac16f79d7e62d1b7cec418d49203444d2ca9";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\workers\\child.js",statementMap:{"0":{start:{line:9,column:21},end:{line:9,column:38}},"1":{start:{line:10,column:13},end:{line:10,column:28}},"2":{start:{line:11,column:11},end:{line:11,column:35}},"3":{start:{line:13,column:17},end:{line:13,column:26}},"4":{start:{line:15,column:16},end:{line:15,column:21}},"5":{start:{line:33,column:4},end:{line:33,column:12}},"6":{start:{line:35,column:4},end:{line:35,column:15}},"7":{start:{line:36,column:4},end:{line:36,column:23}},"8":{start:{line:38,column:4},end:{line:38,column:20}},"9":{start:{line:47,column:4},end:{line:47,column:16}},"10":{start:{line:57,column:16},end:{line:57,column:31}},"11":{start:{line:58,column:21},end:{line:58,column:50}},"12":{start:{line:59,column:20},end:{line:59,column:55}},"13":{start:{line:61,column:4},end:{line:61,column:52}},"14":{start:{line:63,column:4},end:{line:63,column:23}},"15":{start:{line:64,column:4},end:{line:64,column:29}},"16":{start:{line:65,column:4},end:{line:65,column:30}},"17":{start:{line:66,column:4},end:{line:66,column:30}},"18":{start:{line:68,column:4},end:{line:70,column:7}},"19":{start:{line:69,column:6},end:{line:69,column:30}},"20":{start:{line:72,column:4},end:{line:75,column:7}},"21":{start:{line:73,column:6},end:{line:73,column:28}},"22":{start:{line:74,column:6},end:{line:74,column:58}},"23":{start:{line:77,column:4},end:{line:79,column:7}},"24":{start:{line:78,column:6},end:{line:78,column:30}},"25":{start:{line:81,column:4},end:{line:83,column:7}},"26":{start:{line:82,column:6},end:{line:82,column:30}},"27":{start:{line:85,column:4},end:{line:87,column:7}},"28":{start:{line:86,column:6},end:{line:86,column:30}},"29":{start:{line:89,column:4},end:{line:91,column:7}},"30":{start:{line:90,column:6},end:{line:90,column:30}},"31":{start:{line:101,column:4},end:{line:101,column:40}},"32":{start:{line:109,column:4},end:{line:109,column:31}},"33":{start:{line:119,column:2},end:{line:120,column:11}},"34":{start:{line:120,column:4},end:{line:120,column:11}},"35":{start:{line:122,column:2},end:{line:122,column:19}},"36":{start:{line:124,column:2},end:{line:127,column:5}},"37":{start:{line:125,column:4},end:{line:126,column:22}},"38":{start:{line:126,column:6},end:{line:126,column:22}},"39":{start:{line:137,column:19},end:{line:139,column:3}},"40":{start:{line:138,column:4},end:{line:138,column:27}},"41":{start:{line:141,column:19},end:{line:143,column:3}},"42":{start:{line:142,column:4},end:{line:142,column:27}},"43":{start:{line:145,column:20},end:{line:147,column:3}},"44":{start:{line:146,column:4},end:{line:146,column:28}},"45":{start:{line:149,column:18},end:{line:156,column:3}},"46":{start:{line:150,column:4},end:{line:153,column:33}},"47":{start:{line:151,column:6},end:{line:151,column:39}},"48":{start:{line:153,column:6},end:{line:153,column:33}},"49":{start:{line:155,column:4},end:{line:155,column:20}},"50":{start:{line:158,column:2},end:{line:158,column:32}},"51":{start:{line:160,column:2},end:{line:161,column:37}},"52":{start:{line:161,column:4},end:{line:161,column:37}},"53":{start:{line:163,column:2},end:{line:164,column:37}},"54":{start:{line:164,column:4},end:{line:164,column:37}},"55":{start:{line:166,column:2},end:{line:167,column:39}},"56":{start:{line:167,column:4},end:{line:167,column:39}},"57":{start:{line:169,column:2},end:{line:170,column:47}},"58":{start:{line:170,column:4},end:{line:170,column:47}},"59":{start:{line:172,column:2},end:{line:187,column:5}},"60":{start:{line:173,column:4},end:{line:186,column:5}},"61":{start:{line:175,column:8},end:{line:175,column:47}},"62":{start:{line:176,column:8},end:{line:176,column:14}},"63":{start:{line:178,column:8},end:{line:178,column:47}},"64":{start:{line:179,column:8},end:{line:179,column:14}},"65":{start:{line:181,column:8},end:{line:181,column:48}},"66":{start:{line:182,column:8},end:{line:182,column:14}},"67":{start:{line:184,column:8},end:{line:184,column:46}},"68":{start:{line:185,column:8},end:{line:185,column:14}},"69":{start:{line:194,column:0},end:{line:194,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:32,column:2},end:{line:32,column:3}},loc:{start:{line:32,column:20},end:{line:39,column:3}},line:32},"1":{name:"(anonymous_1)",decl:{start:{line:46,column:2},end:{line:46,column:3}},loc:{start:{line:46,column:22},end:{line:48,column:3}},line:46},"2":{name:"(anonymous_2)",decl:{start:{line:56,column:2},end:{line:56,column:3}},loc:{start:{line:56,column:13},end:{line:92,column:3}},line:56},"3":{name:"(anonymous_3)",decl:{start:{line:68,column:27},end:{line:68,column:28}},loc:{start:{line:68,column:36},end:{line:70,column:5}},line:68},"4":{name:"(anonymous_4)",decl:{start:{line:72,column:28},end:{line:72,column:29}},loc:{start:{line:72,column:46},end:{line:75,column:5}},line:72},"5":{name:"(anonymous_5)",decl:{start:{line:77,column:33},end:{line:77,column:34}},loc:{start:{line:77,column:42},end:{line:79,column:5}},line:77},"6":{name:"(anonymous_6)",decl:{start:{line:81,column:34},end:{line:81,column:35}},loc:{start:{line:81,column:43},end:{line:83,column:5}},line:81},"7":{name:"(anonymous_7)",decl:{start:{line:85,column:34},end:{line:85,column:35}},loc:{start:{line:85,column:43},end:{line:87,column:5}},line:85},"8":{name:"(anonymous_8)",decl:{start:{line:89,column:33},end:{line:89,column:34}},loc:{start:{line:89,column:43},end:{line:91,column:5}},line:89},"9":{name:"(anonymous_9)",decl:{start:{line:100,column:2},end:{line:100,column:3}},loc:{start:{line:100,column:14},end:{line:102,column:3}},line:100},"10":{name:"(anonymous_10)",decl:{start:{line:108,column:2},end:{line:108,column:3}},loc:{start:{line:108,column:12},end:{line:110,column:3}},line:108},"11":{name:"bindExit",decl:{start:{line:118,column:9},end:{line:118,column:17}},loc:{start:{line:118,column:20},end:{line:128,column:1}},line:118},"12":{name:"(anonymous_12)",decl:{start:{line:124,column:13},end:{line:124,column:14}},loc:{start:{line:124,column:19},end:{line:127,column:3}},line:124},"13":{name:"listenExit",decl:{start:{line:136,column:9},end:{line:136,column:19}},loc:{start:{line:136,column:29},end:{line:188,column:1}},line:136},"14":{name:"(anonymous_14)",decl:{start:{line:137,column:19},end:{line:137,column:20}},loc:{start:{line:137,column:25},end:{line:139,column:3}},line:137},"15":{name:"(anonymous_15)",decl:{start:{line:141,column:19},end:{line:141,column:20}},loc:{start:{line:141,column:25},end:{line:143,column:3}},line:141},"16":{name:"(anonymous_16)",decl:{start:{line:145,column:20},end:{line:145,column:21}},loc:{start:{line:145,column:26},end:{line:147,column:3}},line:145},"17":{name:"(anonymous_17)",decl:{start:{line:149,column:18},end:{line:149,column:19}},loc:{start:{line:149,column:27},end:{line:156,column:3}},line:149},"18":{name:"(anonymous_18)",decl:{start:{line:172,column:28},end:{line:172,column:29}},loc:{start:{line:172,column:38},end:{line:187,column:3}},line:172}},branchMap:{"0":{loc:{start:{line:74,column:24},end:{line:74,column:48}},type:"cond-expr",locations:[{start:{line:74,column:39},end:{line:74,column:41}},{start:{line:74,column:44},end:{line:74,column:48}}],line:74},"1":{loc:{start:{line:119,column:2},end:{line:120,column:11}},type:"if",locations:[{start:{line:119,column:2},end:{line:120,column:11}},{start:{line:119,column:2},end:{line:120,column:11}}],line:119},"2":{loc:{start:{line:150,column:4},end:{line:153,column:33}},type:"if",locations:[{start:{line:150,column:4},end:{line:153,column:33}},{start:{line:150,column:4},end:{line:153,column:33}}],line:150},"3":{loc:{start:{line:150,column:8},end:{line:150,column:24}},type:"binary-expr",locations:[{start:{line:150,column:8},end:{line:150,column:11}},{start:{line:150,column:15},end:{line:150,column:24}}],line:150},"4":{loc:{start:{line:160,column:2},end:{line:161,column:37}},type:"if",locations:[{start:{line:160,column:2},end:{line:161,column:37}},{start:{line:160,column:2},end:{line:161,column:37}}],line:160},"5":{loc:{start:{line:163,column:2},end:{line:164,column:37}},type:"if",locations:[{start:{line:163,column:2},end:{line:164,column:37}},{start:{line:163,column:2},end:{line:164,column:37}}],line:163},"6":{loc:{start:{line:166,column:2},end:{line:167,column:39}},type:"if",locations:[{start:{line:166,column:2},end:{line:167,column:39}},{start:{line:166,column:2},end:{line:167,column:39}}],line:166},"7":{loc:{start:{line:169,column:2},end:{line:170,column:47}},type:"if",locations:[{start:{line:169,column:2},end:{line:170,column:47}},{start:{line:169,column:2},end:{line:170,column:47}}],line:169},"8":{loc:{start:{line:173,column:4},end:{line:186,column:5}},type:"switch",locations:[{start:{line:174,column:6},end:{line:176,column:14}},{start:{line:177,column:6},end:{line:179,column:14}},{start:{line:180,column:6},end:{line:182,column:14}},{start:{line:183,column:6},end:{line:185,column:14}}],line:173}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0,0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"36c6ac16f79d7e62d1b7cec418d49203444d2ca9"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2n2r71n67g=function(){return actualCoverage;};}return actualCoverage;}cov_2n2r71n67g();const EventEmitter=(cov_2n2r71n67g().s[0]++,require('events'));const path=(cov_2n2r71n67g().s[1]++,require('path'));const cp=(cov_2n2r71n67g().s[2]++,require('child_process'));const children=(cov_2n2r71n67g().s[3]++,new Set());let exitBound=(cov_2n2r71n67g().s[4]++,false);/**
 * Child
 * Represents a child process.
 * @alias module:workers.Child
 * @extends EventEmitter
 * @ignore
 */class Child extends EventEmitter{/**
   * Represents a child process.
   * @constructor
   * @param {String} file
   */constructor(file){cov_2n2r71n67g().f[0]++;cov_2n2r71n67g().s[5]++;super();cov_2n2r71n67g().s[6]++;bindExit();cov_2n2r71n67g().s[7]++;children.add(this);cov_2n2r71n67g().s[8]++;this.init(file);}/**
   * Test whether child process support is available.
   * @returns {Boolean}
   */static hasSupport(){cov_2n2r71n67g().f[1]++;cov_2n2r71n67g().s[9]++;return true;}/**
   * Initialize child process (node.js).
   * @private
   * @param {String} file
   */init(file){cov_2n2r71n67g().f[2]++;const bin=(cov_2n2r71n67g().s[10]++,process.argv[0]);const filename=(cov_2n2r71n67g().s[11]++,path.resolve(__dirname,file));const options=(cov_2n2r71n67g().s[12]++,{stdio:'pipe',env:process.env});cov_2n2r71n67g().s[13]++;this.child=cp.spawn(bin,[filename],options);cov_2n2r71n67g().s[14]++;this.child.unref();cov_2n2r71n67g().s[15]++;this.child.stdin.unref();cov_2n2r71n67g().s[16]++;this.child.stdout.unref();cov_2n2r71n67g().s[17]++;this.child.stderr.unref();cov_2n2r71n67g().s[18]++;this.child.on('error',err=>{cov_2n2r71n67g().f[3]++;cov_2n2r71n67g().s[19]++;this.emit('error',err);});cov_2n2r71n67g().s[20]++;this.child.once('exit',(code,signal)=>{cov_2n2r71n67g().f[4]++;cov_2n2r71n67g().s[21]++;children.delete(this);cov_2n2r71n67g().s[22]++;this.emit('exit',code==null?(cov_2n2r71n67g().b[0][0]++,-1):(cov_2n2r71n67g().b[0][1]++,code),signal);});cov_2n2r71n67g().s[23]++;this.child.stdin.on('error',err=>{cov_2n2r71n67g().f[5]++;cov_2n2r71n67g().s[24]++;this.emit('error',err);});cov_2n2r71n67g().s[25]++;this.child.stdout.on('error',err=>{cov_2n2r71n67g().f[6]++;cov_2n2r71n67g().s[26]++;this.emit('error',err);});cov_2n2r71n67g().s[27]++;this.child.stderr.on('error',err=>{cov_2n2r71n67g().f[7]++;cov_2n2r71n67g().s[28]++;this.emit('error',err);});cov_2n2r71n67g().s[29]++;this.child.stdout.on('data',data=>{cov_2n2r71n67g().f[8]++;cov_2n2r71n67g().s[30]++;this.emit('data',data);});}/**
   * Send data to child process.
   * @param {Buffer} data
   * @returns {Boolean}
   */write(data){cov_2n2r71n67g().f[9]++;cov_2n2r71n67g().s[31]++;return this.child.stdin.write(data);}/**
   * Destroy the child process.
   */destroy(){cov_2n2r71n67g().f[10]++;cov_2n2r71n67g().s[32]++;this.child.kill('SIGTERM');}}/**
 * Cleanup all child processes.
 * @private
 */function bindExit(){cov_2n2r71n67g().f[11]++;cov_2n2r71n67g().s[33]++;if(exitBound){cov_2n2r71n67g().b[1][0]++;cov_2n2r71n67g().s[34]++;return;}else{cov_2n2r71n67g().b[1][1]++;}cov_2n2r71n67g().s[35]++;exitBound=true;cov_2n2r71n67g().s[36]++;listenExit(()=>{cov_2n2r71n67g().f[12]++;cov_2n2r71n67g().s[37]++;for(const child of children){cov_2n2r71n67g().s[38]++;child.destroy();}});}/**
 * Listen for exit.
 * @param {Function} handler
 * @private
 */function listenExit(handler){cov_2n2r71n67g().f[13]++;cov_2n2r71n67g().s[39]++;const onSighup=()=>{cov_2n2r71n67g().f[14]++;cov_2n2r71n67g().s[40]++;process.exit(1|0x80);};cov_2n2r71n67g().s[41]++;const onSigint=()=>{cov_2n2r71n67g().f[15]++;cov_2n2r71n67g().s[42]++;process.exit(2|0x80);};cov_2n2r71n67g().s[43]++;const onSigterm=()=>{cov_2n2r71n67g().f[16]++;cov_2n2r71n67g().s[44]++;process.exit(15|0x80);};cov_2n2r71n67g().s[45]++;const onError=err=>{cov_2n2r71n67g().f[17]++;cov_2n2r71n67g().s[46]++;if((cov_2n2r71n67g().b[3][0]++,err)&&(cov_2n2r71n67g().b[3][1]++,err.stack)){cov_2n2r71n67g().b[2][0]++;cov_2n2r71n67g().s[47]++;console.error(String(err.stack));}else{cov_2n2r71n67g().b[2][1]++;cov_2n2r71n67g().s[48]++;console.error(String(err));}cov_2n2r71n67g().s[49]++;process.exit(1);};cov_2n2r71n67g().s[50]++;process.once('exit',handler);cov_2n2r71n67g().s[51]++;if(process.listenerCount('SIGHUP')===0){cov_2n2r71n67g().b[4][0]++;cov_2n2r71n67g().s[52]++;process.once('SIGHUP',onSighup);}else{cov_2n2r71n67g().b[4][1]++;}cov_2n2r71n67g().s[53]++;if(process.listenerCount('SIGINT')===0){cov_2n2r71n67g().b[5][0]++;cov_2n2r71n67g().s[54]++;process.once('SIGINT',onSigint);}else{cov_2n2r71n67g().b[5][1]++;}cov_2n2r71n67g().s[55]++;if(process.listenerCount('SIGTERM')===0){cov_2n2r71n67g().b[6][0]++;cov_2n2r71n67g().s[56]++;process.once('SIGTERM',onSigterm);}else{cov_2n2r71n67g().b[6][1]++;}cov_2n2r71n67g().s[57]++;if(process.listenerCount('uncaughtException')===0){cov_2n2r71n67g().b[7][0]++;cov_2n2r71n67g().s[58]++;process.once('uncaughtException',onError);}else{cov_2n2r71n67g().b[7][1]++;}cov_2n2r71n67g().s[59]++;process.on('newListener',name=>{cov_2n2r71n67g().f[18]++;cov_2n2r71n67g().s[60]++;switch(name){case'SIGHUP':cov_2n2r71n67g().b[8][0]++;cov_2n2r71n67g().s[61]++;process.removeListener(name,onSighup);cov_2n2r71n67g().s[62]++;break;case'SIGINT':cov_2n2r71n67g().b[8][1]++;cov_2n2r71n67g().s[63]++;process.removeListener(name,onSigint);cov_2n2r71n67g().s[64]++;break;case'SIGTERM':cov_2n2r71n67g().b[8][2]++;cov_2n2r71n67g().s[65]++;process.removeListener(name,onSigterm);cov_2n2r71n67g().s[66]++;break;case'uncaughtException':cov_2n2r71n67g().b[8][3]++;cov_2n2r71n67g().s[67]++;process.removeListener(name,onError);cov_2n2r71n67g().s[68]++;break;}});}/*
 * Expose
 */cov_2n2r71n67g().s[69]++;module.exports=Child;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoaWxkLmpzIl0sIm5hbWVzIjpbIkV2ZW50RW1pdHRlciIsInJlcXVpcmUiLCJwYXRoIiwiY3AiLCJjaGlsZHJlbiIsIlNldCIsImV4aXRCb3VuZCIsIkNoaWxkIiwiY29uc3RydWN0b3IiLCJmaWxlIiwiYmluZEV4aXQiLCJhZGQiLCJpbml0IiwiaGFzU3VwcG9ydCIsImJpbiIsInByb2Nlc3MiLCJhcmd2IiwiZmlsZW5hbWUiLCJyZXNvbHZlIiwiX19kaXJuYW1lIiwib3B0aW9ucyIsInN0ZGlvIiwiZW52IiwiY2hpbGQiLCJzcGF3biIsInVucmVmIiwic3RkaW4iLCJzdGRvdXQiLCJzdGRlcnIiLCJvbiIsImVyciIsImVtaXQiLCJvbmNlIiwiY29kZSIsInNpZ25hbCIsImRlbGV0ZSIsImRhdGEiLCJ3cml0ZSIsImRlc3Ryb3kiLCJraWxsIiwibGlzdGVuRXhpdCIsImhhbmRsZXIiLCJvblNpZ2h1cCIsImV4aXQiLCJvblNpZ2ludCIsIm9uU2lndGVybSIsIm9uRXJyb3IiLCJzdGFjayIsImNvbnNvbGUiLCJlcnJvciIsIlN0cmluZyIsImxpc3RlbmVyQ291bnQiLCJuYW1lIiwicmVtb3ZlTGlzdGVuZXIiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBRUEsYSwreVRBU1k7MkZBUFosS0FBTUEsQ0FBQUEsWUFBWSwwQkFBR0MsT0FBTyxDQUFDLFFBQUQsQ0FBVixDQUFsQixDQUNBLEtBQU1DLENBQUFBLElBQUksMEJBQUdELE9BQU8sQ0FBQyxNQUFELENBQVYsQ0FBVixDQUNBLEtBQU1FLENBQUFBLEVBQUUsMEJBQUdGLE9BQU8sQ0FBQyxlQUFELENBQVYsQ0FBUixDQUVBLEtBQU1HLENBQUFBLFFBQVEsMEJBQUcsR0FBSUMsQ0FBQUEsR0FBSixFQUFILENBQWQsQ0FFQSxHQUFJQyxDQUFBQSxTQUFTLDBCQUFHLEtBQUgsQ0FBYixDQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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Q0U3QixPQUFPLENBQUNzQyxjQUFSLENBQXVCRCxJQUF2QixDQUE2QlAsU0FBN0IsRUFERix5QkFFRSxNQUNGLElBQUssbUJBQUwscURBQ0U5QixPQUFPLENBQUNzQyxjQUFSLENBQXVCRCxJQUF2QixDQUE2Qk4sT0FBN0IsRUFERix5QkFFRSxNQVpKLENBY0QsQ0FmRCxFQWdCRCxDQUVEO0FBQ0E7QUFDQSxHLHlCQUVBUSxNQUFNLENBQUNDLE9BQVAsQ0FBaUJoRCxLQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKiBjaGlsZC5qcyAtIGNoaWxkIHByb2Nlc3NlcyBmb3IgYmNvaW5cclxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMTcsIENocmlzdG9waGVyIEplZmZyZXkgKE1JVCBMaWNlbnNlKS5cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2Jjb2luLW9yZy9iY29pblxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xyXG5jb25zdCBjcCA9IHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKTtcclxuXHJcbmNvbnN0IGNoaWxkcmVuID0gbmV3IFNldCgpO1xyXG5cclxubGV0IGV4aXRCb3VuZCA9IGZhbHNlO1xyXG5cclxuLyoqXHJcbiAqIENoaWxkXHJcbiAqIFJlcHJlc2VudHMgYSBjaGlsZCBwcm9jZXNzLlxyXG4gKiBAYWxpYXMgbW9kdWxlOndvcmtlcnMuQ2hpbGRcclxuICogQGV4dGVuZHMgRXZlbnRFbWl0dGVyXHJcbiAqIEBpZ25vcmVcclxuICovXHJcblxyXG5jbGFzcyBDaGlsZCBleHRlbmRzIEV2ZW50RW1pdHRlciB7XHJcbiAgLyoqXHJcbiAgICogUmVwcmVzZW50cyBhIGNoaWxkIHByb2Nlc3MuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtTdHJpbmd9IGZpbGVcclxuICAgKi9cclxuXHJcbiAgY29uc3RydWN0b3IoZmlsZSkge1xyXG4gICAgc3VwZXIoKTtcclxuXHJcbiAgICBiaW5kRXhpdCgpO1xyXG4gICAgY2hpbGRyZW4uYWRkKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuaW5pdChmaWxlKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciBjaGlsZCBwcm9jZXNzIHN1cHBvcnQgaXMgYXZhaWxhYmxlLlxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICBzdGF0aWMgaGFzU3VwcG9ydCgpIHtcclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5pdGlhbGl6ZSBjaGlsZCBwcm9jZXNzIChub2RlLmpzKS5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBmaWxlXHJcbiAgICovXHJcblxyXG4gIGluaXQoZmlsZSkge1xyXG4gICAgY29uc3QgYmluID0gcHJvY2Vzcy5hcmd2WzBdO1xyXG4gICAgY29uc3QgZmlsZW5hbWUgPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBmaWxlKTtcclxuICAgIGNvbnN0IG9wdGlvbnMgPSB7IHN0ZGlvOiAncGlwZScsIGVudjogcHJvY2Vzcy5lbnYgfTtcclxuXHJcbiAgICB0aGlzLmNoaWxkID0gY3Auc3Bhd24oYmluLCBbZmlsZW5hbWVdLCBvcHRpb25zKTtcclxuXHJcbiAgICB0aGlzLmNoaWxkLnVucmVmKCk7XHJcbiAgICB0aGlzLmNoaWxkLnN0ZGluLnVucmVmKCk7XHJcbiAgICB0aGlzLmNoaWxkLnN0ZG91dC51bnJlZigpO1xyXG4gICAgdGhpcy5jaGlsZC5zdGRlcnIudW5yZWYoKTtcclxuXHJcbiAgICB0aGlzLmNoaWxkLm9uKCdlcnJvcicsIChlcnIpID0+IHtcclxuICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycik7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmNoaWxkLm9uY2UoJ2V4aXQnLCAoY29kZSwgc2lnbmFsKSA9PiB7XHJcbiAgICAgIGNoaWxkcmVuLmRlbGV0ZSh0aGlzKTtcclxuICAgICAgdGhpcy5lbWl0KCdleGl0JywgY29kZSA9PSBudWxsID8gLTEgOiBjb2RlLCBzaWduYWwpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5jaGlsZC5zdGRpbi5vbignZXJyb3InLCAoZXJyKSA9PiB7XHJcbiAgICAgIHRoaXMuZW1pdCgnZXJyb3InLCBlcnIpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5jaGlsZC5zdGRvdXQub24oJ2Vycm9yJywgKGVycikgPT4ge1xyXG4gICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuY2hpbGQuc3RkZXJyLm9uKCdlcnJvcicsIChlcnIpID0+IHtcclxuICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIGVycik7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLmNoaWxkLnN0ZG91dC5vbignZGF0YScsIChkYXRhKSA9PiB7XHJcbiAgICAgIHRoaXMuZW1pdCgnZGF0YScsIGRhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZW5kIGRhdGEgdG8gY2hpbGQgcHJvY2Vzcy5cclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gZGF0YVxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICB3cml0ZShkYXRhKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jaGlsZC5zdGRpbi53cml0ZShkYXRhKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIERlc3Ryb3kgdGhlIGNoaWxkIHByb2Nlc3MuXHJcbiAgICovXHJcblxyXG4gIGRlc3Ryb3koKSB7XHJcbiAgICB0aGlzLmNoaWxkLmtpbGwoJ1NJR1RFUk0nKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDbGVhbnVwIGFsbCBjaGlsZCBwcm9jZXNzZXMuXHJcbiAqIEBwcml2YXRlXHJcbiAqL1xyXG5cclxuZnVuY3Rpb24gYmluZEV4aXQoKSB7XHJcbiAgaWYgKGV4aXRCb3VuZClcclxuICAgIHJldHVybjtcclxuXHJcbiAgZXhpdEJvdW5kID0gdHJ1ZTtcclxuXHJcbiAgbGlzdGVuRXhpdCgoKSA9PiB7XHJcbiAgICBmb3IgKGNvbnN0IGNoaWxkIG9mIGNoaWxkcmVuKVxyXG4gICAgICBjaGlsZC5kZXN0cm95KCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBMaXN0ZW4gZm9yIGV4aXQuXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGhhbmRsZXJcclxuICogQHByaXZhdGVcclxuICovXHJcblxyXG5mdW5jdGlvbiBsaXN0ZW5FeGl0KGhhbmRsZXIpIHtcclxuICBjb25zdCBvblNpZ2h1cCA9ICgpID0+IHtcclxuICAgIHByb2Nlc3MuZXhpdCgxIHwgMHg4MCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3Qgb25TaWdpbnQgPSAoKSA9PiB7XHJcbiAgICBwcm9jZXNzLmV4aXQoMiB8IDB4ODApO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IG9uU2lndGVybSA9ICgpID0+IHtcclxuICAgIHByb2Nlc3MuZXhpdCgxNSB8IDB4ODApO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IG9uRXJyb3IgPSAoZXJyKSA9PiB7XHJcbiAgICBpZiAoZXJyICYmIGVyci5zdGFjaylcclxuICAgICAgY29uc29sZS5lcnJvcihTdHJpbmcoZXJyLnN0YWNrKSk7XHJcbiAgICBlbHNlXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoU3RyaW5nKGVycikpO1xyXG5cclxuICAgIHByb2Nlc3MuZXhpdCgxKTtcclxuICB9O1xyXG5cclxuICBwcm9jZXNzLm9uY2UoJ2V4aXQnLCBoYW5kbGVyKTtcclxuXHJcbiAgaWYgKHByb2Nlc3MubGlzdGVuZXJDb3VudCgnU0lHSFVQJykgPT09IDApXHJcbiAgICBwcm9jZXNzLm9uY2UoJ1NJR0hVUCcsIG9uU2lnaHVwKTtcclxuXHJcbiAgaWYgKHByb2Nlc3MubGlzdGVuZXJDb3VudCgnU0lHSU5UJykgPT09IDApXHJcbiAgICBwcm9jZXNzLm9uY2UoJ1NJR0lOVCcsIG9uU2lnaW50KTtcclxuXHJcbiAgaWYgKHByb2Nlc3MubGlzdGVuZXJDb3VudCgnU0lHVEVSTScpID09PSAwKVxyXG4gICAgcHJvY2Vzcy5vbmNlKCdTSUdURVJNJywgb25TaWd0ZXJtKTtcclxuXHJcbiAgaWYgKHByb2Nlc3MubGlzdGVuZXJDb3VudCgndW5jYXVnaHRFeGNlcHRpb24nKSA9PT0gMClcclxuICAgIHByb2Nlc3Mub25jZSgndW5jYXVnaHRFeGNlcHRpb24nLCBvbkVycm9yKTtcclxuXHJcbiAgcHJvY2Vzcy5vbignbmV3TGlzdGVuZXInLCAobmFtZSkgPT4ge1xyXG4gICAgc3dpdGNoIChuYW1lKSB7XHJcbiAgICAgIGNhc2UgJ1NJR0hVUCc6XHJcbiAgICAgICAgcHJvY2Vzcy5yZW1vdmVMaXN0ZW5lcihuYW1lLCBvblNpZ2h1cCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ1NJR0lOVCc6XHJcbiAgICAgICAgcHJvY2Vzcy5yZW1vdmVMaXN0ZW5lcihuYW1lLCBvblNpZ2ludCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgJ1NJR1RFUk0nOlxyXG4gICAgICAgIHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIobmFtZSwgb25TaWd0ZXJtKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSAndW5jYXVnaHRFeGNlcHRpb24nOlxyXG4gICAgICAgIHByb2Nlc3MucmVtb3ZlTGlzdGVuZXIobmFtZSwgb25FcnJvcik7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qXHJcbiAqIEV4cG9zZVxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gQ2hpbGQ7XHJcbiJdfQ==