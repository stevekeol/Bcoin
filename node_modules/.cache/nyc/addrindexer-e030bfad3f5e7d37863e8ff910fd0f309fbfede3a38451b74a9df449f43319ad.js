/*!
 * mempool.js - mempool for bcoin
 * Copyright (c) 2018-2019, the bcoin developers (MIT License).
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_pybcxncsr(){var path="E:\\Projects\\Test\\bcoin\\lib\\mempool\\addrindexer.js";var hash="370a8d4502c2dd5e02565b8df71a208fe495d20c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\mempool\\addrindexer.js",statementMap:{"0":{start:{line:10,column:15},end:{line:10,column:31}},"1":{start:{line:11,column:20},end:{line:11,column:41}},"2":{start:{line:12,column:15},end:{line:12,column:46}},"3":{start:{line:27,column:4},end:{line:27,column:27}},"4":{start:{line:30,column:4},end:{line:30,column:33}},"5":{start:{line:33,column:4},end:{line:33,column:31}},"6":{start:{line:37,column:4},end:{line:37,column:23}},"7":{start:{line:38,column:4},end:{line:38,column:21}},"8":{start:{line:42,column:19},end:{line:42,column:47}},"9":{start:{line:44,column:4},end:{line:45,column:18}},"10":{start:{line:45,column:6},end:{line:45,column:18}},"11":{start:{line:47,column:17},end:{line:47,column:31}},"12":{start:{line:48,column:17},end:{line:48,column:32}},"13":{start:{line:49,column:16},end:{line:49,column:40}},"14":{start:{line:51,column:18},end:{line:51,column:40}},"15":{start:{line:52,column:4},end:{line:52,column:33}},"16":{start:{line:53,column:4},end:{line:53,column:29}},"17":{start:{line:55,column:4},end:{line:55,column:15}},"18":{start:{line:68,column:19},end:{line:68,column:49}},"19":{start:{line:70,column:16},end:{line:70,column:18}},"20":{start:{line:72,column:4},end:{line:73,column:25}},"21":{start:{line:73,column:6},end:{line:73,column:25}},"22":{start:{line:75,column:4},end:{line:75,column:15}},"23":{start:{line:88,column:19},end:{line:88,column:49}},"24":{start:{line:90,column:16},end:{line:90,column:18}},"25":{start:{line:92,column:4},end:{line:96,column:5}},"26":{start:{line:93,column:19},end:{line:93,column:42}},"27":{start:{line:94,column:6},end:{line:94,column:30}},"28":{start:{line:95,column:6},end:{line:95,column:21}},"29":{start:{line:98,column:4},end:{line:98,column:15}},"30":{start:{line:111,column:36},end:{line:111,column:43}},"31":{start:{line:112,column:16},end:{line:112,column:33}},"32":{start:{line:114,column:4},end:{line:115,column:16}},"33":{start:{line:115,column:6},end:{line:115,column:16}},"34":{start:{line:117,column:18},end:{line:117,column:37}},"35":{start:{line:119,column:4},end:{line:120,column:16}},"36":{start:{line:120,column:6},end:{line:120,column:16}},"37":{start:{line:122,column:17},end:{line:122,column:19}},"38":{start:{line:127,column:18},end:{line:127,column:55}},"39":{start:{line:129,column:4},end:{line:130,column:20}},"40":{start:{line:130,column:6},end:{line:130,column:20}},"41":{start:{line:132,column:4},end:{line:176,column:5}},"42":{start:{line:135,column:18},end:{line:135,column:19}},"43":{start:{line:137,column:6},end:{line:141,column:7}},"44":{start:{line:138,column:8},end:{line:139,column:16}},"45":{start:{line:139,column:10},end:{line:139,column:16}},"46":{start:{line:140,column:8},end:{line:140,column:19}},"47":{start:{line:143,column:6},end:{line:143,column:42}},"48":{start:{line:145,column:18},end:{line:145,column:27}},"49":{start:{line:146,column:16},end:{line:146,column:29}},"50":{start:{line:148,column:6},end:{line:149,column:28}},"51":{start:{line:149,column:8},end:{line:149,column:28}},"52":{start:{line:151,column:6},end:{line:157,column:7}},"53":{start:{line:152,column:8},end:{line:152,column:18}},"54":{start:{line:153,column:8},end:{line:153,column:20}},"55":{start:{line:155,column:8},end:{line:156,column:30}},"56":{start:{line:156,column:10},end:{line:156,column:30}},"57":{start:{line:159,column:6},end:{line:159,column:40}},"58":{start:{line:163,column:6},end:{line:163,column:42}},"59":{start:{line:165,column:6},end:{line:175,column:7}},"60":{start:{line:166,column:20},end:{line:166,column:21}},"61":{start:{line:167,column:18},end:{line:167,column:23}},"62":{start:{line:169,column:8},end:{line:172,column:9}},"63":{start:{line:170,column:10},end:{line:170,column:40}},"64":{start:{line:171,column:10},end:{line:171,column:30}},"65":{start:{line:174,column:8},end:{line:174,column:42}},"66":{start:{line:178,column:4},end:{line:179,column:23}},"67":{start:{line:179,column:6},end:{line:179,column:23}},"68":{start:{line:181,column:4},end:{line:181,column:18}},"69":{start:{line:185,column:15},end:{line:185,column:23}},"70":{start:{line:186,column:17},end:{line:186,column:26}},"71":{start:{line:187,column:18},end:{line:187,column:39}},"72":{start:{line:189,column:4},end:{line:190,column:13}},"73":{start:{line:190,column:6},end:{line:190,column:13}},"74":{start:{line:192,column:4},end:{line:207,column:5}},"75":{start:{line:193,column:18},end:{line:193,column:35}},"76":{start:{line:195,column:6},end:{line:196,column:17}},"77":{start:{line:196,column:8},end:{line:196,column:17}},"78":{start:{line:198,column:18},end:{line:198,column:37}},"79":{start:{line:200,column:6},end:{line:203,column:7}},"80":{start:{line:201,column:8},end:{line:201,column:32}},"81":{start:{line:202,column:8},end:{line:202,column:35}},"82":{start:{line:205,column:6},end:{line:205,column:31}},"83":{start:{line:206,column:6},end:{line:206,column:29}},"84":{start:{line:209,column:4},end:{line:209,column:30}},"85":{start:{line:213,column:18},end:{line:213,column:36}},"86":{start:{line:215,column:4},end:{line:216,column:13}},"87":{start:{line:216,column:6},end:{line:216,column:13}},"88":{start:{line:218,column:4},end:{line:233,column:5}},"89":{start:{line:219,column:18},end:{line:219,column:35}},"90":{start:{line:221,column:6},end:{line:222,column:17}},"91":{start:{line:222,column:8},end:{line:222,column:17}},"92":{start:{line:224,column:20},end:{line:224,column:39}},"93":{start:{line:226,column:6},end:{line:226,column:20}},"94":{start:{line:227,column:6},end:{line:227,column:30}},"95":{start:{line:229,column:6},end:{line:229,column:25}},"96":{start:{line:231,column:6},end:{line:232,column:31}},"97":{start:{line:232,column:8},end:{line:232,column:31}},"98":{start:{line:235,column:4},end:{line:235,column:26}},"99":{start:{line:243,column:0},end:{line:243,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:26,column:2},end:{line:26,column:3}},loc:{start:{line:26,column:23},end:{line:34,column:3}},line:26},"1":{name:"(anonymous_1)",decl:{start:{line:36,column:2},end:{line:36,column:3}},loc:{start:{line:36,column:10},end:{line:39,column:3}},line:36},"2":{name:"(anonymous_2)",decl:{start:{line:41,column:2},end:{line:41,column:3}},loc:{start:{line:41,column:15},end:{line:56,column:3}},line:41},"3":{name:"(anonymous_3)",decl:{start:{line:67,column:2},end:{line:67,column:3}},loc:{start:{line:67,column:26},end:{line:76,column:3}},line:67},"4":{name:"(anonymous_4)",decl:{start:{line:87,column:2},end:{line:87,column:3}},loc:{start:{line:87,column:30},end:{line:99,column:3}},line:87},"5":{name:"(anonymous_5)",decl:{start:{line:110,column:2},end:{line:110,column:3}},loc:{start:{line:110,column:33},end:{line:182,column:3}},line:110},"6":{name:"(anonymous_6)",decl:{start:{line:184,column:2},end:{line:184,column:3}},loc:{start:{line:184,column:22},end:{line:210,column:3}},line:184},"7":{name:"(anonymous_7)",decl:{start:{line:212,column:2},end:{line:212,column:3}},loc:{start:{line:212,column:15},end:{line:236,column:3}},line:212}},branchMap:{"0":{loc:{start:{line:44,column:4},end:{line:45,column:18}},type:"if",locations:[{start:{line:44,column:4},end:{line:45,column:18}},{start:{line:44,column:4},end:{line:45,column:18}}],line:44},"1":{loc:{start:{line:67,column:12},end:{line:67,column:24}},type:"default-arg",locations:[{start:{line:67,column:22},end:{line:67,column:24}}],line:67},"2":{loc:{start:{line:87,column:16},end:{line:87,column:28}},type:"default-arg",locations:[{start:{line:87,column:26},end:{line:87,column:28}}],line:87},"3":{loc:{start:{line:110,column:19},end:{line:110,column:31}},type:"default-arg",locations:[{start:{line:110,column:29},end:{line:110,column:31}}],line:110},"4":{loc:{start:{line:114,column:4},end:{line:115,column:16}},type:"if",locations:[{start:{line:114,column:4},end:{line:115,column:16}},{start:{line:114,column:4},end:{line:115,column:16}}],line:114},"5":{loc:{start:{line:119,column:4},end:{line:120,column:16}},type:"if",locations:[{start:{line:119,column:4},end:{line:120,column:16}},{start:{line:119,column:4},end:{line:120,column:16}}],line:119},"6":{loc:{start:{line:127,column:18},end:{line:127,column:55}},type:"binary-expr",locations:[{start:{line:127,column:18},end:{line:127,column:23}},{start:{line:127,column:27},end:{line:127,column:44}},{start:{line:127,column:48},end:{line:127,column:55}}],line:127},"7":{loc:{start:{line:129,column:4},end:{line:130,column:20}},type:"if",locations:[{start:{line:129,column:4},end:{line:130,column:20}},{start:{line:129,column:4},end:{line:130,column:20}}],line:129},"8":{loc:{start:{line:132,column:4},end:{line:176,column:5}},type:"if",locations:[{start:{line:132,column:4},end:{line:176,column:5}},{start:{line:132,column:4},end:{line:176,column:5}}],line:132},"9":{loc:{start:{line:132,column:8},end:{line:132,column:33}},type:"binary-expr",locations:[{start:{line:132,column:8},end:{line:132,column:13}},{start:{line:132,column:17},end:{line:132,column:33}}],line:132},"10":{loc:{start:{line:138,column:8},end:{line:139,column:16}},type:"if",locations:[{start:{line:138,column:8},end:{line:139,column:16}},{start:{line:138,column:8},end:{line:139,column:16}}],line:138},"11":{loc:{start:{line:148,column:6},end:{line:149,column:28}},type:"if",locations:[{start:{line:148,column:6},end:{line:149,column:28}},{start:{line:148,column:6},end:{line:149,column:28}}],line:148},"12":{loc:{start:{line:151,column:6},end:{line:157,column:7}},type:"if",locations:[{start:{line:151,column:6},end:{line:157,column:7}},{start:{line:151,column:6},end:{line:157,column:7}}],line:151},"13":{loc:{start:{line:155,column:8},end:{line:156,column:30}},type:"if",locations:[{start:{line:155,column:8},end:{line:156,column:30}},{start:{line:155,column:8},end:{line:156,column:30}}],line:155},"14":{loc:{start:{line:165,column:6},end:{line:175,column:7}},type:"if",locations:[{start:{line:165,column:6},end:{line:175,column:7}},{start:{line:165,column:6},end:{line:175,column:7}}],line:165},"15":{loc:{start:{line:169,column:8},end:{line:172,column:9}},type:"if",locations:[{start:{line:169,column:8},end:{line:172,column:9}},{start:{line:169,column:8},end:{line:172,column:9}}],line:169},"16":{loc:{start:{line:178,column:4},end:{line:179,column:23}},type:"if",locations:[{start:{line:178,column:4},end:{line:179,column:23}},{start:{line:178,column:4},end:{line:179,column:23}}],line:178},"17":{loc:{start:{line:189,column:4},end:{line:190,column:13}},type:"if",locations:[{start:{line:189,column:4},end:{line:190,column:13}},{start:{line:189,column:4},end:{line:190,column:13}}],line:189},"18":{loc:{start:{line:195,column:6},end:{line:196,column:17}},type:"if",locations:[{start:{line:195,column:6},end:{line:196,column:17}},{start:{line:195,column:6},end:{line:196,column:17}}],line:195},"19":{loc:{start:{line:200,column:6},end:{line:203,column:7}},type:"if",locations:[{start:{line:200,column:6},end:{line:203,column:7}},{start:{line:200,column:6},end:{line:203,column:7}}],line:200},"20":{loc:{start:{line:215,column:4},end:{line:216,column:13}},type:"if",locations:[{start:{line:215,column:4},end:{line:216,column:13}},{start:{line:215,column:4},end:{line:216,column:13}}],line:215},"21":{loc:{start:{line:221,column:6},end:{line:222,column:17}},type:"if",locations:[{start:{line:221,column:6},end:{line:222,column:17}},{start:{line:221,column:6},end:{line:222,column:17}}],line:221},"22":{loc:{start:{line:231,column:6},end:{line:232,column:31}},type:"if",locations:[{start:{line:231,column:6},end:{line:232,column:31}},{start:{line:231,column:6},end:{line:232,column:31}}],line:231}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},b:{"0":[0,0],"1":[0],"2":[0],"3":[0],"4":[0,0],"5":[0,0],"6":[0,0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"370a8d4502c2dd5e02565b8df71a208fe495d20c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_pybcxncsr=function(){return actualCoverage;};}return actualCoverage;}cov_pybcxncsr();const assert=(cov_pybcxncsr().s[0]++,require('bsert'));const{BufferMap}=(cov_pybcxncsr().s[1]++,require('buffer-map'));const TXMeta=(cov_pybcxncsr().s[2]++,require('../primitives/txmeta'));/**
 * Address Indexer
 * @ignore
 */class AddrIndexer{/**
   * Create TX address index.
   * @constructor
   * @param {Network} network
   */constructor(network){cov_pybcxncsr().f[0]++;cov_pybcxncsr().s[3]++;this.network=network;// Map of addr->entries.
cov_pybcxncsr().s[4]++;this.index=new BufferMap();// Map of txid->addrs.
cov_pybcxncsr().s[5]++;this.map=new BufferMap();}reset(){cov_pybcxncsr().f[1]++;cov_pybcxncsr().s[6]++;this.index.clear();cov_pybcxncsr().s[7]++;this.map.clear();}getKey(addr){cov_pybcxncsr().f[2]++;const prefix=(cov_pybcxncsr().s[8]++,addr.getPrefix(this.network));cov_pybcxncsr().s[9]++;if(prefix<0){cov_pybcxncsr().b[0][0]++;cov_pybcxncsr().s[10]++;return null;}else{cov_pybcxncsr().b[0][1]++;}const hash=(cov_pybcxncsr().s[11]++,addr.getHash());const size=(cov_pybcxncsr().s[12]++,hash.length+1);const raw=(cov_pybcxncsr().s[13]++,Buffer.allocUnsafe(size));let written=(cov_pybcxncsr().s[14]++,raw.writeUInt8(prefix));cov_pybcxncsr().s[15]++;written+=hash.copy(raw,1);cov_pybcxncsr().s[16]++;assert(written===size);cov_pybcxncsr().s[17]++;return raw;}/**
   * Get transactions by address.
   * @param {Address} addr
   * @param {Object} options
   * @param {Number} options.limit
   * @param {Number} options.reverse
   * @param {Buffer} options.after
   */get(addr,options=(cov_pybcxncsr().b[1][0]++,{})){cov_pybcxncsr().f[3]++;const values=(cov_pybcxncsr().s[18]++,this.getEntries(addr,options));const out=(cov_pybcxncsr().s[19]++,[]);cov_pybcxncsr().s[20]++;for(const entry of values){cov_pybcxncsr().s[21]++;out.push(entry.tx);}cov_pybcxncsr().s[22]++;return out;}/**
   * Get transaction meta by address.
   * @param {Address} addr
   * @param {Object} options
   * @param {Number} options.limit
   * @param {Number} options.reverse
   * @param {Buffer} options.after
   */getMeta(addr,options=(cov_pybcxncsr().b[2][0]++,{})){cov_pybcxncsr().f[4]++;const values=(cov_pybcxncsr().s[23]++,this.getEntries(addr,options));const out=(cov_pybcxncsr().s[24]++,[]);cov_pybcxncsr().s[25]++;for(const entry of values){const meta=(cov_pybcxncsr().s[26]++,TXMeta.fromTX(entry.tx));cov_pybcxncsr().s[27]++;meta.mtime=entry.time;cov_pybcxncsr().s[28]++;out.push(meta);}cov_pybcxncsr().s[29]++;return out;}/**
   * Get entries by address.
   * @param {Address} addr
   * @param {Object} options
   * @param {Number} options.limit
   * @param {Number} options.reverse
   * @param {Buffer} options.after
   */getEntries(addr,options=(cov_pybcxncsr().b[3][0]++,{})){cov_pybcxncsr().f[5]++;const{limit,reverse,after}=(cov_pybcxncsr().s[30]++,options);const key=(cov_pybcxncsr().s[31]++,this.getKey(addr));cov_pybcxncsr().s[32]++;if(!key){cov_pybcxncsr().b[4][0]++;cov_pybcxncsr().s[33]++;return[];}else{cov_pybcxncsr().b[4][1]++;}const items=(cov_pybcxncsr().s[34]++,this.index.get(key));cov_pybcxncsr().s[35]++;if(!items){cov_pybcxncsr().b[5][0]++;cov_pybcxncsr().s[36]++;return[];}else{cov_pybcxncsr().b[5][1]++;}let values=(cov_pybcxncsr().s[37]++,[]);// Check to see if results should be skipped because
// the after hash is expected to be within a following
// confirmed query.
const skip=(cov_pybcxncsr().s[38]++,(cov_pybcxncsr().b[6][0]++,after)&&(cov_pybcxncsr().b[6][1]++,!items.has(after))&&(cov_pybcxncsr().b[6][2]++,reverse));cov_pybcxncsr().s[39]++;if(skip){cov_pybcxncsr().b[7][0]++;cov_pybcxncsr().s[40]++;return values;}else{cov_pybcxncsr().b[7][1]++;}cov_pybcxncsr().s[41]++;if((cov_pybcxncsr().b[9][0]++,after)&&(cov_pybcxncsr().b[9][1]++,items.has(after))){cov_pybcxncsr().b[8][0]++;// Give results starting from after
// the tx hash for the address.
let index=(cov_pybcxncsr().s[42]++,0);cov_pybcxncsr().s[43]++;for(const k of items.keys()){cov_pybcxncsr().s[44]++;if(k.compare(after)===0){cov_pybcxncsr().b[10][0]++;cov_pybcxncsr().s[45]++;break;}else{cov_pybcxncsr().b[10][1]++;}cov_pybcxncsr().s[46]++;index+=1;}cov_pybcxncsr().s[47]++;values=Array.from(items.values());let start=(cov_pybcxncsr().s[48]++,index+1);let end=(cov_pybcxncsr().s[49]++,values.length);cov_pybcxncsr().s[50]++;if(end-start>limit){cov_pybcxncsr().b[11][0]++;cov_pybcxncsr().s[51]++;end=start+limit;}else{cov_pybcxncsr().b[11][1]++;}cov_pybcxncsr().s[52]++;if(reverse){cov_pybcxncsr().b[12][0]++;cov_pybcxncsr().s[53]++;start=0;cov_pybcxncsr().s[54]++;end=index;cov_pybcxncsr().s[55]++;if(end>limit){cov_pybcxncsr().b[13][0]++;cov_pybcxncsr().s[56]++;start=end-limit;}else{cov_pybcxncsr().b[13][1]++;}}else{cov_pybcxncsr().b[12][1]++;}cov_pybcxncsr().s[57]++;values=values.slice(start,end);}else{cov_pybcxncsr().b[8][1]++;cov_pybcxncsr().s[58]++;// Give earliest or latest results
// for the address.
values=Array.from(items.values());cov_pybcxncsr().s[59]++;if(values.length>limit){cov_pybcxncsr().b[14][0]++;let start=(cov_pybcxncsr().s[60]++,0);let end=(cov_pybcxncsr().s[61]++,limit);cov_pybcxncsr().s[62]++;if(reverse){cov_pybcxncsr().b[15][0]++;cov_pybcxncsr().s[63]++;start=values.length-limit;cov_pybcxncsr().s[64]++;end=values.length;}else{cov_pybcxncsr().b[15][1]++;}cov_pybcxncsr().s[65]++;values=values.slice(start,end);}else{cov_pybcxncsr().b[14][1]++;}}cov_pybcxncsr().s[66]++;if(reverse){cov_pybcxncsr().b[16][0]++;cov_pybcxncsr().s[67]++;values.reverse();}else{cov_pybcxncsr().b[16][1]++;}cov_pybcxncsr().s[68]++;return values;}insert(entry,view){cov_pybcxncsr().f[6]++;const tx=(cov_pybcxncsr().s[69]++,entry.tx);const hash=(cov_pybcxncsr().s[70]++,tx.hash());const addrs=(cov_pybcxncsr().s[71]++,tx.getAddresses(view));cov_pybcxncsr().s[72]++;if(addrs.length===0){cov_pybcxncsr().b[17][0]++;cov_pybcxncsr().s[73]++;return;}else{cov_pybcxncsr().b[17][1]++;}cov_pybcxncsr().s[74]++;for(const addr of addrs){const key=(cov_pybcxncsr().s[75]++,this.getKey(addr));cov_pybcxncsr().s[76]++;if(!key){cov_pybcxncsr().b[18][0]++;cov_pybcxncsr().s[77]++;continue;}else{cov_pybcxncsr().b[18][1]++;}let items=(cov_pybcxncsr().s[78]++,this.index.get(key));cov_pybcxncsr().s[79]++;if(!items){cov_pybcxncsr().b[19][0]++;cov_pybcxncsr().s[80]++;items=new BufferMap();cov_pybcxncsr().s[81]++;this.index.set(key,items);}else{cov_pybcxncsr().b[19][1]++;}cov_pybcxncsr().s[82]++;assert(!items.has(hash));cov_pybcxncsr().s[83]++;items.set(hash,entry);}cov_pybcxncsr().s[84]++;this.map.set(hash,addrs);}remove(hash){cov_pybcxncsr().f[7]++;const addrs=(cov_pybcxncsr().s[85]++,this.map.get(hash));cov_pybcxncsr().s[86]++;if(!addrs){cov_pybcxncsr().b[20][0]++;cov_pybcxncsr().s[87]++;return;}else{cov_pybcxncsr().b[20][1]++;}cov_pybcxncsr().s[88]++;for(const addr of addrs){const key=(cov_pybcxncsr().s[89]++,this.getKey(addr));cov_pybcxncsr().s[90]++;if(!key){cov_pybcxncsr().b[21][0]++;cov_pybcxncsr().s[91]++;continue;}else{cov_pybcxncsr().b[21][1]++;}const items=(cov_pybcxncsr().s[92]++,this.index.get(key));cov_pybcxncsr().s[93]++;assert(items);cov_pybcxncsr().s[94]++;assert(items.has(hash));cov_pybcxncsr().s[95]++;items.delete(hash);cov_pybcxncsr().s[96]++;if(items.size===0){cov_pybcxncsr().b[22][0]++;cov_pybcxncsr().s[97]++;this.index.delete(key);}else{cov_pybcxncsr().b[22][1]++;}}cov_pybcxncsr().s[98]++;this.map.delete(hash);}}/*
 * Expose
 */cov_pybcxncsr().s[99]++;module.exports=AddrIndexer;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZHJpbmRleGVyLmpzIl0sIm5hbWVzIjpbImFzc2VydCIsInJlcXVpcmUiLCJCdWZmZXJNYXAiLCJUWE1ldGEiLCJBZGRySW5kZXhlciIsImNvbnN0cnVjdG9yIiwibmV0d29yayIsImluZGV4IiwibWFwIiwicmVzZXQiLCJjbGVhciIsImdldEtleSIsImFkZHIiLCJwcmVmaXgiLCJnZXRQcmVmaXgiLCJoYXNoIiwiZ2V0SGFzaCIsInNpemUiLCJsZW5ndGgiLCJyYXciLCJCdWZmZXIiLCJhbGxvY1Vuc2FmZSIsIndyaXR0ZW4iLCJ3cml0ZVVJbnQ4IiwiY29weSIsImdldCIsIm9wdGlvbnMiLCJ2YWx1ZXMiLCJnZXRFbnRyaWVzIiwib3V0IiwiZW50cnkiLCJwdXNoIiwidHgiLCJnZXRNZXRhIiwibWV0YSIsImZyb21UWCIsIm10aW1lIiwidGltZSIsImxpbWl0IiwicmV2ZXJzZSIsImFmdGVyIiwia2V5IiwiaXRlbXMiLCJza2lwIiwiaGFzIiwiayIsImtleXMiLCJjb21wYXJlIiwiQXJyYXkiLCJmcm9tIiwic3RhcnQiLCJlbmQiLCJzbGljZSIsImluc2VydCIsInZpZXciLCJhZGRycyIsImdldEFkZHJlc3NlcyIsInNldCIsInJlbW92ZSIsImRlbGV0ZSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUVBLGEsOHVaQVFZO3lGQU5aLEtBQU1BLENBQUFBLE1BQU0seUJBQUdDLE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWixDQUNBLEtBQU0sQ0FBQ0MsU0FBRCwwQkFBY0QsT0FBTyxDQUFDLFlBQUQsQ0FBckIsQ0FBTixDQUNBLEtBQU1FLENBQUFBLE1BQU0seUJBQUdGLE9BQU8sQ0FBQyxzQkFBRCxDQUFWLENBQVosQ0FFQTtBQUNBO0FBQ0E7QUFDQSxHQUVBLEtBQU1HLENBQUFBLFdBQVksQ0FDaEI7QUFDRjtBQUNBO0FBQ0E7QUFDQSxLQUVFQyxXQUFXLENBQUNDLE9BQUQsQ0FB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VCxDQUFhMUMsSUFBYixDQUFtQndDLEtBQW5CLEVBQ0QsQ0FFREcsTUFBTSxDQUFDM0MsSUFBRCxDQUFPLHdCQUNYLEtBQU13QyxDQUFBQSxLQUFLLDBCQUFHLEtBQUsvQyxHQUFMLENBQVNpQixHQUFULENBQWFWLElBQWIsQ0FBSCxDQUFYLENBRFcsd0JBR1gsR0FBSSxDQUFDd0MsS0FBTCxDQUNFLDJEQUFPLENBRFQsaUNBSFcsd0JBTVgsSUFBSyxLQUFNM0MsQ0FBQUEsSUFBWCxHQUFtQjJDLENBQUFBLEtBQW5CLENBQTBCLENBQ3hCLEtBQU1kLENBQUFBLEdBQUcsMEJBQUcsS0FBSzlCLE1BQUwsQ0FBWUMsSUFBWixDQUFILENBQVQsQ0FEd0Isd0JBR3hCLEdBQUksQ0FBQzZCLEdBQUwsQ0FDRSw2REFBUyxDQURYLGlDQUdBLEtBQU1DLENBQUFBLEtBQUssMEJBQUcsS0FBS25DLEtBQUwsQ0FBV2tCLEdBQVgsQ0FBZWdCLEdBQWYsQ0FBSCxDQUFYLENBTndCLHdCQVF4QnpDLE1BQU0sQ0FBQzBDLEtBQUQsQ0FBTixDQVJ3Qix3QkFTeEIxQyxNQUFNLENBQUMwQyxLQUFLLENBQUNFLEdBQU4sQ0FBVTdCLElBQVYsQ0FBRCxDQUFOLENBVHdCLHdCQVd4QjJCLEtBQUssQ0FBQ2lCLE1BQU4sQ0FBYTVDLElBQWIsRUFYd0Isd0JBYXhCLEdBQUkyQixLQUFLLENBQUN6QixJQUFOLEdBQWUsQ0FBbkIsQ0FDRSx5REFBS1YsS0FBTCxDQUFXb0QsTUFBWCxDQUFrQmxCLEdBQWxCLEVBQXVCLENBRHpCLGlDQUVELENBckJVLHdCQXVCWCxLQUFLakMsR0FBTCxDQUFTbUQsTUFBVCxDQUFnQjVDLElBQWhCLEVBQ0QsQ0F6TmUsQ0E0TmxCO0FBQ0E7QUFDQSxHLHdCQUVBNkMsTUFBTSxDQUFDQyxPQUFQLENBQWlCekQsV0FBakIiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcclxuICogbWVtcG9vbC5qcyAtIG1lbXBvb2wgZm9yIGJjb2luXHJcbiAqIENvcHlyaWdodCAoYykgMjAxOC0yMDE5LCB0aGUgYmNvaW4gZGV2ZWxvcGVycyAoTUlUIExpY2Vuc2UpLlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtMjAxNywgQ2hyaXN0b3BoZXIgSmVmZnJleSAoTUlUIExpY2Vuc2UpLlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vYmNvaW4tb3JnL2Jjb2luXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuY29uc3QgYXNzZXJ0ID0gcmVxdWlyZSgnYnNlcnQnKTtcclxuY29uc3Qge0J1ZmZlck1hcH0gPSByZXF1aXJlKCdidWZmZXItbWFwJyk7XHJcbmNvbnN0IFRYTWV0YSA9IHJlcXVpcmUoJy4uL3ByaW1pdGl2ZXMvdHhtZXRhJyk7XHJcblxyXG4vKipcclxuICogQWRkcmVzcyBJbmRleGVyXHJcbiAqIEBpZ25vcmVcclxuICovXHJcblxyXG5jbGFzcyBBZGRySW5kZXhlciB7XHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIFRYIGFkZHJlc3MgaW5kZXguXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICogQHBhcmFtIHtOZXR3b3JrfSBuZXR3b3JrXHJcbiAgICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKG5ldHdvcmspIHtcclxuICAgIHRoaXMubmV0d29yayA9IG5ldHdvcms7XHJcblxyXG4gICAgLy8gTWFwIG9mIGFkZHItPmVudHJpZXMuXHJcbiAgICB0aGlzLmluZGV4ID0gbmV3IEJ1ZmZlck1hcCgpO1xyXG5cclxuICAgIC8vIE1hcCBvZiB0eGlkLT5hZGRycy5cclxuICAgIHRoaXMubWFwID0gbmV3IEJ1ZmZlck1hcCgpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXQoKSB7XHJcbiAgICB0aGlzLmluZGV4LmNsZWFyKCk7XHJcbiAgICB0aGlzLm1hcC5jbGVhcigpO1xyXG4gIH1cclxuXHJcbiAgZ2V0S2V5KGFkZHIpIHtcclxuICAgIGNvbnN0IHByZWZpeCA9IGFkZHIuZ2V0UHJlZml4KHRoaXMubmV0d29yayk7XHJcblxyXG4gICAgaWYgKHByZWZpeCA8IDApXHJcbiAgICAgIHJldHVybiBudWxsO1xyXG5cclxuICAgIGNvbnN0IGhhc2ggPSBhZGRyLmdldEhhc2goKTtcclxuICAgIGNvbnN0IHNpemUgPSBoYXNoLmxlbmd0aCArIDE7XHJcbiAgICBjb25zdCByYXcgPSBCdWZmZXIuYWxsb2NVbnNhZmUoc2l6ZSk7XHJcblxyXG4gICAgbGV0IHdyaXR0ZW4gPSByYXcud3JpdGVVSW50OChwcmVmaXgpO1xyXG4gICAgd3JpdHRlbiArPSBoYXNoLmNvcHkocmF3LCAxKTtcclxuICAgIGFzc2VydCh3cml0dGVuID09PSBzaXplKTtcclxuXHJcbiAgICByZXR1cm4gcmF3O1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHRyYW5zYWN0aW9ucyBieSBhZGRyZXNzLlxyXG4gICAqIEBwYXJhbSB7QWRkcmVzc30gYWRkclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMubGltaXRcclxuICAgKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5yZXZlcnNlXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IG9wdGlvbnMuYWZ0ZXJcclxuICAgKi9cclxuXHJcbiAgZ2V0KGFkZHIsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3QgdmFsdWVzID0gdGhpcy5nZXRFbnRyaWVzKGFkZHIsIG9wdGlvbnMpO1xyXG5cclxuICAgIGNvbnN0IG91dCA9IFtdO1xyXG5cclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgdmFsdWVzKVxyXG4gICAgICBvdXQucHVzaChlbnRyeS50eCk7XHJcblxyXG4gICAgcmV0dXJuIG91dDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCB0cmFuc2FjdGlvbiBtZXRhIGJ5IGFkZHJlc3MuXHJcbiAgICogQHBhcmFtIHtBZGRyZXNzfSBhZGRyXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnNcclxuICAgKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5saW1pdFxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBvcHRpb25zLnJldmVyc2VcclxuICAgKiBAcGFyYW0ge0J1ZmZlcn0gb3B0aW9ucy5hZnRlclxyXG4gICAqL1xyXG5cclxuICBnZXRNZXRhKGFkZHIsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3QgdmFsdWVzID0gdGhpcy5nZXRFbnRyaWVzKGFkZHIsIG9wdGlvbnMpO1xyXG5cclxuICAgIGNvbnN0IG91dCA9IFtdO1xyXG5cclxuICAgIGZvciAoY29uc3QgZW50cnkgb2YgdmFsdWVzKSB7XHJcbiAgICAgIGNvbnN0IG1ldGEgPSBUWE1ldGEuZnJvbVRYKGVudHJ5LnR4KTtcclxuICAgICAgbWV0YS5tdGltZSA9IGVudHJ5LnRpbWU7XHJcbiAgICAgIG91dC5wdXNoKG1ldGEpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBvdXQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZW50cmllcyBieSBhZGRyZXNzLlxyXG4gICAqIEBwYXJhbSB7QWRkcmVzc30gYWRkclxyXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IG9wdGlvbnMubGltaXRcclxuICAgKiBAcGFyYW0ge051bWJlcn0gb3B0aW9ucy5yZXZlcnNlXHJcbiAgICogQHBhcmFtIHtCdWZmZXJ9IG9wdGlvbnMuYWZ0ZXJcclxuICAgKi9cclxuXHJcbiAgZ2V0RW50cmllcyhhZGRyLCBvcHRpb25zID0ge30pIHtcclxuICAgIGNvbnN0IHtsaW1pdCwgcmV2ZXJzZSwgYWZ0ZXJ9ID0gb3B0aW9ucztcclxuICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGFkZHIpO1xyXG5cclxuICAgIGlmICgha2V5KVxyXG4gICAgICByZXR1cm4gW107XHJcblxyXG4gICAgY29uc3QgaXRlbXMgPSB0aGlzLmluZGV4LmdldChrZXkpO1xyXG5cclxuICAgIGlmICghaXRlbXMpXHJcbiAgICAgIHJldHVybiBbXTtcclxuXHJcbiAgICBsZXQgdmFsdWVzID0gW107XHJcblxyXG4gICAgLy8gQ2hlY2sgdG8gc2VlIGlmIHJlc3VsdHMgc2hvdWxkIGJlIHNraXBwZWQgYmVjYXVzZVxyXG4gICAgLy8gdGhlIGFmdGVyIGhhc2ggaXMgZXhwZWN0ZWQgdG8gYmUgd2l0aGluIGEgZm9sbG93aW5nXHJcbiAgICAvLyBjb25maXJtZWQgcXVlcnkuXHJcbiAgICBjb25zdCBza2lwID0gKGFmdGVyICYmICFpdGVtcy5oYXMoYWZ0ZXIpICYmIHJldmVyc2UpO1xyXG5cclxuICAgIGlmIChza2lwKVxyXG4gICAgICByZXR1cm4gdmFsdWVzO1xyXG5cclxuICAgIGlmIChhZnRlciAmJiBpdGVtcy5oYXMoYWZ0ZXIpKSB7XHJcbiAgICAgIC8vIEdpdmUgcmVzdWx0cyBzdGFydGluZyBmcm9tIGFmdGVyXHJcbiAgICAgIC8vIHRoZSB0eCBoYXNoIGZvciB0aGUgYWRkcmVzcy5cclxuICAgICAgbGV0IGluZGV4ID0gMDtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgayBvZiBpdGVtcy5rZXlzKCkpIHtcclxuICAgICAgICBpZiAoay5jb21wYXJlKGFmdGVyKSA9PT0gMClcclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgIGluZGV4ICs9IDE7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhbHVlcyA9IEFycmF5LmZyb20oaXRlbXMudmFsdWVzKCkpO1xyXG5cclxuICAgICAgbGV0IHN0YXJ0ID0gaW5kZXggKyAxO1xyXG4gICAgICBsZXQgZW5kID0gdmFsdWVzLmxlbmd0aDtcclxuXHJcbiAgICAgIGlmIChlbmQgLSBzdGFydCA+IGxpbWl0KVxyXG4gICAgICAgIGVuZCA9IHN0YXJ0ICsgbGltaXQ7XHJcblxyXG4gICAgICBpZiAocmV2ZXJzZSkge1xyXG4gICAgICAgIHN0YXJ0ID0gMDtcclxuICAgICAgICBlbmQgPSBpbmRleDtcclxuXHJcbiAgICAgICAgaWYgKGVuZCA+IGxpbWl0KVxyXG4gICAgICAgICAgc3RhcnQgPSBlbmQgLSBsaW1pdDtcclxuICAgICAgfVxyXG5cclxuICAgICAgdmFsdWVzID0gdmFsdWVzLnNsaWNlKHN0YXJ0LCBlbmQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gR2l2ZSBlYXJsaWVzdCBvciBsYXRlc3QgcmVzdWx0c1xyXG4gICAgICAvLyBmb3IgdGhlIGFkZHJlc3MuXHJcbiAgICAgIHZhbHVlcyA9IEFycmF5LmZyb20oaXRlbXMudmFsdWVzKCkpO1xyXG5cclxuICAgICAgaWYgKHZhbHVlcy5sZW5ndGggPiBsaW1pdCkge1xyXG4gICAgICAgIGxldCBzdGFydCA9IDA7XHJcbiAgICAgICAgbGV0IGVuZCA9IGxpbWl0O1xyXG5cclxuICAgICAgICBpZiAocmV2ZXJzZSkge1xyXG4gICAgICAgICAgc3RhcnQgPSB2YWx1ZXMubGVuZ3RoIC0gbGltaXQ7XHJcbiAgICAgICAgICBlbmQgPSB2YWx1ZXMubGVuZ3RoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFsdWVzID0gdmFsdWVzLnNsaWNlKHN0YXJ0LCBlbmQpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHJldmVyc2UpXHJcbiAgICAgIHZhbHVlcy5yZXZlcnNlKCk7XHJcblxyXG4gICAgcmV0dXJuIHZhbHVlcztcclxuICB9XHJcblxyXG4gIGluc2VydChlbnRyeSwgdmlldykge1xyXG4gICAgY29uc3QgdHggPSBlbnRyeS50eDtcclxuICAgIGNvbnN0IGhhc2ggPSB0eC5oYXNoKCk7XHJcbiAgICBjb25zdCBhZGRycyA9IHR4LmdldEFkZHJlc3Nlcyh2aWV3KTtcclxuXHJcbiAgICBpZiAoYWRkcnMubGVuZ3RoID09PSAwKVxyXG4gICAgICByZXR1cm47XHJcblxyXG4gICAgZm9yIChjb25zdCBhZGRyIG9mIGFkZHJzKSB7XHJcbiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGFkZHIpO1xyXG5cclxuICAgICAgaWYgKCFrZXkpXHJcbiAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICBsZXQgaXRlbXMgPSB0aGlzLmluZGV4LmdldChrZXkpO1xyXG5cclxuICAgICAgaWYgKCFpdGVtcykge1xyXG4gICAgICAgIGl0ZW1zID0gbmV3IEJ1ZmZlck1hcCgpO1xyXG4gICAgICAgIHRoaXMuaW5kZXguc2V0KGtleSwgaXRlbXMpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBhc3NlcnQoIWl0ZW1zLmhhcyhoYXNoKSk7XHJcbiAgICAgIGl0ZW1zLnNldChoYXNoLCBlbnRyeSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tYXAuc2V0KGhhc2gsIGFkZHJzKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZShoYXNoKSB7XHJcbiAgICBjb25zdCBhZGRycyA9IHRoaXMubWFwLmdldChoYXNoKTtcclxuXHJcbiAgICBpZiAoIWFkZHJzKVxyXG4gICAgICByZXR1cm47XHJcblxyXG4gICAgZm9yIChjb25zdCBhZGRyIG9mIGFkZHJzKSB7XHJcbiAgICAgIGNvbnN0IGtleSA9IHRoaXMuZ2V0S2V5KGFkZHIpO1xyXG5cclxuICAgICAgaWYgKCFrZXkpXHJcbiAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICBjb25zdCBpdGVtcyA9IHRoaXMuaW5kZXguZ2V0KGtleSk7XHJcblxyXG4gICAgICBhc3NlcnQoaXRlbXMpO1xyXG4gICAgICBhc3NlcnQoaXRlbXMuaGFzKGhhc2gpKTtcclxuXHJcbiAgICAgIGl0ZW1zLmRlbGV0ZShoYXNoKTtcclxuXHJcbiAgICAgIGlmIChpdGVtcy5zaXplID09PSAwKVxyXG4gICAgICAgIHRoaXMuaW5kZXguZGVsZXRlKGtleSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tYXAuZGVsZXRlKGhhc2gpO1xyXG4gIH1cclxufVxyXG5cclxuLypcclxuICogRXhwb3NlXHJcbiAqL1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBBZGRySW5kZXhlcjtcclxuIl19