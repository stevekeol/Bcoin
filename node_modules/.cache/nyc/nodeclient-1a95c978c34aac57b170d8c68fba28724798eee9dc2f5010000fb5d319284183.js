/*!
 * nodeclient.js - node client for bcoin
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_2amc8nkmf6(){var path="E:\\Projects\\Test\\bcoin\\lib\\wallet\\nodeclient.js";var hash="3b399f142d2ba02ae5c3903f9de036c619526db8";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\wallet\\nodeclient.js",statementMap:{"0":{start:{line:9,column:15},end:{line:9,column:31}},"1":{start:{line:10,column:21},end:{line:10,column:38}},"2":{start:{line:24,column:4},end:{line:24,column:12}},"3":{start:{line:26,column:4},end:{line:26,column:21}},"4":{start:{line:27,column:4},end:{line:27,column:32}},"5":{start:{line:28,column:4},end:{line:28,column:23}},"6":{start:{line:29,column:4},end:{line:29,column:24}},"7":{start:{line:31,column:4},end:{line:31,column:16}},"8":{start:{line:39,column:4},end:{line:44,column:7}},"9":{start:{line:40,column:6},end:{line:41,column:15}},"10":{start:{line:41,column:8},end:{line:41,column:15}},"11":{start:{line:43,column:6},end:{line:43,column:62}},"12":{start:{line:46,column:4},end:{line:51,column:7}},"13":{start:{line:47,column:6},end:{line:48,column:15}},"14":{start:{line:48,column:8},end:{line:48,column:15}},"15":{start:{line:50,column:6},end:{line:50,column:54}},"16":{start:{line:53,column:4},end:{line:58,column:7}},"17":{start:{line:54,column:6},end:{line:55,column:15}},"18":{start:{line:55,column:8},end:{line:55,column:15}},"19":{start:{line:57,column:6},end:{line:57,column:26}},"20":{start:{line:60,column:4},end:{line:65,column:7}},"21":{start:{line:61,column:6},end:{line:62,column:15}},"22":{start:{line:62,column:8},end:{line:62,column:15}},"23":{start:{line:64,column:6},end:{line:64,column:36}},"24":{start:{line:74,column:4},end:{line:74,column:56}},"25":{start:{line:75,column:4},end:{line:75,column:23}},"26":{start:{line:76,column:4},end:{line:76,column:45}},"27":{start:{line:76,column:23},end:{line:76,column:43}},"28":{start:{line:85,column:4},end:{line:85,column:51}},"29":{start:{line:86,column:4},end:{line:86,column:24}},"30":{start:{line:87,column:4},end:{line:87,column:48}},"31":{start:{line:87,column:23},end:{line:87,column:46}},"32":{start:{line:97,column:4},end:{line:97,column:34}},"33":{start:{line:107,column:4},end:{line:107,column:34}},"34":{start:{line:116,column:4},end:{line:116,column:31}},"35":{start:{line:126,column:18},end:{line:126,column:54}},"36":{start:{line:128,column:4},end:{line:129,column:18}},"37":{start:{line:129,column:6},end:{line:129,column:18}},"38":{start:{line:131,column:4},end:{line:132,column:18}},"39":{start:{line:132,column:6},end:{line:132,column:18}},"40":{start:{line:134,column:4},end:{line:134,column:17}},"41":{start:{line:144,column:4},end:{line:144,column:24}},"42":{start:{line:154,column:4},end:{line:154,column:25}},"43":{start:{line:155,column:4},end:{line:155,column:37}},"44":{start:{line:165,column:4},end:{line:165,column:37}},"45":{start:{line:174,column:4},end:{line:174,column:37}},"46":{start:{line:184,column:4},end:{line:185,column:42}},"47":{start:{line:185,column:6},end:{line:185,column:42}},"48":{start:{line:187,column:16},end:{line:187,column:50}},"49":{start:{line:188,column:4},end:{line:188,column:23}},"50":{start:{line:199,column:4},end:{line:199,column:49}},"51":{start:{line:211,column:4},end:{line:212,column:42}},"52":{start:{line:212,column:6},end:{line:212,column:42}},"53":{start:{line:214,column:4},end:{line:216,column:7}},"54":{start:{line:215,column:6},end:{line:215,column:56}},"55":{start:{line:224,column:0},end:{line:224,column:28}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:23,column:2},end:{line:23,column:3}},loc:{start:{line:23,column:20},end:{line:32,column:3}},line:23},"1":{name:"(anonymous_1)",decl:{start:{line:38,column:2},end:{line:38,column:3}},loc:{start:{line:38,column:9},end:{line:66,column:3}},line:38},"2":{name:"(anonymous_2)",decl:{start:{line:39,column:34},end:{line:39,column:35}},loc:{start:{line:39,column:58},end:{line:44,column:5}},line:39},"3":{name:"(anonymous_3)",decl:{start:{line:46,column:37},end:{line:46,column:38}},loc:{start:{line:46,column:61},end:{line:51,column:5}},line:46},"4":{name:"(anonymous_4)",decl:{start:{line:53,column:23},end:{line:53,column:24}},loc:{start:{line:53,column:31},end:{line:58,column:5}},line:53},"5":{name:"(anonymous_5)",decl:{start:{line:60,column:26},end:{line:60,column:27}},loc:{start:{line:60,column:35},end:{line:65,column:5}},line:60},"6":{name:"(anonymous_6)",decl:{start:{line:73,column:2},end:{line:73,column:3}},loc:{start:{line:73,column:22},end:{line:77,column:3}},line:73},"7":{name:"(anonymous_7)",decl:{start:{line:76,column:17},end:{line:76,column:18}},loc:{start:{line:76,column:23},end:{line:76,column:43}},line:76},"8":{name:"(anonymous_8)",decl:{start:{line:84,column:2},end:{line:84,column:3}},loc:{start:{line:84,column:16},end:{line:88,column:3}},line:84},"9":{name:"(anonymous_9)",decl:{start:{line:87,column:17},end:{line:87,column:18}},loc:{start:{line:87,column:23},end:{line:87,column:46}},line:87},"10":{name:"(anonymous_10)",decl:{start:{line:96,column:2},end:{line:96,column:3}},loc:{start:{line:96,column:22},end:{line:98,column:3}},line:96},"11":{name:"(anonymous_11)",decl:{start:{line:106,column:2},end:{line:106,column:3}},loc:{start:{line:106,column:22},end:{line:108,column:3}},line:106},"12":{name:"(anonymous_12)",decl:{start:{line:115,column:2},end:{line:115,column:3}},loc:{start:{line:115,column:17},end:{line:117,column:3}},line:115},"13":{name:"(anonymous_13)",decl:{start:{line:125,column:2},end:{line:125,column:3}},loc:{start:{line:125,column:23},end:{line:135,column:3}},line:125},"14":{name:"(anonymous_14)",decl:{start:{line:143,column:2},end:{line:143,column:3}},loc:{start:{line:143,column:17},end:{line:145,column:3}},line:143},"15":{name:"(anonymous_15)",decl:{start:{line:153,column:2},end:{line:153,column:3}},loc:{start:{line:153,column:26},end:{line:156,column:3}},line:153},"16":{name:"(anonymous_16)",decl:{start:{line:164,column:2},end:{line:164,column:3}},loc:{start:{line:164,column:24},end:{line:166,column:3}},line:164},"17":{name:"(anonymous_17)",decl:{start:{line:173,column:2},end:{line:173,column:3}},loc:{start:{line:173,column:22},end:{line:175,column:3}},line:173},"18":{name:"(anonymous_18)",decl:{start:{line:183,column:2},end:{line:183,column:3}},loc:{start:{line:183,column:28},end:{line:189,column:3}},line:183},"19":{name:"(anonymous_19)",decl:{start:{line:198,column:2},end:{line:198,column:3}},loc:{start:{line:198,column:40},end:{line:200,column:3}},line:198},"20":{name:"(anonymous_20)",decl:{start:{line:210,column:2},end:{line:210,column:3}},loc:{start:{line:210,column:22},end:{line:217,column:3}},line:210},"21":{name:"(anonymous_21)",decl:{start:{line:214,column:52},end:{line:214,column:53}},loc:{start:{line:214,column:68},end:{line:216,column:5}},line:214}},branchMap:{"0":{loc:{start:{line:40,column:6},end:{line:41,column:15}},type:"if",locations:[{start:{line:40,column:6},end:{line:41,column:15}},{start:{line:40,column:6},end:{line:41,column:15}}],line:40},"1":{loc:{start:{line:47,column:6},end:{line:48,column:15}},type:"if",locations:[{start:{line:47,column:6},end:{line:48,column:15}},{start:{line:47,column:6},end:{line:48,column:15}}],line:47},"2":{loc:{start:{line:54,column:6},end:{line:55,column:15}},type:"if",locations:[{start:{line:54,column:6},end:{line:55,column:15}},{start:{line:54,column:6},end:{line:55,column:15}}],line:54},"3":{loc:{start:{line:61,column:6},end:{line:62,column:15}},type:"if",locations:[{start:{line:61,column:6},end:{line:62,column:15}},{start:{line:61,column:6},end:{line:62,column:15}}],line:61},"4":{loc:{start:{line:128,column:4},end:{line:129,column:18}},type:"if",locations:[{start:{line:128,column:4},end:{line:129,column:18}},{start:{line:128,column:4},end:{line:129,column:18}}],line:128},"5":{loc:{start:{line:131,column:4},end:{line:132,column:18}},type:"if",locations:[{start:{line:131,column:4},end:{line:132,column:18}},{start:{line:131,column:4},end:{line:132,column:18}}],line:131},"6":{loc:{start:{line:184,column:4},end:{line:185,column:42}},type:"if",locations:[{start:{line:184,column:4},end:{line:185,column:42}},{start:{line:184,column:4},end:{line:185,column:42}}],line:184},"7":{loc:{start:{line:198,column:18},end:{line:198,column:28}},type:"default-arg",locations:[{start:{line:198,column:26},end:{line:198,column:28}}],line:198},"8":{loc:{start:{line:198,column:30},end:{line:198,column:38}},type:"default-arg",locations:[{start:{line:198,column:36},end:{line:198,column:38}}],line:198},"9":{loc:{start:{line:211,column:4},end:{line:212,column:42}},type:"if",locations:[{start:{line:211,column:4},end:{line:212,column:42}},{start:{line:211,column:4},end:{line:212,column:42}}],line:211}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0],"8":[0],"9":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"3b399f142d2ba02ae5c3903f9de036c619526db8"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2amc8nkmf6=function(){return actualCoverage;};}return actualCoverage;}cov_2amc8nkmf6();const assert=(cov_2amc8nkmf6().s[0]++,require('bsert'));const AsyncEmitter=(cov_2amc8nkmf6().s[1]++,require('bevent'));/**
 * Node Client
 * @alias module:node.NodeClient
 */class NodeClient extends AsyncEmitter{/**
   * Create a node client.
   * @constructor
   */constructor(node){cov_2amc8nkmf6().f[0]++;cov_2amc8nkmf6().s[2]++;super();cov_2amc8nkmf6().s[3]++;this.node=node;cov_2amc8nkmf6().s[4]++;this.network=node.network;cov_2amc8nkmf6().s[5]++;this.filter=null;cov_2amc8nkmf6().s[6]++;this.opened=false;cov_2amc8nkmf6().s[7]++;this.init();}/**
   * Initialize the client.
   */init(){cov_2amc8nkmf6().f[1]++;cov_2amc8nkmf6().s[8]++;this.node.chain.on('connect',async(entry,block)=>{cov_2amc8nkmf6().f[2]++;cov_2amc8nkmf6().s[9]++;if(!this.opened){cov_2amc8nkmf6().b[0][0]++;cov_2amc8nkmf6().s[10]++;return;}else{cov_2amc8nkmf6().b[0][1]++;}cov_2amc8nkmf6().s[11]++;await this.emitAsync('block connect',entry,block.txs);});cov_2amc8nkmf6().s[12]++;this.node.chain.on('disconnect',async(entry,block)=>{cov_2amc8nkmf6().f[3]++;cov_2amc8nkmf6().s[13]++;if(!this.opened){cov_2amc8nkmf6().b[1][0]++;cov_2amc8nkmf6().s[14]++;return;}else{cov_2amc8nkmf6().b[1][1]++;}cov_2amc8nkmf6().s[15]++;await this.emitAsync('block disconnect',entry);});cov_2amc8nkmf6().s[16]++;this.node.on('tx',tx=>{cov_2amc8nkmf6().f[4]++;cov_2amc8nkmf6().s[17]++;if(!this.opened){cov_2amc8nkmf6().b[2][0]++;cov_2amc8nkmf6().s[18]++;return;}else{cov_2amc8nkmf6().b[2][1]++;}cov_2amc8nkmf6().s[19]++;this.emit('tx',tx);});cov_2amc8nkmf6().s[20]++;this.node.on('reset',tip=>{cov_2amc8nkmf6().f[5]++;cov_2amc8nkmf6().s[21]++;if(!this.opened){cov_2amc8nkmf6().b[3][0]++;cov_2amc8nkmf6().s[22]++;return;}else{cov_2amc8nkmf6().b[3][1]++;}cov_2amc8nkmf6().s[23]++;this.emit('chain reset',tip);});}/**
   * Open the client.
   * @returns {Promise}
   */async open(options){cov_2amc8nkmf6().f[6]++;cov_2amc8nkmf6().s[24]++;assert(!this.opened,'NodeClient is already open.');cov_2amc8nkmf6().s[25]++;this.opened=true;cov_2amc8nkmf6().s[26]++;setImmediate(()=>{cov_2amc8nkmf6().f[7]++;cov_2amc8nkmf6().s[27]++;return this.emit('connect');});}/**
   * Close the client.
   * @returns {Promise}
   */async close(){cov_2amc8nkmf6().f[8]++;cov_2amc8nkmf6().s[28]++;assert(this.opened,'NodeClient is not open.');cov_2amc8nkmf6().s[29]++;this.opened=false;cov_2amc8nkmf6().s[30]++;setImmediate(()=>{cov_2amc8nkmf6().f[9]++;cov_2amc8nkmf6().s[31]++;return this.emit('disconnect');});}/**
   * Add a listener.
   * @param {String} type
   * @param {Function} handler
   */bind(type,handler){cov_2amc8nkmf6().f[10]++;cov_2amc8nkmf6().s[32]++;return this.on(type,handler);}/**
   * Add a listener.
   * @param {String} type
   * @param {Function} handler
   */hook(type,handler){cov_2amc8nkmf6().f[11]++;cov_2amc8nkmf6().s[33]++;return this.on(type,handler);}/**
   * Get chain tip.
   * @returns {Promise}
   */async getTip(){cov_2amc8nkmf6().f[12]++;cov_2amc8nkmf6().s[34]++;return this.node.chain.tip;}/**
   * Get chain entry.
   * @param {Hash} hash
   * @returns {Promise}
   */async getEntry(hash){cov_2amc8nkmf6().f[13]++;const entry=(cov_2amc8nkmf6().s[35]++,await this.node.chain.getEntry(hash));cov_2amc8nkmf6().s[36]++;if(!entry){cov_2amc8nkmf6().b[4][0]++;cov_2amc8nkmf6().s[37]++;return null;}else{cov_2amc8nkmf6().b[4][1]++;}cov_2amc8nkmf6().s[38]++;if(!(await this.node.chain.isMainChain(entry))){cov_2amc8nkmf6().b[5][0]++;cov_2amc8nkmf6().s[39]++;return null;}else{cov_2amc8nkmf6().b[5][1]++;}cov_2amc8nkmf6().s[40]++;return entry;}/**
   * Send a transaction. Do not wait for promise.
   * @param {TX} tx
   * @returns {Promise}
   */async send(tx){cov_2amc8nkmf6().f[14]++;cov_2amc8nkmf6().s[41]++;this.node.relay(tx);}/**
   * Set bloom filter.
   * @param {Bloom} filter
   * @returns {Promise}
   */async setFilter(filter){cov_2amc8nkmf6().f[15]++;cov_2amc8nkmf6().s[42]++;this.filter=filter;cov_2amc8nkmf6().s[43]++;this.node.pool.setFilter(filter);}/**
   * Add data to filter.
   * @param {Buffer} data
   * @returns {Promise}
   */async addFilter(data){cov_2amc8nkmf6().f[16]++;cov_2amc8nkmf6().s[44]++;this.node.pool.queueFilterLoad();}/**
   * Reset filter.
   * @returns {Promise}
   */async resetFilter(){cov_2amc8nkmf6().f[17]++;cov_2amc8nkmf6().s[45]++;this.node.pool.queueFilterLoad();}/**
   * Estimate smart fee.
   * @param {Number?} blocks
   * @returns {Promise}
   */async estimateFee(blocks){cov_2amc8nkmf6().f[18]++;cov_2amc8nkmf6().s[46]++;if(!this.node.fees){cov_2amc8nkmf6().b[6][0]++;cov_2amc8nkmf6().s[47]++;return{rate:this.network.feeRate};}else{cov_2amc8nkmf6().b[6][1]++;}const fee=(cov_2amc8nkmf6().s[48]++,this.node.fees.estimateFee(blocks));cov_2amc8nkmf6().s[49]++;return{rate:fee};}/**
   * Get hash range.
   * @param {Number} start
   * @param {Number} end
   * @returns {Promise}
   */async getHashes(start=(cov_2amc8nkmf6().b[7][0]++,-1),end=(cov_2amc8nkmf6().b[8][0]++,-1)){cov_2amc8nkmf6().f[19]++;cov_2amc8nkmf6().s[50]++;return this.node.chain.getHashes(start,end);}/**
   * Rescan for any missed transactions.
   * @param {Number|Hash} start - Start block.
   * @param {Bloom} filter
   * @param {Function} iter - Iterator.
   * @returns {Promise}
   */async rescan(start){cov_2amc8nkmf6().f[20]++;cov_2amc8nkmf6().s[51]++;if(this.node.spv){cov_2amc8nkmf6().b[9][0]++;cov_2amc8nkmf6().s[52]++;return this.node.chain.reset(start);}else{cov_2amc8nkmf6().b[9][1]++;}cov_2amc8nkmf6().s[53]++;return this.node.chain.scan(start,this.filter,(entry,txs)=>{cov_2amc8nkmf6().f[21]++;cov_2amc8nkmf6().s[54]++;return this.emitAsync('block rescan',entry,txs);});}}/*
 * Expose
 */cov_2amc8nkmf6().s[55]++;module.exports=NodeClient;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVjbGllbnQuanMiXSwibmFtZXMiOlsiYXNzZXJ0IiwicmVxdWlyZSIsIkFzeW5jRW1pdHRlciIsIk5vZGVDbGllbnQiLCJjb25zdHJ1Y3RvciIsIm5vZGUiLCJuZXR3b3JrIiwiZmlsdGVyIiwib3BlbmVkIiwiaW5pdCIsImNoYWluIiwib24iLCJlbnRyeSIsImJsb2NrIiwiZW1pdEFzeW5jIiwidHhzIiwidHgiLCJlbWl0IiwidGlwIiwib3BlbiIsIm9wdGlvbnMiLCJzZXRJbW1lZGlhdGUiLCJjbG9zZSIsImJpbmQiLCJ0eXBlIiwiaGFuZGxlciIsImhvb2siLCJnZXRUaXAiLCJnZXRFbnRyeSIsImhhc2giLCJpc01haW5DaGFpbiIsInNlbmQiLCJyZWxheSIsInNldEZpbHRlciIsInBvb2wiLCJhZGRGaWx0ZXIiLCJkYXRhIiwicXVldWVGaWx0ZXJMb2FkIiwicmVzZXRGaWx0ZXIiLCJlc3RpbWF0ZUZlZSIsImJsb2NrcyIsImZlZXMiLCJyYXRlIiwiZmVlUmF0ZSIsImZlZSIsImdldEhhc2hlcyIsInN0YXJ0IiwiZW5kIiwicmVzY2FuIiwic3B2IiwicmVzZXQiLCJzY2FuIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUVBLGEseTFTQVNZOzJGQVBaLEtBQU1BLENBQUFBLE1BQU0sMEJBQUdDLE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWixDQUNBLEtBQU1DLENBQUFBLFlBQVksMEJBQUdELE9BQU8sQ0FBQyxRQUFELENBQVYsQ0FBbEIsQ0FFQTtBQUNBO0FBQ0E7QUFDQSxHQUVBLEtBQU1FLENBQUFBLFVBQU4sUUFBeUJELENBQUFBLFlBQWEsQ0FDcEM7QUFDRjtBQUNBO0FBQ0EsS0FFRUUsV0FBVyxDQUFDQyxJQUFELENBQU8saURBQ2hCLFFBRGdCLHdCQUdoQixLQUFLQSxJQUFMLENBQVlBLElBQVosQ0FIZ0Isd0JBSWhCLEtBQUtDLE9BQUwsQ0FBZUQsSUFBSSxDQUFDQyxPQUFw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QUFMLENBQVVvQyxJQUFWLENBQWVGLFdBQWYsQ0FBMkJDLE1BQTNCLENBQUgsQ0FBVCxDQUp3Qix5QkFLeEIsTUFBTyxDQUFDRSxJQUFJLENBQUVFLEdBQVAsQ0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBRUUsS0FBTUMsQ0FBQUEsU0FBTixDQUFnQkMsS0FBSyw2QkFBRyxDQUFDLENBQUosQ0FBckIsQ0FBNEJDLEdBQUcsNkJBQUcsQ0FBQyxDQUFKLENBQS9CLENBQXNDLG1EQUNwQyxNQUFPLE1BQUsxQyxJQUFMLENBQVVLLEtBQVYsQ0FBZ0JtQyxTQUFoQixDQUEwQkMsS0FBMUIsQ0FBaUNDLEdBQWpDLENBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBRUUsS0FBTUMsQ0FBQUEsTUFBTixDQUFhRixLQUFiLENBQW9CLG1EQUNsQixHQUFJLEtBQUt6QyxJQUFMLENBQVU0QyxHQUFkLENBQ0UsMkRBQU8sTUFBSzVDLElBQUwsQ0FBVUssS0FBVixDQUFnQndDLEtBQWhCLENBQXNCSixLQUF0QixDQUFQLENBQW9DLENBRHRDLGlDQURrQix5QkFJbEIsTUFBTyxNQUFLekMsSUFBTCxDQUFVSyxLQUFWLENBQWdCeUMsSUFBaEIsQ0FBcUJMLEtBQXJCLENBQTRCLEtBQUt2QyxNQUFqQyxDQUF5QyxDQUFDSyxLQUFELENBQVFHLEdBQVIsR0FBZ0IsbURBQzlELE1BQU8sTUFBS0QsU0FBTCxDQUFlLGNBQWYsQ0FBK0JGLEtBQS9CLENBQXNDRyxHQUF0QyxDQUFQLENBQ0QsQ0FGTSxDQUFQLENBR0QsQ0F4TW1DLENBMk10QztBQUNBO0FBQ0EsRyx5QkFFQXFDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQmxELFVBQWpCIiwic291cmNlc0NvbnRlbnQiOlsiLyohXHJcbiAqIG5vZGVjbGllbnQuanMgLSBub2RlIGNsaWVudCBmb3IgYmNvaW5cclxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMTcsIENocmlzdG9waGVyIEplZmZyZXkgKE1JVCBMaWNlbnNlKS5cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2Jjb2luLW9yZy9iY29pblxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoJ2JzZXJ0Jyk7XHJcbmNvbnN0IEFzeW5jRW1pdHRlciA9IHJlcXVpcmUoJ2JldmVudCcpO1xyXG5cclxuLyoqXHJcbiAqIE5vZGUgQ2xpZW50XHJcbiAqIEBhbGlhcyBtb2R1bGU6bm9kZS5Ob2RlQ2xpZW50XHJcbiAqL1xyXG5cclxuY2xhc3MgTm9kZUNsaWVudCBleHRlbmRzIEFzeW5jRW1pdHRlciB7XHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIGEgbm9kZSBjbGllbnQuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKG5vZGUpIHtcclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgdGhpcy5ub2RlID0gbm9kZTtcclxuICAgIHRoaXMubmV0d29yayA9IG5vZGUubmV0d29yaztcclxuICAgIHRoaXMuZmlsdGVyID0gbnVsbDtcclxuICAgIHRoaXMub3BlbmVkID0gZmFsc2U7XHJcblxyXG4gICAgdGhpcy5pbml0KCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbml0aWFsaXplIHRoZSBjbGllbnQuXHJcbiAgICovXHJcblxyXG4gIGluaXQoKSB7XHJcbiAgICB0aGlzLm5vZGUuY2hhaW4ub24oJ2Nvbm5lY3QnLCBhc3luYyAoZW50cnksIGJsb2NrKSA9PiB7XHJcbiAgICAgIGlmICghdGhpcy5vcGVuZWQpXHJcbiAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgYXdhaXQgdGhpcy5lbWl0QXN5bmMoJ2Jsb2NrIGNvbm5lY3QnLCBlbnRyeSwgYmxvY2sudHhzKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMubm9kZS5jaGFpbi5vbignZGlzY29ubmVjdCcsIGFzeW5jIChlbnRyeSwgYmxvY2spID0+IHtcclxuICAgICAgaWYgKCF0aGlzLm9wZW5lZClcclxuICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICBhd2FpdCB0aGlzLmVtaXRBc3luYygnYmxvY2sgZGlzY29ubmVjdCcsIGVudHJ5KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMubm9kZS5vbigndHgnLCAodHgpID0+IHtcclxuICAgICAgaWYgKCF0aGlzLm9wZW5lZClcclxuICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICB0aGlzLmVtaXQoJ3R4JywgdHgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5ub2RlLm9uKCdyZXNldCcsICh0aXApID0+IHtcclxuICAgICAgaWYgKCF0aGlzLm9wZW5lZClcclxuICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICB0aGlzLmVtaXQoJ2NoYWluIHJlc2V0JywgdGlwKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3BlbiB0aGUgY2xpZW50LlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBvcGVuKG9wdGlvbnMpIHtcclxuICAgIGFzc2VydCghdGhpcy5vcGVuZWQsICdOb2RlQ2xpZW50IGlzIGFscmVhZHkgb3Blbi4nKTtcclxuICAgIHRoaXMub3BlbmVkID0gdHJ1ZTtcclxuICAgIHNldEltbWVkaWF0ZSgoKSA9PiB0aGlzLmVtaXQoJ2Nvbm5lY3QnKSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDbG9zZSB0aGUgY2xpZW50LlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBjbG9zZSgpIHtcclxuICAgIGFzc2VydCh0aGlzLm9wZW5lZCwgJ05vZGVDbGllbnQgaXMgbm90IG9wZW4uJyk7XHJcbiAgICB0aGlzLm9wZW5lZCA9IGZhbHNlO1xyXG4gICAgc2V0SW1tZWRpYXRlKCgpID0+IHRoaXMuZW1pdCgnZGlzY29ubmVjdCcpKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBhIGxpc3RlbmVyLlxyXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB0eXBlXHJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaGFuZGxlclxyXG4gICAqL1xyXG5cclxuICBiaW5kKHR5cGUsIGhhbmRsZXIpIHtcclxuICAgIHJldHVybiB0aGlzLm9uKHR5cGUsIGhhbmRsZXIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGEgbGlzdGVuZXIuXHJcbiAgICogQHBhcmFtIHtTdHJpbmd9IHR5cGVcclxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBoYW5kbGVyXHJcbiAgICovXHJcblxyXG4gIGhvb2sodHlwZSwgaGFuZGxlcikge1xyXG4gICAgcmV0dXJuIHRoaXMub24odHlwZSwgaGFuZGxlcik7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgY2hhaW4gdGlwLlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBnZXRUaXAoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5ub2RlLmNoYWluLnRpcDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdldCBjaGFpbiBlbnRyeS5cclxuICAgKiBAcGFyYW0ge0hhc2h9IGhhc2hcclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgZ2V0RW50cnkoaGFzaCkge1xyXG4gICAgY29uc3QgZW50cnkgPSBhd2FpdCB0aGlzLm5vZGUuY2hhaW4uZ2V0RW50cnkoaGFzaCk7XHJcblxyXG4gICAgaWYgKCFlbnRyeSlcclxuICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgaWYgKCFhd2FpdCB0aGlzLm5vZGUuY2hhaW4uaXNNYWluQ2hhaW4oZW50cnkpKVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICByZXR1cm4gZW50cnk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZW5kIGEgdHJhbnNhY3Rpb24uIERvIG5vdCB3YWl0IGZvciBwcm9taXNlLlxyXG4gICAqIEBwYXJhbSB7VFh9IHR4XHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIHNlbmQodHgpIHtcclxuICAgIHRoaXMubm9kZS5yZWxheSh0eCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXQgYmxvb20gZmlsdGVyLlxyXG4gICAqIEBwYXJhbSB7Qmxvb219IGZpbHRlclxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBzZXRGaWx0ZXIoZmlsdGVyKSB7XHJcbiAgICB0aGlzLmZpbHRlciA9IGZpbHRlcjtcclxuICAgIHRoaXMubm9kZS5wb29sLnNldEZpbHRlcihmaWx0ZXIpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGRhdGEgdG8gZmlsdGVyLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIGFkZEZpbHRlcihkYXRhKSB7XHJcbiAgICB0aGlzLm5vZGUucG9vbC5xdWV1ZUZpbHRlckxvYWQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc2V0IGZpbHRlci5cclxuICAgKiBAcmV0dXJucyB7UHJvbWlzZX1cclxuICAgKi9cclxuXHJcbiAgYXN5bmMgcmVzZXRGaWx0ZXIoKSB7XHJcbiAgICB0aGlzLm5vZGUucG9vbC5xdWV1ZUZpbHRlckxvYWQoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEVzdGltYXRlIHNtYXJ0IGZlZS5cclxuICAgKiBAcGFyYW0ge051bWJlcj99IGJsb2Nrc1xyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyBlc3RpbWF0ZUZlZShibG9ja3MpIHtcclxuICAgIGlmICghdGhpcy5ub2RlLmZlZXMpXHJcbiAgICAgIHJldHVybiB7cmF0ZTogdGhpcy5uZXR3b3JrLmZlZVJhdGV9O1xyXG5cclxuICAgIGNvbnN0IGZlZSA9IHRoaXMubm9kZS5mZWVzLmVzdGltYXRlRmVlKGJsb2Nrcyk7XHJcbiAgICByZXR1cm4ge3JhdGU6IGZlZX07XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgaGFzaCByYW5nZS5cclxuICAgKiBAcGFyYW0ge051bWJlcn0gc3RhcnRcclxuICAgKiBAcGFyYW0ge051bWJlcn0gZW5kXHJcbiAgICogQHJldHVybnMge1Byb21pc2V9XHJcbiAgICovXHJcblxyXG4gIGFzeW5jIGdldEhhc2hlcyhzdGFydCA9IC0xLCBlbmQgPSAtMSkge1xyXG4gICAgcmV0dXJuIHRoaXMubm9kZS5jaGFpbi5nZXRIYXNoZXMoc3RhcnQsIGVuZCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXNjYW4gZm9yIGFueSBtaXNzZWQgdHJhbnNhY3Rpb25zLlxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfEhhc2h9IHN0YXJ0IC0gU3RhcnQgYmxvY2suXHJcbiAgICogQHBhcmFtIHtCbG9vbX0gZmlsdGVyXHJcbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gaXRlciAtIEl0ZXJhdG9yLlxyXG4gICAqIEByZXR1cm5zIHtQcm9taXNlfVxyXG4gICAqL1xyXG5cclxuICBhc3luYyByZXNjYW4oc3RhcnQpIHtcclxuICAgIGlmICh0aGlzLm5vZGUuc3B2KVxyXG4gICAgICByZXR1cm4gdGhpcy5ub2RlLmNoYWluLnJlc2V0KHN0YXJ0KTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5ub2RlLmNoYWluLnNjYW4oc3RhcnQsIHRoaXMuZmlsdGVyLCAoZW50cnksIHR4cykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5lbWl0QXN5bmMoJ2Jsb2NrIHJlc2NhbicsIGVudHJ5LCB0eHMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG4vKlxyXG4gKiBFeHBvc2VcclxuICovXHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IE5vZGVDbGllbnQ7XHJcbiJdfQ==