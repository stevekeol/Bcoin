/*!
 * memblock.js - memblock block object for bcoin
 * Copyright (c) 2014-2015, Fedor Indutny (MIT License)
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_tyezx1uvy(){var path="E:\\Projects\\Test\\bcoin\\lib\\primitives\\memblock.js";var hash="2fc1b22e040f4141f941754e4ec194315b4f8106";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\primitives\\memblock.js",statementMap:{"0":{start:{line:10,column:12},end:{line:10,column:28}},"1":{start:{line:11,column:22},end:{line:11,column:48}},"2":{start:{line:12,column:14},end:{line:12,column:32}},"3":{start:{line:13,column:16},end:{line:13,column:36}},"4":{start:{line:14,column:15},end:{line:14,column:42}},"5":{start:{line:15,column:14},end:{line:15,column:29}},"6":{start:{line:45,column:4},end:{line:45,column:12}},"7":{start:{line:47,column:4},end:{line:47,column:22}},"8":{start:{line:56,column:4},end:{line:56,column:16}},"9":{start:{line:65,column:4},end:{line:65,column:34}},"10":{start:{line:74,column:4},end:{line:74,column:28}},"11":{start:{line:83,column:4},end:{line:83,column:16}},"12":{start:{line:93,column:4},end:{line:94,column:16}},"13":{start:{line:94,column:6},end:{line:94,column:16}},"14":{start:{line:96,column:4},end:{line:100,column:5}},"15":{start:{line:97,column:6},end:{line:97,column:40}},"16":{start:{line:99,column:6},end:{line:99,column:16}},"17":{start:{line:111,column:15},end:{line:111,column:40}},"18":{start:{line:113,column:4},end:{line:113,column:16}},"19":{start:{line:115,column:20},end:{line:115,column:35}},"20":{start:{line:117,column:4},end:{line:118,column:16}},"21":{start:{line:118,column:6},end:{line:118,column:16}},"22":{start:{line:120,column:4},end:{line:120,column:15}},"23":{start:{line:122,column:18},end:{line:122,column:33}},"24":{start:{line:124,column:4},end:{line:127,column:5}},"25":{start:{line:125,column:6},end:{line:126,column:34}},"26":{start:{line:126,column:8},end:{line:126,column:34}},"27":{start:{line:129,column:4},end:{line:130,column:16}},"28":{start:{line:130,column:6},end:{line:130,column:16}},"29":{start:{line:132,column:4},end:{line:132,column:16}},"30":{start:{line:134,column:19},end:{line:134,column:36}},"31":{start:{line:136,column:4},end:{line:136,column:44}},"32":{start:{line:146,column:15},end:{line:146,column:35}},"33":{start:{line:148,column:4},end:{line:148,column:22}},"34":{start:{line:150,column:4},end:{line:150,column:24}},"35":{start:{line:152,column:4},end:{line:152,column:16}},"36":{start:{line:162,column:4},end:{line:162,column:36}},"37":{start:{line:171,column:4},end:{line:171,column:21}},"38":{start:{line:180,column:4},end:{line:180,column:21}},"39":{start:{line:191,column:18},end:{line:191,column:42}},"40":{start:{line:193,column:4},end:{line:193,column:29}},"41":{start:{line:194,column:4},end:{line:194,column:31}},"42":{start:{line:196,column:4},end:{line:196,column:17}},"43":{start:{line:205,column:4},end:{line:205,column:35}},"44":{start:{line:215,column:4},end:{line:215,column:35}},"45":{start:{line:223,column:0},end:{line:223,column:26}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:44,column:2},end:{line:44,column:3}},loc:{start:{line:44,column:16},end:{line:48,column:3}},line:44},"1":{name:"(anonymous_1)",decl:{start:{line:55,column:2},end:{line:55,column:3}},loc:{start:{line:55,column:13},end:{line:57,column:3}},line:55},"2":{name:"(anonymous_2)",decl:{start:{line:64,column:2},end:{line:64,column:3}},loc:{start:{line:64,column:11},end:{line:66,column:3}},line:64},"3":{name:"(anonymous_3)",decl:{start:{line:73,column:2},end:{line:73,column:3}},loc:{start:{line:73,column:12},end:{line:75,column:3}},line:73},"4":{name:"(anonymous_4)",decl:{start:{line:82,column:2},end:{line:82,column:3}},loc:{start:{line:82,column:15},end:{line:84,column:3}},line:82},"5":{name:"(anonymous_5)",decl:{start:{line:92,column:2},end:{line:92,column:3}},loc:{start:{line:92,column:22},end:{line:101,column:3}},line:92},"6":{name:"(anonymous_6)",decl:{start:{line:110,column:2},end:{line:110,column:3}},loc:{start:{line:110,column:24},end:{line:137,column:3}},line:110},"7":{name:"(anonymous_7)",decl:{start:{line:145,column:2},end:{line:145,column:3}},loc:{start:{line:145,column:16},end:{line:153,column:3}},line:145},"8":{name:"(anonymous_8)",decl:{start:{line:161,column:2},end:{line:161,column:3}},loc:{start:{line:161,column:23},end:{line:163,column:3}},line:161},"9":{name:"(anonymous_9)",decl:{start:{line:170,column:2},end:{line:170,column:3}},loc:{start:{line:170,column:10},end:{line:172,column:3}},line:170},"10":{name:"(anonymous_10)",decl:{start:{line:179,column:2},end:{line:179,column:3}},loc:{start:{line:179,column:13},end:{line:181,column:3}},line:179},"11":{name:"(anonymous_11)",decl:{start:{line:190,column:2},end:{line:190,column:3}},loc:{start:{line:190,column:12},end:{line:197,column:3}},line:190},"12":{name:"(anonymous_12)",decl:{start:{line:204,column:2},end:{line:204,column:3}},loc:{start:{line:204,column:14},end:{line:206,column:3}},line:204},"13":{name:"(anonymous_13)",decl:{start:{line:214,column:2},end:{line:214,column:3}},loc:{start:{line:214,column:25},end:{line:216,column:3}},line:214}},branchMap:{"0":{loc:{start:{line:93,column:4},end:{line:94,column:16}},type:"if",locations:[{start:{line:93,column:4},end:{line:94,column:16}},{start:{line:93,column:4},end:{line:94,column:16}}],line:93},"1":{loc:{start:{line:117,column:4},end:{line:118,column:16}},type:"if",locations:[{start:{line:117,column:4},end:{line:118,column:16}},{start:{line:117,column:4},end:{line:118,column:16}}],line:117},"2":{loc:{start:{line:124,column:4},end:{line:127,column:5}},type:"if",locations:[{start:{line:124,column:4},end:{line:127,column:5}},{start:{line:124,column:4},end:{line:127,column:5}}],line:124},"3":{loc:{start:{line:125,column:6},end:{line:126,column:34}},type:"if",locations:[{start:{line:125,column:6},end:{line:126,column:34}},{start:{line:125,column:6},end:{line:126,column:34}}],line:125},"4":{loc:{start:{line:129,column:4},end:{line:130,column:16}},type:"if",locations:[{start:{line:129,column:4},end:{line:130,column:16}},{start:{line:129,column:4},end:{line:130,column:16}}],line:129}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"2fc1b22e040f4141f941754e4ec194315b4f8106"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_tyezx1uvy=function(){return actualCoverage;};}return actualCoverage;}cov_tyezx1uvy();const bio=(cov_tyezx1uvy().s[0]++,require('bufio'));const AbstractBlock=(cov_tyezx1uvy().s[1]++,require('./abstractblock'));const Block=(cov_tyezx1uvy().s[2]++,require('./block'));const Headers=(cov_tyezx1uvy().s[3]++,require('./headers'));const Script=(cov_tyezx1uvy().s[4]++,require('../script/script'));const DUMMY=(cov_tyezx1uvy().s[5]++,Buffer.alloc(0));/**
 * Mem Block
 * A block object which is essentially a "placeholder"
 * for a full {@link Block} object. The v8 garbage
 * collector's head will explode if there is too much
 * data on the javascript heap. Blocks can currently
 * be up to 1mb in size. In the future, they may be
 * 2mb, 8mb, or maybe 20mb, who knows? A MemBlock
 * is an optimization in Bcoin which defers parsing of
 * the serialized transactions (the block Buffer) until
 * the block has passed through the chain queue and
 * is about to enter the chain. This keeps a lot data
 * off of the javascript heap for most of the time a
 * block even exists in memory, and manages to keep a
 * lot of strain off of the garbage collector. Having
 * 500mb of blocks on the js heap would not be a good
 * thing.
 * @alias module:primitives.MemBlock
 * @extends AbstractBlock
 */class MemBlock extends AbstractBlock{/**
   * Create a mem block.
   * @constructor
   */constructor(){cov_tyezx1uvy().f[0]++;cov_tyezx1uvy().s[6]++;super();cov_tyezx1uvy().s[7]++;this._raw=DUMMY;}/**
   * Test whether the block is a memblock.
   * @returns {Boolean}
   */isMemory(){cov_tyezx1uvy().f[1]++;cov_tyezx1uvy().s[8]++;return true;}/**
   * Serialize the block headers.
   * @returns {Buffer}
   */toHead(){cov_tyezx1uvy().f[2]++;cov_tyezx1uvy().s[9]++;return this._raw.slice(0,80);}/**
   * Get the full block size.
   * @returns {Number}
   */getSize(){cov_tyezx1uvy().f[3]++;cov_tyezx1uvy().s[10]++;return this._raw.length;}/**
   * Verify the block.
   * @returns {Boolean}
   */verifyBody(){cov_tyezx1uvy().f[4]++;cov_tyezx1uvy().s[11]++;return true;}/**
   * Retrieve the coinbase height
   * from the coinbase input script.
   * @returns {Number} height (-1 if not present).
   */getCoinbaseHeight(){cov_tyezx1uvy().f[5]++;cov_tyezx1uvy().s[12]++;if(this.version<2){cov_tyezx1uvy().b[0][0]++;cov_tyezx1uvy().s[13]++;return-1;}else{cov_tyezx1uvy().b[0][1]++;}cov_tyezx1uvy().s[14]++;try{cov_tyezx1uvy().s[15]++;return this.parseCoinbaseHeight();}catch(e){cov_tyezx1uvy().s[16]++;return-1;}}/**
   * Parse the coinbase height
   * from the coinbase input script.
   * @private
   * @returns {Number} height (-1 if not present).
   */parseCoinbaseHeight(){cov_tyezx1uvy().f[6]++;const br=(cov_tyezx1uvy().s[17]++,bio.read(this._raw,true));cov_tyezx1uvy().s[18]++;br.seek(80);const txCount=(cov_tyezx1uvy().s[19]++,br.readVarint());cov_tyezx1uvy().s[20]++;if(txCount===0){cov_tyezx1uvy().b[1][0]++;cov_tyezx1uvy().s[21]++;return-1;}else{cov_tyezx1uvy().b[1][1]++;}cov_tyezx1uvy().s[22]++;br.seek(4);let inCount=(cov_tyezx1uvy().s[23]++,br.readVarint());cov_tyezx1uvy().s[24]++;if(inCount===0){cov_tyezx1uvy().b[2][0]++;cov_tyezx1uvy().s[25]++;if(br.readU8()!==0){cov_tyezx1uvy().b[3][0]++;cov_tyezx1uvy().s[26]++;inCount=br.readVarint();}else{cov_tyezx1uvy().b[3][1]++;}}else{cov_tyezx1uvy().b[2][1]++;}cov_tyezx1uvy().s[27]++;if(inCount===0){cov_tyezx1uvy().b[4][0]++;cov_tyezx1uvy().s[28]++;return-1;}else{cov_tyezx1uvy().b[4][1]++;}cov_tyezx1uvy().s[29]++;br.seek(36);const script=(cov_tyezx1uvy().s[30]++,br.readVarBytes());cov_tyezx1uvy().s[31]++;return Script.getCoinbaseHeight(script);}/**
   * Inject properties from serialized data.
   * @private
   * @param {Buffer} data
   */fromRaw(data){cov_tyezx1uvy().f[7]++;const br=(cov_tyezx1uvy().s[32]++,bio.read(data,true));cov_tyezx1uvy().s[33]++;this.readHead(br);cov_tyezx1uvy().s[34]++;this._raw=br.data;cov_tyezx1uvy().s[35]++;return this;}/**
   * Insantiate a memblock from serialized data.
   * @param {Buffer} data
   * @returns {MemBlock}
   */static fromRaw(data){cov_tyezx1uvy().f[8]++;cov_tyezx1uvy().s[36]++;return new this().fromRaw(data);}/**
   * Return serialized block data.
   * @returns {Buffer}
   */toRaw(){cov_tyezx1uvy().f[9]++;cov_tyezx1uvy().s[37]++;return this._raw;}/**
   * Return serialized block data.
   * @returns {Buffer}
   */toNormal(){cov_tyezx1uvy().f[10]++;cov_tyezx1uvy().s[38]++;return this._raw;}/**
   * Parse the serialized block data
   * and create an actual {@link Block}.
   * @returns {Block}
   * @throws Parse error
   */toBlock(){cov_tyezx1uvy().f[11]++;const block=(cov_tyezx1uvy().s[39]++,Block.fromRaw(this._raw));cov_tyezx1uvy().s[40]++;block._hash=this._hash;cov_tyezx1uvy().s[41]++;block._hhash=this._hhash;cov_tyezx1uvy().s[42]++;return block;}/**
   * Convert the block to a headers object.
   * @returns {Headers}
   */toHeaders(){cov_tyezx1uvy().f[12]++;cov_tyezx1uvy().s[43]++;return Headers.fromBlock(this);}/**
   * Test whether an object is a MemBlock.
   * @param {Object} obj
   * @returns {Boolean}
   */static isMemBlock(obj){cov_tyezx1uvy().f[13]++;cov_tyezx1uvy().s[44]++;return obj instanceof MemBlock;}}/*
 * Expose
 */cov_tyezx1uvy().s[45]++;module.exports=MemBlock;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1lbWJsb2NrLmpzIl0sIm5hbWVzIjpbImJpbyIsInJlcXVpcmUiLCJBYnN0cmFjdEJsb2NrIiwiQmxvY2siLCJIZWFkZXJzIiwiU2NyaXB0IiwiRFVNTVkiLCJCdWZmZXIiLCJhbGxvYyIsIk1lbUJsb2NrIiwiY29uc3RydWN0b3IiLCJfcmF3IiwiaXNNZW1vcnkiLCJ0b0hlYWQiLCJzbGljZSIsImdldFNpemUiLCJsZW5ndGgiLCJ2ZXJpZnlCb2R5IiwiZ2V0Q29pbmJhc2VIZWlnaHQiLCJ2ZXJzaW9uIiwicGFyc2VDb2luYmFzZUhlaWdodCIsImUiLCJiciIsInJlYWQiLCJzZWVrIiwidHhDb3VudCIsInJlYWRWYXJpbnQiLCJpbkNvdW50IiwicmVhZFU4Iiwic2NyaXB0IiwicmVhZFZhckJ5dGVzIiwiZnJvbVJhdyIsImRhdGEiLCJyZWFkSGVhZCIsInRvUmF3IiwidG9Ob3JtYWwiLCJ0b0Jsb2NrIiwiYmxvY2siLCJfaGFzaCIsIl9oaGFzaCIsInRvSGVhZGVycyIsImZyb21CbG9jayIsImlzTWVtQmxvY2siLCJvYmoiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FFQSxhLGltTkFRWTt5RkFOWixLQUFNQSxDQUFBQSxHQUFHLHlCQUFHQyxPQUFPLENBQUMsT0FBRCxDQUFWLENBQVQsQ0FDQSxLQUFNQyxDQUFBQSxhQUFhLHlCQUFHRCxPQUFPLENBQUMsaUJBQUQsQ0FBVixDQUFuQixDQUNBLEtBQU1FLENBQUFBLEtBQUsseUJBQUdGLE9BQU8sQ0FBQyxTQUFELENBQVYsQ0FBWCxDQUNBLEtBQU1HLENBQUFBLE9BQU8seUJBQUdILE9BQU8sQ0FBQyxXQUFELENBQVYsQ0FBYixDQUNBLEtBQU1JLENBQUFBLE1BQU0seUJBQUdKLE9BQU8sQ0FBQyxrQkFBRCxDQUFWLENBQVosQ0FDQSxLQUFNSyxDQUFBQSxLQUFLLHlCQUFHQyxNQUFNLENBQUNDLEtBQVAsQ0FBYSxDQUFiLENBQUgs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cUIsZ0RBQ25CLE1BQU8sSUFBSSxLQUFKLEdBQVdELE9BQVgsQ0FBbUJDLElBQW5CLENBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBLEtBRUVFLEtBQUssRUFBRyxnREFDTixNQUFPLE1BQUt2QixJQUFaLENBQ0QsQ0FFRDtBQUNGO0FBQ0E7QUFDQSxLQUVFd0IsUUFBUSxFQUFHLGlEQUNULE1BQU8sTUFBS3hCLElBQVosQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUVFeUIsT0FBTyxFQUFHLHlCQUNSLEtBQU1DLENBQUFBLEtBQUssMEJBQUdsQyxLQUFLLENBQUM0QixPQUFOLENBQWMsS0FBS3BCLElBQW5CLENBQUgsQ0FBWCxDQURRLHdCQUdSMEIsS0FBSyxDQUFDQyxLQUFOLENBQWMsS0FBS0EsS0FBbkIsQ0FIUSx3QkFJUkQsS0FBSyxDQUFDRSxNQUFOLENBQWUsS0FBS0EsTUFBcEIsQ0FKUSx3QkFNUixNQUFPRixDQUFBQSxLQUFQLENBQ0QsQ0FFRDtBQUNGO0FBQ0E7QUFDQSxLQUVFRyxTQUFTLEVBQUcsaURBQ1YsTUFBT3BDLENBQUFBLE9BQU8sQ0FBQ3FDLFNBQVIsQ0FBa0IsSUFBbEIsQ0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQSxLQUVFLE1BQU9DLENBQUFBLFVBQVAsQ0FBa0JDLEdBQWxCLENBQXVCLGlEQUNyQixNQUFPQSxDQUFBQSxHQUFHLFdBQVlsQyxDQUFBQSxRQUF0QixDQUNELENBbExrQyxDQXFMckM7QUFDQTtBQUNBLEcsd0JBRUFtQyxNQUFNLENBQUNDLE9BQVAsQ0FBaUJwQyxRQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKiBtZW1ibG9jay5qcyAtIG1lbWJsb2NrIGJsb2NrIG9iamVjdCBmb3IgYmNvaW5cclxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMTUsIEZlZG9yIEluZHV0bnkgKE1JVCBMaWNlbnNlKVxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtMjAxNywgQ2hyaXN0b3BoZXIgSmVmZnJleSAoTUlUIExpY2Vuc2UpLlxyXG4gKiBodHRwczovL2dpdGh1Yi5jb20vYmNvaW4tb3JnL2Jjb2luXHJcbiAqL1xyXG5cclxuJ3VzZSBzdHJpY3QnO1xyXG5cclxuY29uc3QgYmlvID0gcmVxdWlyZSgnYnVmaW8nKTtcclxuY29uc3QgQWJzdHJhY3RCbG9jayA9IHJlcXVpcmUoJy4vYWJzdHJhY3RibG9jaycpO1xyXG5jb25zdCBCbG9jayA9IHJlcXVpcmUoJy4vYmxvY2snKTtcclxuY29uc3QgSGVhZGVycyA9IHJlcXVpcmUoJy4vaGVhZGVycycpO1xyXG5jb25zdCBTY3JpcHQgPSByZXF1aXJlKCcuLi9zY3JpcHQvc2NyaXB0Jyk7XHJcbmNvbnN0IERVTU1ZID0gQnVmZmVyLmFsbG9jKDApO1xyXG5cclxuLyoqXHJcbiAqIE1lbSBCbG9ja1xyXG4gKiBBIGJsb2NrIG9iamVjdCB3aGljaCBpcyBlc3NlbnRpYWxseSBhIFwicGxhY2Vob2xkZXJcIlxyXG4gKiBmb3IgYSBmdWxsIHtAbGluayBCbG9ja30gb2JqZWN0LiBUaGUgdjggZ2FyYmFnZVxyXG4gKiBjb2xsZWN0b3IncyBoZWFkIHdpbGwgZXhwbG9kZSBpZiB0aGVyZSBpcyB0b28gbXVjaFxyXG4gKiBkYXRhIG9uIHRoZSBqYXZhc2NyaXB0IGhlYXAuIEJsb2NrcyBjYW4gY3VycmVudGx5XHJcbiAqIGJlIHVwIHRvIDFtYiBpbiBzaXplLiBJbiB0aGUgZnV0dXJlLCB0aGV5IG1heSBiZVxyXG4gKiAybWIsIDhtYiwgb3IgbWF5YmUgMjBtYiwgd2hvIGtub3dzPyBBIE1lbUJsb2NrXHJcbiAqIGlzIGFuIG9wdGltaXphdGlvbiBpbiBCY29pbiB3aGljaCBkZWZlcnMgcGFyc2luZyBvZlxyXG4gKiB0aGUgc2VyaWFsaXplZCB0cmFuc2FjdGlvbnMgKHRoZSBibG9jayBCdWZmZXIpIHVudGlsXHJcbiAqIHRoZSBibG9jayBoYXMgcGFzc2VkIHRocm91Z2ggdGhlIGNoYWluIHF1ZXVlIGFuZFxyXG4gKiBpcyBhYm91dCB0byBlbnRlciB0aGUgY2hhaW4uIFRoaXMga2VlcHMgYSBsb3QgZGF0YVxyXG4gKiBvZmYgb2YgdGhlIGphdmFzY3JpcHQgaGVhcCBmb3IgbW9zdCBvZiB0aGUgdGltZSBhXHJcbiAqIGJsb2NrIGV2ZW4gZXhpc3RzIGluIG1lbW9yeSwgYW5kIG1hbmFnZXMgdG8ga2VlcCBhXHJcbiAqIGxvdCBvZiBzdHJhaW4gb2ZmIG9mIHRoZSBnYXJiYWdlIGNvbGxlY3Rvci4gSGF2aW5nXHJcbiAqIDUwMG1iIG9mIGJsb2NrcyBvbiB0aGUganMgaGVhcCB3b3VsZCBub3QgYmUgYSBnb29kXHJcbiAqIHRoaW5nLlxyXG4gKiBAYWxpYXMgbW9kdWxlOnByaW1pdGl2ZXMuTWVtQmxvY2tcclxuICogQGV4dGVuZHMgQWJzdHJhY3RCbG9ja1xyXG4gKi9cclxuXHJcbmNsYXNzIE1lbUJsb2NrIGV4dGVuZHMgQWJzdHJhY3RCbG9jayB7XHJcbiAgLyoqXHJcbiAgICogQ3JlYXRlIGEgbWVtIGJsb2NrLlxyXG4gICAqIEBjb25zdHJ1Y3RvclxyXG4gICAqL1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCk7XHJcblxyXG4gICAgdGhpcy5fcmF3ID0gRFVNTVk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgdGhlIGJsb2NrIGlzIGEgbWVtYmxvY2suXHJcbiAgICogQHJldHVybnMge0Jvb2xlYW59XHJcbiAgICovXHJcblxyXG4gIGlzTWVtb3J5KCkge1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBTZXJpYWxpemUgdGhlIGJsb2NrIGhlYWRlcnMuXHJcbiAgICogQHJldHVybnMge0J1ZmZlcn1cclxuICAgKi9cclxuXHJcbiAgdG9IZWFkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3Jhdy5zbGljZSgwLCA4MCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIGZ1bGwgYmxvY2sgc2l6ZS5cclxuICAgKiBAcmV0dXJucyB7TnVtYmVyfVxyXG4gICAqL1xyXG5cclxuICBnZXRTaXplKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3Jhdy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBWZXJpZnkgdGhlIGJsb2NrLlxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICB2ZXJpZnlCb2R5KCkge1xyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXRyaWV2ZSB0aGUgY29pbmJhc2UgaGVpZ2h0XHJcbiAgICogZnJvbSB0aGUgY29pbmJhc2UgaW5wdXQgc2NyaXB0LlxyXG4gICAqIEByZXR1cm5zIHtOdW1iZXJ9IGhlaWdodCAoLTEgaWYgbm90IHByZXNlbnQpLlxyXG4gICAqL1xyXG5cclxuICBnZXRDb2luYmFzZUhlaWdodCgpIHtcclxuICAgIGlmICh0aGlzLnZlcnNpb24gPCAyKVxyXG4gICAgICByZXR1cm4gLTE7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgcmV0dXJuIHRoaXMucGFyc2VDb2luYmFzZUhlaWdodCgpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICByZXR1cm4gLTE7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBQYXJzZSB0aGUgY29pbmJhc2UgaGVpZ2h0XHJcbiAgICogZnJvbSB0aGUgY29pbmJhc2UgaW5wdXQgc2NyaXB0LlxyXG4gICAqIEBwcml2YXRlXHJcbiAgICogQHJldHVybnMge051bWJlcn0gaGVpZ2h0ICgtMSBpZiBub3QgcHJlc2VudCkuXHJcbiAgICovXHJcblxyXG4gIHBhcnNlQ29pbmJhc2VIZWlnaHQoKSB7XHJcbiAgICBjb25zdCBiciA9IGJpby5yZWFkKHRoaXMuX3JhdywgdHJ1ZSk7XHJcblxyXG4gICAgYnIuc2Vlayg4MCk7XHJcblxyXG4gICAgY29uc3QgdHhDb3VudCA9IGJyLnJlYWRWYXJpbnQoKTtcclxuXHJcbiAgICBpZiAodHhDb3VudCA9PT0gMClcclxuICAgICAgcmV0dXJuIC0xO1xyXG5cclxuICAgIGJyLnNlZWsoNCk7XHJcblxyXG4gICAgbGV0IGluQ291bnQgPSBici5yZWFkVmFyaW50KCk7XHJcblxyXG4gICAgaWYgKGluQ291bnQgPT09IDApIHtcclxuICAgICAgaWYgKGJyLnJlYWRVOCgpICE9PSAwKVxyXG4gICAgICAgIGluQ291bnQgPSBici5yZWFkVmFyaW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGluQ291bnQgPT09IDApXHJcbiAgICAgIHJldHVybiAtMTtcclxuXHJcbiAgICBici5zZWVrKDM2KTtcclxuXHJcbiAgICBjb25zdCBzY3JpcHQgPSBici5yZWFkVmFyQnl0ZXMoKTtcclxuXHJcbiAgICByZXR1cm4gU2NyaXB0LmdldENvaW5iYXNlSGVpZ2h0KHNjcmlwdCk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBJbmplY3QgcHJvcGVydGllcyBmcm9tIHNlcmlhbGl6ZWQgZGF0YS5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhXHJcbiAgICovXHJcblxyXG4gIGZyb21SYXcoZGF0YSkge1xyXG4gICAgY29uc3QgYnIgPSBiaW8ucmVhZChkYXRhLCB0cnVlKTtcclxuXHJcbiAgICB0aGlzLnJlYWRIZWFkKGJyKTtcclxuXHJcbiAgICB0aGlzLl9yYXcgPSBici5kYXRhO1xyXG5cclxuICAgIHJldHVybiB0aGlzO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5zYW50aWF0ZSBhIG1lbWJsb2NrIGZyb20gc2VyaWFsaXplZCBkYXRhLlxyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBkYXRhXHJcbiAgICogQHJldHVybnMge01lbUJsb2NrfVxyXG4gICAqL1xyXG5cclxuICBzdGF0aWMgZnJvbVJhdyhkYXRhKSB7XHJcbiAgICByZXR1cm4gbmV3IHRoaXMoKS5mcm9tUmF3KGRhdGEpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJuIHNlcmlhbGl6ZWQgYmxvY2sgZGF0YS5cclxuICAgKiBAcmV0dXJucyB7QnVmZmVyfVxyXG4gICAqL1xyXG5cclxuICB0b1JhdygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yYXc7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXR1cm4gc2VyaWFsaXplZCBibG9jayBkYXRhLlxyXG4gICAqIEByZXR1cm5zIHtCdWZmZXJ9XHJcbiAgICovXHJcblxyXG4gIHRvTm9ybWFsKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JhdztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFBhcnNlIHRoZSBzZXJpYWxpemVkIGJsb2NrIGRhdGFcclxuICAgKiBhbmQgY3JlYXRlIGFuIGFjdHVhbCB7QGxpbmsgQmxvY2t9LlxyXG4gICAqIEByZXR1cm5zIHtCbG9ja31cclxuICAgKiBAdGhyb3dzIFBhcnNlIGVycm9yXHJcbiAgICovXHJcblxyXG4gIHRvQmxvY2soKSB7XHJcbiAgICBjb25zdCBibG9jayA9IEJsb2NrLmZyb21SYXcodGhpcy5fcmF3KTtcclxuXHJcbiAgICBibG9jay5faGFzaCA9IHRoaXMuX2hhc2g7XHJcbiAgICBibG9jay5faGhhc2ggPSB0aGlzLl9oaGFzaDtcclxuXHJcbiAgICByZXR1cm4gYmxvY2s7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDb252ZXJ0IHRoZSBibG9jayB0byBhIGhlYWRlcnMgb2JqZWN0LlxyXG4gICAqIEByZXR1cm5zIHtIZWFkZXJzfVxyXG4gICAqL1xyXG5cclxuICB0b0hlYWRlcnMoKSB7XHJcbiAgICByZXR1cm4gSGVhZGVycy5mcm9tQmxvY2sodGhpcyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUZXN0IHdoZXRoZXIgYW4gb2JqZWN0IGlzIGEgTWVtQmxvY2suXHJcbiAgICogQHBhcmFtIHtPYmplY3R9IG9ialxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICBzdGF0aWMgaXNNZW1CbG9jayhvYmopIHtcclxuICAgIHJldHVybiBvYmogaW5zdGFuY2VvZiBNZW1CbG9jaztcclxuICB9XHJcbn1cclxuXHJcbi8qXHJcbiAqIEV4cG9zZVxyXG4gKi9cclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTWVtQmxvY2s7XHJcbiJdfQ==