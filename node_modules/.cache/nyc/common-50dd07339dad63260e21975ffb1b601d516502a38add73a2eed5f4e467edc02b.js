/*!
 * common.js - mining utils
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_1mjthpr1pt(){var path="E:\\Projects\\Test\\bcoin\\lib\\mining\\common.js";var hash="56f5086fd5bf24fa53df00367930c7d65ba93925";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\mining\\common.js",statementMap:{"0":{start:{line:9,column:15},end:{line:9,column:31}},"1":{start:{line:10,column:18},end:{line:10,column:50}},"2":{start:{line:11,column:11},end:{line:11,column:39}},"3":{start:{line:17,column:15},end:{line:17,column:22}},"4":{start:{line:23,column:13},end:{line:23,column:79}},"5":{start:{line:24,column:13},end:{line:24,column:64}},"6":{start:{line:25,column:13},end:{line:25,column:48}},"7":{start:{line:26,column:12},end:{line:26,column:31}},"8":{start:{line:27,column:11},end:{line:27,column:14}},"9":{start:{line:35,column:0},end:{line:42,column:2}},"10":{start:{line:36,column:2},end:{line:39,column:3}},"11":{start:{line:36,column:15},end:{line:36,column:16}},"12":{start:{line:37,column:18},end:{line:37,column:44}},"13":{start:{line:38,column:4},end:{line:38,column:39}},"14":{start:{line:41,column:2},end:{line:41,column:14}},"15":{start:{line:51,column:0},end:{line:62,column:2}},"16":{start:{line:52,column:2},end:{line:52,column:32}},"17":{start:{line:54,column:2},end:{line:59,column:3}},"18":{start:{line:54,column:15},end:{line:54,column:27}},"19":{start:{line:55,column:4},end:{line:56,column:16}},"20":{start:{line:56,column:6},end:{line:56,column:16}},"21":{start:{line:57,column:4},end:{line:58,column:15}},"22":{start:{line:58,column:6},end:{line:58,column:15}},"23":{start:{line:61,column:2},end:{line:61,column:11}},"24":{start:{line:70,column:0},end:{line:93,column:2}},"25":{start:{line:71,column:10},end:{line:71,column:11}},"26":{start:{line:74,column:2},end:{line:74,column:31}},"27":{start:{line:76,column:2},end:{line:76,column:37}},"28":{start:{line:77,column:2},end:{line:77,column:37}},"29":{start:{line:78,column:2},end:{line:78,column:38}},"30":{start:{line:80,column:2},end:{line:80,column:37}},"31":{start:{line:81,column:2},end:{line:81,column:37}},"32":{start:{line:82,column:2},end:{line:82,column:38}},"33":{start:{line:84,column:2},end:{line:84,column:37}},"34":{start:{line:85,column:2},end:{line:85,column:36}},"35":{start:{line:86,column:2},end:{line:86,column:37}},"36":{start:{line:88,column:2},end:{line:88,column:36}},"37":{start:{line:89,column:2},end:{line:89,column:36}},"38":{start:{line:90,column:2},end:{line:90,column:36}},"39":{start:{line:92,column:2},end:{line:92,column:11}},"40":{start:{line:102,column:0},end:{line:110,column:2}},"41":{start:{line:103,column:12},end:{line:103,column:16}},"42":{start:{line:104,column:12},end:{line:104,column:36}},"43":{start:{line:106,column:2},end:{line:107,column:13}},"44":{start:{line:107,column:4},end:{line:107,column:13}},"45":{start:{line:109,column:2},end:{line:109,column:27}},"46":{start:{line:118,column:0},end:{line:128,column:2}},"47":{start:{line:119,column:17},end:{line:119,column:44}},"48":{start:{line:121,column:2},end:{line:122,column:43}},"49":{start:{line:122,column:4},end:{line:122,column:43}},"50":{start:{line:124,column:2},end:{line:125,column:39}},"51":{start:{line:125,column:4},end:{line:125,column:39}},"52":{start:{line:127,column:2},end:{line:127,column:46}},"53":{start:{line:136,column:0},end:{line:143,column:2}},"54":{start:{line:137,column:17},end:{line:137,column:35}},"55":{start:{line:139,column:2},end:{line:140,column:39}},"56":{start:{line:140,column:4},end:{line:140,column:39}},"57":{start:{line:142,column:2},end:{line:142,column:37}}},fnMap:{"0":{name:"swap32",decl:{start:{line:35,column:25},end:{line:35,column:31}},loc:{start:{line:35,column:38},end:{line:42,column:1}},line:35},"1":{name:"rcmp",decl:{start:{line:51,column:23},end:{line:51,column:27}},loc:{start:{line:51,column:34},end:{line:62,column:1}},line:51},"2":{name:"double256",decl:{start:{line:70,column:28},end:{line:70,column:37}},loc:{start:{line:70,column:46},end:{line:93,column:1}},line:70},"3":{name:"getDifficulty",decl:{start:{line:102,column:32},end:{line:102,column:45}},loc:{start:{line:102,column:54},end:{line:110,column:1}},line:102},"4":{name:"getTarget",decl:{start:{line:118,column:28},end:{line:118,column:37}},loc:{start:{line:118,column:44},end:{line:128,column:1}},line:118},"5":{name:"getBits",decl:{start:{line:136,column:26},end:{line:136,column:33}},loc:{start:{line:136,column:40},end:{line:143,column:1}},line:136}},branchMap:{"0":{loc:{start:{line:55,column:4},end:{line:56,column:16}},type:"if",locations:[{start:{line:55,column:4},end:{line:56,column:16}},{start:{line:55,column:4},end:{line:56,column:16}}],line:55},"1":{loc:{start:{line:57,column:4},end:{line:58,column:15}},type:"if",locations:[{start:{line:57,column:4},end:{line:58,column:15}},{start:{line:57,column:4},end:{line:58,column:15}}],line:57},"2":{loc:{start:{line:106,column:2},end:{line:107,column:13}},type:"if",locations:[{start:{line:106,column:2},end:{line:107,column:13}},{start:{line:106,column:2},end:{line:107,column:13}}],line:106},"3":{loc:{start:{line:121,column:2},end:{line:122,column:43}},type:"if",locations:[{start:{line:121,column:2},end:{line:122,column:43}},{start:{line:121,column:2},end:{line:122,column:43}}],line:121},"4":{loc:{start:{line:124,column:2},end:{line:125,column:39}},type:"if",locations:[{start:{line:124,column:2},end:{line:125,column:39}},{start:{line:124,column:2},end:{line:125,column:39}}],line:124},"5":{loc:{start:{line:139,column:2},end:{line:140,column:39}},type:"if",locations:[{start:{line:139,column:2},end:{line:140,column:39}},{start:{line:139,column:2},end:{line:140,column:39}}],line:139}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"56f5086fd5bf24fa53df00367930c7d65ba93925"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1mjthpr1pt=function(){return actualCoverage;};}return actualCoverage;}cov_1mjthpr1pt();const assert=(cov_1mjthpr1pt().s[0]++,require('bsert'));const consensus=(cov_1mjthpr1pt().s[1]++,require('../protocol/consensus'));const BN=(cov_1mjthpr1pt().s[2]++,require('bcrypto/lib/bn.js'));/**
 * @exports mining/common
 */const common=(cov_1mjthpr1pt().s[3]++,exports);/*
 * Constants
 */const DIFF=(cov_1mjthpr1pt().s[4]++,0x00000000ffff0000000000000000000000000000000000000000000000000000);const B192=(cov_1mjthpr1pt().s[5]++,0x1000000000000000000000000000000000000000000000000);const B128=(cov_1mjthpr1pt().s[6]++,0x100000000000000000000000000000000);const B64=(cov_1mjthpr1pt().s[7]++,0x10000000000000000);const B0=(cov_1mjthpr1pt().s[8]++,0x1);/**
 * Swap 32 bit endianness of uint256.
 * @param {Buffer} data
 * @returns {Buffer}
 */cov_1mjthpr1pt().s[9]++;common.swap32=function swap32(data){cov_1mjthpr1pt().f[0]++;cov_1mjthpr1pt().s[10]++;for(let i=(cov_1mjthpr1pt().s[11]++,0);i<data.length;i+=4){const field=(cov_1mjthpr1pt().s[12]++,data.readUInt32LE(i,true));cov_1mjthpr1pt().s[13]++;data.writeUInt32BE(field,i,true);}cov_1mjthpr1pt().s[14]++;return data;};/**
 * Compare two uint256le's.
 * @param {Buffer} a
 * @param {Buffer} b
 * @returns {Number}
 */cov_1mjthpr1pt().s[15]++;common.rcmp=function rcmp(a,b){cov_1mjthpr1pt().f[1]++;cov_1mjthpr1pt().s[16]++;assert(a.length===b.length);cov_1mjthpr1pt().s[17]++;for(let i=(cov_1mjthpr1pt().s[18]++,a.length-1);i>=0;i--){cov_1mjthpr1pt().s[19]++;if(a[i]<b[i]){cov_1mjthpr1pt().b[0][0]++;cov_1mjthpr1pt().s[20]++;return-1;}else{cov_1mjthpr1pt().b[0][1]++;}cov_1mjthpr1pt().s[21]++;if(a[i]>b[i]){cov_1mjthpr1pt().b[1][0]++;cov_1mjthpr1pt().s[22]++;return 1;}else{cov_1mjthpr1pt().b[1][1]++;}}cov_1mjthpr1pt().s[23]++;return 0;};/**
 * Convert a uint256le to a double.
 * @param {Buffer} target
 * @returns {Number}
 */cov_1mjthpr1pt().s[24]++;common.double256=function double256(target){cov_1mjthpr1pt().f[2]++;let n=(cov_1mjthpr1pt().s[25]++,0);let hi,lo;cov_1mjthpr1pt().s[26]++;assert(target.length===32);cov_1mjthpr1pt().s[27]++;hi=target.readUInt32LE(28,true);cov_1mjthpr1pt().s[28]++;lo=target.readUInt32LE(24,true);cov_1mjthpr1pt().s[29]++;n+=(hi*0x100000000+lo)*B192;cov_1mjthpr1pt().s[30]++;hi=target.readUInt32LE(20,true);cov_1mjthpr1pt().s[31]++;lo=target.readUInt32LE(16,true);cov_1mjthpr1pt().s[32]++;n+=(hi*0x100000000+lo)*B128;cov_1mjthpr1pt().s[33]++;hi=target.readUInt32LE(12,true);cov_1mjthpr1pt().s[34]++;lo=target.readUInt32LE(8,true);cov_1mjthpr1pt().s[35]++;n+=(hi*0x100000000+lo)*B64;cov_1mjthpr1pt().s[36]++;hi=target.readUInt32LE(4,true);cov_1mjthpr1pt().s[37]++;lo=target.readUInt32LE(0,true);cov_1mjthpr1pt().s[38]++;n+=(hi*0x100000000+lo)*B0;cov_1mjthpr1pt().s[39]++;return n;};/**
 * Calculate mining difficulty
 * from little-endian target.
 * @param {Buffer} target
 * @returns {Number}
 */cov_1mjthpr1pt().s[40]++;common.getDifficulty=function getDifficulty(target){cov_1mjthpr1pt().f[3]++;const d=(cov_1mjthpr1pt().s[41]++,DIFF);const n=(cov_1mjthpr1pt().s[42]++,common.double256(target));cov_1mjthpr1pt().s[43]++;if(n===0){cov_1mjthpr1pt().b[2][0]++;cov_1mjthpr1pt().s[44]++;return d;}else{cov_1mjthpr1pt().b[2][1]++;}cov_1mjthpr1pt().s[45]++;return Math.floor(d/n);};/**
 * Get target from bits as a uint256le.
 * @param {Number} bits
 * @returns {Buffer}
 */cov_1mjthpr1pt().s[46]++;common.getTarget=function getTarget(bits){cov_1mjthpr1pt().f[4]++;const target=(cov_1mjthpr1pt().s[47]++,consensus.fromCompact(bits));cov_1mjthpr1pt().s[48]++;if(target.isNeg()){cov_1mjthpr1pt().b[3][0]++;cov_1mjthpr1pt().s[49]++;throw new Error('Target is negative.');}else{cov_1mjthpr1pt().b[3][1]++;}cov_1mjthpr1pt().s[50]++;if(target.isZero()){cov_1mjthpr1pt().b[4][0]++;cov_1mjthpr1pt().s[51]++;throw new Error('Target is zero.');}else{cov_1mjthpr1pt().b[4][1]++;}cov_1mjthpr1pt().s[52]++;return target.toArrayLike(Buffer,'le',32);};/**
 * Get bits from target.
 * @param {Buffer} data
 * @returns {Buffer}
 */cov_1mjthpr1pt().s[53]++;common.getBits=function getBits(data){cov_1mjthpr1pt().f[5]++;const target=(cov_1mjthpr1pt().s[54]++,new BN(data,'le'));cov_1mjthpr1pt().s[55]++;if(target.isZero()){cov_1mjthpr1pt().b[5][0]++;cov_1mjthpr1pt().s[56]++;throw new Error('Target is zero.');}else{cov_1mjthpr1pt().b[5][1]++;}cov_1mjthpr1pt().s[57]++;return consensus.toCompact(target);};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbW1vbi5qcyJdLCJuYW1lcyI6WyJhc3NlcnQiLCJyZXF1aXJlIiwiY29uc2Vuc3VzIiwiQk4iLCJjb21tb24iLCJleHBvcnRzIiwiRElGRiIsIkIxOTIiLCJCMTI4IiwiQjY0IiwiQjAiLCJzd2FwMzIiLCJkYXRhIiwiaSIsImxlbmd0aCIsImZpZWxkIiwicmVhZFVJbnQzMkxFIiwid3JpdGVVSW50MzJCRSIsInJjbXAiLCJhIiwiYiIsImRvdWJsZTI1NiIsInRhcmdldCIsIm4iLCJoaSIsImxvIiwiZ2V0RGlmZmljdWx0eSIsImQiLCJNYXRoIiwiZmxvb3IiLCJnZXRUYXJnZXQiLCJiaXRzIiwiZnJvbUNvbXBhY3QiLCJpc05lZyIsIkVycm9yIiwiaXNaZXJvIiwidG9BcnJheUxpa2UiLCJCdWZmZXIiLCJnZXRCaXRzIiwidG9Db21wYWN0Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBRUEsYSw4d01BU1k7MkZBUFosS0FBTUEsQ0FBQUEsTUFBTSwwQkFBR0MsT0FBTyxDQUFDLE9BQUQsQ0FBVixDQUFaLENBQ0EsS0FBTUMsQ0FBQUEsU0FBUywwQkFBR0QsT0FBTyxDQUFDLHVCQUFELENBQVYsQ0FBZixDQUNBLEtBQU1FLENBQUFBLEVBQUUsMEJBQUdGLE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVIsQ0FFQTtBQUNBO0FBQ0EsR0FFQSxLQUFNRyxDQUFBQSxNQUFNLDBCQUFHQyxPQUFILENBQVosQ0FFQTtBQUNBO0FBQ0EsR0FFQSxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHLGtFQUFILENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHLG1EQUFILENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHLG1DQUFILENBQVYsQ0FDQSxLQUFNQyxDQUFBQSxHQUFHLDBCQUFHLG1CQUFILENBQVQsQ0FDQSxLQUFNQyxDQUFBQSxFQUFFLDBCQUFHLEdBQUgsQ0FBUixDQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsRyx3QkFF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LGlCQUFWLENBQU4sQ0FBbUMsQ0FEckMsaUNBTjBDLHlCQVMxQyxNQUFPWixDQUFBQSxNQUFNLENBQUNjLFdBQVAsQ0FBbUJDLE1BQW5CLENBQTJCLElBQTNCLENBQWlDLEVBQWpDLENBQVAsQ0FDRCxDQVZELENBWUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHLHlCQUVBakMsTUFBTSxDQUFDa0MsT0FBUCxDQUFpQixRQUFTQSxDQUFBQSxPQUFULENBQWlCMUIsSUFBakIsQ0FBdUIseUJBQ3RDLEtBQU1VLENBQUFBLE1BQU0sMkJBQUcsR0FBSW5CLENBQUFBLEVBQUosQ0FBT1MsSUFBUCxDQUFhLElBQWIsQ0FBSCxDQUFaLENBRHNDLHlCQUd0QyxHQUFJVSxNQUFNLENBQUNhLE1BQVAsRUFBSixDQUNFLDBEQUFNLElBQUlELENBQUFBLEtBQUosQ0FBVSxpQkFBVixDQUFOLENBQW1DLENBRHJDLGlDQUhzQyx5QkFNdEMsTUFBT2hDLENBQUFBLFNBQVMsQ0FBQ3FDLFNBQVYsQ0FBb0JqQixNQUFwQixDQUFQLENBQ0QsQ0FQRCIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKiBjb21tb24uanMgLSBtaW5pbmcgdXRpbHNcclxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMTcsIENocmlzdG9waGVyIEplZmZyZXkgKE1JVCBMaWNlbnNlKS5cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2Jjb2luLW9yZy9iY29pblxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoJ2JzZXJ0Jyk7XHJcbmNvbnN0IGNvbnNlbnN1cyA9IHJlcXVpcmUoJy4uL3Byb3RvY29sL2NvbnNlbnN1cycpO1xyXG5jb25zdCBCTiA9IHJlcXVpcmUoJ2JjcnlwdG8vbGliL2JuLmpzJyk7XHJcblxyXG4vKipcclxuICogQGV4cG9ydHMgbWluaW5nL2NvbW1vblxyXG4gKi9cclxuXHJcbmNvbnN0IGNvbW1vbiA9IGV4cG9ydHM7XHJcblxyXG4vKlxyXG4gKiBDb25zdGFudHNcclxuICovXHJcblxyXG5jb25zdCBESUZGID0gMHgwMDAwMDAwMGZmZmYwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwO1xyXG5jb25zdCBCMTkyID0gMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwO1xyXG5jb25zdCBCMTI4ID0gMHgxMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA7XHJcbmNvbnN0IEI2NCA9IDB4MTAwMDAwMDAwMDAwMDAwMDA7XHJcbmNvbnN0IEIwID0gMHgxO1xyXG5cclxuLyoqXHJcbiAqIFN3YXAgMzIgYml0IGVuZGlhbm5lc3Mgb2YgdWludDI1Ni5cclxuICogQHBhcmFtIHtCdWZmZXJ9IGRhdGFcclxuICogQHJldHVybnMge0J1ZmZlcn1cclxuICovXHJcblxyXG5jb21tb24uc3dhcDMyID0gZnVuY3Rpb24gc3dhcDMyKGRhdGEpIHtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpICs9IDQpIHtcclxuICAgIGNvbnN0IGZpZWxkID0gZGF0YS5yZWFkVUludDMyTEUoaSwgdHJ1ZSk7XHJcbiAgICBkYXRhLndyaXRlVUludDMyQkUoZmllbGQsIGksIHRydWUpO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIGRhdGE7XHJcbn07XHJcblxyXG4vKipcclxuICogQ29tcGFyZSB0d28gdWludDI1NmxlJ3MuXHJcbiAqIEBwYXJhbSB7QnVmZmVyfSBhXHJcbiAqIEBwYXJhbSB7QnVmZmVyfSBiXHJcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcbiAqL1xyXG5cclxuY29tbW9uLnJjbXAgPSBmdW5jdGlvbiByY21wKGEsIGIpIHtcclxuICBhc3NlcnQoYS5sZW5ndGggPT09IGIubGVuZ3RoKTtcclxuXHJcbiAgZm9yIChsZXQgaSA9IGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcclxuICAgIGlmIChhW2ldIDwgYltpXSlcclxuICAgICAgcmV0dXJuIC0xO1xyXG4gICAgaWYgKGFbaV0gPiBiW2ldKVxyXG4gICAgICByZXR1cm4gMTtcclxuICB9XHJcblxyXG4gIHJldHVybiAwO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENvbnZlcnQgYSB1aW50MjU2bGUgdG8gYSBkb3VibGUuXHJcbiAqIEBwYXJhbSB7QnVmZmVyfSB0YXJnZXRcclxuICogQHJldHVybnMge051bWJlcn1cclxuICovXHJcblxyXG5jb21tb24uZG91YmxlMjU2ID0gZnVuY3Rpb24gZG91YmxlMjU2KHRhcmdldCkge1xyXG4gIGxldCBuID0gMDtcclxuICBsZXQgaGksIGxvO1xyXG5cclxuICBhc3NlcnQodGFyZ2V0Lmxlbmd0aCA9PT0gMzIpO1xyXG5cclxuICBoaSA9IHRhcmdldC5yZWFkVUludDMyTEUoMjgsIHRydWUpO1xyXG4gIGxvID0gdGFyZ2V0LnJlYWRVSW50MzJMRSgyNCwgdHJ1ZSk7XHJcbiAgbiArPSAoaGkgKiAweDEwMDAwMDAwMCArIGxvKSAqIEIxOTI7XHJcblxyXG4gIGhpID0gdGFyZ2V0LnJlYWRVSW50MzJMRSgyMCwgdHJ1ZSk7XHJcbiAgbG8gPSB0YXJnZXQucmVhZFVJbnQzMkxFKDE2LCB0cnVlKTtcclxuICBuICs9IChoaSAqIDB4MTAwMDAwMDAwICsgbG8pICogQjEyODtcclxuXHJcbiAgaGkgPSB0YXJnZXQucmVhZFVJbnQzMkxFKDEyLCB0cnVlKTtcclxuICBsbyA9IHRhcmdldC5yZWFkVUludDMyTEUoOCwgdHJ1ZSk7XHJcbiAgbiArPSAoaGkgKiAweDEwMDAwMDAwMCArIGxvKSAqIEI2NDtcclxuXHJcbiAgaGkgPSB0YXJnZXQucmVhZFVJbnQzMkxFKDQsIHRydWUpO1xyXG4gIGxvID0gdGFyZ2V0LnJlYWRVSW50MzJMRSgwLCB0cnVlKTtcclxuICBuICs9IChoaSAqIDB4MTAwMDAwMDAwICsgbG8pICogQjA7XHJcblxyXG4gIHJldHVybiBuO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIENhbGN1bGF0ZSBtaW5pbmcgZGlmZmljdWx0eVxyXG4gKiBmcm9tIGxpdHRsZS1lbmRpYW4gdGFyZ2V0LlxyXG4gKiBAcGFyYW0ge0J1ZmZlcn0gdGFyZ2V0XHJcbiAqIEByZXR1cm5zIHtOdW1iZXJ9XHJcbiAqL1xyXG5cclxuY29tbW9uLmdldERpZmZpY3VsdHkgPSBmdW5jdGlvbiBnZXREaWZmaWN1bHR5KHRhcmdldCkge1xyXG4gIGNvbnN0IGQgPSBESUZGO1xyXG4gIGNvbnN0IG4gPSBjb21tb24uZG91YmxlMjU2KHRhcmdldCk7XHJcblxyXG4gIGlmIChuID09PSAwKVxyXG4gICAgcmV0dXJuIGQ7XHJcblxyXG4gIHJldHVybiBNYXRoLmZsb29yKGQgLyBuKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgdGFyZ2V0IGZyb20gYml0cyBhcyBhIHVpbnQyNTZsZS5cclxuICogQHBhcmFtIHtOdW1iZXJ9IGJpdHNcclxuICogQHJldHVybnMge0J1ZmZlcn1cclxuICovXHJcblxyXG5jb21tb24uZ2V0VGFyZ2V0ID0gZnVuY3Rpb24gZ2V0VGFyZ2V0KGJpdHMpIHtcclxuICBjb25zdCB0YXJnZXQgPSBjb25zZW5zdXMuZnJvbUNvbXBhY3QoYml0cyk7XHJcblxyXG4gIGlmICh0YXJnZXQuaXNOZWcoKSlcclxuICAgIHRocm93IG5ldyBFcnJvcignVGFyZ2V0IGlzIG5lZ2F0aXZlLicpO1xyXG5cclxuICBpZiAodGFyZ2V0LmlzWmVybygpKVxyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdUYXJnZXQgaXMgemVyby4nKTtcclxuXHJcbiAgcmV0dXJuIHRhcmdldC50b0FycmF5TGlrZShCdWZmZXIsICdsZScsIDMyKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgYml0cyBmcm9tIHRhcmdldC5cclxuICogQHBhcmFtIHtCdWZmZXJ9IGRhdGFcclxuICogQHJldHVybnMge0J1ZmZlcn1cclxuICovXHJcblxyXG5jb21tb24uZ2V0Qml0cyA9IGZ1bmN0aW9uIGdldEJpdHMoZGF0YSkge1xyXG4gIGNvbnN0IHRhcmdldCA9IG5ldyBCTihkYXRhLCAnbGUnKTtcclxuXHJcbiAgaWYgKHRhcmdldC5pc1plcm8oKSlcclxuICAgIHRocm93IG5ldyBFcnJvcignVGFyZ2V0IGlzIHplcm8uJyk7XHJcblxyXG4gIHJldHVybiBjb25zZW5zdXMudG9Db21wYWN0KHRhcmdldCk7XHJcbn07XHJcbiJdfQ==