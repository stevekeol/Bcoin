/*!
 * coins.js - coins object for bcoin
 * Copyright (c) 2014-2017, Christopher Jeffrey (MIT License).
 * https://github.com/bcoin-org/bcoin
 */'use strict';function cov_je1v833v3(){var path="E:\\Projects\\Test\\bcoin\\lib\\coins\\coins.js";var hash="28a14a1d1c06caa2aa5701a304ba4f93d78c26c5";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"E:\\Projects\\Test\\bcoin\\lib\\coins\\coins.js",statementMap:{"0":{start:{line:9,column:15},end:{line:9,column:31}},"1":{start:{line:10,column:18},end:{line:10,column:40}},"2":{start:{line:26,column:4},end:{line:26,column:29}},"3":{start:{line:37,column:4},end:{line:37,column:36}},"4":{start:{line:38,column:4},end:{line:38,column:17}},"5":{start:{line:39,column:4},end:{line:39,column:34}},"6":{start:{line:40,column:4},end:{line:40,column:16}},"7":{start:{line:51,column:4},end:{line:51,column:57}},"8":{start:{line:63,column:4},end:{line:63,column:64}},"9":{start:{line:73,column:4},end:{line:73,column:58}},"10":{start:{line:83,column:4},end:{line:83,column:35}},"11":{start:{line:93,column:17},end:{line:93,column:40}},"12":{start:{line:95,column:4},end:{line:96,column:19}},"13":{start:{line:96,column:6},end:{line:96,column:19}},"14":{start:{line:98,column:4},end:{line:98,column:16}},"15":{start:{line:108,column:4},end:{line:108,column:43}},"16":{start:{line:118,column:17},end:{line:118,column:40}},"17":{start:{line:120,column:4},end:{line:121,column:18}},"18":{start:{line:121,column:6},end:{line:121,column:18}},"19":{start:{line:123,column:4},end:{line:123,column:23}},"20":{start:{line:133,column:17},end:{line:133,column:48}},"21":{start:{line:135,column:4},end:{line:136,column:18}},"22":{start:{line:136,column:6},end:{line:136,column:18}},"23":{start:{line:138,column:4},end:{line:138,column:32}},"24":{start:{line:148,column:17},end:{line:148,column:32}},"25":{start:{line:150,column:4},end:{line:151,column:18}},"26":{start:{line:151,column:6},end:{line:151,column:18}},"27":{start:{line:153,column:4},end:{line:153,column:22}},"28":{start:{line:155,column:4},end:{line:155,column:16}},"29":{start:{line:165,column:17},end:{line:165,column:32}},"30":{start:{line:167,column:4},end:{line:168,column:18}},"31":{start:{line:168,column:6},end:{line:168,column:18}},"32":{start:{line:170,column:4},end:{line:170,column:31}},"33":{start:{line:172,column:4},end:{line:172,column:16}},"34":{start:{line:181,column:4},end:{line:181,column:35}},"35":{start:{line:193,column:4},end:{line:193,column:39}},"36":{start:{line:195,column:4},end:{line:204,column:5}},"37":{start:{line:195,column:17},end:{line:195,column:18}},"38":{start:{line:196,column:21},end:{line:196,column:34}},"39":{start:{line:198,column:6},end:{line:199,column:17}},"40":{start:{line:199,column:8},end:{line:199,column:17}},"41":{start:{line:201,column:20},end:{line:201,column:51}},"42":{start:{line:203,column:6},end:{line:203,column:33}},"43":{start:{line:206,column:4},end:{line:206,column:16}},"44":{start:{line:217,column:4},end:{line:217,column:41}},"45":{start:{line:225,column:0},end:{line:225,column:23}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:25,column:2},end:{line:25,column:3}},loc:{start:{line:25,column:16},end:{line:27,column:3}},line:25},"1":{name:"(anonymous_1)",decl:{start:{line:36,column:2},end:{line:36,column:3}},loc:{start:{line:36,column:19},end:{line:41,column:3}},line:36},"2":{name:"(anonymous_2)",decl:{start:{line:50,column:2},end:{line:50,column:3}},loc:{start:{line:50,column:27},end:{line:52,column:3}},line:50},"3":{name:"(anonymous_3)",decl:{start:{line:62,column:2},end:{line:62,column:3}},loc:{start:{line:62,column:30},end:{line:64,column:3}},line:62},"4":{name:"(anonymous_4)",decl:{start:{line:72,column:2},end:{line:72,column:3}},loc:{start:{line:72,column:16},end:{line:74,column:3}},line:72},"5":{name:"(anonymous_5)",decl:{start:{line:82,column:2},end:{line:82,column:3}},loc:{start:{line:82,column:13},end:{line:84,column:3}},line:82},"6":{name:"(anonymous_6)",decl:{start:{line:92,column:2},end:{line:92,column:3}},loc:{start:{line:92,column:19},end:{line:99,column:3}},line:92},"7":{name:"(anonymous_7)",decl:{start:{line:107,column:2},end:{line:107,column:3}},loc:{start:{line:107,column:13},end:{line:109,column:3}},line:107},"8":{name:"(anonymous_8)",decl:{start:{line:117,column:2},end:{line:117,column:3}},loc:{start:{line:117,column:19},end:{line:124,column:3}},line:117},"9":{name:"(anonymous_9)",decl:{start:{line:132,column:2},end:{line:132,column:3}},loc:{start:{line:132,column:19},end:{line:139,column:3}},line:132},"10":{name:"(anonymous_10)",decl:{start:{line:147,column:2},end:{line:147,column:3}},loc:{start:{line:147,column:15},end:{line:156,column:3}},line:147},"11":{name:"(anonymous_11)",decl:{start:{line:164,column:2},end:{line:164,column:3}},loc:{start:{line:164,column:16},end:{line:173,column:3}},line:164},"12":{name:"(anonymous_12)",decl:{start:{line:180,column:2},end:{line:180,column:3}},loc:{start:{line:180,column:12},end:{line:182,column:3}},line:180},"13":{name:"(anonymous_13)",decl:{start:{line:192,column:2},end:{line:192,column:3}},loc:{start:{line:192,column:21},end:{line:207,column:3}},line:192},"14":{name:"(anonymous_14)",decl:{start:{line:216,column:2},end:{line:216,column:3}},loc:{start:{line:216,column:28},end:{line:218,column:3}},line:216}},branchMap:{"0":{loc:{start:{line:95,column:4},end:{line:96,column:19}},type:"if",locations:[{start:{line:95,column:4},end:{line:96,column:19}},{start:{line:95,column:4},end:{line:96,column:19}}],line:95},"1":{loc:{start:{line:95,column:8},end:{line:95,column:27}},type:"binary-expr",locations:[{start:{line:95,column:8},end:{line:95,column:13}},{start:{line:95,column:17},end:{line:95,column:27}}],line:95},"2":{loc:{start:{line:108,column:11},end:{line:108,column:42}},type:"binary-expr",locations:[{start:{line:108,column:11},end:{line:108,column:34}},{start:{line:108,column:38},end:{line:108,column:42}}],line:108},"3":{loc:{start:{line:120,column:4},end:{line:121,column:18}},type:"if",locations:[{start:{line:120,column:4},end:{line:121,column:18}},{start:{line:120,column:4},end:{line:121,column:18}}],line:120},"4":{loc:{start:{line:135,column:4},end:{line:136,column:18}},type:"if",locations:[{start:{line:135,column:4},end:{line:136,column:18}},{start:{line:135,column:4},end:{line:136,column:18}}],line:135},"5":{loc:{start:{line:150,column:4},end:{line:151,column:18}},type:"if",locations:[{start:{line:150,column:4},end:{line:151,column:18}},{start:{line:150,column:4},end:{line:151,column:18}}],line:150},"6":{loc:{start:{line:150,column:8},end:{line:150,column:27}},type:"binary-expr",locations:[{start:{line:150,column:8},end:{line:150,column:13}},{start:{line:150,column:17},end:{line:150,column:27}}],line:150},"7":{loc:{start:{line:167,column:4},end:{line:168,column:18}},type:"if",locations:[{start:{line:167,column:4},end:{line:168,column:18}},{start:{line:167,column:4},end:{line:168,column:18}}],line:167},"8":{loc:{start:{line:198,column:6},end:{line:199,column:17}},type:"if",locations:[{start:{line:198,column:6},end:{line:199,column:17}},{start:{line:198,column:6},end:{line:199,column:17}}],line:198}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"28a14a1d1c06caa2aa5701a304ba4f93d78c26c5"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_je1v833v3=function(){return actualCoverage;};}return actualCoverage;}cov_je1v833v3();const assert=(cov_je1v833v3().s[0]++,require('bsert'));const CoinEntry=(cov_je1v833v3().s[1]++,require('./coinentry'));/**
 * Coins
 * Represents the outputs for a single transaction.
 * @alias module:coins.Coins
 * @property {Map[]} outputs - Coins.
 */class Coins{/**
   * Create coins.
   * @constructor
   */constructor(){cov_je1v833v3().f[0]++;cov_je1v833v3().s[2]++;this.outputs=new Map();}/**
   * Add a single entry to the collection.
   * @param {Number} index
   * @param {CoinEntry} coin
   * @returns {CoinEntry}
   */add(index,coin){cov_je1v833v3().f[1]++;cov_je1v833v3().s[3]++;assert(index>>>0===index);cov_je1v833v3().s[4]++;assert(coin);cov_je1v833v3().s[5]++;this.outputs.set(index,coin);cov_je1v833v3().s[6]++;return coin;}/**
   * Add a single output to the collection.
   * @param {Number} index
   * @param {Output} output
   * @returns {CoinEntry}
   */addOutput(index,output){cov_je1v833v3().f[2]++;cov_je1v833v3().s[7]++;return this.add(index,CoinEntry.fromOutput(output));}/**
   * Add an output to the collection by output index.
   * @param {TX} tx
   * @param {Number} index
   * @param {Number} height
   * @returns {CoinEntry}
   */addIndex(tx,index,height){cov_je1v833v3().f[3]++;cov_je1v833v3().s[8]++;return this.add(index,CoinEntry.fromTX(tx,index,height));}/**
   * Add a single coin to the collection.
   * @param {Coin} coin
   * @returns {CoinEntry}
   */addCoin(coin){cov_je1v833v3().f[4]++;cov_je1v833v3().s[9]++;return this.add(coin.index,CoinEntry.fromCoin(coin));}/**
   * Test whether the collection has a coin.
   * @param {Number} index
   * @returns {Boolean}
   */has(index){cov_je1v833v3().f[5]++;cov_je1v833v3().s[10]++;return this.outputs.has(index);}/**
   * Test whether the collection has an unspent coin.
   * @param {Number} index
   * @returns {Boolean}
   */isUnspent(index){cov_je1v833v3().f[6]++;const coin=(cov_je1v833v3().s[11]++,this.outputs.get(index));cov_je1v833v3().s[12]++;if((cov_je1v833v3().b[1][0]++,!coin)||(cov_je1v833v3().b[1][1]++,coin.spent)){cov_je1v833v3().b[0][0]++;cov_je1v833v3().s[13]++;return false;}else{cov_je1v833v3().b[0][1]++;}cov_je1v833v3().s[14]++;return true;}/**
   * Get a coin entry.
   * @param {Number} index
   * @returns {CoinEntry|null}
   */get(index){cov_je1v833v3().f[7]++;cov_je1v833v3().s[15]++;return(cov_je1v833v3().b[2][0]++,this.outputs.get(index))||(cov_je1v833v3().b[2][1]++,null);}/**
   * Get an output.
   * @param {Number} index
   * @returns {Output|null}
   */getOutput(index){cov_je1v833v3().f[8]++;const coin=(cov_je1v833v3().s[16]++,this.outputs.get(index));cov_je1v833v3().s[17]++;if(!coin){cov_je1v833v3().b[3][0]++;cov_je1v833v3().s[18]++;return null;}else{cov_je1v833v3().b[3][1]++;}cov_je1v833v3().s[19]++;return coin.output;}/**
   * Get a coin.
   * @param {Outpoint} prevout
   * @returns {Coin|null}
   */getCoin(prevout){cov_je1v833v3().f[9]++;const coin=(cov_je1v833v3().s[20]++,this.outputs.get(prevout.index));cov_je1v833v3().s[21]++;if(!coin){cov_je1v833v3().b[4][0]++;cov_je1v833v3().s[22]++;return null;}else{cov_je1v833v3().b[4][1]++;}cov_je1v833v3().s[23]++;return coin.toCoin(prevout);}/**
   * Spend a coin entry and return it.
   * @param {Number} index
   * @returns {CoinEntry|null}
   */spend(index){cov_je1v833v3().f[10]++;const coin=(cov_je1v833v3().s[24]++,this.get(index));cov_je1v833v3().s[25]++;if((cov_je1v833v3().b[6][0]++,!coin)||(cov_je1v833v3().b[6][1]++,coin.spent)){cov_je1v833v3().b[5][0]++;cov_je1v833v3().s[26]++;return null;}else{cov_je1v833v3().b[5][1]++;}cov_je1v833v3().s[27]++;coin.spent=true;cov_je1v833v3().s[28]++;return coin;}/**
   * Remove a coin entry and return it.
   * @param {Number} index
   * @returns {CoinEntry|null}
   */remove(index){cov_je1v833v3().f[11]++;const coin=(cov_je1v833v3().s[29]++,this.get(index));cov_je1v833v3().s[30]++;if(!coin){cov_je1v833v3().b[7][0]++;cov_je1v833v3().s[31]++;return null;}else{cov_je1v833v3().b[7][1]++;}cov_je1v833v3().s[32]++;this.outputs.delete(index);cov_je1v833v3().s[33]++;return coin;}/**
   * Test whether the coins are fully spent.
   * @returns {Boolean}
   */isEmpty(){cov_je1v833v3().f[12]++;cov_je1v833v3().s[34]++;return this.outputs.size===0;}/**
   * Inject properties from tx.
   * @private
   * @param {TX} tx
   * @param {Number} height
   * @returns {Coins}
   */fromTX(tx,height){cov_je1v833v3().f[13]++;cov_je1v833v3().s[35]++;assert(typeof height==='number');cov_je1v833v3().s[36]++;for(let i=(cov_je1v833v3().s[37]++,0);i<tx.outputs.length;i++){const output=(cov_je1v833v3().s[38]++,tx.outputs[i]);cov_je1v833v3().s[39]++;if(output.script.isUnspendable()){cov_je1v833v3().b[8][0]++;cov_je1v833v3().s[40]++;continue;}else{cov_je1v833v3().b[8][1]++;}const entry=(cov_je1v833v3().s[41]++,CoinEntry.fromTX(tx,i,height));cov_je1v833v3().s[42]++;this.outputs.set(i,entry);}cov_je1v833v3().s[43]++;return this;}/**
   * Instantiate a coins object from a transaction.
   * @param {TX} tx
   * @param {Number} height
   * @returns {Coins}
   */static fromTX(tx,height){cov_je1v833v3().f[14]++;cov_je1v833v3().s[44]++;return new this().fromTX(tx,height);}}/*
 * Expose
 */cov_je1v833v3().s[45]++;module.exports=Coins;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvaW5zLmpzIl0sIm5hbWVzIjpbImFzc2VydCIsInJlcXVpcmUiLCJDb2luRW50cnkiLCJDb2lucyIsImNvbnN0cnVjdG9yIiwib3V0cHV0cyIsIk1hcCIsImFkZCIsImluZGV4IiwiY29pbiIsInNldCIsImFkZE91dHB1dCIsIm91dHB1dCIsImZyb21PdXRwdXQiLCJhZGRJbmRleCIsInR4IiwiaGVpZ2h0IiwiZnJvbVRYIiwiYWRkQ29pbiIsImZyb21Db2luIiwiaGFzIiwiaXNVbnNwZW50IiwiZ2V0Iiwic3BlbnQiLCJnZXRPdXRwdXQiLCJnZXRDb2luIiwicHJldm91dCIsInRvQ29pbiIsInNwZW5kIiwicmVtb3ZlIiwiZGVsZXRlIiwiaXNFbXB0eSIsInNpemUiLCJpIiwibGVuZ3RoIiwic2NyaXB0IiwiaXNVbnNwZW5kYWJsZSIsImVudHJ5IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUVBLGEsOGtQQVNZO3lGQVBaLEtBQU1BLENBQUFBLE1BQU0seUJBQUdDLE9BQU8sQ0FBQyxPQUFELENBQVYsQ0FBWixDQUNBLEtBQU1DLENBQUFBLFNBQVMseUJBQUdELE9BQU8sQ0FBQyxhQUFELENBQVYsQ0FBZixDQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUVBLEtBQU1FLENBQUFBLEtBQU0sQ0FDVjtBQUNGO0FBQ0E7QUFDQSxLQUVFQyxXQUFXLEVBQUcsK0NBQ1osS0FBS0MsT0FBTCxDQUFlLEdBQUlDLENBQUFBLEdBQUosRUFBZixDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBRUVDLEdBQUcsQ0FBQ0MsS0FBRCxDQUFRQyxJQUFSLENBQWMsK0NBQ2ZULE1BQU0sQ0FBRVEsS0FBSyxHQUFLLENBQVgsR0FBa0JBLEtBQW5CLENBQU4sQ0FEZSx1QkFFZlIsTUFBTSxDQUFDUyxJQUFELENBQU4sQ0FGZSx1QkFHZixLQUFLSixPQUFMLENBQWFLLEdBQWIsQ0FBaUJGLEtBQWpCLENBQXdCQyxJQUF4QixFQUhlLHVCQUlmLE1BQU9BLENBQUFBLElBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUVFRSxTQUFTLENBQUNILEtBQUQsQ0FBUUksTUFBUixDQUFnQiwrQ0FDdkIsTUFBTyxNQUFLTCxHQUFMLENBQVNDLEtBQVQsQ0FBZ0JOLFNBQVMsQ0FBQ1csVUFBVixDQUFxQkQsTUFBckIsQ0FBaEIsQ0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FFRUUsUUFBUSxDQUFDQyxFQUFELENBQUtQLEtBQUwsQ0FBWVEsTUFBWixDQUFvQiwrQ0FDMUIsTUFBTyxNQUFLVCxHQUFMLENBQVNDLEtBQVQsQ0FBZ0JOLFNBQVMsQ0FBQ2UsTUFBVixDQUFpQkYsRUFBakIsQ0FBcUJQLEtBQXJCLENBQTRCUSxNQUE1QixDQUFoQixDQUFQLENBQ0QsQ0FFRDtBQUNGO0FBQ0E7QUFDQTtBQUNBLEtBRUVFLE9BQU8sQ0FBQ1QsSUFBRCxDQUFPLCtDQUNaLE1BQU8sTUFBS0YsR0FBTCxDQUFTRSxJQUFJLENBQUNELEtBQWQsQ0FBcUJOLFNBQVMsQ0FBQ2lCLFFBQVYsQ0FBbUJWLElBQW5CLENBQXJCLENBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsS0FFRVcsR0FBRyxDQUFDWixLQUFELENBQVEsZ0RBQ1QsTUFBTyxNQUFLSCxPQUFMLENBQWFlLEdBQWIsQ0FBaUJaLEtBQWpCLENBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBO0FBQ0EsS0FFRWEsU0FBUyxDQUFDYixLQUFELENBQVEsd0JBQ2YsS0FBTUMsQ0FBQUEsSUFBSSwwQkFBRyxLQUFLSixPQUFMLENBQWFpQixHQUFiLENBQWlCZCxLQUFqQixDQUFILENBQVYsQ0FEZSx3QkFHZixHQUFJLDRCQUFDQyxJQUFELDhCQUFTQSxJQUFJLENBQUNjLEtBQWQsQ0FBSixDQUNFLHlEQUFPLE1BQVAsQ0FBYSxDQURmLGdDQUhlLHdCQU1mLE1BQU8sS0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQSxLQUVFRCxHQUFHLENBQUNkLEtBQUQsQ0FBUSxnREFDVCxNQUFPLGdDQUFLSCxPQUFMLENBQWFpQixHQUFiLENBQWlCZCxLQUFqQiwrQkFBMkIsSUFBM0IsQ0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQSxLQUVFZ0IsU0FBUyxDQUFDaEIsS0FBRCxDQUFRLHdCQUNmLEtBQU1DLENBQUFBLElBQUksMEJBQUcsS0FBS0osT0FBTCxDQUFhaUIsR0FBYixDQUFpQmQsS0FBakIsQ0FBSCxDQUFWLENBRGUsd0JBR2YsR0FBSSxDQUFDQyxJQUFMLENBQ0UseURBQU8sS0FBUCxDQUFZLENBRGQsZ0NBSGUsd0JBTWYsTUFBT0EsQ0FBQUEsSUFBSSxDQUFDRyxNQUFaLENBQ0QsQ0FFRDtBQUNGO0FBQ0E7QUFDQTtBQUNBLEtBRUVhLE9BQU8sQ0FBQ0MsT0FBRCxDQUFVLHdCQUNmLEtBQU1qQixDQUFBQSxJQUFJLDBCQUFHLEtBQUtKLE9BQUwsQ0FBYWlCLEdBQWIsQ0FBaUJJLE9BQU8sQ0FBQ2xCLEtBQXpCLENBQUgsQ0FBVixDQURlLHdCQUdmLEdBQUksQ0FBQ0MsSUFBTCxDQUNFLHlEQUFPLEtBQVAsQ0FBWSxDQURkLGdDQUhlLHdCQU1mLE1BQU9BLENBQUFBLElBQUksQ0FBQ2tCLE1BQUwsQ0FBWUQsT0FBWixDQUFQLENBQ0QsQ0FFRDtBQUNGO0FBQ0E7QUFDQTtBQUNBLEtBRUVFLEtBQUssQ0FBQ3BCLEtBQUQsQ0FBUSx5QkFDWCxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHLEtBQUthLEdBQUwsQ0FBU2QsS0FBVCxDQUFILENBQVYsQ0FEVyx3QkFHWCxHQUFJLDRCQUFDQyxJQUFELDhCQUFTQSxJQUFJLENBQUNjLEtBQWQsQ0FBSixDQUNFLHlEQUFPLEtBQVAsQ0FBWSxDQURkLGdDQUhXLHdCQU1YZCxJQUFJLENBQUNjLEtBQUwsQ0FBYSxJQUFiLENBTlcsd0JBUVgsTUFBT2QsQ0FBQUEsSUFBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQSxLQUVFb0IsTUFBTSxDQUFDckIsS0FBRCxDQUFRLHlCQUNaLEtBQU1DLENBQUFBLElBQUksMEJBQUcsS0FBS2EsR0FBTCxDQUFTZCxLQUFULENBQUgsQ0FBVixDQURZLHdCQUdaLEdBQUksQ0FBQ0MsSUFBTCxDQUNFLHlEQUFPLEtBQVAsQ0FBWSxDQURkLGdDQUhZLHdCQU1aLEtBQUtKLE9BQUwsQ0FBYXlCLE1BQWIsQ0FBb0J0QixLQUFwQixFQU5ZLHdCQVFaLE1BQU9DLENBQUFBLElBQVAsQ0FDRCxDQUVEO0FBQ0Y7QUFDQTtBQUNBLEtBRUVzQixPQUFPLEVBQUcsaURBQ1IsTUFBTyxNQUFLMUIsT0FBTCxDQUFhMkIsSUFBYixHQUFzQixDQUE3QixDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FFRWYsTUFBTSxDQUFDRixFQUFELENBQUtDLE1BQUwsQ0FBYSxpREFDakJoQixNQUFNLENBQUMsTUFBT2dCLENBQUFBLE1BQVAsR0FBa0IsUUFBbkIsQ0FBTixDQURpQix3QkFHakIsSUFBSyxHQUFJaUIsQ0FBQUEsQ0FBQywwQkFBRyxDQUFILENBQVYsQ0FBZ0JBLENBQUMsQ0FBR2xCLEVBQUUsQ0FBQ1YsT0FBSCxDQUFXNkIsTUFBL0IsQ0FBdUNELENBQUMsRUFBeEMsQ0FBNEMsQ0FDMUMsS0FBTXJCLENBQUFBLE1BQU0sMEJBQUdHLEVBQUUsQ0FBQ1YsT0FBSCxDQUFXNEIsQ0FBWCxDQUFILENBQVosQ0FEMEMsd0JBRzFDLEdBQUlyQixNQUFNLENBQUN1QixNQUFQLENBQWNDLGFBQWQsRUFBSixDQUNFLDREQUFTLENBRFgsZ0NBR0EsS0FBTUMsQ0FBQUEsS0FBSywwQkFBR25DLFNBQVMsQ0FBQ2UsTUFBVixDQUFpQkYsRUFBakIsQ0FBcUJrQixDQUFyQixDQUF3QmpCLE1BQXhCLENBQUgsQ0FBWCxDQU4wQyx3QkFRMUMsS0FBS1gsT0FBTCxDQUFhSyxHQUFiLENBQWlCdUIsQ0FBakIsQ0FBb0JJLEtBQXBCLEVBQ0QsQ0FaZ0Isd0JBY2pCLE1BQU8sS0FBUCxDQUNELENBRUQ7QUFDRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBRUUsTUFBT3BCLENBQUFBLE1BQVAsQ0FBY0YsRUFBZCxDQUFrQkMsTUFBbEIsQ0FBMEIsaURBQ3hCLE1BQU8sSUFBSSxLQUFKLEdBQVdDLE1BQVgsQ0FBa0JGLEVBQWxCLENBQXNCQyxNQUF0QixDQUFQLENBQ0QsQ0F2TVMsQ0EwTVo7QUFDQTtBQUNBLEcsd0JBRUFzQixNQUFNLENBQUNDLE9BQVAsQ0FBaUJwQyxLQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIVxyXG4gKiBjb2lucy5qcyAtIGNvaW5zIG9iamVjdCBmb3IgYmNvaW5cclxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMTcsIENocmlzdG9waGVyIEplZmZyZXkgKE1JVCBMaWNlbnNlKS5cclxuICogaHR0cHM6Ly9naXRodWIuY29tL2Jjb2luLW9yZy9iY29pblxyXG4gKi9cclxuXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoJ2JzZXJ0Jyk7XHJcbmNvbnN0IENvaW5FbnRyeSA9IHJlcXVpcmUoJy4vY29pbmVudHJ5Jyk7XHJcblxyXG4vKipcclxuICogQ29pbnNcclxuICogUmVwcmVzZW50cyB0aGUgb3V0cHV0cyBmb3IgYSBzaW5nbGUgdHJhbnNhY3Rpb24uXHJcbiAqIEBhbGlhcyBtb2R1bGU6Y29pbnMuQ29pbnNcclxuICogQHByb3BlcnR5IHtNYXBbXX0gb3V0cHV0cyAtIENvaW5zLlxyXG4gKi9cclxuXHJcbmNsYXNzIENvaW5zIHtcclxuICAvKipcclxuICAgKiBDcmVhdGUgY29pbnMuXHJcbiAgICogQGNvbnN0cnVjdG9yXHJcbiAgICovXHJcblxyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgdGhpcy5vdXRwdXRzID0gbmV3IE1hcCgpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGEgc2luZ2xlIGVudHJ5IHRvIHRoZSBjb2xsZWN0aW9uLlxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxyXG4gICAqIEBwYXJhbSB7Q29pbkVudHJ5fSBjb2luXHJcbiAgICogQHJldHVybnMge0NvaW5FbnRyeX1cclxuICAgKi9cclxuXHJcbiAgYWRkKGluZGV4LCBjb2luKSB7XHJcbiAgICBhc3NlcnQoKGluZGV4ID4+PiAwKSA9PT0gaW5kZXgpO1xyXG4gICAgYXNzZXJ0KGNvaW4pO1xyXG4gICAgdGhpcy5vdXRwdXRzLnNldChpbmRleCwgY29pbik7XHJcbiAgICByZXR1cm4gY29pbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEFkZCBhIHNpbmdsZSBvdXRwdXQgdG8gdGhlIGNvbGxlY3Rpb24uXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XHJcbiAgICogQHBhcmFtIHtPdXRwdXR9IG91dHB1dFxyXG4gICAqIEByZXR1cm5zIHtDb2luRW50cnl9XHJcbiAgICovXHJcblxyXG4gIGFkZE91dHB1dChpbmRleCwgb3V0cHV0KSB7XHJcbiAgICByZXR1cm4gdGhpcy5hZGQoaW5kZXgsIENvaW5FbnRyeS5mcm9tT3V0cHV0KG91dHB1dCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGFuIG91dHB1dCB0byB0aGUgY29sbGVjdGlvbiBieSBvdXRwdXQgaW5kZXguXHJcbiAgICogQHBhcmFtIHtUWH0gdHhcclxuICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXhcclxuICAgKiBAcGFyYW0ge051bWJlcn0gaGVpZ2h0XHJcbiAgICogQHJldHVybnMge0NvaW5FbnRyeX1cclxuICAgKi9cclxuXHJcbiAgYWRkSW5kZXgodHgsIGluZGV4LCBoZWlnaHQpIHtcclxuICAgIHJldHVybiB0aGlzLmFkZChpbmRleCwgQ29pbkVudHJ5LmZyb21UWCh0eCwgaW5kZXgsIGhlaWdodCkpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogQWRkIGEgc2luZ2xlIGNvaW4gdG8gdGhlIGNvbGxlY3Rpb24uXHJcbiAgICogQHBhcmFtIHtDb2lufSBjb2luXHJcbiAgICogQHJldHVybnMge0NvaW5FbnRyeX1cclxuICAgKi9cclxuXHJcbiAgYWRkQ29pbihjb2luKSB7XHJcbiAgICByZXR1cm4gdGhpcy5hZGQoY29pbi5pbmRleCwgQ29pbkVudHJ5LmZyb21Db2luKGNvaW4pKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGUgY29sbGVjdGlvbiBoYXMgYSBjb2luLlxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICBoYXMoaW5kZXgpIHtcclxuICAgIHJldHVybiB0aGlzLm91dHB1dHMuaGFzKGluZGV4KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGUgY29sbGVjdGlvbiBoYXMgYW4gdW5zcGVudCBjb2luLlxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICBpc1Vuc3BlbnQoaW5kZXgpIHtcclxuICAgIGNvbnN0IGNvaW4gPSB0aGlzLm91dHB1dHMuZ2V0KGluZGV4KTtcclxuXHJcbiAgICBpZiAoIWNvaW4gfHwgY29pbi5zcGVudClcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG5cclxuICAgIHJldHVybiB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGEgY29pbiBlbnRyeS5cclxuICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXhcclxuICAgKiBAcmV0dXJucyB7Q29pbkVudHJ5fG51bGx9XHJcbiAgICovXHJcblxyXG4gIGdldChpbmRleCkge1xyXG4gICAgcmV0dXJuIHRoaXMub3V0cHV0cy5nZXQoaW5kZXgpIHx8IG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYW4gb3V0cHV0LlxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxyXG4gICAqIEByZXR1cm5zIHtPdXRwdXR8bnVsbH1cclxuICAgKi9cclxuXHJcbiAgZ2V0T3V0cHV0KGluZGV4KSB7XHJcbiAgICBjb25zdCBjb2luID0gdGhpcy5vdXRwdXRzLmdldChpbmRleCk7XHJcblxyXG4gICAgaWYgKCFjb2luKVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICByZXR1cm4gY29pbi5vdXRwdXQ7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgYSBjb2luLlxyXG4gICAqIEBwYXJhbSB7T3V0cG9pbnR9IHByZXZvdXRcclxuICAgKiBAcmV0dXJucyB7Q29pbnxudWxsfVxyXG4gICAqL1xyXG5cclxuICBnZXRDb2luKHByZXZvdXQpIHtcclxuICAgIGNvbnN0IGNvaW4gPSB0aGlzLm91dHB1dHMuZ2V0KHByZXZvdXQuaW5kZXgpO1xyXG5cclxuICAgIGlmICghY29pbilcclxuICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgcmV0dXJuIGNvaW4udG9Db2luKHByZXZvdXQpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3BlbmQgYSBjb2luIGVudHJ5IGFuZCByZXR1cm4gaXQuXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XHJcbiAgICogQHJldHVybnMge0NvaW5FbnRyeXxudWxsfVxyXG4gICAqL1xyXG5cclxuICBzcGVuZChpbmRleCkge1xyXG4gICAgY29uc3QgY29pbiA9IHRoaXMuZ2V0KGluZGV4KTtcclxuXHJcbiAgICBpZiAoIWNvaW4gfHwgY29pbi5zcGVudClcclxuICAgICAgcmV0dXJuIG51bGw7XHJcblxyXG4gICAgY29pbi5zcGVudCA9IHRydWU7XHJcblxyXG4gICAgcmV0dXJuIGNvaW47XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZW1vdmUgYSBjb2luIGVudHJ5IGFuZCByZXR1cm4gaXQuXHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4XHJcbiAgICogQHJldHVybnMge0NvaW5FbnRyeXxudWxsfVxyXG4gICAqL1xyXG5cclxuICByZW1vdmUoaW5kZXgpIHtcclxuICAgIGNvbnN0IGNvaW4gPSB0aGlzLmdldChpbmRleCk7XHJcblxyXG4gICAgaWYgKCFjb2luKVxyXG4gICAgICByZXR1cm4gbnVsbDtcclxuXHJcbiAgICB0aGlzLm91dHB1dHMuZGVsZXRlKGluZGV4KTtcclxuXHJcbiAgICByZXR1cm4gY29pbjtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFRlc3Qgd2hldGhlciB0aGUgY29pbnMgYXJlIGZ1bGx5IHNwZW50LlxyXG4gICAqIEByZXR1cm5zIHtCb29sZWFufVxyXG4gICAqL1xyXG5cclxuICBpc0VtcHR5KCkge1xyXG4gICAgcmV0dXJuIHRoaXMub3V0cHV0cy5zaXplID09PSAwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogSW5qZWN0IHByb3BlcnRpZXMgZnJvbSB0eC5cclxuICAgKiBAcHJpdmF0ZVxyXG4gICAqIEBwYXJhbSB7VFh9IHR4XHJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGhlaWdodFxyXG4gICAqIEByZXR1cm5zIHtDb2luc31cclxuICAgKi9cclxuXHJcbiAgZnJvbVRYKHR4LCBoZWlnaHQpIHtcclxuICAgIGFzc2VydCh0eXBlb2YgaGVpZ2h0ID09PSAnbnVtYmVyJyk7XHJcblxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0eC5vdXRwdXRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IG91dHB1dCA9IHR4Lm91dHB1dHNbaV07XHJcblxyXG4gICAgICBpZiAob3V0cHV0LnNjcmlwdC5pc1Vuc3BlbmRhYmxlKCkpXHJcbiAgICAgICAgY29udGludWU7XHJcblxyXG4gICAgICBjb25zdCBlbnRyeSA9IENvaW5FbnRyeS5mcm9tVFgodHgsIGksIGhlaWdodCk7XHJcblxyXG4gICAgICB0aGlzLm91dHB1dHMuc2V0KGksIGVudHJ5KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEluc3RhbnRpYXRlIGEgY29pbnMgb2JqZWN0IGZyb20gYSB0cmFuc2FjdGlvbi5cclxuICAgKiBAcGFyYW0ge1RYfSB0eFxyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBoZWlnaHRcclxuICAgKiBAcmV0dXJucyB7Q29pbnN9XHJcbiAgICovXHJcblxyXG4gIHN0YXRpYyBmcm9tVFgodHgsIGhlaWdodCkge1xyXG4gICAgcmV0dXJuIG5ldyB0aGlzKCkuZnJvbVRYKHR4LCBoZWlnaHQpO1xyXG4gIH1cclxufVxyXG5cclxuLypcclxuICogRXhwb3NlXHJcbiAqL1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBDb2lucztcclxuIl19